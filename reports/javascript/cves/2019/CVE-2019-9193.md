---
cve_id: CVE-2019-9193
template_path: nuclei-templates/javascript/cves/2019/CVE-2019-9193.yaml
affected_product: PostgreSQL
severity: high
authentication: required
external_callback: false
affected_versions: 9.3 through 11.2
preconditions: Requires superuser privileges or membership in the 'pg_execute_server_program' group
poc_classification: rce
---

## Vulnerability
PostgreSQL 9.3 through 11.2 contains an authenticated remote code execution vulnerability (CVE-2019-9193). The COPY TO/FROM PROGRAM SQL functionality permits superusers and members of the pg_execute_server_program role to run arbitrary OS commands in the context of the database server OS user. This is enabled by default across Windows, Linux, and macOS.

Impact: Allows authenticated superusers to achieve arbitrary command execution, leading to full server compromise.

Remediation: Limit superuser and pg_execute_server_program role assignments. Disable COPY FROM PROGRAM functionality when not needed.

## PoC / Detection
Classification: rce

The JavaScript template connects to the PostgreSQL server on port 5432 using provided credentials (clustered with default postgres/postgres on postgres DB). It performs: CREATE TABLE with random name, COPY table FROM PROGRAM 'id' to execute the command and store output, SELECT * FROM table, then DROP TABLE. Detection succeeds by matching UID/GID regex output patterns and the cmd_output table reference.

## References
- https://github.com/vulhub/vulhub/tree/master/postgres/CVE-2019-9193
