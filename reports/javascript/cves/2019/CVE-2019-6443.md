---
cve_id: CVE-2019-6443
template_path: nuclei-templates/javascript/cves/2019/CVE-2019-6443.yaml
affected_product: NTPsec
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.1.3
preconditions: [NTPsec ntpd listening on UDP port 123]
poc_classification: info-leak
---

## Vulnerability
NTPsec before 1.1.3 contains a stack-based buffer over-read in `ctl_getitem` (called from `read_sysvars` in `ntp_control.c` of ntpd). Local or remote attackers can read sensitive memory by sending crafted NTP control requests over UDP/123. CVSS 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H); CWE-125.

## PoC / Detection
Classification: info-leak

The JavaScript template first verifies the UDP port 123 is open, then opens a UDP socket to `{{Host}}:123` and sends the hex payload `160203e80000000000000000`. It receives up to 1024 bytes, parses the response for an NTP version string (handling `ntpsec-` or `+` build suffixes), exports the cleaned version, and matches only when the response contains `ntpsec` **and** `compare_versions(version, '< 1.1.3')` evaluates to true.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2019-6443
- https://www.exploit-db.com/exploits/46175
