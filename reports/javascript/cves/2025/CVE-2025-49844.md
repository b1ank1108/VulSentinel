---
cve_id: CVE-2025-49844
template_path: nuclei-templates/javascript/cves/2025/CVE-2025-49844.yaml
affected_product: Redis Lua Parser
severity: critical
authentication: required
external_callback: false
affected_versions: < 8.2.2
preconditions: [Lua scripting enabled, EVAL/EVALSHA commands permitted by ACL]
poc_classification: rce
---

## Vulnerability

Redis is an open source, in-memory database that persists on disk. Versions 8.2.1 and below allow an authenticated user to use a specially crafted Lua script to manipulate the garbage collector, trigger a use-after-free and potentially lead to remote code execution. The problem exists in all versions of Redis with Lua scripting. This issue is fixed in version 8.2.2. Workaround without patching: use ACL to restrict EVAL and EVALSHA commands.

## PoC / Detection
Classification: rce

The template runs a two-step JavaScript flow. First, it verifies port 6379 is open, calls GetServerInfo to extract `redis_version` via regex and matches `compare_versions(version, ' < 8.2.2')`. Second, it executes the benign Lua payload `return "lua enabled"` via RunLuaScript (testing empty password) and confirms success plus response content to verify Lua execution is possible. Both steps must pass for detection.

## References
- https://www.wiz.io/blog/wiz-research-redis-rce-cve-2025-49844
- https://github.com/dwisiswant0/CVE-2025-49844
