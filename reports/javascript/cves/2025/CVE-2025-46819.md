---
cve_id: CVE-2025-46819
template_path: nuclei-templates/javascript/cves/2025/CVE-2025-46819.yaml
affected_product: Redis
severity: high
authentication: required
external_callback: false
affected_versions: < 8.2.2
preconditions: Lua scripting enabled and permission to execute EVAL or FUNCTION commands
poc_classification: info-leak
---

## Vulnerability
Redis versions below 8.2.2 contain an out-of-bounds read in Lua long-string delimiter handling. An authenticated user with Lua execution rights can submit specially crafted Lua scripts to read out-of-bounds memory or crash the server (denial of service). The flaw exists in all Redis versions with Lua scripting enabled. Fixed in 8.2.2. Workaround: use ACL to restrict EVAL and FUNCTION command families without patching.

## PoC / Detection
Classification: info-leak

The template runs a JavaScript flow (two stages) using the nuclei/redis library. Stage 1 opens port 6379, calls GetServerInfo, extracts the redis_version via regex, and matches success + compare_versions < 8.2.2. Stage 2 calls RunLuaScript with empty password (from payloads) and benign payload `return "lua enabled"`, matching success + response contains "lua enabled" (internal matcher). Both stages must succeed to confirm the vulnerable configuration and exploitable preconditions; no malicious OOB-triggering payload is sent.

## References
- https://github.com/dwisiswant0/CVE-2025-46819
