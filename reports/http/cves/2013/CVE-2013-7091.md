---
cve_id: CVE-2013-7091
template_path: nuclei-templates/http/cves/2013/CVE-2013-7091.yaml
affected_product: Zimbra Collaboration Server
severity: medium
authentication: none
external_callback: false
affected_versions: 7.2.2, 8.0.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A directory traversal vulnerability (CVE-2013-7091, CWE-22) in Zimbra Collaboration Server 7.2.2 and 8.0.2 allows unauthenticated remote attackers to read arbitrary files. The flaw is triggered via the `skin` parameter in `/res/I18nMsg,AjxMsg,ZMsg,ZmMsg,AjxKeys,ZmKeys,ZdMsg,Ajx%20TemplateMsg.js.zgz` using `../` sequences (null-byte terminated). Reading `/opt/zimbra/conf/localconfig.xml` exposes LDAP credentials (`zimbra_ldap_password`, `ldap_*_password`, MySQL root password), enabling subsequent SOAP API abuse for code execution.

**CVSS**: 5.0 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N)  
**Impact**: Successful exploitation allows reading sensitive server files, leading to credential theft and potential full compromise.  
**Remediation**: Apply latest security patches or upgrade to a newer Zimbra version.

## PoC / Detection
Classification: info-leak

The template issues two unauthenticated GET requests to the vulnerable endpoint, injecting `skin=../../../../../../../../../opt/zimbra/conf/localconfig.xml%00` (first) and `skin=../../../../../../../../../etc/passwd%00` (second). It stops at the first match and confirms exploitation if the response contains any Zimbra config string (`zimbra_server_hostname`, `zimbra_ldap_userdn`, `zimbra_ldap_password`, `ldap_postfix_password`, `ldap_amavis_password`, `ldap_nginx_password`, `mysql_root_password`) or matches the regex `root:.*:0:0:`.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2013-7091
- https://www.exploit-db.com/exploits/30085
- https://www.exploit-db.com/exploits/30472
- http://www.exploit-db.com/exploits/30085
- http://packetstormsecurity.com/files/124321
