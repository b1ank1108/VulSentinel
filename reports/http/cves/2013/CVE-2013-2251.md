---
cve_id: CVE-2013-2251
template_path: nuclei-templates/http/cves/2013/CVE-2013-2251.yaml
affected_product: Apache Struts 2
severity: critical
authentication: none
external_callback: false
affected_versions: before 2.3.15.1
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache Struts 2 before 2.3.15.1 does not properly sanitize prefixes "action:", "redirect:", or "redirectAction:" in the DefaultActionMapper. These values are evaluated as OGNL expressions against the value stack, enabling unauthenticated remote code execution.  
CVSS:2.0/AV:N/AC:M/Au:N/C:C/I:C/A:C (score 9.3).  
Impact: full system takeover via arbitrary command execution.  
Remediation: upgrade to 2.3.15.1 or later.

## PoC / Detection
Classification: rce  
The template issues three raw GET requests to `/index.action` and `/login.action` using `redirect`, `action`, or `redirectAction` as the parameter prefix. Each request embeds one of two OGNL payloads that instantiate `ProcessBuilder`/`Runtime.exec("sh -c id")`, capture stdout, and write the output directly to the HTTP response via the servlet writer. Detection succeeds if the body regex matches `((u|g)id|groups)=[0-9]{1,4}\([a-z0-9]+\)` and the status is 200 or 400.

## References
- http://struts.apache.org/release/2.3.x/docs/s2-016.html
- https://cwiki.apache.org/confluence/display/WW/S2-016
- https://nvd.nist.gov/vuln/detail/CVE-2013-2251
- http://archiva.apache.org/security.html
- http://cxsecurity.com/issue/WLB-2014010087
