---
cve_id: CVE-2013-1965
template_path: nuclei-templates/http/cves/2013/CVE-2013-1965.yaml
affected_product: Apache Struts2
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0.0 through 2.3.13 (Struts 2 before 2.3.14.3)
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache Struts2 S2-012 (CVE-2013-1965) permits remote unauthenticated attackers to execute arbitrary OGNL code through a crafted parameter name that bypasses proper sanitization during redirect invocation. The flaw exists in Apache Struts Showcase App 2.0.0â€“2.3.13 and the Struts 2 framework prior to 2.3.14.3. Impact includes full remote code execution on the server. CVSS 2.0: 9.3 (AV:N/AC:M/Au:N/C:C/I:C/A:C). CWE-94. Remediation requires upgrade to Struts 2.3.14.3 or later.

## PoC / Detection
Classification: rce

The template issues a single POST to `{{BaseURL}}/user.action` using `Content-Type: application/x-www-form-urlencoded`. The `name` parameter carries a URL-encoded OGNL expression that instantiates `java.lang.ProcessBuilder` to run `cat /etc/passwd`, redirects stderr, reads the output stream into a 50 kB buffer, and writes the result directly to the servlet response writer before flushing and closing. Success is confirmed by HTTP 200 status combined with a regex match on `root:.*:0:0:` appearing in the body.

## References
- http://struts.apache.org/development/2.x/docs/s2-012.html
- https://nvd.nist.gov/vuln/detail/CVE-2013-1965
- https://bugzilla.redhat.com/show_bug.cgi?id=967655
- https://github.com/CrackerCat/myhktools
- https://github.com/GhostTroops/myhktools
