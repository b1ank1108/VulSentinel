---
cve_id: CVE-2014-8799
template_path: nuclei-templates/http/cves/2014/CVE-2014-8799.yaml
affected_product: WordPress DukaPress plugin
severity: medium
authentication: none
external_callback: false
affected_versions: before 2.5.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress DukaPress plugin before 2.5.4 contains a directory traversal vulnerability (CWE-22) in the `dp_img_resize` function of `php/dp-functions.php`. Unauthenticated remote attackers can read arbitrary files on the server by supplying `../` sequences in the `src` parameter to `/wp-content/plugins/dukapress/lib/dp_image.php`.

CVSS 2.0: 5.0 (AV:N/AC:L/Au:N/C:P/I:N/A:N). Successful exploitation discloses sensitive files such as `wp-config.php`, exposing database credentials and other secrets and enabling further server compromise.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/wp-content/plugins/dukapress/lib/dp_image.php?src=../../../../wp-config.php` and verifies exploitation by confirming HTTP 200 status together with the simultaneous presence of the four database configuration constants (`DB_NAME`, `DB_PASSWORD`, `DB_USER`, `DB_HOST`) in the response body.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2014-8799
- https://www.exploit-db.com/exploits/35346
- https://wordpress.org/plugins/dukapress/changelog/
- https://exchange.xforce.ibmcloud.com/vulnerabilities/98943
- https://plugins.trac.wordpress.org/changeset/1024640/dukapress
