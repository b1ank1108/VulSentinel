---
cve_id: CVE-2014-4535
template_path: nuclei-templates/http/cves/2014/CVE-2014-4535.yaml
affected_product: Import Legacy Media
severity: medium
authentication: none
external_callback: false
affected_versions: <= 0.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Import Legacy Media plugin for WordPress (0.1 and earlier) is vulnerable to reflected cross-site scripting. Remote attackers can inject arbitrary web script or HTML via the `filename` parameter to `/wp-content/plugins/import-legacy-media/getid3/demos/demo.mimeonly.php`.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1); CWE-79.

## PoC / Detection
Classification: info-leak  
The template first requests `{{BaseURL}}` and internally matches the plugin directory string `/wp-content/plugins/import-legacy-media/` to confirm installation. It then sends a GET request to `{{BaseURL}}/wp-content/plugins/import-legacy-media/getid3/demos/demo.mimeonly.php?filename=filename%27%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`, verifying the exact payload string is reflected unescaped in the body, the `Content-Type` header contains `text/html`, and status code is 200.

## References
- https://wpscan.com/vulnerability/7fb78d3c-f784-4630-ad92-d33e5de814fd
- https://nvd.nist.gov/vuln/detail/CVE-2014-4535
- http://codevigilant.com/disclosure/wp-plugin-import-legacy-media-a3-cross-site-scripting-xss
- https://github.com/ARPSyndicate/kenzer-templates
