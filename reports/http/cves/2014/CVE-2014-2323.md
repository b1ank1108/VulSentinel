---
cve_id: CVE-2014-2323
template_path: nuclei-templates/http/cves/2014/CVE-2014-2323.yaml
affected_product: Lighttpd
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.4.35
preconditions: mod_mysql_vhost module enabled
poc_classification: info-leak
---

## Vulnerability
SQL injection in mod_mysql_vhost.c of Lighttpd before 1.4.35 allows remote attackers to execute arbitrary SQL commands via the Host header (related to request_check_hostname). The flaw also enables path traversal.

CVSS v3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H), CWE-89.  
Impact: Unauthorized access to sensitive data and remote code execution.  
Remediation: Upgrade to 1.4.35 or later or apply security patches.

## PoC / Detection
Classification: info-leak

The template sends a single raw HTTP GET request to `/etc/passwd` with the Host header `[::1]' UNION SELECT '/'` (unsafe: true) and matches the response body against the regex `root:[x*]:0:0:` to confirm successful file disclosure via the SQL injection combined with path traversal.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2014-2323
- https://download.lighttpd.net/lighttpd/security/lighttpd_sa_2014_01.txt
- http://www.lighttpd.net/2014/3/12/1.4.35/
- http://seclists.org/oss-sec/2014/q1/561
- http://jvn.jp/en/jp/JVN37417423/index.html
