---
cve_id: CVE-2014-3120
template_path: nuclei-templates/http/cves/2014/CVE-2014-3120.yaml
affected_product: Elasticsearch
severity: medium
authentication: none
external_callback: false
affected_versions: before 1.2
preconditions: dynamic scripting enabled (default configuration)
poc_classification: rce
---

## Vulnerability
The default configuration in Elasticsearch before 1.2 enables dynamic scripting, which allows remote attackers to execute arbitrary MVEL expressions and Java code via the source parameter to _search. This only violates the vendor's intended security policy if the user does not run Elasticsearch in its own independent virtual machine.

Impact: Allows remote attackers to execute arbitrary code on the affected system.  
Remediation: Upgrade to a patched version of Elasticsearch.

## PoC / Detection
Classification: rce  
The template sends a POST request to `/_search?pretty` with a JSON body containing a `script_fields` entry that injects Java code to run `cat /etc/passwd` via `Runtime.getRuntime().exec()`. It detects successful execution by matching `application/json` in the header, HTTP 200 status, and the regex `root:.*:0:0:` appearing in the response body (proving the command output was returned inline).

## References
- https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2014-3120
- https://www.elastic.co/blog/logstash-1-4-3-released
- https://nvd.nist.gov/vuln/detail/CVE-2014-3120
- http://bouk.co/blog/elasticsearch-rce/
- https://www.elastic.co/community/security/
