---
cve_id: CVE-2014-3704
template_path: nuclei-templates/http/cves/2014/CVE-2014-3704.yaml
affected_product: Drupal
severity: high
authentication: none
external_callback: false
affected_versions: 7.x before 7.32
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The expandArguments function in Drupal core 7.x database abstraction API (before 7.32) fails to safely construct prepared statements when processing array parameters containing specially crafted keys. This enables unauthenticated remote SQL injection.  
CVSS 2.0: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P) â€¢ CWE-89.  
Successful exploitation yields unauthorized database read/write access, data leakage, and full application compromise.  
Remediation: upgrade to Drupal core 7.32 or later.

## PoC / Detection
Classification: info-leak  
The template issues one unauthenticated POST to `{{BaseURL}}/?q=node&destination=node` carrying a login-block form payload where the `name` array key is crafted as `[0 or updatexml(0x23,concat(1,md5(999999999)),1)%23]` to force a MySQL XPath evaluation error. Detection matches HTTP 500 responses whose body simultaneously contains the string "PDOException" and the literal MD5 hash of 999999999, confirming error-based SQL injection that leaks computed values.

## References
- https://www.drupal.org/forum/newsletters/security-advisories-for-drupal-core/2014-10-15/sa-core-2014-005-drupal-core-sql
- https://nvd.nist.gov/vuln/detail/CVE-2014-3704
- https://www.drupal.org/SA-CORE-2014-005
- https://www.exploit-db.com/exploits/34984
- https://www.exploit-db.com/exploits/34992
- https://www.exploit-db.com/exploits/34993
- https://www.exploit-db.com/exploits/35150
