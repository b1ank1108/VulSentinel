---
cve_id: CVE-2014-8682
template_path: nuclei-templates/http/cves/2014/CVE-2014-8682.yaml
affected_product: Gogs (Go Git Service)
severity: high
authentication: none
external_callback: false
affected_versions: 0.3.1-9 through 0.5.x before 0.5.6.1105 Beta
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Gogs (aka Go Git Service) 0.3.1-9 through 0.5.x before 0.5.6.1105 Beta contains multiple SQL injection vulnerabilities. Remote attackers can execute arbitrary SQL commands via the unsanitized `q` parameter to `/api/v1/repos/search` (models/repo.go) or `/api/v1/users/search` (models/user.go).  
CVSS v2.0: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P). CWE-89.  
Successful exploitation enables unauthorized access, data leakage, modification, and full system compromise.

## PoC / Detection
Classification: info-leak  
The template performs a single unauthenticated GET request to `{{BaseURL}}/api/v1/repos/search?q=...` with a crafted UNION SELECT payload (closing the original query, injecting multiple JOINs and SELECT user() statements to force valid result structure). It matches on HTTP 200 status plus body keywords `"ok":true`, `"data"`, and `"repolink":"` to confirm the injection succeeded and database data was returned.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2014-8682
- http://seclists.org/fulldisclosure/2014/Nov/33
- http://packetstormsecurity.com/files/129117/Gogs-Repository-Search-SQL-Injection.html
- https://github.com/gogits/gogs/commit/0c5ba4573aecc9eaed669e9431a70a5d9f184b8d
- https://www.exploit-db.com/exploits/35238
- https://exchange.xforce.ibmcloud.com/vulnerabilities/98694
