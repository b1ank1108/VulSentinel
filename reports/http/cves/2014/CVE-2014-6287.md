---
cve_id: CVE-2014-6287
template_path: nuclei-templates/http/cves/2014/CVE-2014-6287.yaml
affected_product: HTTP File Server
severity: critical
authentication: none
external_callback: false
affected_versions: <2.3c
preconditions: []
poc_classification: rce
---

## Vulnerability
HTTP File Server (by Rejetto) versions before 2.3c are susceptible to remote command execution. The findMacroMarker function in parserLib.pas allows an attacker to execute arbitrary programs via a %00 sequence in a search action. An attacker can obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials.

**Impact:** Successful exploitation allows remote attackers to execute arbitrary commands on the target system.  
**Remediation:** Upgrade to HTTP File Server >=2.3c.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-94

## PoC / Detection
Classification: rce

The template sends a single unauthenticated GET request to `{{BaseURL}}/?search==%00{.cookie|{{rand_base(6)}}|value%3dCVE-2014-6287.}` (using random values for macro injection) and verifies exploitation conditions via an AND matcher:  
- response body contains `<title>HFS /</title>`  
- response header contains both `Set-Cookie: <random>=CVE-2014-6287;` and `text/html`  
- HTTP status 200  

This confirms the server processes the vulnerable null-byte + macro sequence.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6287
- http://www.kb.cert.org/vuls/id/251276
- http://packetstormsecurity.com/files/128243/HttpFileServer-2.3.x-Remote-Command-Execution.html
- https://github.com/rapid7/metasploit-framework/pull/3793
- https://nvd.nist.gov/vuln/detail/CVE-2014-6287
