---
cve_id: CVE-2010-4977
template_path: nuclei-templates/http/cves/2010/CVE-2010-4977.yaml
affected_product: Joomla! Component Canteen
severity: high
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: [Canteen (com_canteen) component installed on Joomla!]
poc_classification: info-leak
---

## Vulnerability
Joomla! Component Canteen 1.0 (com_canteen by miniwork) for Joomla! is affected by local file inclusion. Remote unauthenticated attackers can traverse directories via the `controller` parameter passed to index.php?option=com_canteen (null-byte terminated) to read arbitrary local files such as /etc/passwd. The info.description additionally references a SQL injection in menu.php via the mealid parameter allowing arbitrary SQL execution. Impact includes unauthorized access to sensitive files, remote code execution, and potential full compromise of the Joomla! installation. CVSS 2.0: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P), CWE-89.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/index.php?option=com_canteen&controller=../../../../../etc/passwd%00` and verifies success with HTTP 200 status code plus regex matcher `root:.*:0:0:` confirming /etc/passwd contents were returned.

## References
- https://www.exploit-db.com/exploits/34250
- https://nvd.nist.gov/vuln/detail/CVE-2010-4977
- http://www.salvatorefresta.net/files/adv/Canteen%20Joomla%20Component%201.0%20Multiple%20Remote%20Vulnerabilities-04072010.txt
- http://packetstormsecurity.org/1007-exploits/joomlacanteen-lfisql.txt
- http://securityreason.com/securityalert/8495
