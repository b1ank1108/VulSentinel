---
cve_id: CVE-2010-4282
template_path: nuclei-templates/http/cves/2010/CVE-2010-4282.yaml
affected_product: Pandora FMS
severity: high
authentication: none
external_callback: false
affected_versions: before 3.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Pandora FMS before 3.1.1 is affected by multiple directory traversal vulnerabilities. Remote unauthenticated attackers can exploit the `page` parameter to `ajax.php`, the `id` parameter to `general/pandora_help.php`, and the `layout` parameter to `operation/agentes/networkmap.php` to include and execute arbitrary local files, or to create, modify, or delete arbitrary local files.

This enables access to sensitive files containing confidential information such as configuration files or user credentials.  
CVSS 2.0: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P) | CWE-22.

Remediation: Upgrade to version 3.1.1 or later and apply the provided security patch.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing a single unauthenticated GET request to `{{BaseURL}}/pandora_console/ajax.php?page=../../../../../../etc/passwd` and checking if the server responds with status 200 and a regex match for `root:.*:0:0:` indicating successful path traversal and disclosure of `/etc/passwd`.

## References
- https://www.exploit-db.com/exploits/15643
- https://nvd.nist.gov/vuln/detail/CVE-2010-4282
- http://sourceforge.net/projects/pandora/files/Pandora%20FMS%203.1/Final%20version%20%28Stable%29/pandorafms_console-3.1_security_patch_13Oct2010.tar.gz/download
- http://www.exploit-db.com/exploits/15643
- http://seclists.org/fulldisclosure/2010/Nov/326
