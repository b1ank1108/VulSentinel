---
cve_id: CVE-2019-6715
template_path: nuclei-templates/http/cves/2019/CVE-2019-6715.yaml
affected_product: W3 Total Cache
severity: high
authentication: none
external_callback: false
affected_versions: 0.9.2.6 through 0.9.3 (before 0.9.4)
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-6715 is an unauthenticated file read and directory traversal vulnerability in the W3 Total Cache WordPress plugin versions 0.9.2.6 through 0.9.3 (before 0.9.4). The vulnerability exists in the `pub/sns.php` endpoint, which processes Amazon SNS (Simple Notification Service) subscription confirmation requests. Remote attackers can exploit this flaw by sending specially crafted JSON data containing a malicious `SubscribeURL` field in `SubscriptionConfirmation` messages. The vulnerable endpoint improperly validates and processes the URL, allowing attackers to read arbitrary files from the server's filesystem or traverse directories without authentication. This can lead to unauthorized access to sensitive files, configuration data, database credentials, or other confidential information stored on the target system.

The CVSS v3.1 score of 7.5 (High) reflects the severity of this information disclosure vulnerability, with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a PUT request to `/wp-content/plugins/w3-total-cache/pub/sns.php` with a JSON payload containing a `SubscriptionConfirmation` type message. The payload includes a `SubscribeURL` field pointing to a known test file at `https://rfi.nessus.org/rfi.txt`. 

The template verifies successful exploitation by checking if the response body contains the base64-encoded string `TmVzc3VzQ29kZUV4ZWNUZXN0` (which decodes to "NessusCodeExecTest"), indicating that the vulnerable endpoint successfully fetched and processed the remote file content. This confirms the file read capability and validates the presence of CVE-2019-6715.

Note: This template is marked as "intrusive" as it actively attempts to trigger the vulnerability by causing the target server to make an external HTTP request.

## References

- https://vinhjaxt.github.io/2019/03/cve-2019-6715
- http://packetstormsecurity.com/files/160674/WordPress-W3-Total-Cache-0.9.3-File-Read-Directory-Traversal.html
- https://nvd.nist.gov/vuln/detail/CVE-2019-6715
- https://github.com/sobinge/nuclei-templates
- https://github.com/random-robbie/cve-2019-6715
