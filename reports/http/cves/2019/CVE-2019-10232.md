---
cve_id: CVE-2019-10232
template_path: nuclei-templates/http/cves/2019/CVE-2019-10232.yaml
affected_product: Teclib GLPI
severity: critical
authentication: none
external_callback: false
affected_versions: <= 9.3.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Teclib GLPI versions 9.3.3 and earlier contain an unauthenticated SQL injection vulnerability in the `/scripts/unlock_tasks.php` script. The script fails to properly sanitize user-controlled data before incorporating it into SQL queries. An attacker can manipulate the `cycle` parameter to inject arbitrary SQL commands, altering the semantic structure of the original query to extract database records. This vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8, indicating critical severity. The vulnerability allows network-based attacks with low complexity, requires no privileges or user interaction, and can impact confidentiality, integrity, and availability.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending GET requests to the vulnerable `unlock_tasks.php` script with a crafted SQL injection payload in the `cycle` parameter. The payload uses a UNION-based SQL injection technique (`cycle=1 UNION ALL SELECT 1,(@@version)-- &only_tasks=1`) to extract the database version information. The template tests two possible paths where the script might be located (`/glpi/scripts/` and `/scripts/`). 

Detection is confirmed when the response body contains both "-MariaDB-" (indicating successful extraction of the database version) and "Start unlock script" (confirming the script executed). The template also extracts the specific MariaDB version number using a regex pattern. This demonstrates the vulnerability allows unauthorized database information disclosure without authentication.

## References

- https://www.synacktiv.com/ressources/advisories/GLPI_9.3.3_SQL_Injection.pdf
- https://github.com/glpi-project/glpi/commit/684d4fc423652ec7dde21cac4d41c2df53f56b3c
- https://nvd.nist.gov/vuln/detail/CVE-2019-10232
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/HimmelAward/Goby_POC
