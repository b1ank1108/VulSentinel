---
cve_id: CVE-2019-13396
template_path: nuclei-templates/http/cves/2019/CVE-2019-13396.yaml
affected_product: FlightPath
severity: medium
authentication: none
external_callback: false
affected_versions: <4.8.2, 5.0-rc2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

FlightPath versions prior to 4.8.2 and 5.0-rc2 contain a local file inclusion (LFI) vulnerability classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory). The vulnerability exists in the form submission handling mechanism at `/flightpath/index.php?q=system-handle-form-submit`, where the `form_include` parameter is not properly sanitized. This allows attackers to traverse directories and include arbitrary files from the server's filesystem without authentication.

The vulnerability can lead to unauthorized access to sensitive files, data leakage, and potentially remote code execution if combined with other attack vectors. The CVSS v3.0 score is 5.3 (Medium), with an EPSS score of 0.66535 (98.5th percentile), indicating a relatively high probability of exploitation in the wild.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Initial Request**: Sends a GET request to `/login` to retrieve a valid `form_token` value from the login page HTML
2. **Exploitation Attempt**: Submits a POST request to `/flightpath/index.php?q=system-handle-form-submit` with:
   - The extracted `form_token` for CSRF validation
   - `callback=system_login_form` parameter
   - `form_include=../../../../../../../../../etc/passwd` parameter containing directory traversal sequences

The template confirms the vulnerability by:
- Checking for a 200 HTTP status code
- Matching the regex pattern `root:.*:0:0:` in the response body, which indicates successful reading of the `/etc/passwd` file

This demonstrates the ability to read arbitrary files from the server filesystem through path traversal.

## References

- https://www.exploit-db.com/exploits/47121
- http://getflightpath.com/node/2650
- https://nvd.nist.gov/vuln/detail/CVE-2019-13396
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/d4n-sec/d4n-sec.github.io
