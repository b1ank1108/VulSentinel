---
cve_id: CVE-2019-5591
template_path: nuclei-templates/http/cves/2019/CVE-2019-5591.yaml
affected_product: FortiOS
severity: medium
authentication: none
external_callback: true
affected_versions: unknown
preconditions: insecure LDAP configuration (missing ca-cert, secure LDAPS, or server-identity-check); attacker positioned to impersonate LDAP server within same subnet
poc_classification: info-leak
---

## Vulnerability
FortiOS (FortiGate) LDAP server configuration is insecure when ca-cert, secure LDAPS, or server-identity-check options are missing. This exposes LDAP bind/auth traffic to interception and man-in-the-middle attacks. Unauthenticated remote attackers on the same subnet as the LDAP server can impersonate it and capture credentials under specific network conditions. CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 6.5). Remediation requires proper LDAP settings plus latest firmware.

## PoC / Detection
Classification: info-leak

The template performs a two-step HTTP interaction to verify the misconfiguration:  
1. GET /login checks that the login form body contains both `name="username"` and `name="secretkey"`.  
2. POST /logincheck (Content-Type: text/plain) submits `ajax=1&username=<random>&secretkey={{interactsh-url}}` and matches on body_2 containing status codes 0/1/2 (or not echoing the ajax parameter) plus an out-of-band DNS or HTTP callback to the interactsh server.  
This probe confirms the LDAP settings allow credential-related traffic that can be hijacked for interception.

## References
- https://github.com/ayewo/fortios-ldap-mitm-poc-CVE-2019-5591
- https://www.fortiguard.com/psirt/FG-IR-19-037
