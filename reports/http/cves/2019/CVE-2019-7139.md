---
cve_id: CVE-2019-7139
template_path: nuclei-templates/http/cves/2019/CVE-2019-7139.yaml
affected_product: Magento
severity: critical
authentication: none
external_callback: false
affected_versions: Magento 2.1 prior to 2.1.18, Magento 2.2 prior to 2.2.9, Magento 2.3 prior to 2.3.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
An unauthenticated SQL injection (CVE-2019-7139) in the `/catalog/product_frontend_action/synchronize` endpoint allows arbitrary read access to the underlying database. This causes sensitive data leakage including customer information, payment details, and administrative credentials, potentially leading to complete store compromise.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-89.

## PoC / Detection
Classification: info-leak

The template first issues a GET request to `/` (with up to 2 redirects) and matches status 200 + `text/x-magento-init` in the body to fingerprint Magento installations. It then sends three crafted GET requests to the synchronize endpoint injecting payloads into the `ids[0][product_id][to]` parameter: a time-based query using `SLEEP(8)` and two blind boolean UNION SELECT queries (false/true conditions). Detection matches on response duration (>=8s + JSON content-type) for time-based or on status codes (200/400), content-type (JSON), and body lengths (exactly 2 bytes) for blind.

## References
- https://pentest-tools.com/blog/exploiting-sql-injection-in-magento-with-sqlmap
- https://www.ambionics.io/blog/magento-sqli
- https://magento.com/security/patches/magento-2.3.2-2.2.9-and-2.1.18-security-update-13
- https://github.com/koutto/jok3r-pocs
- https://nvd.nist.gov/vuln/detail/CVE-2019-7139
