---
cve_id: CVE-2019-18957
template_path: nuclei-templates/http/cves/2019/CVE-2019-18957.yaml
affected_product: MicroStrategy Library
severity: medium
authentication: none
external_callback: false
affected_versions: before 11.1.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
MicroStrategy Library before 11.1.3 contains a reflected cross-site scripting (XSS) vulnerability in the `/MicroStrategyLibrary/auth/ui/loginPage` endpoint. The `loginMode` parameter allows injection of arbitrary JavaScript payloads that execute in the context of the victim's browser when the crafted URL is visited. This can enable session hijacking via cookie theft, website defacement, or other client-side attacks.

Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information. The issue is resolved by upgrading to 11.1.3.

## PoC / Detection
Classification: info-leak

The template issues a GET request to `{{BaseURL}}/MicroStrategyLibrary/auth/ui/loginPage?loginMode=alert(document.domain)` and matches for reflection of the unsanitized payload ("previousLoginMode: alert(document.domain),") in the response body along with HTTP 200 status and text/html content-type to confirm the XSS condition.

## References
- https://seclists.org/bugtraq/2019/Nov/23
- https://packetstormsecurity.com/files/155320/MicroStrategy-Library-Cross-Site-Scripting.html
- https://nvd.nist.gov/vuln/detail/CVE-2019-18957
- http://packetstormsecurity.com/files/155320/MicroStrategy-Library-Cross-Site-Scripting.html
- http://seclists.org/fulldisclosure/2019/Nov/4
