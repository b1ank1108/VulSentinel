---
cve_id: CVE-2019-19781
template_path: nuclei-templates/http/cves/2019/CVE-2019-19781.yaml
affected_product: Citrix ADC and Gateway
severity: critical
authentication: none
external_callback: false
affected_versions: 10.5, 11.1, 12.0, 12.1, 13.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-19781 is a critical directory traversal vulnerability affecting Citrix Application Delivery Controller (ADC) and Gateway versions 10.5, 11.1, 12.0, 12.1, and 13.0. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no privileges or user interaction required.

The flaw allows unauthenticated remote attackers to traverse directories and access sensitive files on the affected systems. Successful exploitation can lead to unauthorized access to sensitive information, potential data leakage, and further compromise of the affected system, including the possibility of remote code execution. The vulnerability has an EPSS score of 0.94442 (99.989th percentile), indicating extremely high likelihood of active exploitation in the wild. It is listed in the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by attempting to exploit the directory traversal flaw to read a sensitive configuration file. It sends a GET request to `/vpn/../vpns/cfg/smb.conf`, using path traversal sequences to escape the intended directory structure and access the Samba configuration file (`smb.conf`).

The detection logic verifies successful exploitation by checking for:
1. The presence of the string `[global]` in the response body, which is a standard section header in Samba configuration files
2. An HTTP 200 status code, indicating successful file retrieval

Both conditions must be satisfied for the vulnerability to be confirmed. The successful retrieval of this configuration file demonstrates that an attacker can bypass directory restrictions and read arbitrary files on the system, which could expose credentials, configuration details, and other sensitive information.

## References

- https://support.citrix.com/article/CTX267027
- https://nvd.nist.gov/vuln/detail/CVE-2019-19781
- https://www.kb.cert.org/vuls/id/619785
- http://packetstormsecurity.com/files/155904/Citrix-Application-Delivery-Controller-Gateway-Remote-Code-Execution.html
- http://packetstormsecurity.com/files/155905/Citrix-Application-Delivery-Controller-Gateway-Remote-Code-Execution-Traversal.html
