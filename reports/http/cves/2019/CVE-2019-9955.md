---
cve_id: CVE-2019-9955
template_path: nuclei-templates/http/cves/2019/CVE-2019-9955.yaml
affected_product: Zyxel Firewall Devices
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-9955 is a reflected cross-site scripting (XSS) vulnerability affecting multiple Zyxel firewall and security gateway devices including ATP200, ATP500, ATP800, USG20-VPN, USG20W-VPN, USG40, USG40W, USG60, USG60W, USG110, USG210, USG310, USG1100, USG1900, USG2200-VPN, ZyWALL 110, ZyWALL 310, and ZyWALL 1100. The vulnerability exists on the security firewall login page and is triggered through the `mp_idx` parameter. When exploited, attackers can inject malicious JavaScript that executes in the context of a victim's browser session. This can lead to theft of cookies, session tokens, or enable attackers to perform unauthorized actions on behalf of authenticated users. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity). The attack vector is network-based, requires low attack complexity, no privileges, but does require user interaction with a specially crafted URL.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the target's root path with a crafted `mp_idx` parameter containing a JavaScript payload: `"?mp_idx=%22;alert(%271%27);//"`. The payload attempts to break out of a JavaScript string context and inject an alert function. The template verifies successful exploitation by checking for two conditions in the response body: (1) the reflected payload `";alert('1');//` appears unescaped in the HTML, and (2) the page contains `<title>Welcome</title>`, confirming it's the login page. If both conditions are met, the vulnerability is confirmed as the application fails to properly sanitize user input before reflecting it in the response.

## References

- http://packetstormsecurity.com/files/152525/Zyxel-ZyWall-Cross-Site-Scripting.html
- https://www.exploit-db.com/exploits/46706/
- https://www.securitymetrics.com/blog/Zyxel-Devices-Vulnerable-Cross-Site-Scripting-Login-page
- https://www.zyxel.com/support/reflected-cross-site-scripting-vulnerability-of-firewalls.shtml
- https://nvd.nist.gov/vuln/detail/CVE-2019-9955
