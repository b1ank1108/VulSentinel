---
cve_id: CVE-2019-9879
template_path: nuclei-templates/http/cves/2019/CVE-2019-9879.yaml
affected_product: WPGraphQL
severity: critical
authentication: none
external_callback: false
affected_versions: 0.2.3
preconditions: [new user registrations are allowed]
poc_classification: state-change
---

## Vulnerability
WPGraphQL 0.2.3 plugin for WordPress allows unauthenticated remote attackers to register a new administrator user via the `registerUser` GraphQL mutation when new user registrations are enabled. This stems from missing authorization checks on the mutation (CWE-306). Impact: attackers can create admin users, leading to full control over the WordPress site. CVSS: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: state-change

The template sends a single raw POST request to `/` containing a GraphQL mutation that registers a user with randomly generated username, password, email, and explicitly sets the `roles` to `["administrator"]`. Success is matched by HTTP 200 status, JSON content-type, and presence of the clientMutationId along with `{"status":` in the response body, confirming the account creation.

## References
- https://github.com/wp-graphql/wp-graphql/releases/tag/v0.3.0
- https://github.com/pentestpartners/snippets/blob/master/wp-graphql0.2.3_exploit.py
- https://wpscan.com/vulnerability/2d451c89-91ce-4151-b3fb-56af15869644/
- https://nvd.nist.gov/vuln/detail/CVE-2019-9879
