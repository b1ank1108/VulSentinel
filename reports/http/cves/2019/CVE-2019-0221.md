---
cve_id: CVE-2019-0221
template_path: nuclei-templates/http/cves/2019/CVE-2019-0221.yaml
affected_product: Apache Tomcat
severity: medium
authentication: none
external_callback: false
affected_versions: 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39, and 7.0.0 to 7.0.93
preconditions: SSI enabled (disabled by default)
poc_classification: info-leak
---

## Vulnerability
Apache Tomcat versions 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39, and 7.0.0 to 7.0.93 suffer from a cross-site scripting (XSS) vulnerability in the Server Side Includes (SSI) `printenv` command. This command echoes user-controlled data such as QUERY_STRING without HTML escaping, enabling script injection when SSI is active. SSI is disabled by default and the printenv command is for debugging, reducing likelihood in production. CVSS 6.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), CWE-79.

## PoC / Detection
Classification: info-leak

The template issues GET requests to `/printenv.shtml` and `/ssi/printenv.shtml` appending a URL-encoded payload `<script>alert({{rand_int()}})</script>`. It matches for the literal unescaped payload appearing in `QUERY_STRING_UNESCAPED=` within the response body (indicating missing output sanitization), alongside status 200 and `text/html` Content-Type. This confirms the reflected XSS condition.

## References
- https://seclists.org/fulldisclosure/2019/May/50
- https://wwws.nightwatchcybersecurity.com/2019/05/27/xss-in-ssi-printenv-command-apache-tomcat-cve-2019-0221/
- https://www.exploit-db.com/exploits/50119
- https://lists.apache.org/thread.html/6e6e9eacf7b28fd63d249711e9d3ccd4e0a83f556e324aee37be5a8c@%3Cannounce.tomcat.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2019-0221
