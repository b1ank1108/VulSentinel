---
cve_id: CVE-2019-15043
template_path: nuclei-templates/http/cves/2019/CVE-2019-15043.yaml
affected_product: Grafana
severity: high
authentication: none
external_callback: false
affected_versions: 2.x through 6.x before 6.3.4
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2019-15043 is an improper access control vulnerability affecting Grafana versions 2.x through 6.x before 6.3.4. The vulnerability stems from insufficient access controls on the snapshot API endpoint, allowing unauthenticated attackers to create and delete arbitrary snapshots without proper authorization checks. This is classified as CWE-306 (Missing Authentication for Critical Function). The CVSS v3.0 score is 7.5 (High), with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction. While the confidentiality and integrity impacts are rated as none, the availability impact is high, making this primarily a denial of service vulnerability. Successful exploitation allows attackers to create numerous snapshots to exhaust system resources or delete legitimate snapshots, disrupting service availability and potentially causing data loss of saved dashboard states.

## PoC / Detection

Classification: state-change

The template detects this vulnerability by attempting to create an unauthorized snapshot through the `/api/snapshots` API endpoint. It sends an unauthenticated POST request with a JSON payload containing a dashboard object with a name field populated by 4000 repeated "A" characters. The template verifies successful exploitation by checking for:

1. A 200 HTTP status code indicating successful snapshot creation
2. The presence of all four expected JSON response fields: `deleteUrl`, `deleteKey`, `key`, and `url` in the response body
3. An `application/json` content-type header in the response

The detection confirms that the API endpoint accepts and processes snapshot creation requests without requiring authentication, demonstrating the improper access control vulnerability. The template is marked as "intrusive" because it actually creates a snapshot on the target system, modifying its state.

## References

- https://community.grafana.com/t/grafana-5-4-5-and-6-3-4-security-update/20569
- https://grafana.com/blog/2019/08/29/grafana-5.4.5-and-6.3.4-released-with-important-security-fix/
- https://bugzilla.redhat.com/show_bug.cgi?id=1746945
- https://aaron-hoffmann.com/posts/cve-2019-15043/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15043
- https://nvd.nist.gov/vuln/detail/CVE-2019-15043
