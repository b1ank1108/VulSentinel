---
cve_id: CVE-2019-9757
template_path: nuclei-templates/http/cves/2019/CVE-2019-9757.yaml
affected_product: LabKey Server
severity: high
authentication: required
external_callback: false
affected_versions: 19.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

LabKey Server 19.1.0 is affected by an XML External Entity (XXE) vulnerability (CVE-2019-9757, CWE-611). An attacker can read arbitrary local files on the server by submitting a malicious SVG payload to the `visualization-exportPDF.view` or `visualization-exportImage.view` endpoints.

**Impact:** High confidentiality impact allowing disclosure of sensitive files (e.g., /etc/passwd). CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).

**Remediation:** Update to a patched version of LabKey Server.

## PoC / Detection

Classification: info-leak

The nuclei template verifies the vulnerability with a multi-step authenticated workflow:
- Extracts X-LABKEY-CSRF token from `/labkey/home/project-begin.view`.
- Logs in via POST to `/home/login-loginApi.api` using `{{username}}` and `{{password}}`.
- Sends a multipart/form-data POST to `/labkey/home/visualization-exportPDF.view` with an SVG containing `<!ENTITY xxe SYSTEM "file:///etc/passwd" >` entity.
- Matches the response for `root:.*:0:0:` pattern and HTTP 200 to confirm successful arbitrary file read.

## References
- https://rhinosecuritylabs.com/application-security/labkey-server-vulnerabilities-to-rce/
- https://github.com/LabKey/Issues/issues/37636
- https://nvd.nist.gov/vuln/detail/CVE-2019-9757
