---
cve_id: CVE-2019-9881
template_path: nuclei-templates/http/cves/2019/CVE-2019-9881.yaml
affected_product: WPGraphQL
severity: medium
authentication: none
external_callback: false
affected_versions: 0.2.3
preconditions: [WPGraphQL plugin installed and active, GraphQL endpoint accessible at /graphql]
poc_classification: state-change
---

## Vulnerability

CVE-2019-9881 is an authentication bypass vulnerability in the WPGraphQL plugin version 0.2.3 for WordPress. The vulnerability exists in the `createComment` mutation, which fails to properly enforce authentication requirements. This allows unauthenticated attackers to post comments on any WordPress article through the GraphQL API, even when the "allow comment" setting is disabled for that post. The flaw is classified as CWE-306 (Missing Authentication for Critical Function) with a CVSS v3.0 score of 5.3 (Medium severity). The vulnerability enables unauthorized content manipulation, potentially leading to spam, defacement, or injection of malicious content into WordPress sites.

## PoC / Detection

Classification: state-change

The template detects this vulnerability by attempting to create an unauthorized comment through the GraphQL API endpoint. It sends a POST request to `/graphql` with a mutation query that invokes `createComment` with parameters including a random post ID (1), user ID (1), random content string, and a random client mutation ID. The template verifies successful exploitation by checking for:

1. HTTP 200 status code
2. JSON content type in the response
3. Presence of the mutation response structure containing `createComment`, `clientMutationId`, and the JSON data wrapper
4. Echo of the randomly generated client mutation ID in the response

A successful match indicates the comment was created without authentication, confirming the vulnerability exists.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2019-9881
- https://github.com/wp-graphql/wp-graphql/releases/tag/v0.3.0
- https://www.pentestpartners.com/security-blog/pwning-wordpress-graphql/
- https://wpvulndb.com/vulnerabilities/9282
