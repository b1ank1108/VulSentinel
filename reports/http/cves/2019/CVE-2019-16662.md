---
cve_id: CVE-2019-16662
template_path: nuclei-templates/http/cves/2019/CVE-2019-16662.yaml
affected_product: rConfig
severity: critical
authentication: none
external_callback: false
affected_versions: 3.9.2
preconditions: []
poc_classification: rce
---

## Vulnerability
rConfig 3.9.2 is susceptible to a remote code execution vulnerability. An attacker can directly execute arbitrary system commands by sending a GET request to `ajaxServerSettingsChk.php` because the `rootUname` parameter is passed to the `exec` function without any filtering or sanitization.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8)  
CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

Impact: Successful exploitation of this vulnerability can lead to unauthorized access, data theft, and complete compromise of the affected system.  
Remediation: Upgrade to a patched version of rConfig (3.9.3 or later) or apply the vendor-supplied patch.

## PoC / Detection
Classification: rce

The template sends a GET request to `{{BaseURL}}/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=%3b%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%20%23` (injecting the command `;cat /etc/passwd #`) and verifies success with an HTTP 200 response containing the regex match `root:.*:0:0:`.

## References
- https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/
- https://nvd.nist.gov/vuln/detail/CVE-2019-16662
- https://drive.google.com/open?id=1OXI5cNuwWqc6y-7BgNCfYHgFPK2cpvnu
- http://packetstormsecurity.com/files/154999/rConfig-3.9.2-Remote-Code-Execution.html
- http://packetstormsecurity.com/files/155186/rConfig-3.9.2-Command-Injection.html
