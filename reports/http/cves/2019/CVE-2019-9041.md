---
cve_id: CVE-2019-9041
template_path: nuclei-templates/http/cves/2019/CVE-2019-9041.yaml
affected_product: ZZZCMS 1.6.1
severity: high
authentication: none
external_callback: false
affected_versions: 1.6.1
preconditions: []
poc_classification: rce
---

## Vulnerability
ZZZCMS 1.6.1 (zzzphp) is vulnerable to remote code execution via `inc/zzz_template.php`. The `parserIfLabel()` function applies insufficient filtering on template labels, enabling arbitrary PHP code execution using constructs such as the `if:assert` substring (e.g. via `array_map` + `base_convert`).

Successful exploitation allows an attacker to execute arbitrary code on the affected system. CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (7.2). CWE-917.

Remediation: apply the latest security patch or upgrade to a newer version of ZZZCMS.

## PoC / Detection
Classification: rce

The template sends two raw POST requests to `/search/`. The first is a baseline request (empty body after headers). The second injects `keys={if:array_map(base_convert(27440799224,10,32),array(1))}{end if}`. It verifies the condition with DSL matchers: status_code_2 == 200, body_1 does not contain "phpinfo", and body_2 contains both "phpinfo" and "PHP Version", confirming the injected payload executed server-side PHP code (phpinfo()).

## References
- https://www.exploit-db.com/exploits/46454/
- http://www.iwantacve.cn/index.php/archives/118/
- https://nvd.nist.gov/vuln/detail/CVE-2019-9041
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/sobinge/nuclei-templates
