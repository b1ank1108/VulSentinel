---
cve_id: CVE-2019-12725
template_path: nuclei-templates/http/cves/2019/CVE-2019-12725.yaml
affected_product: Zeroshell
severity: critical
authentication: none
external_callback: false
affected_versions: 3.9.0
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2019-12725 is a critical remote command execution vulnerability in Zeroshell 3.9.0. The vulnerability stems from improper handling of HTTP parameters in the web application, specifically in the `/cgi-bin/kerbynet` endpoint. An unauthenticated attacker can inject operating system commands into vulnerable parameters (User and PW parameters in the StartSessionSubmit action), leading to arbitrary command execution on the target system with elevated privileges. The vulnerability is classified as CWE-78 (OS Command Injection) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no authentication requirements. The product is no longer supported by the vendor.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a GET request to `/cgi-bin/kerbynet` with the Action parameter set to `StartSessionSubmit`. It injects a command execution payload into the User parameter using newline characters and backticks: `'%0acat%20/etc/passwd%0a'`. The PW parameter is left empty. The template verifies successful command execution by checking for two conditions: (1) the response body contains a regex pattern matching `/etc/passwd` entries (specifically `root:.*:0:0:` indicating the root user entry), and (2) the HTTP response status is 200. This confirms that the injected `cat /etc/passwd` command was executed and its output was returned in the response, demonstrating arbitrary command execution capability.

## References

- https://www.zeroshell.org/new-release-and-critical-vulnerability/
- https://www.tarlogic.com/advisories/zeroshell-rce-root.txt
- https://github.com/X-C3LL/PoC-CVEs/blob/master/CVE-2019-12725/ZeroShell-RCE-EoP.py
- https://zeroshell.org/blog/
- http://packetstormsecurity.com/files/160211/ZeroShell-3.9.0-Remote-Command-Execution.html
