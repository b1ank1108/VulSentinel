---
cve_id: CVE-2019-15889
template_path: nuclei-templates/http/cves/2019/CVE-2019-15889.yaml
affected_product: WordPress Download Manager plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <2.9.94
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-15889 is a cross-site scripting (XSS) vulnerability in the WordPress Download Manager plugin affecting versions prior to 2.9.94. The vulnerability exists in the category shortcode feature, specifically through the `orderby` or `search[publish_date]` parameters. An attacker can inject arbitrary JavaScript code that executes in the context of the affected website when a victim views a specially crafted URL. This could allow an attacker to steal sensitive information such as session cookies, perform unauthorized actions on behalf of the victim, or manipulate page content. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity), requiring user interaction but no authentication.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Plugin Verification**: Sends a GET request to `/wp-content/plugins/download-manager/readme.txt` to confirm the Download Manager plugin is installed by checking for the presence of "Download Manager" and "License:" strings in the response.

2. **XSS Probe**: If the plugin is detected, sends a GET request to `/wpdmpro/list-packages/?orderby=title%22%3E%3Cscript%3Ealert(1)%3C/script%3E&order=asc` which injects a reflected XSS payload (`"><script>alert(1)</script>`) via the `orderby` parameter.

The template confirms the vulnerability by verifying:
- The injected `<script>alert(1)</script>` appears in the response body
- The response has a `text/html` content type
- The response returns HTTP status 200

This demonstrates the lack of input sanitization in the category shortcode feature, allowing arbitrary JavaScript execution through URL parameters.

## References

- https://www.cybersecurity-help.cz/vdb/SB2019041819
- https://wordpress.org/plugins/download-manager/#developers
- https://nvd.nist.gov/vuln/detail/CVE-2019-15889
- http://packetstormsecurity.com/files/154356/WordPress-Download-Manager-2.9.93-Cross-Site-Scripting.html
- https://plugins.trac.wordpress.org/changeset/2070388/download-manager
