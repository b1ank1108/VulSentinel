---
cve_id: CVE-2019-5128
template_path: nuclei-templates/http/cves/2019/CVE-2019-5128.yaml
affected_product: YouPHPTube Encoder
severity: critical
authentication: none
external_callback: false
affected_versions: 2.3
preconditions: []
poc_classification: rce
---

## Vulnerability
YouPHPTube Encoder 2.3 (plugin providing encoder functionality for YouPHPTube) contains an unauthenticated command injection in the `base64Url` parameter of `/objects/getImageMP4.php`.  
CWE-78, CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Unauthenticated remote attackers can inject and execute arbitrary OS commands, resulting in full server compromise and access to all media content.

## PoC / Detection
Classification: rce  
The template performs a two-step detection:  
1. Sends a GET request to `/objects/getImageMP4.php?base64Url=<base64-encoded `id > random.txt` payload>&format=jpg` to trigger command injection and write the output of the `id` command to a temporary file.  
2. Follows up with a GET to `/objects/{{random}}.txt` and matches for `uid=[0-9]+.*gid=[0-9]+` in the body (status 200) to confirm successful arbitrary command execution.

## References
- https://xz.aliyun.com/news/6312
