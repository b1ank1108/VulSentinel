---
cve_id: CVE-2019-6802
template_path: nuclei-templates/http/cves/2019/CVE-2019-6802.yaml
affected_product: Pypiserver
severity: medium
authentication: none
external_callback: false
affected_versions: <1.2.5
preconditions: []
poc_classification: state-change
---

## Vulnerability
Pypiserver through 1.2.5 and below is susceptible to carriage return line feed injection. An attacker can set arbitrary HTTP headers and possibly conduct cross-site scripting attacks via a %0d%0a in a URI.

Impact: Attackers can inject arbitrary HTTP headers through CRLF injection, potentially conducting cross-site scripting attacks or cache poisoning.

Remediation: Upgrade to Pypiserver version 1.2.5 or later.

Classification: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1); CWE-74.

## PoC / Detection
Classification: state-change

The template sends a single GET request to `{{BaseURL}}/%0d%0aSet-Cookie:crlfinjection=1;` and matches the regex `^Set-Cookie: crlfinjection=1;` on the response header part. This confirms the server reflects the injected header, verifying the CRLF flaw that permits arbitrary HTTP header injection and response modification.

## References
- https://vuldb.com/?id.130257
- https://github.com/pypiserver/pypiserver/issues/237
- https://nvd.nist.gov/vuln/detail/CVE-2019-6802
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
