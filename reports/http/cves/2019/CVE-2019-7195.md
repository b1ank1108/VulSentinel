---
cve_id: CVE-2019-7195
template_path: nuclei-templates/http/cves/2019/CVE-2019-7195.yaml
affected_product: QNAP Photo Station
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-7195 is a critical path traversal vulnerability (CWE-22) in QNAP Photo Station. The vulnerability stems from external control of file name or path, allowing remote attackers to access or modify system files without authentication. The flaw enables unauthenticated attackers to exploit path traversal sequences to read sensitive system files, including configuration files and credentials. The CVSS v3.1 score is 9.8 (Critical) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-exploitable, low complexity, no privileges required, and high impact to confidentiality, integrity, and availability. The EPSS score of 0.9411 (99.906th percentile) indicates extremely high probability of active exploitation in the wild. This vulnerability is listed in the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: info-leak

The template performs a three-step detection process to verify the path traversal vulnerability:

1. **Album Creation**: Sends a POST request to `/photo/p/api/album.php` with action `setSlideshow` and a random filename to create a slideshow album. Extracts the generated `album_id` from the XML response.

2. **Access Code Retrieval**: Sends a GET request to `/photo/slideshow.php` with the extracted album ID to retrieve the slideshow page. Extracts the `access_code` parameter from JavaScript code in the response.

3. **Path Traversal Exploitation**: Sends a POST request to `/photo/p/api/video.php` with the extracted album ID and access code, along with a malicious filename parameter containing path traversal sequences: `.%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`. This attempts to read the `/etc/passwd` file.

The template confirms successful exploitation by verifying:
- HTTP 200 response status
- Presence of `admin:` string in the response body (indicating `/etc/passwd` contents)
- Response headers containing both `video/subtitle` and `filename=` (indicating file download)

## References

- https://cycrafttechnology.medium.com/qnap-pre-auth-root-rce-affecting-312k-devices-on-the-internet-fc8af285622e
- https://packetstorm.news/files/id/157857
- https://github.com/cycraft-corp/cve-2019-7192-check
- https://github.com/qazbnm456/awesome-cve-poc
- https://github.com/th3gundy/CVE-2019-7192_QNAP_Exploit
- https://nvd.nist.gov/vuln/detail/CVE-2019-7195
