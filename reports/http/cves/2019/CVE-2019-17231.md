---
cve_id: CVE-2019-17231
template_path: nuclei-templates/http/cves/2019/CVE-2019-17231.yaml
affected_product: WordPress OneTone theme
severity: medium
authentication: none
external_callback: false
affected_versions: <= 3.0.6
preconditions: []
poc_classification: state-change
---

## Vulnerability
The WordPress OneTone theme through 3.0.6 contains multiple stored XSS vulnerabilities in `includes/theme-functions.php`. Unauthenticated attackers can inject malicious JavaScript payloads via the `onetone_options_import` AJAX endpoint, specifically targeting fields like `top_bar_info_content`. The payload is stored in theme options and executes when the page is rendered for other users/visitors.

**Impact**: Malicious JS can steal cookies, credentials, or perform actions on behalf of visitors (CSRF-like in browser context).  
**CVSS 3.1**: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**Remediation**: Update to 3.0.7 or later or switch themes.

## PoC / Detection
Classification: state-change

The template first issues an unauthenticated POST to `/wp-admin/admin-ajax.php?action=onetone_options_import` with JSON options containing a `<script>console.log(13-digit-random)</script>` payload. It confirms "Import successful." response. Then performs a GET to `/` and verifies the script tag appears in the HTML body alongside "top-bar-info", confirming the stored payload was rendered.

## References
- https://blog.sucuri.net/2020/04/onetone-vulnerability-leads-to-javascript-cookie-hijacking.html
- https://blog.nintechnet.com/unauthenticated-stored-xss-vulnerability-in-wordpress-onetone-theme-unpatched/
- https://nvd.nist.gov/vuln/detail/CVE-2019-17231
