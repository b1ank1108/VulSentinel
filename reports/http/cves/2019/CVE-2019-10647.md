---
cve_id: CVE-2019-10647
template_path: nuclei-templates/http/cves/2018/CVE-2019-10647.yaml
affected_product: ZZZCMS ZZZPHP
severity: critical
authentication: none
external_callback: true
affected_versions: 1.6.3
preconditions: []
poc_classification: rce
---

## Vulnerability

ZZZCMS ZZZPHP 1.6.3 contains a remote PHP code execution vulnerability caused by unrestricted file handling in `inc/zzz_file.php`. Unauthenticated attackers supply a crafted URL (serving PHP code as plain text) in the `source[]` parameter of `/plugins/ueditor/php/controller.php?action=catchimage`. The application fetches and saves the response as an executable `.php` file under `/upload/`.

**CVSS v3.0:** 9.8 (Critical)  
**Vector:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H  
**CWE-434:** Unrestricted Upload of File with Dangerous Type  
**Impact:** Arbitrary PHP execution leading to full system compromise.

## PoC / Detection

Classification: rce

The template performs a non-destructive two-step verification of the file-write primitive:  
1. POSTs `source[]=http://{{interactsh-url}}/{{randstr}}.php` to the catchimage endpoint and asserts HTTP 200 + body contains "SUCCESS" and "state" + DNS interaction on interactsh.  
2. Regex-extracts the saved filename from the JSON `title` field, then GETs `/upload/{{filename}}` and asserts status 200.  

## References

- https://nvd.nist.gov/vuln/detail/CVE-2019-10647
- https://github.com/kyrie403/Vuln/blob/master/zzzcms/zzzphp%20v1.6.3%20write%20file%20with%20dangerous%20type.md
