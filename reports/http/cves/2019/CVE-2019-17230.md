---
cve_id: CVE-2019-17230
template_path: nuclei-templates/http/cves/2019/CVE-2019-17230.yaml
affected_product: WordPress OneTone theme
severity: medium
authentication: none
external_callback: false
affected_versions: <= 3.0.6
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2019-17230 is an unauthenticated options change vulnerability in the OneTone theme for WordPress (versions through 3.0.6). The vulnerability exists in `includes/theme-functions.php` and allows attackers without authentication to modify WordPress theme options through the `onetone_options_import` AJAX action. This enables unauthorized modification of theme settings, including the 404 error page content (`content_404` option), which can be exploited to inject malicious content or alter site behavior. The vulnerability has a CVSS v3.1 score of 5.3 (Medium severity) with the vector AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N, indicating network-exploitable, low complexity, no privileges required, and impacts to integrity.

## PoC / Detection

Classification: state-change

The template performs a two-step verification process:

1. **Exploitation attempt**: Sends a POST request to `/wp-admin/admin-ajax.php` with the action `onetone_options_import` and a JSON payload containing a randomly generated string for the `content_404` option. This attempts to modify the theme's 404 page content without authentication.

2. **Verification**: Sends a GET request to a non-existent random path to trigger a 404 error page, then checks if the response contains the randomly generated string that was injected in step 1. If the custom content appears in the 404 page, it confirms the theme options were successfully modified without authentication.

The template verifies the vulnerability by confirming both successful import (HTTP 200 with "Import successful." message) and persistence of the modified content in the actual 404 error page output.

## References

- https://blog.sucuri.net/2020/04/onetone-vulnerability-leads-to-javascript-cookie-hijacking.html
- https://blog.nintechnet.com/unauthenticated-stored-xss-vulnerability-in-wordpress-onetone-theme-unpatched/
- https://nvd.nist.gov/vuln/detail/CVE-2019-17230
