---
cve_id: CVE-2019-14530
template_path: nuclei-templates/http/cves/2019/CVE-2019-14530.yaml
affected_product: OpenEMR
severity: high
authentication: required
external_callback: false
affected_versions: < 5.0.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OpenEMR before 5.0.2 is vulnerable to local file inclusion via the `fileName` parameter in `custom/ajax_download.php`. An authenticated attacker can read any file readable by the web-server user. If the target file is writable by the web-server user and `/var/www/openemr/sites/default/documents/cqm_qrda/` exists, the file is also deleted.

## PoC / Detection
Classification: info-leak  
The template first POSTs credentials to `/interface/main/main_screen.php?auth=login&site=default` to establish an authenticated session, then sends `GET /custom/ajax_download.php?fileName=../../../../../../../../../etc/passwd`. It matches on HTTP 200, `filename=passwd` in the `Content-Disposition` header, and the regex `root:[x*]:0:0` in the response body.

## References
- https://www.exploit-db.com/exploits/50037
- https://github.com/openemr/openemr/archive/refs/tags/v5_0_1_7.zip
- https://github.com/openemr/openemr/pull/2592
- https://nvd.nist.gov/vuln/detail/CVE-2019-14530
- https://github.com/sec-it/exploit-CVE-2019-14530
