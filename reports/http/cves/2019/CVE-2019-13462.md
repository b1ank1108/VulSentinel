---
cve_id: CVE-2019-13462
template_path: nuclei-templates/http/cves/2019/CVE-2019-13462.yaml
affected_product: Lansweeper
severity: critical
authentication: none
external_callback: false
affected_versions: before 7.1.117.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Lansweeper before 7.1.117.4 contains an unauthenticated SQL injection in WidgetHandler.ashx (MethodName=Sort parameter).  
Attackers can inject arbitrary SQL queries without any credentials, enabling database enumeration, full data exfiltration, unauthorized access, and potential system compromise.  
**CVSS:** 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)  
**CWE:** CWE-89  
**Impact:** unauthorized access, data leakage, and potential compromise of the entire Lansweeper system.  
**Remediation:** Apply the latest security patch or update provided by Lansweeper.

## PoC / Detection
Classification: info-leak

The template sends one GET request to `{{BaseURL}}/WidgetHandler.ashx?MethodName=Sort&ID=1&row=1&column=%28SELECT%20CONCAT%28CONCAT%28CHAR%28126%29%2C%28SELECT%20SUBSTRING%28%28ISNULL%28CAST%28db_name%28%29%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%29%2C1%2C1024%29%29%29%2CCHAR%28126%29%29%29` that injects a subquery to extract and reflect the current database name wrapped in tildes. Detection succeeds if the body contains `~lansweeperdb~`, the Content-Type header is `text/plain`, and status is 500.

## References
- https://www.nccgroup.com/ae/our-research/technical-advisory-unauthenticated-sql-injection-in-lansweeper/
- https://nvd.nist.gov/vuln/detail/CVE-2019-13462
- https://www.nccgroup.trust/uk/our-research/technical-advisory-unauthenticated-sql-injection-in-lansweeper/
- https://www.lansweeper.com/forum/yaf_topics33_Announcements.aspx
