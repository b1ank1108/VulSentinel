---
cve_id: CVE-2019-12989
template_path: nuclei-templates/http/cves/2019/CVE-2019-12989.yaml
affected_product: Citrix SD-WAN and NetScaler SD-WAN
severity: critical
authentication: none
external_callback: false
affected_versions: Citrix SD-WAN 10.2.x before 10.2.3 and NetScaler SD-WAN 10.0.x before 10.0.8
preconditions: []
poc_classification: state-change
---

## Vulnerability
Citrix SD-WAN 10.2.x before 10.2.3 and NetScaler SD-WAN 10.0.x before 10.0.8 contain an unauthenticated SQL injection via improper input validation in the get_package_file component. An attacker can execute arbitrary SQL queries on the backend database, resulting in information disclosure, data manipulation, or full system compromise.

## PoC / Detection
Classification: state-change

The template sends one raw unauthenticated POST request to `/sdwan/nitro/v1/config/get_package_file?action=file_download` containing a JSON payload with a UNION SELECT md5({{num}}) injection inside the `site_name` field. It matches if the 400 response body contains either `"status\":\"fail", "Invalid value specified"` or the rendered MD5 hash value, confirming the backend database executed the injected SQL.

## References
- http://packetstormsecurity.com/files/153638/Citrix-SD-WAN-Appliance-10.2.2-Authentication-Bypass-Remote-Command-Execution.html
- https://support.citrix.com/article/CTX251987
- https://www.tenable.com/security/research/tra-2019-32
- https://nvd.nist.gov/vuln/detail/CVE-2019-12989
