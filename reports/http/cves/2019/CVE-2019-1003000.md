---
cve_id: CVE-2019-1003000
template_path: nuclei-templates/http/cves/2019/CVE-2019-1003000.yaml
affected_product: Jenkins Script Security Plugin
severity: high
authentication: required
external_callback: true
affected_versions: <=1.49
preconditions: permission to submit sandboxed scripts
poc_classification: rce
---

## Vulnerability
A sandbox bypass vulnerability exists in Jenkins Script Security Plugin <=1.49 within `src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/GroovySandbox.java`. Authenticated attackers with permission to submit sandboxed scripts can bypass sandbox protections and execute arbitrary code on the Jenkins master JVM.

CVSS: 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).  
Impact: full compromise of the Jenkins environment and all managed systems.  
Remediation: upgrade to version 1.50 or later.

## PoC / Detection
Classification: rce

The template first confirms a Jenkins instance via the /login page, then performs authentication (POST to /j_acegi_security_check as admin followed by session validation). It next issues GET requests to the `checkScript` endpoints (`/securityRealm/user/.../SecureGroovyScript/checkScript` and `/.../CpsFlowDefinition/checkScriptCompile`) using sandbox=true and malicious Groovy payloads. Payloads contain `.execute()` to run `ping` (DNS OOB) or `@GrabResolver` + `@Grab` to force Maven POM resolution (HTTP OOB) against interactsh-url. Success is confirmed when DNS or HTTP callbacks are received, verifying the sandbox bypass that enables arbitrary code execution.

## References
- https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266
- http://www.rapid7.com/db/modules/exploit/multi/http/jenkins_metaprogramming
- https://github.com/slowmistio/CVE-2019-1003000-and-CVE-2018-1999002-Pre-Auth-RCE-Jenkins
- https://github.com/1NTheKut/CVE-2019-1003000_RCE-DETECTION
- https://github.com/purple-WL/Jenkins_CVE-2019-1003000
- https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc
