---
cve_id: CVE-2019-9618
template_path: nuclei-templates/http/cves/2019/CVE-2019-9618.yaml
affected_product: WordPress GraceMedia Media Player plugin
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress GraceMedia Media Player plugin version 1.0 contains a local file inclusion (LFI) vulnerability via the `cfg` parameter in the `ajax_controller.php` file. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS score of 9.8 (Critical). The flaw allows unauthenticated attackers to include arbitrary local files from the server's filesystem through path traversal sequences. This can lead to information disclosure by reading sensitive files (such as `/etc/passwd`) or potentially enable remote code execution if combined with other attack vectors like log poisoning or file upload capabilities.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the vulnerable endpoint `/wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php` with a malicious `cfg` parameter containing path traversal sequences (`../../../../../../../../../../etc/passwd`). The template also includes the `ajaxAction=getIds` parameter. 

The detection confirms the vulnerability by:
1. Checking for the presence of Unix password file content using a regex pattern matching `root:.*:0:0:` (indicating successful file inclusion of `/etc/passwd`)
2. Verifying the HTTP response status is either 200 or 500

The template uses a harmless probe (reading `/etc/passwd`) to verify the exploitable LFI condition without causing system damage.

## References

- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9618
- https://seclists.org/fulldisclosure/2019/Mar/26
- https://www.exploit-db.com/exploits/46537
- https://nvd.nist.gov/vuln/detail/CVE-2019-9618
- http://seclists.org/fulldisclosure/2019/Mar/32
