---
cve_id: CVE-2019-3912
template_path: nuclei-templates/http/cves/2019/CVE-2019-3912.yaml
affected_product: LabKey Server Community Edition
severity: medium
authentication: none
external_callback: true
affected_versions: before 18.3.0-61806.763
preconditions: []
poc_classification: detect-only
---

## Vulnerability

LabKey Server Community Edition before 18.3.0-61806.763 contains an open redirect vulnerability. The flaw is triggered via the `returnURL` parameter on the `/__r1/` endpoint (specifically demonstrated at `/labkey/__r1/login-login.view`). An attacker can supply an arbitrary URL (e.g., attacker-controlled domain) which the server reflects in a `Location` header, redirecting authenticated or unauthenticated users. This enables phishing, credential theft, or further attacks. CVSS 3.1 score 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), CWE-601.

## PoC / Detection

Classification: detect-only

The template issues a GET request to `{{BaseURL}}/labkey/__r1/login-login.view?returnUrl=http://interact.sh` and uses a regex matcher on the response headers to verify if the `Location` header contains a redirect back to the interact.sh domain. This confirms the open redirect behavior without performing state changes or data exfiltration on the target.

## References

- https://www.tenable.com/security/research/tra-2019-03
- https://nvd.nist.gov/vuln/detail/CVE-2019-3912
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/StarCrossPortal/scalpel
- https://github.com/anonymous364872/Rapier_Tool
