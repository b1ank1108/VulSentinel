---
cve_id: CVE-2019-3911
template_path: nuclei-templates/http/cves/2019/CVE-2019-3911.yaml
affected_product: LabKey Server Community Edition
severity: medium
authentication: none
external_callback: false
affected_versions: before 18.3.0-61806.763
preconditions: []
poc_classification: info-leak
---

## Vulnerability
LabKey Server Community Edition before 18.3.0-61806.763 contains a reflected cross-site scripting vulnerability via the onerror parameter in the /__r2/query endpoints. An unauthenticated remote attacker can inject arbitrary JavaScript by crafting a malicious URL.

Successful exploitation could allow an attacker to execute arbitrary scripts in the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.

Remediation: Upgrade to version 18.3.0 or later.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score: 6.1)

CWE: CWE-79

## PoC / Detection
Classification: info-leak

The template sends a GET request to `{{BaseURL}}/__r2/query-printRows.view` with a specially crafted `query.sort` parameter containing the breakout payload `elk5q</script><script>alert(document.domain)</script>zp59r`. 

Matchers verify exploitation success if the response body reflects the unsanitized `</script><script>alert(document.domain)</script>` string, the Content-Type header contains `text/html`, and the HTTP status is 200.

This confirms the reflected XSS vulnerability is present.

## References
- https://www.tenable.com/security/research/tra-2019-03
- https://nvd.nist.gov/vuln/detail/CVE-2019-3911
- https://github.com/ARPSyndicate/kenzer-templates
