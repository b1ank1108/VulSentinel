---
cve_id: CVE-2019-9733
template_path: nuclei-templates/http/cves/2019/CVE-2019-9733.yaml
affected_product: JFrog Artifactory
severity: critical
authentication: none
external_callback: false
affected_versions: 6.7.3
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2019-9733 is a critical authentication bypass vulnerability in JFrog Artifactory 6.7.3. The vulnerability stems from a design flaw in the password reset mechanism for the admin account. By default, the access-admin account is used to reset the admin password, and this operation is restricted to localhost connections. However, the application improperly trusts the X-Forwarded-For HTTP header, allowing an attacker to spoof their source IP address as 127.0.0.1 and bypass the IP whitelist restriction.

An unauthenticated remote attacker can exploit this by sending a login request with the X-Forwarded-For header set to 127.0.0.1 and using the default credentials of the access-admin account (username: "access-admin", password: "password"). Once authenticated as access-admin, the attacker can leverage Artifactory's API to request authentication tokens for all users, including the admin account, effectively gaining full administrative control over all artifacts and repositories managed by the Artifactory instance.

The vulnerability has a CVSS v3.0 score of 9.8 (Critical) with an EPSS score of 0.93083 (99.783rd percentile), indicating a very high likelihood of exploitation in the wild.

## PoC / Detection

Classification: auth-bypass

The template detects this vulnerability by attempting to authenticate as the access-admin account using default credentials while spoofing the source IP address. It sends a POST request to `/artifactory/ui/auth/login` with the following characteristics:

1. Sets the X-Forwarded-For header to "127.0.0.1" to bypass the localhost-only restriction
2. Includes authentication headers (X-Requested-With: artUI, Request-Agent: artifactoryUI)
3. Submits a JSON payload with default credentials: `{"user":"access-admin","password":"password","type":"login"}`

The template confirms successful exploitation by checking for:
- HTTP 200 status code
- Response body containing `"username": "access-admin"`, indicating successful authentication

A successful match indicates the system is vulnerable to authentication bypass, allowing unauthorized administrative access.

## References

- http://packetstormsecurity.com/files/152172/JFrog-Artifactory-Administrator-Authentication-Bypass.html
- https://www.ciphertechs.com/jfrog-artifactory-advisory/
- https://www.jfrog.com/confluence/display/RTF/Release+Notes#ReleaseNotes-Artifactory6.8.6
- https://nvd.nist.gov/vuln/detail/CVE-2019-9733
- https://github.com/ARPSyndicate/kenzer-templates
