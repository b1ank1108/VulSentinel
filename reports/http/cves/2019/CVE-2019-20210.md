---
cve_id: CVE-2019-20210
template_path: nuclei-templates/http/cves/2019/CVE-2019-20210.yaml
affected_product: CTHthemes CityBook, TownHub, and EasyBook WordPress themes
severity: medium
authentication: none
external_callback: false
affected_versions: CityBook < 2.3.4, TownHub < 1.0.6, EasyBook < 1.2.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-20210 is a reflected cross-site scripting (XSS) vulnerability affecting multiple WordPress themes developed by CTHthemes: CityBook (versions prior to 2.3.4), TownHub (versions prior to 1.0.6), and EasyBook (versions prior to 1.2.2). The vulnerability exists in the search functionality where user-supplied input in search queries is not properly sanitized before being reflected in the HTTP response. This allows attackers to inject malicious JavaScript code that executes in the context of a victim's browser session when they click on a crafted link.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low impact to confidentiality and integrity but no availability impact.

Successful exploitation can lead to session hijacking, website defacement, theft of sensitive information such as cookies or authentication tokens, or the installation of malware on victim systems through drive-by downloads.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the WordPress site's search endpoint with a specially crafted XSS payload in the `search_term` parameter. The payload `</script><script>alert(document.domain)</script>` attempts to break out of any existing script context and inject a new script tag that would execute JavaScript code.

The template verifies the vulnerability through three conditions:
1. The injected payload `</script><script>alert(document.domain)</script>` is reflected unencoded in the response body
2. The response contains `/wp-content/themes/citybook`, confirming the CityBook theme is active
3. The response has a `text/html` content type header and returns HTTP status 200

This detection method confirms that the search parameter is vulnerable to reflected XSS without actually executing the malicious JavaScript, making it safe for automated scanning.

## References

- https://wpscan.com/vulnerability/10013
- https://wpvulndb.com/vulnerabilities/10018
- https://cxsecurity.com/issue/WLB-2019120112
- https://nvd.nist.gov/vuln/detail/CVE-2019-20210
- https://themeforest.net/item/citybook-directory-listing-wordpress-theme/21694727
