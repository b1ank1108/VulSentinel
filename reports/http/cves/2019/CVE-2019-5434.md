---
cve_id: CVE-2019-5434
template_path: nuclei-templates/http/cves/2019/CVE-2019-5434.yaml
affected_product: Revive Adserver
severity: critical
authentication: none
external_callback: false
affected_versions: 4.2
preconditions: []
poc_classification: rce
---

## Vulnerability
Revive Adserver 4.2 is susceptible to remote code execution. An attacker can send a crafted payload to the XML-RPC invocation script and trigger the unserialize() call on the "what" parameter in the "openads.spc" RPC method. This can be exploited to perform various types of attacks, e.g. serialize-related PHP vulnerabilities or PHP object injection. It is possible, although unconfirmed, that the vulnerability has been used by some attackers in order to gain access to some Revive Adserver instances and deliver malware through them to third-party websites.

Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system.

## PoC / Detection
Classification: rce

The template performs active exploitation for detection: It issues a POST request to `/adxmlrpc.php` containing a crafted XML-RPC payload with a serialized PHP object chain (League\Flysystem gadgets) that forces deserialization to write a backdoor PHP file at `plugins/3rdPartyServers/ox3rdPartyServers/max.class.php` containing `<?php system($_GET["0"]); ?>`. A follow-up GET request to the same path with query `?0=id` executes the system command; matchers then assert HTTP/200, `text/html` Content-Type in the second response, and a regex match for Linux `id` command output (`uid=\d+\([^)]+\) gid=\d+\([^)]+\)`) in the body.

## References
- https://packetstormsecurity.com/files/155559/Revive-Adserver-4.2-Remote-Code-Execution.html
- https://www.exploit-db.com/exploits/47739
- https://www.revive-adserver.com/security/revive-sa-2019-001/
- https://nvd.nist.gov/vuln/detail/CVE-2019-5434
- http://packetstormsecurity.com/files/155559/Revive-Adserver-4.2-Remote-Code-Execution.html
