---
cve_id: CVE-2019-19824
template_path: nuclei-templates/http/cves/2019/CVE-2019-19824.yaml
affected_product: TOTOLINK Realtek SDK based routers
severity: high
authentication: required
external_callback: true
affected_versions: A3002RU ≤2.0.0, A702R ≤2.1.3, N301RT ≤2.1.6, N302R ≤3.4.0, N300RT ≤3.4.0, N200RE ≤4.0.0, N150RT ≤3.4.0, N100RE ≤3.4.0
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2019-19824 is a remote command injection vulnerability affecting multiple TOTOLINK router models based on the Realtek SDK. The vulnerability exists in the `/boafrm/formSysCmd` endpoint, which accepts OS commands via the `sysCmd` parameter. An authenticated attacker can exploit this flaw to execute arbitrary operating system commands on the affected device, even when the GUI interface (`syscmd.htm`) is not available or accessible. This vulnerability is classified as CWE-78 (OS Command Injection) and has a CVSS v3.1 score of 8.8, indicating high severity. Successful exploitation grants the attacker full control over the device's internals, allowing complete compromise of the router.

The vulnerability affects multiple TOTOLINK router models with firmware versions: A3002RU through 2.0.0, A702R through 2.1.3, N301RT through 2.1.6, N302R through 3.4.0, N300RT through 3.4.0, N200RE through 4.0.0, N150RT through 3.4.0, and N100RE through 3.4.0.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending an authenticated POST request to the `/boafrm/formSysCmd` endpoint. It uses HTTP Basic Authentication with credentials `admin:password` (Base64 encoded as `YWRtaW46cGFzc3dvcmQ=`). The request includes form parameters that trigger the command execution functionality, specifically setting `sysCmd` to execute a `wget` command that attempts to contact an Interactsh server controlled by the tester.

The detection mechanism relies on out-of-band interaction: the template injects a command (`wget http://{{interactsh-url}}`) that causes the vulnerable router to make an HTTP request to the attacker-controlled Interactsh server. The template confirms successful command execution by verifying that an HTTP callback is received from the target device, indicating that the injected command was executed by the router's operating system.

## References

- https://sploit.tech/2019/12/16/Realtek-TOTOLINK.html
- https://cybersecurity.att.com/blogs/labs-research/att-alien-labs-finds-new-golang-malwarebotenago-targeting-millions-of-routers-and-iot-devices-with-more-than-30-exploits
- https://nvd.nist.gov/vuln/detail/CVE-2019-19824
- https://sploit.tech
- https://github.com/ARPSyndicate/kenzer-templates
