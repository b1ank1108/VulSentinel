---
cve_id: CVE-2019-0230
template_path: nuclei-templates/http/cves/2019/CVE-2019-0230.yaml
affected_product: Apache Struts
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0.0 to 2.5.20
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2019-0230 is a critical remote code execution vulnerability in Apache Struts versions 2.0.0 through 2.5.20. The vulnerability stems from forced double OGNL (Object-Graph Navigation Language) evaluation when processing raw user input in tag attributes. This double evaluation allows attackers to inject and execute arbitrary OGNL expressions, leading to remote code execution on the affected server. The vulnerability is classified as CWE-1321 (improperly controlled modification of object prototype attributes) and has a CVSS score of 9.8, indicating critical severity with network-based exploitation requiring no privileges or user interaction.

## PoC / Detection

Classification: rce

The template detects this vulnerability by exploiting the double OGNL evaluation behavior. It sends a GET request with a specially crafted parameter containing an OGNL expression: `?id={{random_string}}%25{128*128}`. The payload uses URL encoding (`%25` for `%`) to inject the OGNL expression `{128*128}` which should evaluate to 16384. If the vulnerability is present, the server performs double OGNL evaluation, first decoding the URL-encoded percent sign and then evaluating the mathematical expression. The template confirms exploitation by checking if the response body contains the concatenation of the random string and the calculated result "16384", proving that arbitrary OGNL expressions are being evaluated server-side.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2019-0230
- https://cwiki.apache.org/confluence/display/WW/S2-059
- https://www.tenable.com/blog/cve-2019-0230-apache-struts-potential-remote-code-execution-vulnerability
- http://packetstormsecurity.com/files/160108/Apache-Struts-2.5.20-Double-OGNL-Evaluation.html
- https://cwiki.apache.org/confluence/display/ww/s2-059
