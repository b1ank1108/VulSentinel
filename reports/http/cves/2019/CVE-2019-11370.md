---
cve_id: CVE-2019-11370
template_path: nuclei-templates/http/cves/2019/CVE-2019-11370.yaml
affected_product: Carel pCOWeb
severity: medium
authentication: none
external_callback: false
affected_versions: <B1.2.4
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2019-11370 is a stored cross-site scripting (XSS) vulnerability in Carel pCOWeb firmware versions prior to B1.2.4. The vulnerability exists in the SNMP configuration interface, specifically in the "System contact" field accessible via the config/pw_snmp.html page. An attacker can inject malicious JavaScript code into this field, which is then stored on the device and executed in the browsers of users who subsequently view the SNMP configuration page. This allows attackers to inject malicious scripts into web pages viewed by users, potentially leading to data theft, session hijacking, or unauthorized actions performed in the context of the victim's session.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 5.4 (Medium severity). The CVSS vector (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N) indicates network-based exploitation with low attack complexity, requiring low privileges and user interaction, with changed scope and low impact to confidentiality and integrity.

## PoC / Detection

Classification: state-change

The Nuclei template detects this vulnerability through a two-step process:

1. **Injection Phase**: Sends a POST request to `/config/pw_snmp_done.html` with URL-encoded payload that sets the SNMP system contact field to contain an XSS payload: `"><script>alert(document.domain)</script>`. The payload is submitted via the parameter `%3Fscript%3Asetdb%28%27snmp%27%2C%27syscontact%27%29`.

2. **Verification Phase**: Sends a GET request to `/config/pw_snmp.html` to retrieve the SNMP configuration page and verify that the injected script is stored and reflected in the HTML response.

The template confirms the vulnerability by checking that:
- The second response has a 200 status code
- The response contains "text/html" content type
- The response body contains the injected payload within a value attribute: `value=\"\"><script>alert(document.domain)</script>\"></td>`

This demonstrates a stored XSS vulnerability where malicious JavaScript persists in the device configuration and executes when administrators view the affected page.

## References

- https://www.exploit-db.com/exploits/46897
- https://github.com/nepenthe0320/cve_poc/blob/master/CVE-2019-11370
- https://nvd.nist.gov/vuln/detail/CVE-2019-11370
- https://github.com/ARPSyndicate/kenzer-templates
