---
cve_id: CVE-2019-20085
template_path: nuclei-templates/http/cves/2019/CVE-2019-20085.yaml
affected_product: TVT NVMS-1000
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-20085 is a Local File Inclusion (LFI) vulnerability affecting TVT NVMS-1000 devices. The vulnerability exists in the web interface and allows attackers to perform directory traversal attacks using GET requests with path manipulation sequences. Specifically, the flaw permits unauthorized access to arbitrary files on the system through the URL path by using encoded directory traversal sequences (`..%2F`). 

The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) and has a CVSS v3.1 score of 7.5 (High severity). The attack vector is network-based, requires low complexity, no privileges, and no user interaction. The primary impact is on confidentiality, allowing attackers to read sensitive files stored on the affected system. This vulnerability has an EPSS score of 0.94186 (99.916th percentile), indicating a very high probability of exploitation in the wild. It is also listed in the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by attempting to exploit the directory traversal flaw to read the Windows `win.ini` file. It sends a GET request to the target with a path containing multiple encoded directory traversal sequences: `/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fwin.ini`. 

The detection logic verifies successful exploitation through two conditions:
1. The response body contains regex patterns matching typical `win.ini` file sections: `[(font|extension|file)s]`
2. The HTTP response status code is 200

If both conditions are met, the vulnerability is confirmed, indicating that the system is susceptible to local file inclusion attacks that can expose sensitive system files.

## References

- https://www.exploit-db.com/exploits/48311
- https://www.exploit-db.com/exploits/47774
- http://packetstormsecurity.com/files/157196/TVT-NVMS-1000-Directory-Traversal.html
- https://nvd.nist.gov/vuln/detail/CVE-2019-20085
- https://github.com/ARPSyndicate/kenzer-templates
