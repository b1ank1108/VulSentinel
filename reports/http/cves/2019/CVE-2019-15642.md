---
cve_id: CVE-2019-15642
template_path: nuclei-templates/http/cves/2019/CVE-2019-15642.yaml
affected_product: Webmin
severity: high
authentication: required
external_callback: false
affected_versions: < 1.920
preconditions: []
poc_classification: rce
---

## Vulnerability
rpc.cgi in Webmin < 1.920 allows authenticated remote code execution via a crafted object name because unserialise_variable performs an unsafe eval call. NOTE: RPC can run any command or modify any file on a server, which is why access must not be granted to un-trusted Webmin users.

Impact: successful exploitation allows an authenticated attacker to execute arbitrary code on the target system.  
CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8). CWE-94.  
Remediation: upgrade to version 1.920 or later.

## PoC / Detection
Classification: rce

The template first POSTs to /session_login.cgi with pitchfork payloads (username: admin/root; password: admin/root) to establish an authenticated session, then POSTs to /rpc.cgi the payload `OBJECT Socket;print "Content-Type: text/plain\n\n";$cmd=`id`;print "$cmd\n\n";` (stop-at-first-match, host-redirects). It verifies by matching body_2 for uid=(\d+) regex output, word "Content-type: text/plain", and status 200.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2019-15642
- https://github.com/jas502n/CVE-2019-15642
- https://doxfer.webmin.com/Webmin/Webmin_Servers_Index
- https://github.com/webmin/webmin/blob/ab5e00e41ea1ecc1e24b8f8693f3495a0abb1aed/rpc.cgi#L26-L37
- https://github.com/webmin/webmin/commit/df8a43fb4bdc9c858874f72773bcba597ae9432c
