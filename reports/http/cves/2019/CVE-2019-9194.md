---
cve_id: CVE-2019-9194
template_path: nuclei-templates/http/cves/2019/CVE-2019-9194.yaml
affected_product: elFinder
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.1.47
preconditions: PHP connector accessible with support for file upload and JPEG image operations
poc_classification: rce
---

## Vulnerability
elFinder <= 2.1.47 contains a command injection vulnerability in the PHP connector. The flaw occurs when performing image operations on JPEG files, as the filename is passed unsanitized to the `exiftran` utility.

**Impact:** Remote arbitrary command execution, enabling complete server compromise.

**Remediation:** Upgrade to elFinder 2.1.48 or later.

**Classification details:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8), CWE-78.

## PoC / Detection
Classification: rce

The template performs a full exploitation to confirm RCE:
- Uploads a malicious JPEG via multipart POST to `/php/connector.minimal.php` (cmd=upload) with filename embedding `;echo [base64-payload] | base64 -d > [rand].php` to write a test PHP file.
- Triggers execution by requesting rotate/resize (degree=180) on the file hash.
- Verifies by GETting `/php/[rand].php` and checking for the MD5 hash output.

Marked intrusive with 3-request flow.

## References
- https://www.exploit-db.com/exploits/46481
- https://www.exploit-db.com/exploits/46539/
- https://nvd.nist.gov/vuln/detail/CVE-2019-9194
- https://github.com/cved-sources/cve-2019-9194
- https://github.com/Studio-42/elFinder/releases/tag/2.1.48
