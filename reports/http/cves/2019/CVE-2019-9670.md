---
cve_id: CVE-2019-9670
template_path: nuclei-templates/http/cves/2019/CVE-2019-9670.yaml
affected_product: Synacor Zimbra Collaboration
severity: critical
authentication: none
external_callback: false
affected_versions: 8.7.x before 8.7.11p10
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Unauthenticated XML External Entity (XXE) injection in the mailboxd component via the Autodiscover servlet (CVE-2019-9670, CWE-611). Allows remote attackers to read arbitrary local files (e.g. /etc/passwd) by injecting a SYSTEM entity. CVSS 3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact limited to information disclosure in the provided template; references note potential SSRF chaining. Fixed in 8.7.11p10+.

## PoC / Detection
Classification: info-leak

The template issues a single raw POST to `/Autodiscover/Autodiscover.xml` with a crafted DOCTYPE declaring `<!ENTITY xxe SYSTEM "file:///etc/passwd">` and references `&xxe;` inside `<AcceptableResponseSchema>`. Detection matches status 503 AND regex `root:.*:0:0:` in body AND string `Problem accessing` in body.

## References
- https://www.exploit-db.com/exploits/46693/
- https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories
- https://bugzilla.zimbra.com/show_bug.cgi?id=109129
- http://www.rapid7.com/db/modules/exploit/linux/http/zimbra_xxe_rce
- http://packetstormsecurity.com/files/152487/Zimbra-Collaboration-Autodiscover-Servlet-XXE-ProxyServlet-SSRF.html
- https://isc.sans.edu/forums/diary/CVE20199670+Zimbra+Collaboration+Suite+XXE+vulnerability/27570/
- https://nvd.nist.gov/vuln/detail/CVE-2019-9670
