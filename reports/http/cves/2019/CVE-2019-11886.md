---
cve_id: CVE-2019-11886
template_path: nuclei-templates/http/cves/2019/CVE-2019-11886.yaml
affected_product: Yellow Pencil Visual Theme Customizer
severity: high
authentication: none
external_callback: false
affected_versions: < 7.2.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2019-11886 is a privilege escalation vulnerability in the Yellow Pencil Visual Theme Customizer (WaspThemes Visual CSS Style Editor) plugin for WordPress versions prior to 7.2.1. The vulnerability stems from a Cross-Site Request Forgery (CSRF) weakness in the `yp_option_update` functionality, specifically exploitable through the `yp_remote_get` parameter. Attackers can leverage this flaw to manipulate WordPress site options without authentication, including enabling user registration settings. This allows unauthenticated attackers to gain administrator-level access to the WordPress site, resulting in complete control over content, user management, and site configuration. The vulnerability is classified as CWE-352 (Cross-Site Request Forgery) with a CVSS v3.0 score of 8.8 (High severity). The EPSS score of 0.34178 (96.884th percentile) indicates a significant probability of active exploitation in the wild.

## PoC / Detection

Classification: state-change

The template performs a two-stage detection process to verify the privilege escalation vulnerability:

1. **Stage 1 - Enable Registration**: Sends a POST request to `/wp-admin/admin-post.php?yp_remote_get=test` with a crafted payload (`yp_json_import_data=[{"users_can_register":"MQ=="}]`) that enables WordPress user registration by manipulating site options. The base64-encoded value "MQ==" decodes to "1" (enabled). It then verifies the change by checking if the registration link appears on the login page.

2. **Stage 2 - Disable Registration**: Sends another POST request with the opposite payload (`yp_json_import_data=[{"users_can_register":"MA=="}]`) where "MA==" decodes to "0" (disabled), then confirms the registration link is removed from the login page.

The template detects the vulnerability by confirming that unauthenticated requests can successfully toggle the `users_can_register` WordPress option, demonstrating unauthorized state modification capability. The detection verifies both enabling and disabling the setting to confirm exploitability and avoid false positives.

## References

- https://www.wordfence.com/blog/2019/04/zero-day-vulnerability-in-yellow-pencil-visual-theme-customizer-exploited-in-the-wild/
- https://web.archive.org/web/20190410184502/https://www.pluginvulnerabilities.com/2019/04/09/recently-closed-visual-css-style-editor-wordpress-plugin-contains-privilege-escalation-vulnerability-that-leads-to-option-update-vulnerability/
- https://nvd.nist.gov/vuln/detail/CVE-2019-11886
