---
cve_id: CVE-2019-11507
template_path: nuclei-templates/http/cves/2019/CVE-2019-11507.yaml
affected_product: Pulse Secure Pulse Connect Secure
severity: medium
authentication: required
external_callback: false
affected_versions: 8.3.x before 8.3R7.1, 9.0.x before 9.0R3
preconditions: [Victim must visit a malicious link]
poc_classification: info-leak
---

## Vulnerability

Pulse Secure Pulse Connect Secure (PCS) versions 8.3.x before 8.3R7.1 and 9.0.x before 9.0R3 contain a reflected cross-site scripting (XSS) vulnerability caused by insufficient sanitization on the Application Launcher page. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).

The flaw exists in the `/dana/home/cts_get_ica.cgi` endpoint where the `appname` parameter is not properly sanitized before being reflected in the HTTP response. Attackers can craft malicious URLs containing JavaScript payloads that execute in the victim's browser context when the link is visited. This allows arbitrary script execution within the authenticated session, potentially leading to session hijacking, credential theft, or defacement.

The vulnerability requires user interaction (UI:R) as the victim must click on or visit a specially crafted malicious link while authenticated to the Pulse Connect Secure interface.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Authentication Phase**: The template first sends a GET request to `/dana-na/auth/url_default/welcome.cgi` to retrieve the `xsauth_token` value from the login page. It then performs a POST request to `/dana-na/auth/url_default/login.cgi` with provided credentials (username and password variables) to establish an authenticated session.

2. **XSS Verification**: After authentication, the template sends a GET request to `/dana/home/cts_get_ica.cgi` with a crafted payload in the `appname` parameter: `aa%0d%0aContent-Type::text/html%0d%0aContent-Disposition::inline%0d%0aaa:bb<svg/onload=alert(document.domain)>`. This payload attempts to inject an SVG element with an onload event handler.

The template confirms the vulnerability by checking that:
- The response returns HTTP 200 status
- The Content-Type header is `text/html`
- The injected payload `<svg/onload=alert(document.domain)>` is reflected in the response body without proper sanitization

This detection method verifies that the application is vulnerable to reflected XSS by confirming the malicious script is echoed back in the HTML response.

## References

- https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/
- https://nvd.nist.gov/vuln/detail/CVE-2019-11507
