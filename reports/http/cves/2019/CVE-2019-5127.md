---
cve_id: CVE-2019-5127
template_path: nuclei-templates/http/cves/2019/CVE-2019-5127.yaml
affected_product: YouPHPTube Encoder
severity: critical
authentication: none
external_callback: false
affected_versions: 2.3
preconditions: []
poc_classification: rce
---

## Vulnerability
YouPHPTube Encoder 2.3 is susceptible to a command injection vulnerability which could allow an attacker to compromise the server. These exploitable unauthenticated command injections exist via the parameter base64Url in /objects/getImage.php (and related endpoints getImageMP4.php, getSpiritsFromVideo.php). Arbitrary OS commands are executed after base64 decoding without sanitization.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8, CWE-78).  
Impact: Successful exploitation of this vulnerability can lead to unauthorized remote code execution, potentially compromising the entire system.

## PoC / Detection
Classification: rce  
The template injects a base64-encoded payload equivalent to `` `id > {{random5}}.txt` `` via GET requests to the three vulnerable endpoints with base64Url and format parameters. A second GET then fetches the created file at /objects/{{filename}}.txt and confirms RCE by matching the `id` command output (uid=...gid=... regex), text/plain Content-Type header, and HTTP 200 status.

## References
- https://talosintelligence.com/vulnerability_reports/TALOS-2019-0917
- https://nvd.nist.gov/vuln/detail/CVE-2019-5127
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/sobinge/nuclei-templates
