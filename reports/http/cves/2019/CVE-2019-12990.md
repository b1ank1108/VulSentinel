---
cve_id: CVE-2019-12990
template_path: nuclei-templates/http/cves/2019/CVE-2019-12990.yaml
affected_product: Citrix SD-WAN Center
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability

Citrix SD-WAN Center is susceptible to a critical unauthenticated local file inclusion via the `applianceSettingsFileTransfer` function in `ApplianceSettingsController`. The function does not sufficiently validate or sanitize HTTP request parameter values (`filename`, `filedata`, `workspace_id`) used to construct a file system path. An attacker can route traffic through the Collector controller to write arbitrary files to locations writable by the www-data user and/or place a crafted PHP file in `/home/talariuser/www/app/webroot/files/` for arbitrary PHP code execution. CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8), CWE-22. Impact includes remote code execution, sensitive data access, or denial of service.

## PoC / Detection

Classification: rce

The template fingerprints the target with `GET /login` (checks for `<title>Citrix SD-WAN</title>`), then sends `POST /Collector/appliancesettings/applianceSettingsFileTransfer` with traversal payload `filename=../../../../../../home/talariuser/www/app/webroot/files/{{randstr}}&filedata=` to perform the arbitrary file write, followed by `GET /talari/app/files/{{randstr}}` to confirm successful write via status 200 and text/html content-type. DSL matchers enforce Citrix presence, HTTP 200 on final request, and header/body conditions.

## References

- https://www.tenable.com/security/research/tra-2019-31
- https://support.citrix.com/search?searchQuery=*&lang=en&sort=relevance&prod=&pver=&ct=Security+Bulletin
- https://nvd.nist.gov/vuln/detail/CVE-2019-12990
- https://support.citrix.com/search?searchQuery=%2A&lang=en&sort=relevance&prod=&pver=&ct=Security+Bulletin
