---
cve_id: CVE-2019-12581
template_path: nuclei-templates/http/cves/2019/CVE-2019-12581.yaml
affected_product: Zyxel ZyWall/USG/UAG Devices
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-12581 is a reflected cross-site scripting (XSS) vulnerability affecting Zyxel ZyWall, USG, and UAG network devices. The vulnerability exists in the `free_time_failed.cgi` CGI program, which fails to properly sanitize the `err_msg` parameter before reflecting it in HTTP responses. Remote attackers can inject arbitrary JavaScript or HTML code through this parameter, which executes in the context of a victim's browser when they visit a malicious link. This can lead to session hijacking, credential theft, website defacement, or other client-side attacks. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity), requiring user interaction but no authentication to exploit.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to `/free_time_failed.cgi` with a crafted `err_msg` parameter containing a JavaScript payload: `<script>alert(document.domain);</script>`. The template verifies the vulnerability by checking for three conditions:

1. The injected script tag `<script>alert(document.domain);</script>` is reflected in the response body
2. The response body contains the text "Please contact with administrator." (indicating the error page context)
3. The response has a `text/html` Content-Type header and returns HTTP status 200

If all conditions are met, the template confirms that user-supplied input is reflected without proper sanitization, demonstrating the presence of the XSS vulnerability.

## References

- https://www.zyxel.com/support/vulnerabilities-related-to-the-Free-Time-feature.shtml
- https://sec-consult.com/vulnerability-lab/advisory/reflected-cross-site-scripting-in-zxel-zywall/
- https://n-thumann.de/blog/zyxel-gateways-missing-access-control-in-account-generator-xss/
- https://nvd.nist.gov/vuln/detail/CVE-2019-12581
- https://www.zyxel.com/us/en/
