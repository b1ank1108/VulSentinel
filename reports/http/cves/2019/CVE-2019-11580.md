---
cve_id: CVE-2019-11580
template_path: nuclei-templates/http/cves/2019/CVE-2019-11580.yaml
affected_product: Atlassian Crowd and Crowd Data Center
severity: critical
authentication: none
external_callback: false
affected_versions: 2.1.0 to <3.0.5, 3.1.0 to <3.1.6, 3.2.0 to <3.2.8, 3.3.0 to <3.3.5, 3.4.0 to <3.4.4
preconditions: [pdkinstall development plugin incorrectly enabled in release builds]
poc_classification: rce
---

## Vulnerability

CVE-2019-11580 is a critical remote code execution vulnerability in Atlassian Crowd and Crowd Data Center. The vulnerability stems from the pdkinstall development plugin being incorrectly enabled in release builds. This misconfiguration allows attackers to send unauthenticated or authenticated requests to install arbitrary plugins on vulnerable Crowd instances, which directly enables remote code execution.

The vulnerability affects all versions of Crowd from 2.1.0 through multiple version branches: versions before 3.0.5 in the 3.0.x series, before 3.1.6 in the 3.1.x series, before 3.2.8 in the 3.2.x series, before 3.3.5 in the 3.3.x series, and before 3.4.4 in the 3.4.x series. Successful exploitation results in complete system compromise, allowing attackers to execute arbitrary code with the privileges of the Crowd application.

The CVSS v3.1 score is 9.8 (Critical) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-based exploitation requiring no privileges, no user interaction, and resulting in high impact to confidentiality, integrity, and availability. The EPSS score of 0.94386 (99.969th percentile) indicates this vulnerability is actively exploited in the wild.

## PoC / Detection

Classification: rce

The template performs a two-stage attack to verify the remote code execution vulnerability:

1. **Plugin Upload Stage**: The template sends a POST request to `/crowd/admin/uploadplugin.action` with a malicious JAR file containing a custom plugin. The plugin is uploaded as multipart/mixed data with a hex-encoded payload that includes an `atlassian-plugin.xml` descriptor and compiled Java classes (`com/cdl/shell/exp.class` and `com/cdl/shell/exp.java`).

2. **Execution Verification Stage**: After uploading the malicious plugin, the template sends a GET request to `/crowd/plugins/servlet/exp` to trigger the installed plugin's servlet endpoint.

The template confirms successful exploitation by checking if the response body contains the string "CVE-2019-11580", which is presumably output by the custom plugin code upon execution. This demonstrates that arbitrary code can be executed on the target system through the plugin installation mechanism.

## References

- https://github.com/jas502n/CVE-2019-11580
- https://jira.atlassian.com/browse/CWD-5388
- https://nvd.nist.gov/vuln/detail/CVE-2019-11580
- http://packetstormsecurity.com/files/163810/Atlassian-Crowd-pdkinstall-Remote-Code-Execution.html
- https://github.com/Elsfa7-110/kenzer-templates
