---
cve_id: CVE-2019-6799
template_path: nuclei-templates/http/cves/2019/CVE-2019-6799.yaml
affected_product: phpMyAdmin
severity: medium
authentication: none
external_callback: true
affected_versions: > 3.9.9 and < 4.8.5 (PHP < 7.3.4)
preconditions: AllowArbitraryServer configuration setting set to true
poc_classification: info-leak
---

## Vulnerability
phpMyAdmin before 4.8.5 is susceptible to local file inclusion. When the AllowArbitraryServer configuration setting is set to true, an attacker can read, with the use of a rogue MySQL server, any file on the server that the web server's user can access. This is related to the mysql.allow_local_infile PHP configuration, and the inadvertent ignoring of MYSQLI_OPT_LOCAL_INFILE calls. CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N (score 5.9).

## PoC / Detection
Classification: info-leak

The template sends unauthenticated GET requests (batteringram attack) to common phpMyAdmin paths such as /index.php, /pma/index.php, /phpmyadmin/index.php with parameters ?pma_servername={{interactsh-url}}&pma_username={{randstr}}&pma_password={{randstr}}&server=1. It verifies via DNS interaction on interactsh, presence of mysqli_real_connect and pma_servername strings in response, status 200, plus DSL compare_versions matchers (phpMyAdmin >3.9.9 <4.8.5 extracted via regex on ?v=; PHP <7.3.4 extracted from X-Powered-By header).

## References
- https://paper.seebug.org/1112/#_4
- https://github.com/phpmyadmin/phpmyadmin/commit/828f740158e7bf14aa4a7473c5968d06364e03a2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6799
- https://github.com/rmb122/rogue_mysql_server
- https://github.com/vulnspy/phpmyadmin-4.8.4-allowarbitraryserver
- https://nvd.nist.gov/vuln/detail/CVE-2019-6799
