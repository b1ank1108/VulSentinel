---
cve_id: CVE-2019-17564
template_path: nuclei-templates/http/cves/2019/CVE-2019-17564.yaml
affected_product: Apache Dubbo
severity: critical
authentication: none
external_callback: false
affected_versions: 2.5.x, 2.6.0 to 2.6.7, 2.7.0 to 2.7.4
preconditions: [HTTP remoting enabled]
poc_classification: rce
---

## Vulnerability
Apache Dubbo (with HTTP remoting enabled) contains an unsafe Java deserialization flaw (CWE-502) in the HTTP provider endpoint. An unauthenticated remote attacker can submit a POST request containing a malicious serialized object (Commons Collections gadget chain), resulting in arbitrary code execution and full compromise of the Dubbo Provider instance. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). Impact includes complete server takeover; remediation is upgrade to 2.7.5+ or disable HTTP remoting.

## PoC / Detection
Classification: rce

The template issues one POST request to `{{BaseURL}}/{{interface}}` (default: `/com.example.TestService`) with `Content-Type: application/x-www-form-urlencoded` and a fixed base64-decoded serialized payload in the body that triggers the Commons Collections gadget chain (Runtime.getRuntime().exec("ls")). It matches on Java exception strings (`java.lang.ClassNotFoundException`, `java.io.InvalidClassException`, `java.lang.ClassCastException`, `java.io.StreamCorruptedException`, or `java.rmi.RemoteException: Deserialized object needs to be assignable`) appearing in the response body combined with HTTP status 500 or 400.

## References
- https://advisory.checkmarx.net/advisory/CX-2020-4275
- https://github.com/Hu3sky/CVE-2019-17564
- https://github.com/r00t4dm/CVE-2019-17564
- https://dubbo.apache.org/en/docs3-v2/java-sdk/advanced-features-and-usage/security/
