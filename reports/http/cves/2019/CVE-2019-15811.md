---
cve_id: CVE-2019-15811
template_path: nuclei-templates/http/cves/2019/CVE-2019-15811.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: <=4.13.0
preconditions: []
poc_classification: detect-only
---

## Vulnerability

DomainMOD versions through 4.13.0 contain a reflected cross-site scripting (XSS) vulnerability in the `/reporting/domains/cost-by-month.php` endpoint. The vulnerability exists in the `daterange` parameter, which fails to properly sanitize user input before reflecting it in the HTML response. An attacker can craft a malicious URL containing JavaScript code that will execute in the context of an authenticated user's browser session when the victim clicks the link. This is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation).

The vulnerability requires an authenticated session to exploit, as the affected endpoint is only accessible to logged-in users. Successful exploitation could lead to session hijacking, credential theft, or unauthorized actions performed on behalf of the victim user within the DomainMOD application.

## PoC / Detection

Classification: detect-only

The Nuclei template performs a two-step detection process:

1. **Authentication**: Sends a POST request to the root endpoint (`/`) with credentials (`new_username` and `new_password` parameters) to establish an authenticated session.

2. **XSS Probe**: Sends a GET request to `/reporting/domains/cost-by-month.php` with a crafted `daterange` parameter containing an XSS payload: `"onfocus="alert(document.domain)"autofocus="`. This payload attempts to trigger JavaScript execution through HTML attribute injection.

The template verifies the vulnerability by checking for:
- HTTP 200 status code on the second request
- `text/html` content type in the response
- The reflected XSS payload appearing unescaped in the response body: `value=""onfocus="alert(document.domain)"autofocus="`
- Presence of "DomainMOD" string confirming the target application

The template does not actually execute the XSS payload but confirms that the malicious input is reflected without proper sanitization, indicating the vulnerability is present.

## References

- https://www.exploit-db.com/exploits/47325
- https://github.com/domainmod/domainmod/issues/108
- https://nvd.nist.gov/vuln/detail/CVE-2019-15811
- https://zerodays.lol/
- https://github.com/ARPSyndicate/kenzer-templates
