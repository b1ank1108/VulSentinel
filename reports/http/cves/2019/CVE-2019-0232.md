---
cve_id: CVE-2019-0232
template_path: nuclei-templates/http/cves/2019/CVE-2019-0232.yaml
affected_product: Apache Tomcat
severity: high
authentication: none
external_callback: false
affected_versions: 9.0.0.M1 to 9.0.17, 8.5.0 to 8.5.39, 7.0.0 to 7.0.93
preconditions: [Running on Windows, CGI Servlet enabled, enableCmdLineArguments enabled]
poc_classification: rce
---

## Vulnerability

CVE-2019-0232 is a Remote Code Execution vulnerability in Apache Tomcat's CGI Servlet when running on Windows systems. The vulnerability stems from a bug in how the Java Runtime Environment (JRE) passes command line arguments to Windows processes. When the CGI Servlet is enabled with the `enableCmdLineArguments` option set to true, attackers can inject arbitrary commands through specially crafted URL parameters.

The vulnerability affects Apache Tomcat versions 9.0.0.M1 through 9.0.17, 8.5.0 through 8.5.39, and 7.0.0 through 7.0.93. The CGI Servlet is disabled by default in Tomcat installations, and the `enableCmdLineArguments` option is also disabled by default in Tomcat 9.0.x. However, when both are explicitly enabled on Windows systems, the server becomes vulnerable to command injection attacks that can lead to complete system compromise.

The root cause is related to improper command-line argument quoting in Windows environments, allowing attackers to break out of intended argument boundaries and execute arbitrary system commands with the privileges of the Tomcat process.

## PoC / Detection

Classification: rce

The template detects this vulnerability by attempting command injection through URL parameters. It sends a GET request with a specially crafted query string containing `?&echo+{{sid}}`, where `{{sid}}` is a randomly generated 10-character alphabetic string. The `&` character is used to chain commands in Windows batch scripts.

The template verifies successful exploitation through multiple matchers:
1. The response body contains the randomly generated string (indicating the echo command executed)
2. The response body does NOT contain the literal strings "echo {{sid}}" or "echo+{{sid}}" (confirming command execution rather than echo of the input)
3. The response Content-Type is "text/plain" (typical for CGI script output)
4. The HTTP status code is 200

This detection method confirms that the server executed the injected `echo` command and returned its output, demonstrating the presence of the command injection vulnerability.

## References

- http://packetstormsecurity.com/files/153506/Apache-Tomcat-CGIServlet-enableCmdLineArguments-Remote-Code-Execution.html
- http://seclists.org/fulldisclosure/2019/May/4
- https://access.redhat.com/errata/RHSA-2019:1712
- https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-cve-2019-0232-a-remote-code-execution-vulnerability-in-apache-tomcat/
- https://codewhitesec.blogspot.com/2016/02/java-and-command-line-injections-in-windows.html
