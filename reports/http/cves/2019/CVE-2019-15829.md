---
cve_id: CVE-2019-15829
template_path: nuclei-templates/http/cves/2019/CVE-2019-15829.yaml
affected_product: Gallery PhotoBlocks
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.1.43
preconditions: [Authenticated user access required, WordPress admin panel access]
poc_classification: info-leak
---

## Vulnerability

CVE-2019-15829 is an Authenticated Reflected Cross-Site Scripting (XSS) vulnerability in the Gallery PhotoBlocks WordPress plugin affecting versions prior to 1.1.43. The vulnerability exists in the plugin's admin interface, specifically in the `photoblocks-edit` page where the `id` parameter is not properly sanitized before being reflected in the HTML response.

Authenticated attackers can craft malicious URLs containing JavaScript payloads in the `id` parameter. When an authenticated user (particularly an administrator) visits the malicious URL, the injected script executes in their browser context. This allows attackers to steal session cookies, perform privileged actions on behalf of the victim, modify plugin settings, or conduct further attacks against the WordPress installation.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 4.8 (Medium severity). The attack vector is network-based with low attack complexity, but requires high privileges (authenticated access) and user interaction (victim must click the malicious link). The scope is changed, meaning the vulnerable component impacts resources beyond its security scope.

## PoC / Detection

Classification: info-leak

The Nuclei template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials (`username` and `password` parameters) to establish an authenticated session.

2. **XSS Probe**: Sends a GET request to `/wp-admin/admin.php?page=photoblocks-edit` with a crafted `id` parameter containing an XSS payload: `"><svg/onload=alert(document.domain)>`. This payload attempts to break out of the HTML context and inject an SVG element with an onload event handler.

The template verifies the vulnerability by checking three conditions:
- The response returns HTTP 200 status
- The response body contains the reflected XSS payload `<svg/onload=alert(document.domain)>` (unencoded)
- The response body contains the string "post galleries!" (confirming the correct admin page loaded)

The template uses a harmless `alert(document.domain)` payload for detection purposes, demonstrating that arbitrary JavaScript can be executed in the context of an authenticated user's session.

## References

- https://wpscan.com/vulnerability/b8d1d88e-f2e5-4212-af34-c91f563f07b6/
- https://nvd.nist.gov/vuln/detail/CVE-2019-15829
- https://wordpress.org/plugins/photoblocks-grid-gallery/
- https://wordpress.org/plugins/photoblocks-grid-gallery/#developers
- https://wpvulndb.com/vulnerabilities/9443
