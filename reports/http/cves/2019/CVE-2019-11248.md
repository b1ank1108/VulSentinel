---
cve_id: CVE-2019-11248
template_path: nuclei-templates/http/cves/2019/CVE-2019-11248.yaml
affected_product: Kubernetes
severity: high
authentication: none
external_callback: false
affected_versions: <1.12.10, 1.13.0-1.13.7, 1.14.0-1.14.3, 1.15.0
preconditions: [Kubelet healthz port exposed, non-default configuration with debug endpoint enabled]
poc_classification: info-leak
---

## Vulnerability

CVE-2019-11248 is an information disclosure vulnerability in Kubernetes where the debugging endpoint `/debug/pprof` is exposed over the unauthenticated Kubelet healthz port. This endpoint can leak sensitive information including internal Kubelet memory addresses, configuration details, and potentially enable limited denial of service attacks. The vulnerability affects Kubernetes versions prior to 1.15.0, 1.14.4, 1.13.8, and 1.12.10. While classified as medium severity by the vendor, it is rated high in this template due to the potential for information leakage that could facilitate further attacks. The issue is not exposed by default configuration, requiring specific deployment settings where the debug endpoint is accessible over the healthz port.

The vulnerability is classified as CWE-862 (Missing Authorization) and CWE-419 (Unprotected Primary Channel), with a CVSS v3.1 score of 8.2 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L), indicating high confidentiality impact and low availability impact with no authentication required.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by attempting to access two debug profiling endpoints without authentication:

1. `/debug/pprof/` - The main pprof index page
2. `/debug/pprof/goroutine?debug=1` - A specific goroutine profile endpoint

The detection uses a stop-at-first-match strategy, sending GET requests to these paths and checking for successful responses containing characteristic pprof output. The template matches on specific strings that indicate the debug endpoint is accessible:
- "Types of profiles available:" - Present in the pprof index page
- "Profile Descriptions" - Alternative text from pprof interface
- "goroutine profile: total" - Specific to the goroutine profile output

A positive match confirms that the debugging endpoint is exposed and accessible without authentication, allowing potential attackers to gather internal runtime information about the Kubernetes Kubelet process.

## References

- https://medium.com/bugbountywriteup/my-first-bug-bounty-21d3203ffdb0
- http://mmcloughlin.com/posts/your-pprof-is-showing
- https://github.com/kubernetes/kubernetes/issues/81023
- https://groups.google.com/d/msg/kubernetes-security-announce/pKELclHIov8/BEDtRELACQAJ
- https://nvd.nist.gov/vuln/detail/CVE-2019-11248
