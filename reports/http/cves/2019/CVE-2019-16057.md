---
cve_id: CVE-2019-16057
template_path: nuclei-templates/http/cves/2019/CVE-2019-16057.yaml
affected_product: D-Link DNS-320
severity: critical
authentication: none
external_callback: false
affected_versions: through 2.05.B10
preconditions: []
poc_classification: rce
---

## Vulnerability
D-Link DNS-320 firmware through 2.05.B10 contains an unauthenticated remote command injection (CWE-78) in `login_mgr.cgi`.  

Attackers inject OS commands via the `port` parameter during a crafted login request.  

**CVSS 3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Description:** The login_mgr.cgi script in D-Link DNS-320 through 2.05.B10 is vulnerable to remote command injection.  
**Impact:** Successful exploitation leads to unauthorized access, data loss, and full device compromise.  
**Remediation:** Apply the latest firmware update provided by D-Link.

## PoC / Detection
Classification: rce

The template issues a single unauthenticated GET request to `{{BaseURL}}/cgi-bin/login_mgr.cgi` with URL-encoded injection in the `port` parameter (`80%7Cpwd%26id`) while supplying dummy login values (`f_username=admin`). It detects successful arbitrary command execution by matching HTTP status 200 and the presence of `uid=`, `gid=`, and the injected string `pwd&id` in the response body.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2019-16057
- https://web.archive.org/web/20201222035258im_/https://blog.cystack.net/content/images/2019/09/poc.png
- https://www.ftc.gov/system/files/documents/cases/dlink_proposed_order_and_judgment_7-2-19.pdf
- https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors
- https://github.com/Z0fhack/Goby_POC
