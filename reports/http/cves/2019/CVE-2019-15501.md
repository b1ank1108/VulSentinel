---
cve_id: CVE-2019-15501
template_path: nuclei-templates/http/cves/2019/CVE-2019-15501.yaml
affected_product: L-Soft LISTSERV
severity: medium
authentication: none
external_callback: false
affected_versions: <16.5-2018a
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2019-15501 is a reflected cross-site scripting (XSS) vulnerability in L-Soft LISTSERV versions prior to 16.5-2018a. The vulnerability exists in the `/scripts/wa.exe` endpoint, specifically in the `OK` parameter, which fails to properly sanitize user-supplied input before reflecting it in the HTTP response. An attacker can craft a malicious URL containing JavaScript code that, when accessed by a victim, executes in the context of the victim's browser session. This could enable the attacker to steal session cookies, perform unauthorized actions on behalf of the victim, or redirect users to malicious sites. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity), requiring user interaction but no authentication.

## PoC / Detection

Classification: info-leak

The template detects this XSS vulnerability by sending a GET request to `/scripts/wa.exe` with a crafted `OK` parameter containing URL-encoded JavaScript: `</script><script>alert(document.domain)</script>`. The detection verifies three conditions:
1. The response body contains the unescaped JavaScript payload (`</script><script>alert(document.domain)</script>`) and the string "LISTSERV" (case-insensitive)
2. The response Content-Type header is `text/html`
3. The HTTP status code is 200

If all conditions are met, the template confirms that user input is reflected without proper sanitization, indicating the presence of the XSS vulnerability. The template uses a benign proof-of-concept payload that would display the document domain in an alert box if executed in a browser.

## References

- https://www.exploit-db.com/exploits/47302
- http://www.lsoft.com/manuals/16.5/LISTSERV16.5-2018a_WhatsNew.pdf
- https://nvd.nist.gov/vuln/detail/CVE-2019-15501
- https://github.com/ARPSyndicate/kenzer-templates
