---
cve_id: CVE-2019-7609
template_path: nuclei-templates/http/cves/2019/CVE-2019-7609.yaml
affected_product: Kibana Timelion
severity: critical
authentication: none
external_callback: false
affected_versions: before 5.6.15 and 6.6.1
preconditions: access to the Timelion application
poc_classification: rce
---

## Vulnerability
Kibana versions before 5.6.15 and 6.6.1 contain an arbitrary code execution flaw in the Timelion visualizer (CWE-94). An attacker with access to the Timelion application can send a request that executes arbitrary JavaScript code, resulting in command execution with the privileges of the Kibana process.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (score 10.0).  
Impact: unauthorized access, data leakage, and full system compromise.  
Remediation: upgrade to 5.6.15+, 6.6.1+, or apply latest security patches.

## PoC / Detection
Classification: rce  
The template issues a single POST request to `{{BaseURL}}/api/timelion/run` carrying the benign JSON body `{"sheet":[".es(*)"],"time":{"from":"now-1m","to":"now","mode":"quick","interval":"auto","timezone":"Asia/Shanghai"}}` (Content-Type: application/json). It matches on HTTP 200, `application/json` header, and the string `seriesList` in the response body to confirm the vulnerable Timelion endpoint is active and responsive. The probe itself is harmless; the underlying flaw permits arbitrary JavaScript injection via crafted `sheet` values.

## References
- https://github.com/mpgn/CVE-2019-7609
- https://discuss.elastic.co/t/elastic-stack-6-6-1-and-5-6-15-security-update/169077
- https://nvd.nist.gov/vuln/detail/CVE-2019-7609
- https://www.elastic.co/community/security
- https://access.redhat.com/errata/RHBA-2019:2824
