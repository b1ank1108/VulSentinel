---
cve_id: CVE-2019-18952
template_path: nuclei-templates/http/cves/2019/CVE-2019-18952.yaml
affected_product: Xfilesharing
severity: critical
authentication: none
external_callback: false
affected_versions: through 2.5.1
preconditions: []
poc_classification: rce
---

## Vulnerability
SibSoft Xfilesharing through 2.5.1 allows arbitrary file upload via the `cgi-bin/up.cgi` endpoint. Unauthenticated attackers can upload PHP files (or .html as noted for chaining) that are served and executed from `/cgi-bin/temp/`. Chaining with CVE-2019-18951 enables remote code execution leading to full system compromise. CVSS:3.1 9.8 (Critical), CWE-434.

## PoC / Detection
Classification: rce

The template verifies exploitability by uploading a self-deleting PHP payload via POST multipart/form-data to `/cgi-bin/up.cgi` (using random `sid` path and `.php` filename with `Content-Type: application/php`). It then GETs the file at `/cgi-bin/temp/{{path}}/{{filename}}.php` and matches the output of `md5('999999999')` to confirm upload success and arbitrary PHP code execution.

## References
- https://www.exploit-db.com/exploits/47659
- https://gist.github.com/pak0s/af9f640170aed335fdf6d110d468dbce
- https://nvd.nist.gov/vuln/detail/CVE-2019-18952
