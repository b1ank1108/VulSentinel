---
cve_id: CVE-2019-5129
template_path: nuclei-templates/http/cves/2019/CVE-2019-5129.yaml
affected_product: YouPHPTube Encoder
severity: critical
authentication: none
external_callback: false
affected_versions: 2.3
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2019-5129 is a critical unauthenticated command injection vulnerability in YouPHPTube Encoder version 2.3, a plugin providing encoder functionality for YouPHPTube. The vulnerability exists in the `/objects/getSpiritsFromVideo.php` endpoint (note: the template description mentions `/objects/getImageMP4.php`, but the actual exploit targets `getSpiritsFromVideo.php`), specifically in the `base64Url` parameter. This parameter fails to properly sanitize user input before passing it to system commands, allowing attackers to inject arbitrary shell commands without any authentication.

The vulnerability is classified as CWE-78 (OS Command Injection) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no privileges or user interaction required. The EPSS score of 0.9306 (99.78th percentile) indicates this vulnerability is highly likely to be exploited in the wild.

Successful exploitation allows unauthenticated remote attackers to execute arbitrary system commands with the privileges of the web server process, leading to complete server compromise, unauthorized access to all media content, data exfiltration, and potential lateral movement within the network.

## PoC / Detection

Classification: rce

The template performs a two-stage detection process to verify the command injection vulnerability:

1. **Command Injection Stage**: Sends a GET request to `/objects/getSpiritsFromVideo.php` with a malicious `base64Url` parameter. The payload is base64-encoded and contains backtick-wrapped command injection: `` `id > [random].txt` ``. This executes the `id` command and redirects output to a randomly-named text file in the objects directory.

2. **Verification Stage**: Sends a second GET request to retrieve the created file at `/objects/[random].txt`. The template verifies successful command execution by checking if the response body contains the expected output pattern from the `id` command (matching `uid=[0-9]+.*gid=[0-9]+.*`).

The template confirms the vulnerability when both conditions are met: HTTP 200 status code and the regex pattern matching Unix user/group ID output, proving arbitrary command execution capability.

## References

- https://xz.aliyun.com/news/6312
