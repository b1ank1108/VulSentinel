---
cve_id: CVE-2019-17506
template_path: nuclei-templates/http/cves/2019/CVE-2019-17506.yaml
affected_product: D-Link DIR-868L/817LW
severity: critical
authentication: none
external_callback: false
affected_versions: D-Link DIR-868L B1-2.03 and DIR-817LW A1-1.04
preconditions: []
poc_classification: info-leak
---

## Vulnerability

D-Link DIR-868L B1-2.03 and DIR-817LW A1-1.04 routers suffer from an unauthenticated information disclosure vulnerability in `/getcfg.php`. The endpoint allows extraction of administrative credentials and device configuration by submitting `SERVICES=DEVICE.ACCOUNT&AUTHORIZED_GROUP=1%0a` without any authentication.

**CVSS Score:** 9.8 (Critical)  
**Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H  
**CWE:** CWE-306 (Missing Authentication for Critical Function)  

Exploitation grants attackers the router username/password and other sensitive data, enabling full remote control.

## PoC / Detection

Classification: info-leak

The template sends a POST request to `{{BaseURL}}/getcfg.php` with body `SERVICES=DEVICE.ACCOUNT&AUTHORIZED_GROUP=1%0a` and `Content-Type: text/xml` header. Detection succeeds if the 200 OK response body contains both `</password>` and `DEVICE.ACCOUNT`.

## References
- https://github.com/dahua966/Routers-vuls/blob/master/DIR-868/name%26passwd.py
- https://nvd.nist.gov/vuln/detail/CVE-2019-17506
- https://github.com/openx-org/BLEN
- https://github.com/sobinge/nuclei-templates
- https://github.com/SexyBeast233/SecBooks
