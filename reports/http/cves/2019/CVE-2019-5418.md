---
cve_id: CVE-2019-5418
template_path: nuclei-templates/http/cves/2019/CVE-2019-5418.yaml
affected_product: Rails
severity: high
authentication: none
external_callback: false
affected_versions: <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 and v3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Rails <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 and v3 are susceptible to a file content disclosure vulnerability. Specially crafted Accept headers can cause contents of arbitrary files on the target system's file system to be exposed. This vulnerability can lead to unauthorized access to sensitive information stored on the server.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}` with the header `Accept: ../../../../../../../../etc/passwd{{`. It verifies success if the response status is 200 or 500 and the body matches the regex `root:.*:0:0:` (indicating /etc/passwd contents were returned).

## References
- https://github.com/omarkurt/CVE-2019-5418
- https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/
- https://nvd.nist.gov/vuln/detail/CVE-2019-5418
- https://www.exploit-db.com/exploits/46585/
- http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00011.html
