---
cve_id: CVE-2019-16931
template_path: nuclei-templates/http/cves/2019/CVE-2019-16931.yaml
affected_product: WordPress Visualizer
severity: medium
authentication: none
external_callback: false
affected_versions: < 3.3.1
preconditions: []
poc_classification: state-change
---

## Vulnerability
WordPress Visualizer plugin before version 3.3.1 suffers from a stored cross-site scripting (XSS) vulnerability via the `/wp-json/visualizer/v1/update-chart` WP-JSON API endpoint. An unauthenticated attacker can submit a malicious JavaScript payload in the chart update request. The payload persists and executes in the browser of any administrator or privileged user who subsequently edits or views the affected chart in the WordPress dashboard.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection
Classification: state-change

The template issues a raw unauthenticated POST request to the update-chart endpoint with JSON payload `{"id": 7, "visualizer-chart-type": "<script>alert(document.domain)</script>"}`. It confirms success (and thus lack of sanitization) by matching HTTP 200 status, application/json Content-Type header, and the response body containing '{"success":"Chart updated"}'. This verifies the ability to perform unauthorized data modification by injecting persistent XSS payloads into chart data.

## References
- https://wpscan.com/vulnerability/867e000d-d2f5-4d53-89b0-41d7d4163f44
- https://nathandavison.com/blog/wordpress-visualizer-plugin-xss-and-ssrf
- https://wpvulndb.com/vulnerabilities/9893
- https://nvd.nist.gov/vuln/detail/CVE-2019-16931
- https://wordpress.org/plugins/visualizer/#developers
