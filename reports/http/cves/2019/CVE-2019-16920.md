---
cve_id: CVE-2019-16920
template_path: nuclei-templates/http/cves/2019/CVE-2019-16920.yaml
affected_product: D-Link Routers
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
D-Link routers contain an unauthenticated command injection (CWE-78) vulnerability in the PingTest CGI endpoint at `/apply_sec.cgi`.  
Affected models: DIR-655C, DIR-866L, DIR-652, DHP-1565, DIR-855L, DAP-1533, DIR-862L, DIR-615, DIR-835, DIR-825.  
Attackers inject arbitrary OS commands by appending a newline (`%0a`) followed by a payload to the `ping_ipaddr` parameter when `action=ping_test`.  
Successful exploitation yields full system compromise (router shell access and network control).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Impact: complete device takeover.  
Remediation: apply latest D-Link firmware update.

## PoC / Detection
Classification: rce  
The template executes a 3-request raw HTTP chain to verify the flaw:  
1. POST `/apply_sec.cgi` performs `do_graph_auth` as `admin` (empty password) to establish context.  
2â€“3. POST `/apply_sec.cgi` (with fixed `uid=1234123` cookie) sets `action=ping_test` and injects `ping_ipaddr=127.0.0.1%0a<cmd>` where `<cmd>` is `cat /etc/passwd` (Unix) or `type C:\\Windows\\win.ini` (Windows).  
Matchers require HTTP 200 and body containing either `root:.*:0:0:` or Windows INI section headers (`[fonts]`, `[extensions]`, `[files]`).  
This confirms injected commands execute and their output is returned in-band.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2019-16920
- https://github.com/pwnhacker0x18/CVE-2019-16920-MassPwn3r
- https://fortiguard.com/zeroday/FG-VD-19-117
- https://www.seebug.org/vuldb/ssvid-98079
- https://medium.com/@80vul/determine-the-device-model-affected-by-cve-2019-16920-by-zoomeye-bf6fec7f9bb3
