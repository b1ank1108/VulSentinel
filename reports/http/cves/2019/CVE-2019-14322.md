---
cve_id: CVE-2019-14322
template_path: nuclei-templates/http/cves/2019/CVE-2019-14322.yaml
affected_product: Pallets Werkzeug
severity: high
authentication: none
external_callback: false
affected_versions: <0.15.5
preconditions: [Windows operating system, SharedDataMiddleware in use]
poc_classification: info-leak
---

## Vulnerability

CVE-2019-14322 is a local file inclusion (LFI) vulnerability in Pallets Werkzeug versions prior to 0.15.5. The vulnerability stems from improper handling of Windows drive names (such as `C:`) in pathnames by the SharedDataMiddleware component. This flaw allows attackers to traverse the filesystem and access arbitrary files on Windows systems by manipulating path parameters to include drive letter specifications. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) and carries a CVSS v3.1 score of 7.5 (High severity), with an EPSS score of 0.90059 indicating high likelihood of exploitation in the wild. The vulnerability enables unauthorized access to sensitive files, potential data leakage, and could facilitate remote code execution depending on the files accessed.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by attempting to exploit the path traversal flaw to read the Windows system file `win.ini`. It sends GET requests to three common Odoo framework endpoints (`/base_import/static/`, `/web/static/`, and `/base/static/`) appending the Windows-specific path `c:/windows/win.ini`. The detection uses a stop-at-first-match strategy to minimize requests. 

The template confirms successful exploitation by checking for:
1. HTTP 200 status code indicating successful file retrieval
2. Presence of characteristic `win.ini` file content markers in the response body: "bit app support", "fonts", and "extensions" (all three must be present)

This detection method verifies that the application is vulnerable to path traversal and can serve arbitrary Windows system files, demonstrating the local file inclusion vulnerability.

## References

- https://palletsprojects.com/blog/werkzeug-0-15-5-released/
- http://packetstormsecurity.com/files/163398/Pallets-Werkzeug-0.15.4-Path-Traversal.html
- https://nvd.nist.gov/vuln/detail/CVE-2019-14322
- https://github.com/faisalfs10x/CVE-2019-14322-scanner
- https://github.com/sobinge/nuclei-templates
