---
cve_id: CVE-2019-18393
template_path: nuclei-templates/http/cves/2019/CVE-2019-18393.yaml
affected_product: Ignite Realtime Openfire
severity: medium
authentication: none
external_callback: false
affected_versions: through 4.4.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Ignite Realtime Openfire through version 4.4.2 is vulnerable to local file inclusion in PluginServlet.java. The servlet does not enforce that retrieved files reside under the Openfire home directory, enabling path-traversal attacks to read arbitrary server files.

CVSS: 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) â€¢ CWE-22. Exploitation discloses sensitive configuration data (e.g., database credentials from conf/openfire.xml) and may enable further compromise.

## PoC / Detection
Classification: info-leak

The template detects the flaw by sending a single unauthenticated GET request with directory traversal to `{{BaseURL}}/plugins/search/..\..\..\conf\openfire.xml` and confirming a 200 OK response that contains the exact signature strings from the Openfire configuration file: "org.jivesoftware.database.EmbeddedConnectionProvider" and "Most properties are stored in the Openfire database".

## References
- https://github.com/igniterealtime/Openfire/pull/1498
- https://swarm.ptsecurity.com/openfire-admin-console/
- https://nvd.nist.gov/vuln/detail/CVE-2019-18393
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Elsfa7-110/kenzer-templates
