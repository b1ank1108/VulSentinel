---
cve_id: CVE-2019-14206
template_path: nuclei-templates/http/cves/2019/CVE-2019-14206.yaml
affected_product: WordPress Nevma Adaptive Images plugin
severity: high
authentication: required
external_callback: false
affected_versions: < 0.6.67
preconditions: [Plugin must be installed and active, Attacker must have WordPress account with file upload privileges]
poc_classification: state-change
---

## Vulnerability

CVE-2019-14206 is an arbitrary file deletion vulnerability in the Nevma Adaptive Images plugin for WordPress versions prior to 0.6.67. The vulnerability exists in the `adaptive-images-script.php` file due to unsanitized input handling. Remote attackers can exploit this flaw by sending specially crafted request parameters to delete arbitrary files on the server, potentially causing data loss and service disruption. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS v3.1 score of 7.5 (High severity), indicating network-based exploitation with low attack complexity and no privileges required at the protocol level, though the template demonstrates exploitation requires WordPress authentication.

## PoC / Detection

Classification: state-change

The template performs a multi-step exploitation chain to verify the arbitrary file deletion vulnerability:

1. **WordPress Detection**: Confirms the target is running WordPress by checking for `/license.txt`
2. **Authentication**: Logs into WordPress using provided credentials via POST to `/wp-login.php`
3. **Nonce Extraction**: Retrieves a WordPress nonce token from `/wp-admin/media-new.php` required for file upload
4. **File Upload**: Uploads a minimal JPEG image with a randomized filename to the WordPress media library via `/wp-admin/async-upload.php`, extracting the attachment ID from the response
5. **File Manipulation**: Makes three sequential requests to `adaptive-images-script.php` with progressively complex parameter manipulation:
   - First request accesses the uploaded file through path traversal
   - Second request adds resolution parameters
   - Third request exploits multiple unsanitized parameters (`source_file`, `wp_content`, `cache_dir`, `request_uri`, `watch_cache`) to delete the WordPress `license.txt` file
6. **Verification**: Confirms successful deletion by checking that `/license.txt` returns a 404 status code

The template demonstrates actual file deletion capability by removing a non-critical WordPress core file as proof of exploitation.

## References

- https://wordpress.org/plugins/adaptive-images/#developers
- https://wpscan.com/vulnerability/025a47f0-eddc-46dd-b994-e1e824dc5225/
- https://github.com/markgruffer/markgruffer.github.io/blob/master/_posts/2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown
- https://markgruffer.github.io/2019/07/19/adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.html
- https://wpvulndb.com/vulnerabilities/9468
- https://nvd.nist.gov/vuln/detail/CVE-2019-14206
