---
cve_id: CVE-2019-25141
template_path: nuclei-templates/http/cves/2019/CVE-2019-25141.yaml
affected_product: Easy WP SMTP
severity: critical
authentication: none
external_callback: false
affected_versions: <= 1.3.9
preconditions: []
poc_classification: state-change
---

## Vulnerability
Easy WP SMTP plugin for WordPress (<= 1.3.9) suffers from missing authorization (CWE-862) due to absent capability checks on the `admin_init()` function combined with insufficient input validation on settings import. Unauthenticated remote attackers can therefore update arbitrary WordPress options, including `users_can_register=1` and `default_role=administrator`, to inject new administrative accounts and achieve full site takeover.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact includes complete WordPress compromise.

## PoC / Detection
Classification: state-change

The template executes the actual exploit via a single raw POST to `/wp-admin/admin-ajax.php` containing a crafted multipart/form-data payload: `action=swpsmtp_clear_log`, `swpsmtp_import_settings=1`, and a file upload (`swpsmtp_import_settings_file`) whose serialized content sets the two critical options with a matching checksum. Detection relies on the server responding with HTTP 302 and a `Location` header pointing to `options-general.php?page=swpsmtp_settings`.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/id/84b75f7d-7258-46f6-aee6-b96d70bee264?source=cve
- https://medium.com/@ayman.abdul.kareem/from-bug-finder-to-risk-advisor-how-security-roles-are-evolving-db1aa86dd137
- https://nvd.nist.gov/vuln/detail/CVE-2019-25141
