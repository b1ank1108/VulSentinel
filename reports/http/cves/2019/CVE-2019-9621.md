---
cve_id: CVE-2019-9621
template_path: nuclei-templates/http/cves/2019/CVE-2019-9621.yaml
affected_product: Zimbra Collaboration Suite
severity: high
authentication: none
external_callback: false
affected_versions: Zimbra Collaboration Suite before 8.6 patch 13, 8.7.x before 8.7.11 patch 10, and 8.8.x before 8.8.10 patch 7 or 8.8.x before 8.8.11 patch 3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Zimbra Collaboration Suite (Collaboration Server) contains an SSRF (CWE-918) in the ProxyServlet component, reachable unauthenticated via XXE injection in the Autodiscover service. CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact includes arbitrary local file reads (e.g. /etc/passwd) and potential internal network probing.

## PoC / Detection
Classification: info-leak

The template issues one unauthenticated POST request to `/autodiscover` containing a crafted XML document that defines an external entity `&xxe;` pointing to `file:///etc/passwd` inside the AcceptableResponseSchema field. Detection succeeds when the response body simultaneously matches a regex for the root user entry (`root:.*:0:0:`), contains the string "response schema", and the Content-Type header includes "text/html".

## References
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra_xxe_rce.rb
- https://nvd.nist.gov/vuln/detail/cve-2019-9621
- http://packetstormsecurity.com/files/153190/Zimbra-XML-Injection-Server-Side-Request-Forgery.html
- https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html
- https://bugzilla.zimbra.com/show_bug.cgi?id=109127
