---
cve_id: CVE-2019-1821
template_path: nuclei-templates/http/cves/2019/CVE-2019-1821.yaml
affected_product: Cisco Prime Infrastructure and Cisco Evolved Programmable Network Manager
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Cisco Prime Infrastructure (PI) and Cisco Evolved Programmable Network (EPN) Manager allow an unauthenticated remote attacker to achieve root-level remote code execution. The root cause is improper validation of user-supplied input in the file upload handler, permitting directory traversal through crafted tar archives uploaded to the administrative interface.

## PoC / Detection
Classification: rce

The template performs exploitation verification by issuing a raw POST to `/servlet/UploadServlet` containing a multipart/form-data payload with `Filename: test.tar`, `Destination-Dir: tftpRoot`, and a tar entry using `../../opt/CSCOlumos/tomcat/webapps/ROOT/test.txt` to embed `{{randstr}}`. It follows with a GET to `/test.txt` and matches for HTTP 200 and presence of the random string in the body to confirm successful arbitrary file write.

## References
- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190515-pi-rce
- https://srcincite.io/blog/2019/05/17/panic-at-the-cisco-unauthenticated-rce-in-prime-infrastructure.html
- https://nvd.nist.gov/vuln/detail/CVE-2019-1821
- http://packetstormsecurity.com/files/153350/Cisco-Prime-Infrastructure-Health-Monitor-TarArchive-Directory-Traversal.html
- https://github.com/ARPSyndicate/kenzer-templates
