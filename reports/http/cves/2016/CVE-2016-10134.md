---
cve_id: CVE-2016-10134
template_path: nuclei-templates/http/cves/2016/CVE-2016-10134.yaml
affected_product: Zabbix
severity: critical
authentication: none
external_callback: false
affected_versions: Zabbix before 2.2.14 and 3.0 before 3.0.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Zabbix before 2.2.14 and 3.0 before 3.0.4 is vulnerable to SQL injection (CVE-2016-10134, CWE-89). Remote unauthenticated attackers can execute arbitrary SQL commands via the `toggle_ids` array parameter in `latest.php` (detected via crafted payload in `jsrpc.php`).

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation leads to unauthorized access, data leakage, and potential full compromise of the Zabbix application and underlying systems.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/jsrpc.php?type=0&mode=1&method=screen.get&profileIdx=web.item.graph&resourcetype=17&profileIdx2=updatexml(0,concat(0xa,user()),0)::` embedding an error-based `updatexml` payload designed to leak the current database user. It matches HTTP 200 responses containing both `'Error in query [INSERT INTO profiles (profileid, userid'` and `'You have an error in your SQL syntax'` in the body.

## References
- https://github.com/vulhub/vulhub/tree/master/zabbix/CVE-2016-10134
- https://nvd.nist.gov/vuln/detail/CVE-2016-10134
- https://support.zabbix.com/browse/ZBX-11023
- https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=850936
- http://www.debian.org/security/2017/dsa-3802
