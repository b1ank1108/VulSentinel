---
cve_id: CVE-2016-3081
template_path: nuclei-templates/http/cves/2016/CVE-2016-3081.yaml
affected_product: Apache Struts
severity: high
authentication: none
external_callback: false
affected_versions: 2.3.19 to 2.3.20.2, 2.3.21 to 2.3.24.1, and 2.3.25 to 2.3.28
preconditions: dynamic method invocation enabled
poc_classification: rce
---

## Vulnerability
Apache Struts 2.3.19 to 2.3.20.2, 2.3.21 to 2.3.24.1, and 2.3.25 to 2.3.28, when dynamic method invocation is enabled, allows remote attackers to execute arbitrary code via method: prefix (related to chained expressions).  
Impact: Remote code execution.  
Remediation: Upgrade to Apache Struts version 2.3.20.2, 2.3.24.2, or 2.3.28.1.  
CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (score 8.1).  
CWE: CWE-77.

## PoC / Detection
Classification: rce  
The template sends a single unauthenticated raw GET request to `/index.action` embedding an OGNL payload in the `method` parameter that forces `Runtime.getRuntime().exec("cat /etc/passwd")` and returns the command output. Detection succeeds on HTTP 200 combined with regex match `root:.*:0:0:` in the response body.

## References
- https://cwiki.apache.org/confluence/display/WW/S2-032
- https://struts.apache.org/docs/s2-032.html
- https://nvd.nist.gov/vuln/detail/CVE-2016-3081
- http://web.archive.org/web/20211207042547/https://securitytracker.com/id/1035665
- http://www.huawei.com/en/psirt/security-advisories/huawei-sa-20160527-01-struts2-en
