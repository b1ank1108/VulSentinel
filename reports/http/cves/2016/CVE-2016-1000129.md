---
cve_id: CVE-2016-1000129
template_path: nuclei-templates/http/cves/2016/CVE-2016-1000129.yaml
affected_product: WordPress defa-online-image-protector
severity: medium
authentication: none
external_callback: false
affected_versions: <=3.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress defa-online-image-protector plugin versions 3.3 and earlier contains a reflected cross-site scripting (XSS) vulnerability (CWE-79) in `redirect.php`. An unauthenticated remote attacker can craft a URL with a malicious `r` parameter containing a closing script tag followed by arbitrary JavaScript. When a victim visits the link, the payload reflects unsanitized into the HTML response and executes in the victim's browser context (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1). Successful exploitation enables session hijacking via cookie theft, page defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak

The template issues two sequential HTTP requests. The first GETs `/wp-content/plugins/defa-online-image-protector/readme.txt` and internally matches the string "Defa Online Image Protector" to confirm plugin presence. The second GETs `/wp-content/plugins/defa-online-image-protector/redirect.php?r=</script><script>alert(document.domain)</script>` and checks three conditions simultaneously: the exact payload string appears unescaped in the response body, the `Content-Type` header contains `text/html`, and the status code is 200.

## References
- https://wordpress.org/plugins/defa-online-image-protector
- http://www.vapidlabs.com/wp/wp_advisory.php?v=449
- https://nvd.nist.gov/vuln/detail/CVE-2016-1000129
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
