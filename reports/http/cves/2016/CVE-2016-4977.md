---
cve_id: CVE-2016-4977
template_path: nuclei-templates/http/cves/2016/CVE-2016-4977.yaml
affected_product: Spring Security OAuth2
severity: high
authentication: none
external_callback: false
affected_versions: 2.0.0 to 2.0.9 and 1.0.0 to 1.0.5
preconditions: whitelabel views used for approval and error pages
poc_classification: rce
---

## Vulnerability
Spring Security OAuth2 contains a remote command execution vulnerability in versions 2.0.0 to 2.0.9 and 1.0.0 to 1.0.5. The issue arises during processing of authorization requests that use whitelabel views, where the response_type parameter is evaluated as a Spring SpEL expression. A maliciously crafted value enables arbitrary command execution.

Successful exploitation can lead to full system compromise. Remediation involves avoiding whitelabel views for approval and error pages (1.0.x) or upgrading to 2.0.10+ / avoiding whitelabel views (2.0.x). CVSS 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H); CWE-19.

## PoC / Detection
Classification: rce

The template performs a GET request to `{{BaseURL}}/oauth/authorize?response_type=${13337*73331}&client_id=acme&scope=openid&redirect_uri=http://test`. Detection relies on matching HTTP status 400 and the string "Unsupported response types: [978015547]" in the body (result of safe SpEL math evaluation confirming the injection that enables RCE).

## References
- https://github.com/vulhub/vulhub/blob/master/spring/CVE-2016-4977/README.md
- https://tanzu.vmware.com/security/cve-2016-4977
- https://nvd.nist.gov/vuln/detail/CVE-2016-4977
- https://pivotal.io/security/cve-2016-4977
- http://www.openwall.com/lists/oss-security/2019/10/16/1
