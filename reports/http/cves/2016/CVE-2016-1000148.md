---
cve_id: CVE-2016-1000148
template_path: nuclei-templates/http/cves/2016/CVE-2016-1000148.yaml
affected_product: WordPress S3 Video
severity: medium
authentication: none
external_callback: false
affected_versions: <=0.983
preconditions: S3 Video plugin installed on a WordPress site
poc_classification: info-leak
---

## Vulnerability
WordPress S3 Video plugin <=0.983 contains a reflected cross-site scripting vulnerability in `/wp-content/plugins/s3-video/views/video-management/preview_video.php` via the unsanitized `media` parameter. An unauthenticated remote attacker can craft a malicious URL that executes arbitrary JavaScript in the victim's browser in the context of the affected site. This enables theft of cookie-based authentication credentials and other client-side attacks.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1)  
CWE-79

## PoC / Detection
Classification: info-leak

The template first sends a GET request to `/wp-content/plugins/s3-video/readme.txt` (internal matcher) to confirm the presence of the S3 Video plugin by matching the string 'S3 Video Plugin ='. It then sends a GET request to `/wp-content/plugins/s3-video/views/video-management/preview_video.php` with the reflected XSS payload in the `media` parameter (`%22%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3C%22`) and verifies the vulnerability if the exact payload string appears unescaped in the response body, the Content-Type header contains `text/html`, and the status code is 200.

## References
- https://wpscan.com/vulnerability/ead796ed-202a-451f-b041-d39c9cf1fb54
- https://wordpress.org/plugins/s3-video
- http://www.vapidlabs.com/wp/wp_advisory.php?v=240
- https://nvd.nist.gov/vuln/detail/CVE-2016-1000148
- https://github.com/ARPSyndicate/cvemon
