---
cve_id: CVE-2016-3088
template_path: nuclei-templates/http/cves/2016/CVE-2016-3088.yaml
affected_product: Apache ActiveMQ Fileserver
severity: critical
authentication: none
external_callback: false
affected_versions: 5.x before 5.14.0
preconditions: Fileserver web application enabled and accessible
poc_classification: rce
---

## Vulnerability
Apache ActiveMQ 5.x before 5.14.0 allows remote unauthenticated attackers to upload and execute arbitrary files via an HTTP PUT followed by an HTTP MOVE request to the Fileserver web application (CVE-2016-3088, CWE-20).  

**CVSS:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Impact:** Attacker can write arbitrary files to the server filesystem, potentially leading to remote code execution.  
**Remediation:** Upgrade to Apache ActiveMQ 5.14.0 or later.

## PoC / Detection
Classification: rce

The template detects the vulnerability by issuing a raw two-request sequence:  
- PUT `/fileserver/{{randstr}}.txt` containing a random integer payload (expects HTTP 204).  
- GET the same path (expects HTTP 200 and body containing the exact random payload).  

Matchers use DSL conditions (`status_code_1==204 && status_code_2==200 && contains(body_2, rand1)`) to confirm successful arbitrary file write. The probe is intrusive (actually writes a temporary file) but non-destructive; the underlying flaw is the PUT/MOVE file-write primitive described in the CVE.

## References
- https://www.exploit-db.com/exploits/40857
- https://medium.com/@knownsec404team/analysis-of-apache-activemq-remote-code-execution-vulnerability-cve-2016-3088-575f80924f30
- http://activemq.apache.org/security-advisories.data/CVE-2016-3088-announcement.txt
- https://nvd.nist.gov/vuln/detail/CVE-2016-3088
- http://rhn.redhat.com/errata/RHSA-2016-2036.html
