---
cve_id: CVE-2016-15042
template_path: nuclei-templates/http/cves/2016/CVE-2016-15042.yaml
affected_product: WordPress Frontend File Manager and N-Media Post Frontend
severity: critical
authentication: none
external_callback: false
affected_versions: Frontend File Manager < 4.0 and N-Media Post Frontend < 1.1
preconditions: []
poc_classification: rce
---

## Vulnerability
Frontend File Manager plugin (<4.0) and N-Media Post Front-end Form plugin (<1.1) for WordPress allow arbitrary file uploads due to missing file-type validation in AJAX handlers (`nm_filemanager_upload_file` / `nm_postfront_upload_file`). Unauthenticated attackers can upload PHP webshells to `/wp-content/uploads/user_uploads/` or `/wp-content/uploads/post_files/`, achieving remote code execution. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H), CWE-434. Full server compromise, data theft and lateral movement possible.

## PoC / Detection
Classification: rce

Template performs two unauthenticated multipart POSTs (via `flow: http(1) || http(2)`) to `/wp-admin/admin-ajax.php`. For N-Media: `action=nm_postfront_upload_file` with random `.php` payload containing `<?php echo 'randstr'; ?>`. For Frontend File Manager: `action=nm_filemanager_upload_file` using same payload. Follow-up GET to the respective upload path verifies HTTP 200, upload response contains filename metadata, and retrieved body contains echoed random string (confirming upload succeeded and PHP executed).

## References
- https://www.pluginvulnerabilities.com/2016/09/19/arbitrary-file-upload-vulnerability-in-front-end-file-upload-and-manager-plugin/
- https://www.pluginvulnerabilities.com/2016/09/19/arbitrary-file-upload-vulnerability-in-n-media-post-front-end-form/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-15042
- https://wordpress.org/plugins/nmedia-user-file-uploader/#developers
- https://wpscan.com/vulnerability/052f7d9a-aaff-4fb1-92b7-aeb83cc705a7
