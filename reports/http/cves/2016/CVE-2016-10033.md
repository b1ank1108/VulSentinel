---
cve_id: CVE-2016-10033
template_path: nuclei-templates/http/cves/2016/CVE-2016-10033.yaml
affected_product: WordPress PHPMailer
severity: critical
authentication: none
external_callback: false
affected_versions: < 5.2.18
preconditions: [isMail transport]
poc_classification: rce
---

## Vulnerability
WordPress PHPMailer versions before 5.2.18 allow remote attackers to pass extra parameters to the mail command and execute arbitrary code via a crafted Sender property (backslash double quote) when using the isMail transport.

Impact: Successful exploitation leads to unauthorized remote code execution on the affected WordPress website.  
Remediation: Upgrade PHPMailer to version 5.2.18 or higher.  
CVSS v3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE: CWE-88

## PoC / Detection
Classification: rce

The template detects the vulnerability by executing the full exploit chain:  
- GET request to `/?author=1` extracts a valid username via regex matching the author span in the HTML body (internal extractor).  
- POST request to `/wp-login.php?action=lostpassword` submits the extracted username together with a malicious `Host` header containing an Exim-style command-injection payload (`target(any -froot@localhost -be ${run{...touch...success}} null)`) that triggers during PHPMailer isMail processing.  
Matchers verify success via `and` condition on 302 status and `Location` header containing `wp-login.php?checkemail=confirm`, confirming the vulnerable mailer path processed the request.

## References
- https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html
- https://nvd.nist.gov/vuln/detail/CVE-2016-10033
- https://www.exploit-db.com/exploits/40970/
- https://www.exploit-db.com/exploits/40968/
- http://seclists.org/fulldisclosure/2016/Dec/78
