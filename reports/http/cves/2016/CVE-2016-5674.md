---
cve_id: CVE-2016-5674
template_path: nuclei-templates/http/cves/2016/CVE-2016-5674.yaml
affected_product: NUUO NVR camera debugging_center_utils_.php
severity: critical
authentication: none
external_callback: false
affected_versions: NUUO NVRmini 2 1.7.5 through 3.0.0, NUUO NVRsolo 1.7.5 through 3.0.0, NETGEAR ReadyNAS Surveillance 1.1.1 through 1.4.1
preconditions: []
poc_classification: rce
---

## Vulnerability
`__debugging_center_utils___.php` in NUUO NVRmini 2 1.7.5 through 3.0.0, NUUO NVRsolo 1.7.5 through 3.0.0, and NETGEAR ReadyNAS Surveillance 1.1.1 through 1.4.1 allows remote attackers to execute arbitrary PHP code via the log parameter. Attackers can execute arbitrary PHP code remotely without authentication through command injection, leading to complete server compromise and data breach. Update NUUO NVR devices to the latest firmware version that patches the command injection vulnerability. CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-20.

## PoC / Detection
Classification: rce

The template performs active detection by issuing two GET requests to `{{BaseURL}}/__debugging_center_utils___.php?log=;echo {{rand}} | id` (Linux) and `?log=;echo {{rand}} | ipconfig` (Windows), using `stop-at-first-match`. It verifies exploitation success via `matchers-condition: or`: HTTP 200 + "Debugging Center" string in body + either `regex('uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)', body)` or "Windows IP" string.

## References
- http://www.kb.cert.org/vuls/id/856152
- https://www.exploit-db.com/exploits/40200/
