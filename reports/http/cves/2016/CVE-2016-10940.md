---
cve_id: CVE-2016-10940
template_path: nuclei-templates/http/cves/2016/CVE-2016-10940.yaml
affected_product: WordPress zm-gallery plugin
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: zm-gallery plugin must be installed and activated on WordPress
poc_classification: info-leak
---

## Vulnerability
WordPress zm-gallery plugin 1.0 for WordPress is susceptible to SQL injection via the orderby parameter. An authenticated high-privilege attacker can execute arbitrary SQL queries, potentially leading to unauthorized access, data leakage, or data manipulation (CWE-89, CVSS 7.2: AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: info-leak

The template first POSTs to `/wp-login.php` with `{{username}}`/`{{password}}` to obtain a valid admin session (expecting 302 redirect). It then issues two GET requests to `/wp-admin/admin.php?page=zm_gallery` injecting a boolean-based SQLi payload into the `orderby` parameter: true condition `(SELECT (CASE WHEN (7422=7422) THEN 0x6e616d65 ELSE ...))` and false condition `(SELECT (CASE WHEN (7422=7421) THEN 0x6e616d65 ELSE ...))`. The DSL matchers verify login success plus differential response bodies: the true payload returns the normal admin table (`[zm_gallery id=` and `<th scope="row" class="check-column">`), while the false payload does not.

## References
- https://wpscan.com/vulnerability/c0cbd314-0f4f-47db-911d-9b2e974bd0f6
- https://lenonleite.com.br/en/2016/12/16/zm-gallery-1-plugin-wordpress-blind-injection/
- https://nvd.nist.gov/vuln/detail/CVE-2016-10940
- http://lenonleite.com.br/en/2016/12/16/zm-gallery-1-plugin-wordpress-blind-injection/
- https://wordpress.org/plugins/zm-gallery/#developers
