---
cve_id: CVE-2016-7981
template_path: nuclei-templates/http/cves/2016/CVE-2016-7981.yaml
affected_product: SPIP
severity: medium
authentication: none
external_callback: false
affected_versions: <3.1.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
SPIP versions prior to 3.1.2 contain a reflected cross-site scripting vulnerability in `valider_xml.php`. Remote unauthenticated attackers can inject arbitrary web script or HTML via the `var_url` parameter supplied to the `valider_xml` action. CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Successful exploitation allows arbitrary JavaScript execution in the context of the victim's browser.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/ecrire/?exec=valider_xml&var_url=%22%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E` embedding a classic reflected-XSS probe. It matches on the exact unsanitized payload string appearing in the response body, `text/html` Content-Type header, and HTTP 200 status.

## References
- https://core.spip.net/projects/spip/repository/revisions/23202
- https://core.spip.net/projects/spip/repository/revisions/23201
- https://core.spip.net/projects/spip/repository/revisions/23200
- https://nvd.nist.gov/vuln/detail/CVE-2016-7981
- http://www.openwall.com/lists/oss-security/2016/10/05/17
