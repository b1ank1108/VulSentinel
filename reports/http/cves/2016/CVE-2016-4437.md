---
cve_id: CVE-2016-4437
template_path: nuclei-templates/http/cves/2016/CVE-2016-4437.yaml
affected_product: Apache Shiro
severity: high
authentication: none
external_callback: true
affected_versions: before 1.2.5
preconditions: cipher key has not been configured for the "remember me" feature
poc_classification: rce
---

## Vulnerability
Apache Shiro before 1.2.5, when a cipher key has not been configured for the "remember me" feature, allows remote attackers to execute arbitrary code or bypass intended access restrictions via an unspecified request parameter.  
Impact: Remote code execution  
Remediation: Upgrade to a patched version of Apache Shiro  
CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (score 8.1)

## PoC / Detection
Classification: rce  
The template sends an unauthenticated GET / request containing a `rememberMe` cookie. The cookie value is a base64-encoded concatenation of the default Shiro AES/CBC/PKCS5Padding parameters and an AES-encrypted ysoserial "dns" Java gadget that resolves `http://{{interactsh-url}}`. Successful deserialization on the server triggers an out-of-band DNS callback, which the interactsh matcher confirms.

## References
- https://github.com/Medicean/VulApps/tree/master/s/shiro/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4437
- http://packetstormsecurity.com/files/137310/Apache-Shiro-1.2.4-Information-Disclosure.html
- http://packetstormsecurity.com/files/157497/Apache-Shiro-1.2.4-Remote-Code-Execution.html
- http://rhn.redhat.com/errata/RHSA-2016-2035.html
