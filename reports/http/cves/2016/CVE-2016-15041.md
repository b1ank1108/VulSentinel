---
cve_id: CVE-2016-15041
template_path: nuclei-templates/http/cves/2016/CVE-2016-15041.yaml
affected_product: MainWP Dashboard
severity: high
authentication: none
external_callback: false
affected_versions: <= 3.1.2
preconditions: []
poc_classification: state-change
---

## Vulnerability
MainWP Dashboard (WordPress plugin for managing multiple sites) <= 3.1.2 suffers from stored cross-site scripting. Insufficient sanitization and output escaping of the `mwp_setup_purchase_username` parameter in the unauthenticated purchase-extension setup flow allows arbitrary JavaScript injection. The payload is stored server-side and executes in the browser context of any user (typically administrators) who subsequently visits the affected setup wizard page.

## PoC / Detection
Classification: state-change

The template first fetches `/wp-content/plugins/mainwp-vuln/readme.txt`, extracts the Stable tag via regex, and internally verifies `compare_versions(version, '<= 3.1.2')`. It then performs a GET to `/wp-admin/admin-post.php?page=mainwp-setup&step=purchase_extension` to extract the `_wpnonce` value, issues a POST submitting `mwp_setup_purchase_username=<randstr>"+onmouseover=alert(document.domain)+x="` (plus dummy password and nonce), and finally re-GETs the same page. A matcher confirms the unsanitized payload string appears verbatim in the final response body, proving unauthorized storage of attacker-controlled data.

## References
- https://klikki.fi/mainwp-admin-panel-unauthenticated-stored-xss/
