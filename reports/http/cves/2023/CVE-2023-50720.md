---
cve_id: CVE-2023-50720
template_path: nuclei-templates/http/cves/2023/CVE-2023-50720.yaml
affected_product: XWiki
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 14.10.15, 15.5.2 and 15.7RC1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
XWiki Solr-based search discloses user email addresses even when email obfuscation is enabled. Attackers can trigger the issue via the standard search interface by querying `objcontent:email*`, which returns indexed email data from XWiki.XWikiUsers objects.

Impact: Successful exploitation leads to disclosure of emails for all users.  
Remediation: Fixed in XWiki 14.10.15, 15.5.2 and 15.7RC1 by not indexing email address properties when obfuscation is enabled.  
CVSS: 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | CWE-200

## PoC / Detection
Classification: info-leak

The template performs unauthenticated GET requests to `{{BaseURL}}/bin/view/Main/Search?sort=score&sortOrder=desc&highlight=true&facet=true&r=1&f_locale=en&f_locale=&text=objcontent%3Aemail*` or the `/xwiki/bin/view/...` variant (stop-at-first-match). Detection succeeds if the 200 OK response body contains all of "email</span> :", "XWiki.XWikiUsers[0]", and "email_checked</span>".

## References
- https://jira.xwiki.org/browse/XWIKI-20371
- https://nvd.nist.gov/vuln/detail/CVE-2023-50720
