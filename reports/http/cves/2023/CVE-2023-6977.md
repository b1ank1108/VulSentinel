---
cve_id: CVE-2023-6977
template_path: nuclei-templates/http/cves/2023/CVE-2023-6977.yaml
affected_product: Mlflow
severity: high
authentication: none
external_callback: false
affected_versions: <2.8.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Mlflow before 2.8.0 is susceptible to local file inclusion due to path traversal in the model artifact retrieval logic (GitHub repository mlflow/mlflow). An unauthenticated remote attacker can read arbitrary files on the server filesystem by abusing the `/model-versions/get-artifact` endpoint after setting a malicious model version `source` value.

**Impact**: Attacker can obtain sensitive information (e.g., `/etc/passwd`, configuration files, secrets). CVSS 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N) | CWE-29.

**Remediation** (per template): Upgrade to version 2.9.2 or later.

## PoC / Detection
Classification: info-leak

The template verifies the LFI by executing this exact three-step sequence on an exposed MLflow instance:

1. `POST /ajax-api/2.0/mlflow/registered-models/create` — creates a registered model using a random name.
2. `POST /ajax-api/2.0/mlflow/model-versions/create` — creates a model version for that name with `source: "//proc/self/root"` to establish the path-traversal context.
3. `GET /model-versions/get-artifact?name={{randstr}}&path=etc%2Fpasswd&version=1` — triggers the artifact download of `/etc/passwd`.

Matchers (AND condition) succeed only if:
- response body contains regex `root:.*:0:0:`
- third-response headers contain both `filename=passwd` and `application/octet-stream`
- HTTP status 200

## References
- https://huntr.com/bounties/fe53bf71-3687-4711-90df-c26172880aaf
- https://nvd.nist.gov/vuln/detail/CVE-2023-6977
