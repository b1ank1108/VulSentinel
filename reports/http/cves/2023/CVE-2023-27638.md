---
cve_id: CVE-2023-27638
template_path: nuclei-templates/http/cves/2023/CVE-2023-27638.yaml
affected_product: tshirtecommerce PrestaShop Module
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [tshirtecommerce module installed on PrestaShop]
poc_classification: info-leak
---

## Vulnerability
The tshirtecommerce module for PrestaShop is vulnerable to unauthenticated SQL injection via the `tshirtecommerce_design_cart_id` parameter in the `/module/tshirtecommerce/designer` endpoint due to missing input sanitization (patched by adding `pSQL()` escaping). Unauthenticated attackers can execute arbitrary SQL queries, enabling extraction of the complete PrestaShop database including customer records and payment information.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Impact:** Full database compromise (C:H/I:H/A:H).  
**Remediation:** Update the tshirtecommerce module to the latest patched version.

## PoC / Detection
Classification: info-leak

The template first issues an internal fingerprint request to `/` and matches for the presence of both "prestashop" and "tshirtecommerce" (case-insensitive) in the response body with status 200. It then sends a GET request to `/module/tshirtecommerce/designer?tshirtecommerce_design_cart_id=1%20OR%20SLEEP(8)` (30s timeout) and detects the vulnerability if response duration is â‰¥8 seconds while status_code remains 200, confirming time-based blind SQL injection.

## References
- https://security.friendsofpresta.org/module/2023/03/21/tshirtecommerce_cwe-89.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27638
