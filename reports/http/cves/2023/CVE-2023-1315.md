---
cve_id: CVE-2023-1315
template_path: nuclei-templates/http/cves/2023/CVE-2023-1315.yaml
affected_product: osTicket
severity: medium
authentication: required
external_callback: false
affected_versions: < v1.16.6
preconditions: authenticated access to staff control panel (/scp/)
poc_classification: info-leak
---

## Vulnerability
osTicket versions prior to 1.16.6 contain a reflected Cross-Site Scripting (XSS) vulnerability in the staff control panel AJAX endpoint at `/scp/ajax.php/tickets/search`.

Description: Cross-site Scripting (XSS) - Reflected in GitHub repository osticket/osticket prior to v1.16.6.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4, Medium). CWE-79.

Impact: Successful exploitation allows execution of arbitrary JavaScript in the victim's browser context (victim must be authenticated staff and click malicious link), enabling data theft or unauthorized actions.

Remediation: Upgrade osTicket to a version later than 1.16.6.

## PoC / Detection
Classification: info-leak

The template first sends GET /scp/login.php to verify osTicket presence (body contains "osticket") and extracts the `__CSRFToken__` value via regex. It then authenticates with POST /scp/login.php using the token plus provided `{{username}}`/`{{password}}` credentials. Finally it issues GET /scp/ajax.php/tickets/search with two reflected XSS payloads injected into query parameters (`parent_id=1"><svg/x=">"/onload=confirm()//` and `pid=adhoc%2cpdXBTnfSg0riebm%22%3e%3cscript%3ealert(document.domain)%3c%2fscript%3etgghb`), matching for unsanitized payload presence in the 200 OK response body that also has `text/html` content-type. This confirms the reflection flaw without actual exploitation or version comparison.

## References
- https://huntr.com/bounties/70a7fd8c-7e6f-4a43-9f8c-163b8967b16e
- https://nvd.nist.gov/vuln/detail/CVE-2023-1315
