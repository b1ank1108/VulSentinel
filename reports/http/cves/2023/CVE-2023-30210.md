---
cve_id: CVE-2023-30210
template_path: nuclei-templates/http/cves/2023/CVE-2023-30210.yaml
affected_product: OURPHP
severity: medium
authentication: none
external_callback: false
affected_versions: <= 7.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OURPHP <= 7.2.0 is vulnerable to reflected Cross-Site Scripting (XSS) via `/client/manage/ourphp_tz.php` (parameter `callback` with `act=rt`).  
Unauthenticated remote attackers can supply a malicious link containing arbitrary JavaScript that is reflected unsanitized into the HTML response and executed in the victim's browser context.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.  
Impact includes data theft (e.g. session cookies), session hijacking, or page defacement.  
Remediation: upgrade to 7.2.1 or higher.

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/client/manage/ourphp_tz.php?act=rt&callback=<script>alert(document.domain)</script>`.  
It verifies successful reflection by matching all of the following in the response:  
- exact payload string `<script>alert(document.domain)</script>` appears in body  
- application strings `barmemCachedPercent` and `swapPercent` are also present in body  
- `Content-Type` header contains `text/html`  
- HTTP status code is 200  

## References
- https://www.ourphp.net/
- https://wanheiqiyihu.top/2023/03/27/OURPHP-v7-2-0-ourphp-tz-php-Reflection-xss/
- https://nvd.nist.gov/vuln/detail/CVE-2023-30210
