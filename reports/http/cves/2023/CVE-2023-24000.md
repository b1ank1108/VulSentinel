---
cve_id: CVE-2023-24000
template_path: nuclei-templates/http/cves/2023/CVE-2023-24000.yaml
affected_product: WordPress GamiPress plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.5.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability

The GamiPress plugin for WordPress contains a SQL Injection vulnerability in versions up to and including 2.5.7. The vulnerability exists due to insufficient escaping on the user-supplied parameter `$qv[$field_id]` and lack of sufficient preparation on existing SQL queries. This allows unauthenticated attackers to append additional SQL queries into already existing queries, enabling extraction of sensitive information from the database. The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8, indicating critical severity. The attack vector is network-based, requires low complexity, no privileges, and no user interaction.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a time-based blind SQL injection payload to the WordPress REST API endpoint `/wp-json/wp/v2/gamipress-logs`. The payload injects a `SLEEP(6)` command into the `trigger_type[]` parameter using the injection string: `test') AND (SELECT 1 FROM (SELECT(SLEEP(6)))x) AND ('a'='a`. 

The template verifies successful exploitation by checking multiple conditions:
- Response time is 6 seconds or greater (indicating the SLEEP command executed)
- Response body length equals 2 characters
- HTTP status code is 200
- Response body contains an empty JSON array `[]`
- Content-Type header contains `application/json`

The time-based detection method confirms the SQL injection is exploitable without requiring authentication.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-24000
