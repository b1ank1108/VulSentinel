---
cve_id: CVE-2023-22952
template_path: nuclei-templates/http/cves/2023/CVE-2023-22952.yaml
affected_product: SugarCRM
severity: high
authentication: required
external_callback: false
affected_versions: before 12.0 Hotfix 91155
preconditions: []
poc_classification: rce
---

## Vulnerability
SugarCRM before 12.0 Hotfix 91155 is vulnerable to remote code execution via missing input validation in the EmailTemplates module. A crafted request allows injection of custom PHP code.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).  
CWE-20, CWE-94.  
Authenticated attackers can execute arbitrary commands on the server, compromising customer relationship data and business intelligence.  
Remediation requires updating to 12.0 Hotfix 91155 or later.

## PoC / Detection
Classification: rce

The template uses a chained three-request flow to verify the flaw:  
1. POST `/index.php` with hardcoded credentials (`user_name=brenda&user_password=DbLiL98a`) and matcher confirming login behavior.  
2. Multipart POST `/index.php` (module=EmailTemplates, action=AttachFiles) uploading a random `.txt` file (PNG binary content) and internally matching the returned cache path.  
3. GET `/cache/images/{{randstr}}.txt` checking for the test string "CVE-2023-22952" in body and `text/plain` Content-Type header.  
This confirms the upload path and storage in the web-accessible cache, validating the injection vector described in the CVE.

## References
- https://attackerkb.com/topics/E486ui94II/cve-2023-22952
