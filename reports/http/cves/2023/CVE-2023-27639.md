---
cve_id: CVE-2023-27639
template_path: nuclei-templates/http/cves/2023/CVE-2023-27639.yaml
affected_product: PrestaShop TshirteCommerce
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: Custom Product Designer (tshirtecommerce) module installed on PrestaShop
poc_classification: info-leak
---

## Vulnerability

PrestaShop TshirteCommerce's Custom Product Designer (tshirtecommerce) module contains a directory traversal vulnerability (CWE-22) in the ajax.php handler. Unauthenticated remote attackers can forge HTTP POST and GET parameters to traverse the filesystem and read arbitrary files, including source code and configuration files that may expose database credentials and other sensitive PrestaShop data.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).

## PoC / Detection
Classification: info-leak

The template issues a single POST request to `/tshirtecommerce/ajax.php?type=svg` using a crafted body with directory traversal (`url=.%2F..%2Fvendor%2Fjdorn%2Fsql-formatter%2Fexamples&file_name=examples.php`). It verifies exploitation success by confirming HTTP 200 status and the presence of strings from the targeted PHP file ("SqlFormatter Examples", "SqlFormatter", "<?php").

## References
- https://www.cvedetails.com/cve/CVE-2023-27639/
- https://security.friendsofpresta.org/module/2023/03/30/tshirtecommerce_cwe-22.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27639
