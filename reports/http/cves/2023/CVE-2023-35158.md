---
cve_id: CVE-2023-35158
template_path: nuclei-templates/http/cves/2023/CVE-2023-35158.yaml
affected_product: XWiki
severity: medium
authentication: none
external_callback: false
affected_versions: >=9.4-rc-1, <14.10.5 and >=15.0, <15.1-rc-1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-35158 is a Reflected Cross-Site Scripting (XSS) vulnerability in XWiki Platform. The vulnerability exists in the restore template functionality, where user-supplied input in the `xredirect` parameter is not properly sanitized before being reflected in the HTML response. Attackers can forge malicious URLs containing JavaScript payloads that execute in the context of a victim's browser when the URL is accessed. The vulnerability has existed since XWiki version 9.4-rc-1 and affects all subsequent versions until patched in 14.10.5 and 15.1-rc-1. The CVSS score is 6.1 (Medium), with the attack vector being network-based, requiring no privileges but user interaction (victim must click the malicious link). The vulnerability is classified under CWE-87 (Improper Neutralization of Alternate XSS Syntax).

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the XWiki restore page with a crafted `xredirect` parameter containing a JavaScript payload: `javascript:alert(document.domain)`. The detection verifies that:

1. The malicious JavaScript payload is reflected in the response body within an anchor tag's href attribute: `href="javascript:alert(document.domain)">Cancel</a>`
2. The response has a Content-Type header indicating HTML content
3. The server returns a 200 OK status code

The template uses a harmless `alert(document.domain)` payload to confirm the XSS vulnerability without executing malicious actions. The presence of the unescaped JavaScript in the HTML response confirms that user input is improperly sanitized, making the application vulnerable to XSS attacks.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-35158
