---
cve_id: CVE-2023-49103
template_path: nuclei-templates/http/cves/2023/CVE-2023-49103.yaml
affected_product: ownCloud graphapi
severity: high
authentication: none
external_callback: false
affected_versions: 0.2.x before 0.2.1 and 0.3.x before 0.3.1
preconditions: graphapi app installed
poc_classification: info-leak
---

## Vulnerability

An issue was discovered in ownCloud owncloud/graphapi 0.2.x before 0.2.1 and 0.3.x before 0.3.1. The graphapi app relies on a third-party GetPhpInfo.php library that provides a publicly accessible URL. When this URL is accessed it reveals the full phpinfo() output containing PHP configuration details and all webserver environment variables. In containerized deployments these environment variables frequently include sensitive data such as the ownCloud admin password, mail server credentials and license key. Simply disabling the graphapi app does not eliminate the vulnerability. phpinfo also exposes various other potentially sensitive configuration details.

Unauthenticated attackers can access the endpoint. Impact: high (CVSS 3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, CWE-200).

## PoC / Detection
Classification: info-leak

The template issues GET requests to `{{BaseURL}}/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/{{rand_base(4)}}.css` and the `/owncloud/apps/...` variant (stop-at-first-match). It verifies exploitation conditions via status 200 and body containing all three words "PHP Extension", "PHP Version" and "owncloud".

## References
- https://github.com/creacitysec/CVE-2023-49103/blob/main/exploit.py
- https://nvd.nist.gov/vuln/detail/CVE-2023-49103
- https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/
- https://www.labs.greynoise.io//grimoire/2023-11-29-owncloud-redux/
- https://attackerkb.com/topics/G9urDj4Cg2/cve-2023-49103
- https://www.rapid7.com/blog/post/2023/12/01/etr-cve-2023-49103-critical-information-disclosure-in-owncloud-graph-api/
