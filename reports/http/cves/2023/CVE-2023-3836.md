---
cve_id: CVE-2023-3836
template_path: nuclei-templates/http/cves/2023/CVE-2023-3836.yaml
affected_product: Dahua Smart Park Management
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Dahua Smart Park Management (Dahua wisdom park integrated management platform, CPE `cpe:2.3:a:dahuasecurity:smart_parking_management:*:*:*:*:*:*:*:*`) contains an unauthenticated arbitrary file upload flaw (CWE-434) at `/emap/devicePoint_addImgIco?hasSubsystem=true`. Attackers can POST multipart/form-data containing a `.jsp` file that is saved under `/upload/emap/society_new/` and immediately retrievable/executable by the application server, resulting in remote code execution and full system compromise.  
CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact: unauthenticated RCE.

## PoC / Detection
Classification: rce  
The template executes a two-request in-band check:  
1. POSTs a multipart upload of a random 6-char `.jsp` filename containing an MD5 marker string.  
2. GETs the uploaded file at `/upload/emap/society_new/{{extracted_filename}}` (filename extracted via regex `ico_res_(\w+)_on\.jsp` from response body).  
Matchers confirm both 200 OK and marker string presence in body, proving the upload succeeded and the file is stored/executable (validating RCE potential).

## References
- https://github.com/qiuhuihk/cve/blob/main/upload.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-3836
- https://vuldb.com/?ctiid.235162
- https://vuldb.com/?id.235162
- https://github.com/1f3lse/taiE
