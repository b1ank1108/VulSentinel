---
cve_id: CVE-2023-26843
template_path: nuclei-templates/http/cves/2023/CVE-2023-26843.yaml
affected_product: ChurchCRM
severity: medium
authentication: required
external_callback: false
affected_versions: 4.5.3
preconditions: []
poc_classification: state-change
---

## Vulnerability
ChurchCRM 4.5.3 suffers from a stored Cross-Site Scripting (XSS) vulnerability (CWE-79) in NoteEditor.php. Authenticated remote attackers can inject arbitrary web scripts or HTML via the NoteText parameter. CVSS 3.1 score 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N). Successful exploitation enables script execution in the context of other users, facilitating data theft, session hijacking, or defacement.

## PoC / Detection
Classification: state-change

The template first authenticates by sending username/password to /session/begin, then issues a POST to /NoteEditor.php?FamilyID=1 injecting the payload `"><img src=x onerror=alert(document.domain)>` in the NoteText field. Detection confirms the vulnerability if the second response (status 200, HTML content) contains the unescaped payload and "ChurchCRM" string, indicating lack of sanitization on stored notes.

## References
- https://github.com/10splayaSec/CVE-Disclosures/tree/main/ChurchCRM/CVE-2023-26843
- https://nvd.nist.gov/vuln/detail/CVE-2023-26843
- https://github.com/ChurchCRM/CRM
- https://github.com/10splayaSec/CVE-Disclosures
- https://github.com/ARPSyndicate/cvemon
