---
cve_id: CVE-2023-1719
template_path: nuclei-templates/http/cves/2023/CVE-2023-1719.yaml
affected_product: Bitrix24
severity: critical
authentication: none
external_callback: false
affected_versions: 22.0.300
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Bitrix24 22.0.300 suffers from a critical vulnerability (CVE-2023-1719, CWE-665) caused by global variable extraction in `bitrix/modules/main/tools.php`. Unauthenticated remote attackers can enumerate attachments present on the server and inject arbitrary JavaScript that executes in the victim's browser. If the victim is an administrator, this can further enable arbitrary PHP code execution on the server. CVSS 3.1 vector: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Impact includes full platform compromise and access to sensitive business data. Remediation requires updating to any version newer than 22.0.300 that properly initializes variables and sanitizes input.

## PoC / Detection
Classification: info-leak

The template issues one unauthenticated GET request to `{{BaseURL}}/bitrix/components/bitrix/socialnetwork.events_dyn/get_message_2.php?log_cnt=<img%20onerror=alert(document.domain)%20src=1>`. Detection succeeds when the 200 OK response contains `text/html` Content-Type and the response body simultaneously includes the literal strings `'LOG_CNT':` and `<img onerror=alert(document.domain) src=1>` (confirming unsanitized reflection of the parameter that enables attachment enumeration and JavaScript execution).

## References
- https://starlabs.sg/advisories/23/23-1719/
- https://nvd.nist.gov/vuln/detail/CVE-2023-1719
- https://github.com/20142995/sectool
