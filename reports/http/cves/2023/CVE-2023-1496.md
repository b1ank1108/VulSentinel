---
cve_id: CVE-2023-1496
template_path: nuclei-templates/http/cves/2023/CVE-2023-1496.yaml
affected_product: imgproxy
severity: medium
authentication: none
external_callback: false
affected_versions: < 3.14.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
imgproxy < 3.14.0 suffers from a reflected Cross-site Scripting (XSS) vulnerability when processing SVG images through the `/unsafe/plain/` endpoint. Malicious SVG payloads containing JavaScript can be injected and reflected unsanitized in the response.

CVSS: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N) | CWE-79

Impact includes potential execution of arbitrary JavaScript in the victim's browser context, enabling data theft or unauthorized client-side actions. Remediation requires upgrading to 3.14.0+.

## PoC / Detection
Classification: info-leak

The template issues a GET request to `{{BaseURL}}/unsafe/plain/https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/refs/heads/main/helpers/payloads/retool-xss.svg`. Detection succeeds if the body contains the embedded `alert(document.domain);` payload along with XML and script tags (indicating unsanitized reflection), the response status is 200, and no restrictive `Content-Security-Policy: default-src 'none';` header is present. This confirms the reflected XSS condition.

## References
- https://github.com/imgproxy/imgproxy/commit/62f8d08a93d301285dcd1dabcc7ba10c6c65b689
- https://huntr.dev/bounties/de603972-935a-401a-96fb-17ddadd282b2
