---
cve_id: CVE-2023-3139
template_path: nuclei-templates/http/cves/2023/CVE-2023-3139.yaml
affected_product: Protect WP Admin
severity: medium
authentication: none
external_callback: false
affected_versions: <= 4.0
preconditions: [Protect WP Admin plugin installed on a WordPress site]
poc_classification: info-leak
---

## Vulnerability
Protect WP Admin WordPress plugin <= 4.0 suffers from unauthenticated protection bypass (CVE-2023-3139, CWE-601). A crafted URL triggers redirection that discloses the hidden admin panel URL, allowing bypass of the plugin's protection. CVSS 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Impact limited to low-confidentiality/low-integrity disclosure and bypass. Fixed in 4.0 or later.

## PoC / Detection
Classification: info-leak

The template first issues GET `{{BaseURL}}/wp-content/plugins/protect-wp-admin/readme.txt`, matches status 200 + "Protect WP Admin" string, extracts version via regex on "Stable tag: ([0-9.]+)" and enforces `compare_versions(version, '<= 4.0')` (internal). It then sends GET `{{BaseURL}}/wp-login.php?action=lostpassword&error=invalidkey`, matches 301 status with Location containing the original query parameters, extracts the full redirect URL from the Location header and outputs it as the disclosed protected admin panel URL.

## References
- https://wpscan.com/vulnerability/f8a29aee-19cd-4e62-b829-afc9107f69bd/
- https://magos-securitas.com/txt/CVE-2023-3139.txt
