---
cve_id: CVE-2023-3345
template_path: nuclei-templates/http/cves/2023/CVE-2023-3345.yaml
affected_product: LMS by Masteriyo
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.6.8
preconditions: [User must have student role or equivalent access to the plugin's REST API endpoints]
poc_classification: info-leak
---

## Vulnerability

CVE-2023-3345 is an information exposure vulnerability in the LMS by Masteriyo WordPress plugin affecting versions prior to 1.6.8. The plugin fails to properly safeguard sensitive user information through its REST API endpoints, specifically the `/wp-json/masteriyo/v1/users/` endpoint. This weakness allows authenticated users (such as students) to access and leak other users' email addresses and account information that should be restricted. The vulnerability is classified as CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) with a CVSS score of 6.5 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N), indicating network-exploitable access requiring low privileges with high confidentiality impact.

## PoC / Detection

Classification: info-leak

The template performs authenticated detection by:

1. **Authentication**: Sends a POST request to `/wp-login.php` with username and password credentials to establish a WordPress session
2. **Nonce Extraction**: Retrieves the user profile page at `/wp-admin/profile.php` and extracts the WordPress nonce value required for REST API authentication
3. **Exploitation Probe**: Makes a GET request to the vulnerable REST API endpoint `/wp-json/masteriyo/v1/users/` with the extracted X-WP-Nonce header
4. **Verification**: Confirms the vulnerability by checking for the presence of sensitive user data fields (`username`, `email`, `roles`) in the JSON response with HTTP 200 status

The template successfully detects when the plugin exposes user information that should be restricted to authorized administrators only.

## References

- https://wpscan.com/vulnerability/0d07423e-98d2-43a3-824d-562747a3d65a
- https://github.com/RandomRobbieBF/learning-management-system
- https://wordpress.org/plugins/learning-management-system
- https://nvd.nist.gov/vuln/detail/CVE-2023-3345
