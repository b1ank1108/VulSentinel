---
cve_id: CVE-2023-47117
template_path: nuclei-templates/http/cves/2023/CVE-2023-47117.yaml
affected_product: Label Studio
severity: high
authentication: required
external_callback: false
affected_versions: unknown
preconditions: [existence of projects and tasks]
poc_classification: info-leak
---

## Vulnerability
Label Studio is affected by a sensitive information exposure vulnerability (CVE-2023-47117) where an attacker can construct a filter chain to filter tasks based on sensitive fields for all user accounts on the platform by exploiting Django's Object Relational Mapper (ORM). Query results can be manipulated by the ORM filter to leak these sensitive fields character by character.

## PoC / Detection
Classification: info-leak

The template first issues a GET to /user/login/ to extract the CSRF token via regex, followed by a POST to /user/login/ using supplied username/password and the token. It then sends a PATCH to /api/dm/views/{{Task_id}} (with project={{Project_id}}) that creates a custom view containing an ORM filter on the sensitive field `updated_by__active_organization__active_users__password` using regex operator and value `^pbkdf2_sha256\$260000\$`. Finally it performs a GET to /api/tasks with the new view ID. The matcher confirms success if the JSON response body contains task metadata fields ("completed_at", "file_upload", "annotators") and the PATCH/GET return 200 with JSON content-type, verifying the vulnerable filter chain executed and exposed restricted data.

## References
- https://security.snyk.io/vuln/SNYK-PYTHON-LABELSTUDIO-6056277
- https://nvd.nist.gov/vuln/detail/CVE-2023-47117
- https://github.com/elttam/publications
