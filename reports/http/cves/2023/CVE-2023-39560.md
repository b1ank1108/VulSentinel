---
cve_id: CVE-2023-39560
template_path: nuclei-templates/http/cves/2023/CVE-2023-39560.yaml
affected_product: ECTouch v2
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
ECTouch v2 e-commerce platform suffers from a SQL injection flaw in the `$arr['id']` parameter processed at `default/helpers/insert.php` (CWE-89, CVE-2023-39560).  
Unauthenticated remote attackers can leverage this to perform error-based SQL injection and extract database contents, including customer records, orders, and payment data.  
CVSS 3.1: 9.8 Critical (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
CPE: `cpe:2.3:a:ectouch:ectouch:2.0:*:*:*:*:*:*:*`.  
Remediation: update to a version newer than 2.0 that uses parameterized queries or prepared statements.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `/index.php?m=default&c=user&a=register&u=0`, embedding a malicious payload inside the Referer header (`554fcae493e564ee0dc75bdf2ebf94cabought_notes|a:1:{s:2:"id";s:49:"0&&updatexml(1,concat(0x7e,(database()),0x7e),1)#";}`).  
It verifies exploitation by matching the resulting XPATH syntax error string `XPATH syntax error: '~[^~]+~'<br>` in the 200 OK response body and extracts the leaked database name via regex.

## References
- https://wiki.bachang.org/doc/2582/
- https://nvd.nist.gov/vuln/detail/CVE-2023-39560
