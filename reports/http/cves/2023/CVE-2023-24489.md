---
cve_id: CVE-2023-24489
template_path: nuclei-templates/http/cves/2023/CVE-2023-24489.yaml
affected_product: Citrix ShareFile StorageZones Controller
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [customer-managed deployment]
poc_classification: rce
---

## Vulnerability

Citrix ShareFile StorageZones Controller (customer-managed instances) is affected by an unauthenticated remote code execution vulnerability via path traversal and arbitrary ASPX file upload on the `documentum/upload.aspx` endpoint. 

An unauthenticated attacker can remotely compromise the system. 

**Impact**: Successful exploitation allows arbitrary code execution on the affected system. 

**CVSS v3.1**: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) 

**CWE**: CWE-284, NVD-CWE-Other 

**Tags**: KEV (known exploited vulnerability), intrusive file-upload, RCE.

## PoC / Detection

Classification: rce

The template first issues a GET to `/` and internally matches on response body containing "ShareFile Storage Server", "ShareFile", or "documentum" to fingerprint the product. It then sends up to 256 raw POST requests (stopping at first match) to `/documentum/upload.aspx?parentid={{url_encode(padding)}}&raw=1&unzip=on&uploadid={{rand_base(8)}}\..\..\..\cifs&filename={{rand_base(8)}}.aspx`, where `padding` is fuzzed from `citrix_paddings.txt`. The POST body is a malicious ASPX payload (`<%@ Page ... %>` with C# `Page_Load` that does `Response.Write("{{randstr}}")`). 

Detection succeeds on status_code == 200 AND exact body "ERROR: The method or operation is not implemented.". 

An extractor returns the URL of the uploaded webshell: `{{BaseURL}}/cifs/{{fileName}}.aspx`.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-24489
- https://blog.assetnote.io/2023/07/04/citrix-sharefile-rce/
- https://support.citrix.com/article/CTX559517/sharefile-storagezones-controller-security-update-for-cve202324489
- https://github.com/20142995/sectool
- https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors
