---
cve_id: CVE-2023-20889
template_path: nuclei-templates/http/cves/2023/CVE-2023-20889.yaml
affected_product: VMware Aria Operations for Networks
severity: high
authentication: required
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Aria Operations for Networks contains an information disclosure vulnerability. A malicious actor with network access to VMware Aria Operations for Networks may be able to perform a command injection attack resulting in information disclosure.

Successful exploitation of this vulnerability can result in unauthorized access to sensitive information.

Remediation: Apply the latest security patches provided by VMware to mitigate this vulnerability.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). CWE-77.

## PoC / Detection
Classification: rce

The template first performs a POST to /api/auth/login with username/password/domain=localdomain to extract the CSRF token via regex. It then issues a POST to /api/pdfexport as multipart/form-data with a crafted HTML body containing an <xss> element that uses @keyframes animation and onwebkitanimationstart="eval(atob('{{base64(payload)}}'))" where the payload sets location to http://{{interactsh-url}}. Detection matches on out-of-band interactsh DNS/HTTP callback, application/octet-stream header in the second response, and HTTP 200 status.

## References
- https://www.zerodayinitiative.com/advisories/ZDI-23-842/
- https://www.vmware.com/security/advisories/VMSA-2023-0012.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-20889
