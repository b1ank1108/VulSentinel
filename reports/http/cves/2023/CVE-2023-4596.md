---
cve_id: CVE-2023-4596
template_path: nuclei-templates/http/cves/2023/CVE-2023-4596.yaml
affected_product: WordPress Forminator plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.24.6
preconditions: accessible Forminator custom forms supporting file uploads
poc_classification: rce
---

## Vulnerability
The Forminator WordPress plugin versions up to and including 1.24.6 contains an arbitrary file upload vulnerability in the `upload_post_image()` function. File type validation is performed after the file upload to the server, allowing unauthenticated attackers to upload arbitrary files (such as PHP webshells) on the affected site's server, potentially enabling remote code execution and complete server compromise. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-434.

## PoC / Detection
Classification: rce

The template detects the vulnerability through a two-request sequence:  
- A GET request to `/` extracts the `forminator_nonce` and `form_id` via regex from HTML containing upload form elements (matching 'Upload file</label>' and 'forminator-field-upload').  
- A subsequent POST to `/wp-admin/admin-ajax.php` with multipart/form-data simulating a custom form submission, including a `.php` file payload that outputs `md5("CVE-2023-4596")` and self-deletes via `unlink(__FILE__)` as `postdata-1-post-image`.  

Matchers verify successful upload via JSON response indicators (`{"success":true`, form_id match) and HTTP 200 status on both requests.

## References
- https://www.exploit-db.com/exploits/51664
- https://www.wordfence.com/threat-intel/vulnerabilities/id/9cd87da6-1f4c-4a15-8ebb-6e0f8ef72513?source=cve
- https://plugins.trac.wordpress.org/changeset/2954409/forminator/trunk/library/fields/postdata.php
- https://github.com/E1A/CVE-2023-4596
- https://nvd.nist.gov/vuln/detail/CVE-2023-4596
