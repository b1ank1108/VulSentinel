---
cve_id: CVE-2023-34362
template_path: nuclei-templates/http/cves/2023/CVE-2023-34362.yaml
affected_product: MOVEit Transfer
severity: critical
authentication: none
external_callback: false
affected_versions: All versions before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)
preconditions: []
poc_classification: rce
---

## Vulnerability
Progress MOVEit Transfer web application (including MOVEit Cloud per metadata) contains an unauthenticated SQL injection vulnerability (CWE-89, CVSS 9.8) in guest-access paths. Attackers can reach the backend database (MySQL, Microsoft SQL Server, or Azure SQL), infer structure/contents, and execute arbitrary SQL to alter or delete elements. All prior versions (including 2020.0, 2019x, and unsupported releases) are affected. Actively exploited in the wild via HTTP/HTTPS in May-June 2023. Leads to unauthorized database access, data theft, and potential full server compromise.

**Impact:** Unauthorized access, data theft, server compromise.  
**Remediation:** Apply latest vendor patches.

## PoC / Detection
Classification: rce  
The template runs a 7-request chain to confirm successful exploitation:  
- GET / and POST /moveitisapi/moveitisapi.dll?action=m2 to set guest session (MyUsername: Guest, MyGuestEmailAddr, etc.).  
- POST /guestaccess.aspx to continue guest flow.  
- GET https://checkip.amazonaws.com to extract attacker IP for payload.  
- POST /moveitisapi/moveitisapi.dll with SQL injection in X-siLock-SessVar1: `'); INSERT INTO activesessions ... UPDATE activesessions SET Username=(select top-priv user) ...` to hijack highest-privilege session.  
- Follow-up POST /guestaccess.aspx.  
- POST /api/v1/auth/token using the injected ASP.NET_SessionId cookie.  
Matchers verify JSON `access_token` in body_7 + 200 status. Extractors capture IP, CSRF token, and access_token.

## References
- https://github.com/horizon3ai/CVE-2023-34362
- https://www.horizon3.ai/moveit-transfer-cve-2023-34362-deep-dive-and-indicators-of-compromise/
- https://nvd.nist.gov/vuln/detail/CVE-2023-34362
- http://packetstormsecurity.com/files/172883/MOVEit-Transfer-SQL-Injection-Remote-Code-Execution.html
- http://packetstormsecurity.com/files/173110/MOVEit-SQL-Injection.html
