---
cve_id: CVE-2023-34192
template_path: nuclei-templates/http/cves/2023/CVE-2023-34192.yaml
affected_product: Zimbra Collaboration Suite (ZCS)
severity: critical
authentication: required
external_callback: false
affected_versions: 8.8.15
preconditions: []
poc_classification: rce
---

## Vulnerability
Zimbra Collaboration Suite (ZCS) v8.8.15 contains a cross-site scripting vulnerability in the `/h/autoSaveDraft` endpoint. A remote authenticated attacker can execute arbitrary JavaScript by injecting a crafted payload into the `draftid` parameter.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H (score 9.0), CWE-79. Exploitation can result in session hijacking, page defacement, or theft of sensitive information in the victim's browser context.

## PoC / Detection
Classification: rce

The template first performs authentication via a POST to `/zimbra/` using `username` and `password` variables. It then issues a GET request to `/h/autoSaveDraft?draftid=aaaaaaaaaaa%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3Cbbbbbbbb` containing the XSS payload. It verifies success by checking that the response body contains the unsanitized `<script>alert(document.domain)</script>` string along with "zimbra", the Content-Type header contains `text/html`, and status code is 200.

## References
- https://mp.weixin.qq.com/s/Vz8yL4xBlZN5EQQ_BG0OOA
- https://www.helpnetsecurity.com/2023/07/17/cve-2023-34192/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-34192
- https://wiki.zimbra.com/wiki/Security_Center
- https://wiki.zimbra.com/wiki/Zimbra_Responsible_Disclosure_Policy
