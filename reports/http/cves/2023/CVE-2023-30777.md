---
cve_id: CVE-2023-30777
template_path: nuclei-templates/http/cves/2023/CVE-2023-30777.yaml
affected_product: Advanced Custom Fields
severity: medium
authentication: required
external_callback: false
affected_versions: < 6.1.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Advanced Custom Fields plugin for WordPress versions prior to 6.1.6 contains a reflected cross-site scripting (XSS) vulnerability in the `post_status` parameter. The vulnerability stems from insufficient input sanitization and output escaping, allowing attackers to inject arbitrary JavaScript code that executes in the context of a victim's browser session. This can lead to session hijacking, credential theft, website defacement, or other malicious actions performed with the victim's privileges.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability through a two-step authenticated process:

1. **Authentication**: Performs a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Probe**: Sends a GET request to `/wp-admin/edit.php` with a crafted `post_status` parameter containing an XSS payload: `"style=animation-name:rotation onanimationstart=alert(document.domain)//`

The template verifies successful exploitation by checking for:
- HTTP 200 response status
- HTML content type
- Presence of the injected payload (`onanimationstart=alert(document.domain)//`) in the response body
- Confirmation that the page belongs to Advanced Custom Fields plugin

The detection uses a CSS animation-based XSS vector that triggers JavaScript execution when the malicious style attribute is rendered by the browser.

## References

- https://wpscan.com/vulnerability/95ded80f-a47b-411e-bd17-050439bf565f
- https://wordpress.org/plugins/advanced-custom-fields/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2023-30777
- https://patchstack.com/database/vulnerability/advanced-custom-fields-pro/wordpress-advanced-custom-fields-pro-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
- https://patchstack.com/database/vulnerability/advanced-custom-fields/wordpress-advanced-custom-fields-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
