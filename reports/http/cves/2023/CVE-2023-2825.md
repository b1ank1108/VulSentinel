---
cve_id: CVE-2023-2825
template_path: nuclei-templates/http/cves/2023/CVE-2023-2825.yaml
affected_product: GitLab
severity: high
authentication: required
external_callback: false
affected_versions: 16.0.0
preconditions: [attachment exists in a public project nested within at least five groups]
poc_classification: info-leak
---

## Vulnerability
GitLab CE/EE version 16.0.0 contains a path traversal (CWE-22) vulnerability in the attachments upload handling. An attacker can read arbitrary files on the server (including `/etc/passwd`) when an attachment exists in a public project nested inside at least five groups. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5 High). Only version 16.0.0 is affected; the issue was fixed in 16.0.1+.

## PoC / Detection
Classification: info-leak

The template performs an intrusive multi-step workflow:  
1. GET `/users/sign_in` and extract authenticity token.  
2. POST login with `{{username}}` / `{{password}}`.  
3. Create 11 consecutively nested public groups (random 5-char prefix).  
4. Create a public project named `CVE-2023-2825` inside the deepest group.  
5. Upload a dummy file to the project's `/uploads` endpoint and extract the upload hash.  
6. Issue a GET request to the upload path with 13 `..%2F` segments ending in `/etc/passwd`.  

Success is confirmed if the response body contains hex `726f6f743a78` ("root:x") and the `Content-Type` header indicates `application/octet-stream` with the traversed path.

## References
- https://about.gitlab.com/releases/2023/05/23/critical-security-release-gitlab-16-0-1-released/
- https://github.com/Occamsec/CVE-2023-2825
- https://labs.watchtowr.com/gitlab-arbitrary-file-read-gitlab-cve-2023-2825-analysis/
- https://nvd.nist.gov/vuln/detail/CVE-2023-2825
- https://gitlab.com/gitlab-org/cves/-/blob/master/2023/CVE-2023-2825.json
