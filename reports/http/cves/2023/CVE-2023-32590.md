---
cve_id: CVE-2023-32590
template_path: nuclei-templates/http/cves/2023/CVE-2023-32590.yaml
affected_product: Subscribe to Category
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.7.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

The Subscribe to Category WordPress plugin version 2.7.4 and earlier contains a SQL injection vulnerability (CWE-89) in its TextMagic SMS integration endpoint. The vulnerability stems from improper neutralization of special elements used in SQL commands within the `/wp-json/textmagic/v1/smsreceived` REST API endpoint. The `sender` parameter accepts unsanitized user input that is directly incorporated into SQL queries, allowing attackers to inject arbitrary SQL commands. This is an unauthenticated vulnerability with a CVSS score of 9.3 (Critical), exploitable remotely without authentication or user interaction despite the description mentioning user interaction requirements. The vulnerability allows attackers to manipulate database queries through time-based blind SQL injection techniques.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a POST request to the WordPress REST API endpoint `/wp-json/textmagic/v1/smsreceived` with a JSON payload containing a time-based blind SQL injection in the `sender` field. The payload `1' AND (SELECT 1 FROM (SELECT(SLEEP(10)))sqltest) AND '1'='1` attempts to inject a SQL SLEEP command that delays query execution by 10 seconds. The template verifies successful exploitation by checking four conditions: response time is at least 10 seconds (confirming the SLEEP executed), response body is empty, HTTP status code is 200, and content-type is `application/json`. This time-based detection method confirms the SQL injection vulnerability exists and can be exploited to extract database information through blind SQL injection techniques.

## References

- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/subscribe-to-category/subscribe-to-category-274-unauthenticated-sql-injection
- https://nvd.nist.gov/vuln/detail/CVE-2023-32590
