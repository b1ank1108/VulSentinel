---
cve_id: CVE-2023-34124
template_path: nuclei-templates/http/cves/2023/CVE-2023-34124.yaml
affected_product: SonicWall GMS and Analytics Web Services
severity: critical
authentication: none
external_callback: true
affected_versions: GMS: 9.3.2-SP1 and earlier versions; Analytics: 2.5.0.4-R7 and earlier versions
preconditions: []
poc_classification: rce
---

## Vulnerability
SonicWall GMS and Analytics Web Services are affected by a shell injection vulnerability (CVE-2023-34124). The authentication mechanism had insufficient checks, allowing authentication bypass. This issue affects GMS: 9.3.2-SP1 and earlier versions; Analytics: 2.5.0.4-R7 and earlier versions. Successful exploitation can lead to unauthorized access, data leakage (including extraction of admin credentials from sgmsdb.users), and potential compromise of the target system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-287, CWE-305.

## PoC / Detection
Classification: rce

The template performs a chained exploit sequence (max-request: 4):
- Crafted GET `/ws/msw/tenant/' union select ...` with `Auth: {"user": "system", "hash": "..."}` (HMAC-SHA1 of SQL payload) to extract admin `alias` (id:password) and `servertoken` via JSON/regex from response.
- GET `/appliance/login`.
- POST `/appliance/applianceMainPage` (action=login) using extracted values to complete session.
- POST `/appliance/applianceMainPage` (action=file_system&task=search) injecting base64-encoded bash reverse-shell payload (uudecode → write /tmp/.random → exec → rm) into `searchFilter` parameter.
Matchers verify SonicWall management title in final body and DNS OOB callback to interactsh.

## References
- https://raw.githubusercontent.com/rapid7/metasploit-framework/4b130f5be7590d04878f3bda37555e59e733324d/modules/exploits/multi/http/sonicwall_shell_injection_cve_2023_34124.rb
- https://attackerkb.com/topics/Vof5fWs4rx/cve-2023-34127/rapid7-analysis
- https://www.sonicwall.com/support/product-notification/urgent-security-notice-sonicwall-gms-analytics-impacted-by-suite-of-vulnerabilities/230710150218060/
- https://github.com/getdrive/PoC/blob/main/2023/Sonicwall_Shell_Injection/sonicwall_shell_injection_cve_2023_34124.rb
- https://nvd.nist.gov/vuln/detail/CVE-2023-34124
