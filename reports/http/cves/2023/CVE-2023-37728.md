---
cve_id: CVE-2023-37728
template_path: nuclei-templates/http/cves/2023/CVE-2023-37728.yaml
affected_product: IceWarp Webmail Server
severity: medium
authentication: none
external_callback: false
affected_versions: 10.2.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

IceWarp Webmail Server v10.2.1 contains a reflected cross-site scripting (XSS) vulnerability via the `color` parameter in the webmail interface. Unauthenticated remote attackers can inject malicious JavaScript (e.g., via crafted URLs) that executes in the context of authenticated users' browsers due to insufficient output encoding/sanitization of the parameter.

Impact: session-cookie theft and unauthorized access to email communications.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1) | CWE-79 | CPE cpe:2.3:a:icewarp:icewarp:10.2.1:*:*:*:*:*:*:*

## PoC / Detection
Classification: info-leak

The template issues GET requests to `{{BaseURL}}/webmail/?color=%22%3e%3cimg%20src%20onerror%3dalert(document.domain)%3e%3c%22%27` (and root-path variant), stopping at the first match. It verifies the flaw if status_code == 200, content_type contains "text/html", IceWarp branding appears in headers or body ("IceWarp WebClient"), and the exact unsanitized payload string appears in the response body.

## References
- https://medium.com/@ayush.engr29/cve-2023-37728-6dfb7586311
- https://nvd.nist.gov/vuln/detail/CVE-2023-37728
- http://icearp.com
- http://icewarp.com
- https://medium.com/%40ayush.engr29/cve-2023-37728-6dfb7586311
