---
cve_id: CVE-2023-36845
template_path: nuclei-templates/http/cves/2023/CVE-2023-36845.yaml
affected_product: Juniper Junos OS J-Web
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [J-Web interface must be accessible, affects EX Series and SRX Series devices]
poc_classification: rce
---

## Vulnerability

CVE-2023-36845 is a PHP External Variable Modification vulnerability (CWE-473) in the J-Web management interface of Juniper Networks Junos OS on EX Series and SRX Series devices. The vulnerability allows an unauthenticated, network-based attacker to control certain environment variables, specifically the `PHPRC` PHP configuration directive, to execute arbitrary remote commands on the affected device. The flaw stems from improper handling of PHP configuration parameters passed through HTTP requests, enabling attackers to manipulate the PHP runtime environment and include arbitrary files for execution. This is a critical severity vulnerability with a CVSS score of 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) and an EPSS score of 0.94355 (99.957th percentile), indicating active exploitation in the wild. The vulnerability is listed in the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to the J-Web interface with a malicious `PHPRC` parameter in the query string (`/?PHPRC=/dev/fd/0`). The request body contains a PHP configuration directive (`auto_prepend_file="/etc/passwd"`) that instructs PHP to prepend the `/etc/passwd` file before executing any PHP script. This technique exploits the PHP External Variable Modification flaw to force the application to read and output the contents of `/etc/passwd`. The template confirms successful exploitation by checking for three conditions: (1) the response body contains a regex pattern matching root user entries (`root:.*:0:0:`), (2) the response contains the word "Juniper" to confirm the target device, and (3) the HTTP status code is 200. While the template uses a harmless file read for detection purposes, the underlying vulnerability allows full remote code execution through arbitrary PHP configuration manipulation.

## References

- https://vulncheck.com/blog/juniper-cve-2023-36845
- https://nvd.nist.gov/vuln/detail/CVE-2023-36845
- https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/
- http://packetstormsecurity.com/files/174865/Juniper-SRX-Firewall-EX-Switch-Remote-Code-Execution.html
- https://supportportal.juniper.net/JSA72300
