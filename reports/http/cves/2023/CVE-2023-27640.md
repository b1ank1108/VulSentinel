---
cve_id: CVE-2023-27640
template_path: nuclei-templates/http/cves/2023/CVE-2023-27640.yaml
affected_product: PrestaShop tshirtecommerce
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [Custom Product Designer (tshirtecommerce) module installed on PrestaShop]
poc_classification: info-leak
---

## Vulnerability
The Custom Product Designer (tshirtecommerce) module for PrestaShop contains a directory traversal vulnerability in the `fonts.php` script. Unauthenticated remote attackers can exploit the `type` parameter via POST or GET requests to read arbitrary files on the server filesystem, including PHP source code files that may expose database credentials and configuration details.

Impact includes high confidentiality exposure (CVSS 7.5, CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, CWE-22). The flaw stems from insufficient path validation in the module.

## PoC / Detection
Classification: info-leak

The detection template sends a crafted GET request to `/tshirtecommerce/fonts.php?name=2&type=./../index.php` attempting to retrieve the PrestaShop root `index.php` file through directory traversal. It verifies success by checking for status code 200, text/html content type, and the presence of "PrestaShop" and "<?php" markers in the base64-decoded response body.

## References
- https://www.cvedetails.com/cve/CVE-2023-27640/
- https://security.friendsofpresta.org/module/2023/03/30/tshirtecommerce_cwe-22.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27640
