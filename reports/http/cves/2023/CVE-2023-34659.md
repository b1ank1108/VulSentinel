---
cve_id: CVE-2023-34659
template_path: nuclei-templates/http/cves/2023/CVE-2023-34659.yaml
affected_product: JeecgBoot
severity: critical
authentication: none
external_callback: false
affected_versions: 3.5.0, 3.5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

JeecgBoot versions 3.5.0 and 3.5.1 contain a SQL injection vulnerability in the `id` parameter of the `/jeecg-boot/jmreport/show` interface. This is a CWE-89 (SQL Injection) vulnerability with a CVSS score of 9.8 (Critical). The vulnerability allows unauthenticated attackers to execute arbitrary SQL queries against the backend database. Successful exploitation could lead to unauthorized access, data leakage, or data manipulation. The vulnerability is exploitable remotely over the network with low attack complexity and requires no user interaction or privileges.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a POST request to `/jeecg-boot/jmreport/show` with a crafted JSON payload. The payload contains a malicious SQL injection string in the nested `params.id` field: `1' or '%1%' like (updatexml(0x3a,concat(1,(version())),1)) or '%%' like '`. This injection uses MySQL's `updatexml()` function to trigger an XPATH syntax error that reveals the database version in the error message.

The template confirms the vulnerability by checking for:
1. The presence of both "XPATH syntax error:" and "SQLException" strings in the response body
2. An `application/json` content-type header
3. HTTP status code 200

The detection method demonstrates that the application is vulnerable to SQL injection by forcing a database error that leaks version information, confirming the ability to execute arbitrary SQL commands.

## References

- https://github.com/jeecgboot/jeecg-boot/issues/4976
- https://nvd.nist.gov/vuln/detail/CVE-2023-34659
- https://github.com/izj007/wechat
