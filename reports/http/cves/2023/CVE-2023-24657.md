---
cve_id: CVE-2023-24657
template_path: nuclei-templates/http/cves/2023/CVE-2023-24657.yaml
affected_product: phpIPAM
severity: medium
authentication: required
external_callback: false
affected_versions: 1.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
phpIPAM 1.6 contains a cross-site scripting vulnerability via the closeClass parameter at /subnet-masks/popup.php. An attacker can inject arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.

Successful exploitation could allow an attacker to execute malicious scripts in the victim's browser context, potentially leading to session hijacking, defacement, or theft of sensitive information.

Remediation requires upgrading to a patched version of phpIPAM or applying vendor security patches.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection
Classification: info-leak

The template first sends a POST request to /app/login/login_check.php with ipamusername={{username}}&ipampassword={{password}} to establish an authenticated session. It then issues a GET request to /app/tools/subnet-masks/popup.php?closeClass=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E. Detection succeeds if the second response returns status 200 and its body contains both the unsanitized "<script>alert(document.domain)</script>" payload and the string "Subnet masks", confirming reflection of the injected script.

## References
- https://github.com/phpipam/phpipam/issues/3738
- https://nvd.nist.gov/vuln/detail/CVE-2023-24657
