---
cve_id: CVE-2023-2437
template_path: nuclei-templates/http/cves/2023/CVE-2023-2437.yaml
affected_product: UserPro
severity: critical
authentication: none
external_callback: false
affected_versions: <= 5.1.1
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
UserPro WordPress plugin <= 5.1.1 contains an authentication bypass in the `userpro_fbconnect` AJAX action (CVE-2023-2437, CWE-287). Unauthenticated attackers can log in as any user (including admins) by supplying an arbitrary `id` parameter in the Facebook connect flow, leading to full administrative access and compromise of all user accounts on the site.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

**Impact**  
Unauthenticated attackers can bypass authentication by exploiting the Facebook connect AJAX action with arbitrary user IDs.

**Remediation**  
Update UserPro plugin to a version newer than 5.1.1 that properly validates authentication in the `userpro_fbconnect` AJAX action.

## PoC / Detection
Classification: auth-bypass

The multi-step template verifies exploitability as follows:  
1. Confirms UserPro plugin presence via `GET /wp-content/plugins/userpro/css/userpro.min.css` and checks for `.userpro` in body (status 200).  
2. Extracts the first user's `id` and `slug` (as email) via public `GET /wp-json/wp/v2/users` endpoint.  
3. Sends `POST /wp-admin/admin-ajax.php` with `action=userpro_fbconnect&id={{user_id}}&email={{slug}}` (no credentials).  
4. Matches success on response body containing `{"redirect_uri":"refresh"}`, `wp-admin-bar-logout`, or `<span class='display-name'>`, OR headers containing `wordpress_logged_in`/`wordpress_sec_` (status 200).

## References
- https://github.com/RxRCoder/CVE-2023-2437
- https://www.wordfence.com/blog/2023/11/several-critical-vulnerabilities-including-privilege-escalation-authentication-bypass-and-more-patched-in-userpro-wordpress-plugin/
- https://nvd.nist.gov/vuln/detail/CVE-2023-2437
- https://codecanyon.net/item/userpro-user-profiles-with-social-login/5958681
