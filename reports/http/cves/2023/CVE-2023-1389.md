---
cve_id: CVE-2023-1389
template_path: nuclei-templates/http/cves/2023/CVE-2023-1389.yaml
affected_product: TP-Link Archer AX21 (AX1800)
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
TP-Link Archer AX21 (AX1800) routers expose unauthenticated OS command injection via the `country` parameter at `/cgi-bin/luci/;stok=/locale?form=country`. Remote attackers can inject arbitrary commands that execute as root (CWE-78). CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact: full router compromise. Remediation: apply latest TP-Link firmware.

## PoC / Detection
Classification: rce

Template sends two identical raw POST requests (`operation=write&country=$(id)`) to the locale endpoint, then matches HTTP 200 status and regex `uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)` in the response body to confirm command execution.

## References
- https://www.tenable.com/security/research/tra-2023-11
- https://nvd.nist.gov/vuln/detail/CVE-2023-1389
- https://github.com/tenable/poc-cve-2023-1389
