---
cve_id: CVE-2023-4542
template_path: nuclei-templates/http/cves/2023/CVE-2023-4542.yaml
affected_product: D-Link DAR-8000-10
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability

D-Link DAR-8000-10 firmware contains an operating system command injection vulnerability (CVE-2023-4542, CWE-78) originating from the unsanitized `id` parameter (template probe uses `cmd`) of `/app/sys1.php`. Unauthenticated attackers can execute arbitrary operating system commands, potentially gaining full control of the router and intercepting all network traffic. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Remediation requires updating to a patched firmware version that sanitizes the parameter.

## PoC / Detection
Classification: rce

The template sends a single POST request to `/app/sys1.php` containing the form-encoded body `cmd=id` and confirms successful exploitation if the response returns HTTP 200 and the body matches the regex `uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)` (output of the injected `id` command).

## References
- https://github.com/20142995/sectool
- https://github.com/tanjiti/sec_profile
- https://github.com/wy876/POC/blob/main/D-Link_DAR-8000%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E(CVE-2023-4542).md
- https://vuldb.com/?ctiid.238047
- https://vuldb.com/?id.238047
