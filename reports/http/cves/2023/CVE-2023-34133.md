---
cve_id: CVE-2023-34133
template_path: nuclei-templates/http/cves/2023/CVE-2023-34133.yaml
affected_product: SonicWall GMS and Analytics
severity: high
authentication: none
external_callback: false
affected_versions: GMS: 9.3.2-SP1 and earlier versions; Analytics: 2.5.0.4-R7 and earlier versions
preconditions: []
poc_classification: info-leak
---

## Vulnerability
SonicWall GMS and Analytics is affected by an SQL Injection vulnerability (CVE-2023-34133, CWE-89) caused by improper neutralization of special elements used in an SQL command. An unauthenticated attacker can extract sensitive information from the application database (demonstrated via SGMSDB.DOMAINS table).

Affected versions: GMS 9.3.2-SP1 and earlier; Analytics 2.5.0.4-R7 and earlier.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).  
Impact includes unauthorized database access, data leakage, and potential further system compromise.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by sending a single GET request to `/ws/msw/tenant/{{url_encode(query)}}` where `query` is a crafted UNION SELECT payload that returns a domain ID together with the known MD5 hash of a static number. A custom `Auth` header containing the base64-encoded HMAC-SHA1 hash (computed over the query using a hardcoded secret for the "system" user) is included. The matcher checks the response body for the injected MD5 value to confirm successful SQL injection and information extraction.

## References
- https://raw.githubusercontent.com/rapid7/metasploit-framework/4b130f5be7590d04878f3bda37555e59e733324d/modules/exploits/multi/http/sonicwall_shell_injection_cve_2023_34124.rb
- https://www.sonicwall.com/support/product-notification/urgent-security-notice-sonicwall-gms-analytics-impacted-by-suite-of-vulnerabilities/230710150218060/
- https://github.com/getdrive/PoC/blob/main/2023/Sonicwall_Shell_Injection/sonicwall_shell_injection_cve_2023_34124.rb
- https://nvd.nist.gov/vuln/detail/CVE-2023-34133
- http://packetstormsecurity.com/files/174571/Sonicwall-GMS-9.9.9320-Remote-Code-Execution.html
