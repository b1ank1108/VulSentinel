---
cve_id: CVE-2023-6895
template_path: nuclei-templates/http/cves/2023/CVE-2023-6895.yaml
affected_product: Hikvision Intercom Broadcasting System
severity: critical
authentication: none
external_callback: false
affected_versions: 3.0.3_20201113_RELEASE(HIK) (fixed in 4.1.0)
preconditions: []
poc_classification: rce
---

## Vulnerability
Hikvision Intercom Broadcasting System 3.0.3_20201113_RELEASE(HIK) contains a critical OS command injection (CWE-78) in `/php/ping.php` via manipulation of the `jsondata[ip]` parameter. 

CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Unauthenticated attackers can execute arbitrary OS commands (e.g., via `netstat -ano` or custom payloads), leading to full system compromise.

Remediation: Upgrade to version 4.1.0 or later.

## PoC / Detection
Classification: rce

The Nuclei template detects the vulnerability by issuing POST requests to `{{BaseURL}}/php/ping.php` using `jsondata[type]=99&jsondata[ip]={{command}}` with payloads `id` and `cmd /c ipconfig`. Success is confirmed if the 200 OK response body contains expected command output (regex for UID/GID or "Windows IP") and `text/html` Content-Type.

## References
- https://vuldb.com/?ctiid.248254
- https://vuldb.com/?id.248254
- https://github.com/tanjiti/sec_profile
- https://github.com/wy876/POC
- https://github.com/xingchennb/POC-
