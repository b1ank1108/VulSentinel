---
cve_id: CVE-2023-3519
template_path: nuclei-templates/http/cves/2023/CVE-2023-3519.yaml
affected_product: Citrix NetScaler ADC and NetScaler Gateway
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: configured as a Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) or AAA virtual server
poc_classification: rce
---

## Vulnerability
Citrix NetScaler ADC and NetScaler Gateway appliances are affected by a critical unauthenticated remote code execution vulnerability in SAML request processing. Exploitation allows arbitrary code execution on the appliance.  
**Impact:** Unauthenticated attackers can compromise corporate network access and intercept VPN traffic.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-94

## PoC / Detection
Classification: rce  
The template sends a POST request to `/saml/login` containing a base64-encoded SAML AuthnRequest XML payload with repeated `ds:CanonicalizationMethod` elements and malformed signature data (`SignedInfo`, `SignatureValue`, `DigestValue` set to dummy values). It detects the vulnerable condition via the matcher `status_code == 200 AND contains(body, 'SAML Assertion verification failed;')`.

## References
- https://github.com/assetnote/exploits/blob/main/citrix/CVE-2023-3519/README.md
- https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX561482
- https://www.assetnote.io/resources/research/analysis-of-cve-2023-3519-in-citrix-adc-and-netscaler-gateway
