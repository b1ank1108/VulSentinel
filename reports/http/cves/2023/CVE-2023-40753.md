---
cve_id: CVE-2023-40753
template_path: nuclei-templates/http/cves/2023/CVE-2023-40753.yaml
affected_product: PHPJabbers Ticket Support Script
severity: medium
authentication: required
external_callback: false
affected_versions: 3.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Cross-Site Scripting (XSS) in the `message` parameter of `index.php` during ticket notification creation in PHPJabbers Ticket Support Script v3.2. Authenticated attackers inject unsanitized JavaScript that executes when support staff view the notification.

**CVSS v3.1:** 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
**CWE-79**  
**Impact:** Malicious JavaScript can steal support staff session cookies and grant access to sensitive customer support tickets.

## PoC / Detection
Classification: info-leak

The template first authenticates by POSTing `login_user=1&login_email={{username}}&login_password={{password}}` to `/index.php?controller=pjBase&action=pjActionLogin`. It then issues a GET to the notification creation endpoint (`/notification_create=1&type=NewTicket&...&i18n[1][message]=</textarea><scrIpt>alert(document.domain);</scRipt><textarea>`) with breakout payload. It confirms the vulnerability if `body_2` reflects the exact unsanitized payload plus "Subject" and "Recipient users", with status 200 and `text/html` content-type.

## References
- https://medium.com/@tfortinsec/multiple-vulnerabilities-in-phpjabbers-part-3-40fc3565982f
- https://nvd.nist.gov/vuln/detail/CVE-2023-40753
