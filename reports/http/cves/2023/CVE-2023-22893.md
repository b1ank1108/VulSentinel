---
cve_id: CVE-2023-22893
template_path: nuclei-templates/http/cves/2023/CVE-2023-22893.yaml
affected_product: Strapi
severity: high
authentication: none
external_callback: false
affected_versions: <=4.5.5
preconditions: AWS Cognito login provider used for authentication
poc_classification: auth-bypass
---

## Vulnerability
Strapi through 4.5.5 does not verify the access or ID tokens issued during the OAuth flow when the AWS Cognito login provider is used. A remote unauthenticated attacker can forge an ID token signed using the 'None' algorithm to bypass authentication and impersonate any user (including administrators), gaining unauthorized access to CMS content and administrative functions.

CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
CWE-287  
Remediation: Update to version 4.5.6 or later.

## PoC / Detection
Classification: auth-bypass

The template sends a single raw GET request to `/api/auth/cognito/callback?access_token=<random>&id_token=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.<base64-encoded-impersonation-payload>.` (JWT header forces alg: none; payload contains arbitrary random username and attacker-chosen email). It verifies exploitation by matching HTTP 200 status, `application/json` Content-Type, and the presence of both `"provider":` and `"confirmed":` keys in the JSON body, then extracts the returned `.jwt` token.

## References
- https://www.ghostccamm.com/blog/multi_strapi_vulns
- https://github.com/strapi/strapi/releases
- https://github.com/ARPSyndicate/cvemon
- https://nvd.nist.gov/vuln/detail/CVE-2023-22893
