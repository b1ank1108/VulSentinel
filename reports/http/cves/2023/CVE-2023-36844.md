---
cve_id: CVE-2023-36844
template_path: nuclei-templates/http/cves/2023/CVE-2023-36844.yaml
affected_product: Juniper Junos OS on EX Series
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [J-Web interface must be accessible]
poc_classification: rce
---

## Vulnerability

CVE-2023-36844 is a PHP External Variable Modification vulnerability affecting J-Web of Juniper Networks Junos OS on EX Series devices. This vulnerability allows an unauthenticated, network-based attacker to control certain important environment variables through crafted requests. The flaw enables attackers to modify specific PHP environment variables, leading to partial loss of integrity. This vulnerability can be chained with other vulnerabilities (CVE-2023-36845, CVE-2023-36846, CVE-2023-36847) to achieve remote code execution on affected Juniper devices.

The vulnerability is classified as CWE-473 (PHP External Variable Modification) with a CVSS v3.1 score of 5.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N). The EPSS score of 0.94302 (99.941th percentile) indicates a very high probability of active exploitation. This vulnerability has been added to the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: rce

The template performs a multi-stage exploitation chain to verify the remote code execution vulnerability:

1. **First Request**: Uploads a PHP file containing `<?php echo md5('CVE-2023-36844');unlink(__FILE__);?>` to `/var/tmp/` via the `/webauth_operation.php` endpoint using the `do_upload` operation. The payload is base64-encoded and sent as fileData with a randomly generated filename.

2. **Second Request**: Uploads an INI configuration file that sets `auto_prepend_file` to point to the previously uploaded PHP file. This modifies PHP's configuration to automatically execute the malicious PHP file before any other PHP script.

3. **Third Request**: Triggers execution by accessing `/webauth_operation.php` with the `PHPRC` parameter pointing to the uploaded INI file, causing PHP to load the modified configuration and execute the prepended malicious code.

The template confirms successful exploitation by detecting the MD5 hash output (`8a3d8f5d8e8c8b5e5f5d5e5f5d5e5f5d`) in the response body, proving arbitrary PHP code execution capability.

## References

- https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/
- https://github.com/watchtowrlabs/juniper-rce_cve-2023-36844
- https://supportportal.juniper.net/JSA72300
- http://packetstormsecurity.com/files/174397/Juniper-JunOS-SRX-EX-Remote-Code-Execution.html
- http://packetstormsecurity.com/files/174865/Juniper-SRX-Firewall-EX-Switch-Remote-Code-Execution.html
