---
cve_id: CVE-2023-22518
template_path: nuclei-templates/http/cves/2023/CVE-2023-22518.yaml
affected_product: Atlassian Confluence Server
severity: critical
authentication: none
external_callback: false
affected_versions: All versions of Confluence Data Center and Server
preconditions: self-hosted deployment (not Atlassian Cloud / atlassian.net domain)
poc_classification: auth-bypass
---

## Vulnerability
Atlassian Confluence Server (Data Center and Server editions) contains an improper authorization flaw (CWE-863) in the `/json/setup-restore.action` endpoint. All versions are affected. Atlassian Cloud instances (atlassian.net domains) are not vulnerable. No confidentiality impact possible; attacker cannot exfiltrate data. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

Unauthenticated remote attackers can upload malicious backup ZIP files, triggering database reset and full administrative access to the instance.

Update to a patched version that enforces proper authorization on the setup-restore endpoint.

## PoC / Detection
Classification: auth-bypass

The template issues one unauthenticated raw POST request to `/json/setup-restore.action` with a crafted multipart/form-data payload containing `buildIndex=false`, a randomly-named empty `.zip` file (random content), and the form field "Upload and import". It matches on HTTP 200 status plus the exact body strings "The zip file did not contain an entry" and "exportDescriptor.properties". This safely confirms the endpoint processes uploads without authentication (the real exploit would use a malicious backup ZIP). The probe is non-destructive and will not reset any data.

## References
- https://confluence.atlassian.com/pages/viewpage.action?pageId=1311473907
- https://blog.projectdiscovery.io/atlassian-confluence-auth-bypass/
- https://jira.atlassian.com/browse/CONFSERVER-93142
- https://nvd.nist.gov/vuln/detail/CVE-2023-22518
- https://github.com/RootUp/PersonalStuff/blob/master/check_cve_2023_22518.py
