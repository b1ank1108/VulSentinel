---
cve_id: CVE-2023-0942
template_path: nuclei-templates/http/cves/2023/CVE-2023-0942.yaml
affected_product: WordPress Japanized for WooCommerce
severity: medium
authentication: required
external_callback: false
affected_versions: <2.5.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Japanized for WooCommerce plugin (vendor: artisanworkshop, product: japanized_for_woocommerce) before 2.5.5 contains a reflected cross-site scripting vulnerability via the `tab` parameter on the admin settings screen (`/wp-admin/admin.php?page=wc4jp-options`). The root cause is missing input sanitization and output escaping in `html-admin-setting-screen.php`. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). An attacker can inject arbitrary JavaScript that executes in the victim's browser context, enabling cookie theft, session hijacking, or page defacement. Fixed in 2.5.5.

## PoC / Detection
Classification: info-leak

The template first authenticates by sending a POST to `/wp-login.php` with `log={{username}}&pwd={{password}}`. It then sends a GET request to the vulnerable endpoint with `tab=a</script><svg/onload=alert(document.domain)>` and matches on HTTP 200 plus unsanitized reflection of the payload and the string "woocommerce-for-japan" in the response body. This confirms the reflected XSS flaw, allowing client-side script execution and data exfiltration (e.g., document.cookie) in the victim's authenticated session.

## References
- https://wpscan.com/vulnerability/71aa9460-6dea-49cc-946c-d7d4bf723511
- https://wordpress.org/plugins/woocommerce-for-japan/
- https://plugins.trac.wordpress.org/browser/woocommerce-for-japan/trunk/includes/admin/views/html-admin-setting-screen.php#L63
- https://nvd.nist.gov/vuln/detail/CVE-2023-0942
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2868545%40woocommerce-for-japan%2Ftrunk&old=2863064%40woocommerce-for-japan%2Ftrunk&sfp_email=&sfph_mail=
