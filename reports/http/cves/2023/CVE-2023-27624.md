---
cve_id: CVE-2023-27624
template_path: nuclei-templates/http/cves/2023/CVE-2023-27624.yaml
affected_product: WordPress Redirect After Login plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 0.1.9
preconditions: [admin privileges required]
poc_classification: state-change
---

## Vulnerability
Marcelotorres Redirect After Login plugin <= 0.1.9 contains a stored cross-site scripting vulnerability caused by insufficient sanitization of the login redirect parameter (specifically the custom URL fields in plugin settings). Exploit requires admin privileges.  

**CVSS 3.1:** AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:L (score 5.9)  
**CWE:** CWE-79  
**Impact:** Attackers can execute malicious scripts in the context of the affected site, potentially leading to session hijacking or defacement.  
**Remediation:** Update to the latest version of the plugin where the vulnerability is fixed.

## PoC / Detection
Classification: state-change  

The template executes a 4-step authenticated workflow:  
1. GET /wp-login.php to confirm the login page.  
2. POST credentials to /wp-login.php and verify successful admin session via 302 redirect and `wordpress_logged_in` cookie.  
3. GET the plugin settings page (/wp-admin/options-general.php?page=mtral), confirm plugin presence, and extract `_wpnonce`.  
4. POST to /wp-admin/options.php with the malicious payload `"><img src=x onerror=alert(document.domain)>` injected into `mtral_settings[mtral_field_custom_url_administrator]`, then GET the settings page again and confirm the exact unsanitized payload appears in the HTML body.  

This verifies the ability to modify plugin configuration with unsanitized input, resulting in persistent XSS when the settings page is viewed.

## References
- https://patchstack.com/database/vulnerability/redirect-after-login/wordpress-redirect-after-login-plugin-0-1-9-cross-site-scripting-xss-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2023-27624
