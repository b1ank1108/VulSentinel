---
cve_id: CVE-2023-39007
template_path: nuclei-templates/http/cves/2023/CVE-2023-39007.yaml
affected_product: OPNsense
severity: critical
authentication: required
external_callback: false
affected_versions: Community Edition before 23.7 and Business Edition before 23.4.2
preconditions: access to Cron component (/ui/cron/item/open)
poc_classification: rce
---

## Vulnerability
OPNsense Community Edition before 23.7 and Business Edition before 23.4.2 contains a reflected cross-site scripting (XSS) flaw in the Cron component at `/ui/cron/item/open` via unsanitized `openAction` handling in `ItemController.php`. Authenticated attackers can inject arbitrary JavaScript that escalates to remote code execution, enabling full compromise of the firewall/router and connected networks (CVSS 9.6, CWE-79).

## PoC / Detection
Classification: rce

The template verifies the flaw with an authenticated multi-request flow that extracts a CSRF token then triggers the vulnerability:
- `GET /` parses the login form for hidden parameter name/value (regex on body).
- `POST /` submits credentials plus the extracted token.
- `GET /ui/cron/item/open/0'+alert(document.domain)+' ` injects the XSS payload into the path.
Matchers confirm reflection of the exact unsanitized payload string inside an `openDialog` call in `body_3`, `text/html` content-type in `header_3`, and HTTP 200 status.

## References
- https://logicaltrust.net/blog/2023/08/opnsense.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-39007
