---
cve_id: CVE-2023-30150
template_path: nuclei-templates/http/cves/2023/CVE-2023-30150.yaml
affected_product: PrestaShop leocustomajax
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0 and 1.0.0
preconditions: leocustomajax module installed on PrestaShop
poc_classification: info-leak
---

## Vulnerability
PrestaShop leocustomajax module versions 1.0 and 1.0.0 contain a critical SQL injection (CWE-89) in `modules/leocustomajax/leoajax.php`. Unauthenticated remote attackers can inject arbitrary SQL via the `pro_add` and `cat_list` parameters, enabling time-based blind SQLi. 

CVSS 3.1 vector: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation leads to unauthorized database access, data exfiltration/leakage, data modification, and full compromise of the PrestaShop application and underlying database.

## PoC / Detection
Classification: info-leak

The template performs a two-request flow to detect the vulnerability. First: GET `/modules/leocustomajax/leocustomajax.js` (host-redirects enabled) to fingerprint module presence (requires status_code==200 and body containing 'processajax', 'leoajax', 'leocustomajax.css' or 'leosearch'). Second (only if first succeeds): time-based blind SQLi payloads against `/modules/leocustomajax/leoajax.php` â€” POST `leoajax=1&pro_add=if(now()=sysdate(),sleep(6),0)` (with Referer/X-Requested-With) and GET `?cat_list=(SELECT(0)FROM(SELECT(SLEEP(6)))a)` (each with 20s timeout). Matches if any response duration >=6s plus supporting conditions (body/status/content-type).

## References
- https://security.friendsofpresta.org/module/2023/06/06/leocustomajax.html
- https://www.tenable.com/cve/CVE-2023-30150
- https://friends-of-presta.github.io/security-advisories/module/2023/06/06/leocustomajax.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-30150
