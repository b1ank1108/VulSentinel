---
cve_id: CVE-2023-6021
template_path: nuclei-templates/http/cves/2023/CVE-2023-6021.yaml
affected_product: Ray API
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Ray API has a Local File Inclusion (LFI) vulnerability (CVE-2023-6021) in its log API endpoint. Unauthenticated attackers can exploit path traversal in the `filename` parameter to read any file on the server, such as sensitive configuration files, credentials, and system files like `/etc/passwd`.

CVSS: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
CWE: CWE-22, CWE-29

## PoC / Detection
Classification: info-leak

The template first performs a GET request to `{{BaseURL}}/nodes?view=summary` to extract a valid `node_id` from the JSON response. It then issues a second GET request to `{{BaseURL}}/api/v0/logs/file?node_id={{nodeid}}&filename=../../../../../etc%2fpasswd&lines=50000`. Detection succeeds if the response body matches the regex for root user entry (`root:.*:0:0:`), the Content-Type header indicates `text/plain` served by aiohttp, and the status code is 200.

## References
- https://huntr.com/bounties/5039c045-f986-4cbc-81ac-370fe4b0d3f8/
- https://nvd.nist.gov/vuln/detail/CVE-2023-6021
