---
cve_id: CVE-2023-41266
template_path: nuclei-templates/http/cves/2023/CVE-2023-41266.yaml
affected_product: Qlik Sense Enterprise
severity: medium
authentication: none
external_callback: false
affected_versions: May 2023 Patch 3 and earlier, February 2023 Patch 7 and earlier, November 2022 Patch 10 and earlier, and August 2022 Patch 12 and earlier
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Qlik Sense Enterprise for Windows contains a path traversal vulnerability (CVE-2023-41266, CWE-20) that permits an unauthenticated remote attacker to generate an anonymous session and transmit HTTP requests to unauthorized internal endpoints (e.g., /qrs/ API).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N (score 6.5).  
Impact: attackers can access protected Qlik Repository Service endpoints, enabling extraction of sensitive business-intelligence data and manipulation of dashboards.  
Fixed in August 2023 IR, May 2023 Patch 4, February 2023 Patch 8, November 2022 Patch 11, and August 2022 Patch 13 via improved resource-path validation and authentication enforcement.

## PoC / Detection
Classification: info-leak  
The template issues a single unauthenticated GET request to the path-traversed endpoint `{{BaseURL}}/resources/qmc/fonts/../../../qrs/ReloadTask?xrfkey=1333333333333337&filter=.ttf`, supplying a dummy `X-Qlik-Session` cookie and `X-Qlik-Xrfkey` header. Detection succeeds when all three conditions match: HTTP 400 status, `X-Qlik-Session` present in the `Set-Cookie` header, and the response body contains the string "The comparison expression does not consist of three elements". This confirms the traversal succeeded and the request reached the protected /qrs/ReloadTask endpoint, proving anonymous-session generation and unauthorized API access.

## References
- https://community.qlik.com/t5/Official-Support-Articles/Critical-Security-fixes-for-Qlik-Sense-Enterprise-for-Windows/ta-p/2110801
- https://www.praetorian.com/blog/advisory-qlik-sense/
- https://www.praetorian.com/blog/qlik-sense-technical-exploit
- https://community.qlik.com/t5/Release-Notes/tkb-p/ReleaseNotes
- https://github.com/Ostorlab/KEV
