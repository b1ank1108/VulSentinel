---
cve_id: CVE-2023-28121
template_path: nuclei-templates/http/cves/2023/CVE-2023-28121.yaml
affected_product: WooCommerce Payments
severity: critical
authentication: none
external_callback: false
affected_versions: <=5.6.1
preconditions: WooCommerce Payments plugin activated on WordPress site
poc_classification: auth-bypass
---

## Vulnerability
A critical authentication bypass (CVE-2023-28121, CWE-287, CVSS 9.8) in the WooCommerce Payments WordPress plugin (versions 5.6.1 and lower) allows unauthenticated remote attackers to impersonate an elevated user (e.g. administrator). By supplying the `X-WCPAY-PLATFORM-CHECKOUT-USER: 1` header, attackers can issue privileged requests on behalf of an admin, specifically creating new administrator accounts via the WordPress REST API. This results in full site compromise, including data theft, modification, or complete takeover.

## PoC / Detection
Classification: auth-bypass

The template issues a single POST request to the site root (`/`) containing the bypass header `X-WCPAY-PLATFORM-CHECKOUT-USER: 1` and form-encoded data that registers a new user with `roles=administrator` via the `/wp/v2/users` REST endpoint. It confirms successful exploitation by matching HTTP status 201, `application/json` Content-Type header, and the presence of `"registered_date":`, `"username":`, and `"email":` fields in the response body. Random username, password, and email are generated on-the-fly and extracted from the matcher for immediate use.

## References
- https://github.com/gbrsh/CVE-2023-28121
- https://nvd.nist.gov/vuln/detail/CVE-2023-28121
- https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/
- https://woocommerce.com/products/woocommerce-payments/
- https://developer.woocommerce.com/2023/03/23/critical-vulnerability-detected-in-woocommerce-payments-what-you-need-to-know/
