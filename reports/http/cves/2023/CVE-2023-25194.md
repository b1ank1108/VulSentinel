---
cve_id: CVE-2023-25194
template_path: nuclei-templates/http/cves/2023/CVE-2023-25194.yaml
affected_product: Apache Druid Kafka Connect
severity: high
authentication: required
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache Druid Kafka Connect contains an unsafe deserialization vulnerability in the Kafka Connect REST API. When configuring a Kafka connector, the `sasl.jaas.config` property (used with SCRAM-SHA-256 and SASL_SSL) is processed without sanitization, allowing injection of a JndiLoginModule that triggers JNDI lookups. Authenticated remote attackers can achieve arbitrary code execution on the underlying server, leading to full compromise of the Druid data-analytics infrastructure. CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H). CWE-502: Deserialization of Untrusted Data.

## PoC / Detection
Classification: rce

The template sends a single raw POST request to `/druid/indexer/v1/sampler?for=connect` with a crafted JSON payload that defines a Kafka sampler spec. The payload embeds a malicious `sasl.jaas.config` value containing `com.sun.security.auth.module.JndiLoginModule` and an RMI URL pointing to `{{interactsh-url}}`. Detection is performed by matching on an out-of-band DNS interaction via interactsh, the string "RecordSupplier" appearing in the response body, and HTTP status code 400.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25194
- https://nvd.nist.gov/vuln/detail/CVE-2023-25194
- https://github.com/nbxiglk0/Note/blob/0ddc14ecd296df472726863aa5d1f0f29c8adcc4/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/Java/ApacheDruid/ApacheDruid%20Kafka-rce/ApacheDruid%20Kafka-rce.md#apachedruid-kafka-connect-rce
- http://packetstormsecurity.com/files/173151/Apache-Druid-JNDI-Injection-Remote-Code-Execution.html
- https://kafka.apache.org/cve-list
