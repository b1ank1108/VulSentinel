---
cve_id: CVE-2023-23488
template_path: nuclei-templates/http/cves/2023/CVE-2023-23488.yaml
affected_product: WordPress Paid Memberships Pro plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <2.9.8
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Paid Memberships Pro plugin versions before 2.9.8 contain a blind SQL injection vulnerability in the 'code' parameter of the `/pmpro/v1/order` REST API route. This vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8 (Critical). The flaw allows unauthenticated attackers to inject malicious SQL queries through the REST API endpoint without requiring any authentication or special configuration.

The vulnerability enables attackers to extract sensitive information from the database, modify data, and potentially execute unauthorized administrative operations within the context of the affected WordPress site. The blind nature of the SQL injection means attackers can infer database contents through time-based or boolean-based techniques even when direct error messages are not returned.

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection detection by sending a crafted GET request to the vulnerable REST API endpoint `/pmpro/v1/order` with a malicious payload in the 'code' parameter. The payload `a' OR (SELECT 1 FROM (SELECT(SLEEP(7)))a)-- -` attempts to trigger a 7-second delay through SQL injection.

The detection logic verifies three conditions:
1. The first request takes 7 seconds or longer to respond (indicating successful SQL injection)
2. The response status code is not 403 (to exclude false positives from Wordfence WAF blocking)
3. A second request confirms the plugin is installed by checking for the presence of `pmpro_updates` in the plugin's JavaScript file

The template uses a 30-second timeout to accommodate the intentional delay. This approach confirms both the presence of the vulnerable plugin and the exploitability of the SQL injection flaw without actually extracting data or modifying the database.

## References

- https://www.tenable.com/security/research/tra-2023-2
- https://wordpress.org/plugins/paid-memberships-pro/
- https://nvd.nist.gov/vuln/detail/CVE-2023-23488
- http://packetstormsecurity.com/files/171661/WordPress-Paid-Memberships-Pro-2.9.8-SQL-Injection.html
- https://github.com/CVEDB/PoC-List
