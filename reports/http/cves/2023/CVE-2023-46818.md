---
cve_id: CVE-2023-46818
template_path: nuclei-templates/http/cves/2023/CVE-2023-46818.yaml
affected_product: ISPConfig
severity: high
authentication: required
external_callback: false
affected_versions: before 3.2.11p1
preconditions: admin_allow_langedit enabled
poc_classification: rce
---

## Vulnerability
CVE-2023-46818: PHP code injection in ISPConfig language file editor (before 3.2.11p1) when `admin_allow_langedit` is enabled. Authenticated administrators can inject arbitrary PHP code via `/admin/language_edit.php`, write a webshell, and achieve full remote code execution with potential complete server compromise.

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (7.2 High)  
CWE-94: Improper Control of Generation of Code ('Code Injection')

## PoC / Detection
Classification: rce

The template executes a complete authenticated exploit chain using provided admin credentials:  
- Logs in via POST `/login/index.php` (extracts session cookies)  
- Creates temporary malicious `.lng` file via POST `/admin/language_edit.php` (extracts CSRF tokens + file location)  
- Injects payload `'];file_put_contents('{{random}}.php',base64_decode(...webshell...));die;#` to drop PHP webshell with `passthru(base64_decode($_SERVER['HTTP_C']))`  
- Triggers webshell via GET `/admin/{{random}}.php` with `C: {{base64(echo random-hash)}}` header and matches output  
- Cleans up by deleting language file + webshell via additional webshell requests (all steps chained via `flow: http(1) && ... && http(6)`)

## References
- https://www.ispconfig.org/blog/ispconfig-3-2-11p1-released/
- http://packetstormsecurity.com/files/176126/ISPConfig-3.2.11-PHP-Code-Injection.html
- http://seclists.org/fulldisclosure/2023/Dec/2
- https://nvd.nist.gov/vuln/detail/CVE-2023-46818
