---
cve_id: CVE-2023-22621
template_path: nuclei-templates/http/cves/2023/CVE-2023-22621.yaml
affected_product: Strapi
severity: high
authentication: required
external_callback: true
affected_versions: <=4.5.5
preconditions: Authenticated administrator access to the Strapi admin panel
poc_classification: rce
---

## Vulnerability
Strapi versions <=4.5.5 is affected by an authenticated Server-Side Template Injection (SSTI) in email templates that bypasses validation and leads to remote code execution. An attacker with admin-panel access can inject payloads (e.g., Node.js `process.binding('spawn_sync')` to spawn `/bin/sh curl`) into templates such as `email_confirmation` or `reset_password`, executing arbitrary system commands on the server.  
CVSS 3.1: 7.2 (High) · CWE-74 · Impact: full server compromise.

## PoC / Detection
Classification: rce

The template executes the full exploit chain for verification:  
- POST `/admin/login` with supplied admin credentials to obtain JWT token.  
- PUT `/users-permissions/advanced` to enable registration.  
- PUT `/users-permissions/email-templates` to overwrite the `email_confirmation` template with SSTI payload containing `{{interactsh-url}}`.  
- POST `/api/auth/local/register` with random user data to trigger template rendering and command execution.  
- Confirms success via DNS OOB interaction on interactsh and `ApplicationError` response.

## References
- https://github.com/strapi/strapi/releases
- https://github.com/sofianeelhor/CVE-2023-22621-POC
- https://github.com/strapi/security-patches
- https://github.com/ARPSyndicate/cvemon
- https://nvd.nist.gov/vuln/detail/CVE-2023-22621
