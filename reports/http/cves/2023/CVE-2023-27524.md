---
cve_id: CVE-2023-27524
template_path: nuclei-templates/http/cves/2023/CVE-2023-27524.yaml
affected_product: Apache Superset
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.0.1
preconditions: [default SECRET_KEY configuration not changed from installation defaults]
poc_classification: auth-bypass
---

## Vulnerability

CVE-2023-27524 is a critical authentication bypass vulnerability in Apache Superset affecting versions up to and including 2.0.1. The vulnerability stems from insecure default configuration where installations that have not altered the default SECRET_KEY value allow attackers to forge valid session tokens and authenticate without credentials. This is classified as CWE-1188 (Insecure Default Initialization of Resource) with a CVSS score of 9.8.

The vulnerability enables attackers to bypass authentication mechanisms entirely and access unauthorized resources by crafting session cookies using the predictable default SECRET_KEY. This does not affect installations where administrators have followed security best practices and changed the default SECRET_KEY configuration value during setup.

The vulnerability has been added to CISA's Known Exploited Vulnerabilities (KEV) catalog, indicating active exploitation in the wild. Successful exploitation allows complete unauthorized access to the Superset instance, potentially leading to sensitive data exposure and remote code execution capabilities.

## PoC / Detection

Classification: auth-bypass

The template detects this vulnerability by attempting to authenticate using pre-computed session tokens that are valid when the default SECRET_KEY is in use. It performs a clusterbomb attack testing multiple database endpoint paths (IDs 1-10) with five different pre-forged session cookies. These session tokens are crafted using the known default SECRET_KEY and encode `{"_user_id":1,"user_id":1}`, effectively impersonating the admin user (user_id 1).

The detection sends GET requests to `/api/v1/database/{id}` endpoints with forged session cookies in the Cookie header. A successful match occurs when the response returns HTTP 200 status and contains JSON fields `"database_name":` and `"configuration_method":`, indicating authenticated access to database configuration information that should only be available to authenticated administrators.

The template stops at the first successful match, confirming that the target is using the default SECRET_KEY and is vulnerable to authentication bypass.

## References

- https://github.com/horizon3ai/CVE-2023-27524
- https://www.horizon3.ai/cve-2023-27524-insecure-default-configuration-in-apache-superset-leads-to-remote-code-execution/
- https://nvd.nist.gov/vuln/detail/CVE-2023-27524
- http://packetstormsecurity.com/files/172522/Apache-Superset-2.0.0-Authentication-Bypass.html
- http://www.openwall.com/lists/oss-security/2023/04/24/2
