---
cve_id: CVE-2023-1317
template_path: nuclei-templates/http/cves/2023/CVE-2023-1317.yaml
affected_product: osTicket
severity: medium
authentication: required
external_callback: false
affected_versions: < v1.16.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-1317 is a reflected Cross-Site Scripting (XSS) vulnerability in osTicket versions prior to v1.16.6. The vulnerability exists in the organization search functionality accessible through the staff control panel (SCP). An authenticated attacker can inject malicious JavaScript code through the search query parameter (`q`) in the `/scp/ajax.php/orgs/search` endpoint. When the crafted payload is reflected in the response without proper sanitization, arbitrary JavaScript executes in the context of the victim's browser session.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (Medium severity). The attack vector is network-based with low attack complexity, but requires low-level privileges (authenticated user) and user interaction. The scope is changed, meaning the vulnerable component impacts resources beyond its security scope, with low confidentiality and integrity impact.

Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the victim's browser, potentially leading to session hijacking, credential theft, phishing attacks, or unauthorized actions performed on behalf of the victim within the osTicket application.

## PoC / Detection

Classification: info-leak

The Nuclei template performs authenticated detection of this XSS vulnerability through a three-step process:

1. **Initial reconnaissance**: Sends a GET request to `/scp/login.php` to verify the target is running osTicket and extracts the CSRF token required for authentication.

2. **Authentication**: Performs a POST request to `/scp/login.php` with user-provided credentials (`{{username}}` and `{{password}}`), including the extracted CSRF token to establish an authenticated session.

3. **Vulnerability verification**: Sends a GET request to `/scp/ajax.php/orgs/search` with a crafted XSS payload in the query parameter: `q=osTicket<img src=a onerror=alert(document.domain)>`. The template checks if the malicious payload is reflected unescaped in the HTML response by matching the presence of `<img src=a onerror=alert(document.domain)>` in the response body, along with a `text/html` content type and HTTP 200 status code.

The template uses a harmless proof-of-concept payload that would trigger a JavaScript alert displaying the document domain, demonstrating the XSS vulnerability without causing actual harm.

## References

- https://huntr.com/bounties/c3e27af2-358b-490b-9baf-e451663e4e5f
- https://nvd.nist.gov/vuln/detail/CVE-2023-1317
