---
cve_id: CVE-2023-3710
template_path: nuclei-templates/http/cves/2023/CVE-2023-3710.yaml
affected_product: Honeywell PM43 Printer Firmware
severity: critical
authentication: none
external_callback: false
affected_versions: < P10.19.050004
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2023-3710 is a critical command injection vulnerability in Honeywell PM43 printers caused by improper input validation. The vulnerability exists in the printer's web interface, specifically in the `loadfile.lp` module. Unauthenticated attackers can inject arbitrary operating system commands through the `username` parameter, allowing them to execute commands with the privileges of the web server process. This affects all PM43 printer firmware versions prior to P10.19.050004 (MR19.5).

The vulnerability is classified under CWE-77 (Improper Neutralization of Special Elements used in a Command) and CWE-20 (Improper Input Validation), with a CVSS v3.1 score of 9.8 (Critical). The attack vector is network-based, requires no authentication, low attack complexity, and no user interaction. Successful exploitation can result in complete compromise of confidentiality, integrity, and availability of the affected printer, potentially allowing attackers to intercept sensitive print jobs, modify printer configurations, or use the device as a pivot point within the network.

## PoC / Detection

Classification: rce

The Nuclei template detects this vulnerability by sending a POST request to `/loadfile.lp?pageid=Configure` with a crafted payload in the `username` parameter. The payload uses newline characters (`%0a`) to inject shell commands: `x%0aid;pwd;cat+/etc/*-release%0a`. This attempts to execute the `id`, `pwd`, and `cat /etc/*-release` commands on the target system.

The template confirms successful command injection by checking for three conditions:
1. The response body contains a regex pattern matching Unix user/group ID output: `uid=([0-9(a-z)]+) gid=([0-9(a-z)]+) groups=([0-9(a-z)]+)`
2. The response body contains the string "Release date" (indicating the `/etc/*-release` file was successfully read)
3. The HTTP response status is 200

This detection method verifies that arbitrary commands can be executed on the printer's operating system without authentication, confirming the presence of the remote code execution vulnerability.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-3710
- https://github.com/vpxuser/CVE-2023-3710-POC
- https://twitter.com/win3zz/status/1713451282344853634
- https://hsmftp.honeywell.com:443/en/Software/Printers/Industrial/PM23-PM23c-PM43-PM43c/Current/Firmware/firmwaresignedP1019050004
- https://hsmftp.honeywell.com:443/en/Software/Printers/Industrial/PM23-PM23c-PM43-PM43c/Current/Firmware/firmwarexasignedP1019050004A
