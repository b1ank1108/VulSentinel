---
cve_id: CVE-2023-34993
template_path: nuclei-templates/http/cves/2023/CVE-2023-34993.yaml
affected_product: Fortinet FortiWLM
severity: critical
authentication: none
external_callback: true
affected_versions: 8.6.0 through 8.6.5, 8.5.0 through 8.5.4
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2023-34993 is an unauthenticated OS command injection vulnerability in Fortinet FortiWLM. The vulnerability stems from improper neutralization of special elements used in OS commands (CWE-78) within the `ezrf_upgrade_images.cgi` endpoint. An attacker can inject arbitrary OS commands through the `progressfile` parameter without requiring authentication. Successful exploitation allows complete system compromise, enabling attackers to execute unauthorized code, bypass authentication mechanisms, and gain full control over the affected FortiWLM system. The vulnerability has a CVSS score of 9.8 (Critical) with an EPSS score of 0.86959, indicating high likelihood of active exploitation.

Affected versions include FortiWLM 8.6.0 through 8.6.5 and 8.5.0 through 8.5.4. Remediation requires upgrading to version 8.6.6 or later for the 8.6.x branch, or version 8.5.5 or later for the 8.5.x branch.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a GET request to the `/ems/cgi-bin/ezrf_upgrade_images.cgi` endpoint with crafted parameters. It exploits the command injection by injecting a curl command into the `progressfile` parameter that makes an HTTP callback to an Interactsh server. The payload uses command chaining (semicolon) to append `curl {{interactsh-url}}` after a random base filename, with a comment character (#) to neutralize any trailing command elements.

The template verifies successful exploitation by:
1. Confirming an HTTP callback is received from the target (interactsh_protocol contains "http")
2. Validating the User-Agent header in the callback matches "curl", proving the injected command executed

This detection method confirms the presence of unauthenticated remote code execution capability without causing destructive impact.

## References

- https://fortiguard.com/psirt/FG-IR-23-140
- https://www.horizon3.ai/attack-research/attack-blogs/fortiwlm-the-almost-story-for-the-forti-forty/
