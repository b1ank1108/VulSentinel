---
cve_id: CVE-2023-26469
template_path: nuclei-templates/http/cves/2023/CVE-2023-26469.yaml
affected_product: Jorani
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Jorani 1.0.0 contains a path-traversal vulnerability (CWE-22) in the login endpoint (`/session/login`). An unauthenticated remote attacker can supply a `language` parameter containing directory traversal (`../../application/logs`) combined with a malicious `login` value containing PHP code. The application logs the crafted input to a predictable log file, which is later interpreted and executed when the log is requested with a custom `X-REQUESTED-WITH` header matching the injected trigger.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Impact: full remote code execution on the server.  
Remediation: upgrade Jorani to a patched version.

## PoC / Detection
Classification: rce

The template executes a three-step chain:  
1. GET `/session/login` to extract the `csrf_test_jorani` token via regex.  
2. POST `/session/login` with `language=..%2F..%2Fapplication%2Flogs`, `login` set to a PHP payload (`<?php if(isset($_SERVER['HTTP_{{header}}'])){echo md5('CVE-2023-26469');unlink(__FILE__);} ?>`), and dummy credentials.  
3. GET `/pages/view/log-{{date_time("%Y-%M-%D")}}` supplying the random uppercase header value.  

Detection succeeds if the third response body contains `7cca0844e81cd333152def045fe075c2` (md5 of the trigger string) and the final status is 401.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-26469
- https://github.com/Orange-Cyberdefense/CVE-repository/blob/master/PoCs/CVE_Jorani.py
- https://github.com/advisories/GHSA-7r9h-9r47-7vjj
- http://packetstormsecurity.com/files/174248/Jorani-Remote-Code-Execution.html
- https://jorani.org/security-features-in-lms.html
