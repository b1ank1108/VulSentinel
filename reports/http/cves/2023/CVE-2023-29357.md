---
cve_id: CVE-2023-29357
template_path: nuclei-templates/http/cves/2023/CVE-2023-29357.yaml
affected_product: Microsoft SharePoint Server
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Microsoft SharePoint Server Elevation of Privilege Vulnerability (CVE-2023-29357). Unauthenticated attackers can bypass authentication by forging JWT tokens using the "none" algorithm. This grants access to SharePoint REST APIs (e.g. `/_api/web/siteusers`), enabling elevated privileges and exposure of sensitive documents, user information, and site configurations.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: auth-bypass

The template detects the vulnerability by:
- Sending an initial `GET /_api/web/siteusers` request with `Authorization: Bearer` (empty) and extracting the `realm` value from the `WWW-Authenticate` response header via regex.
- Constructing a second `GET /_api/web/siteusers` request using the fixed `client_id` `00000003-0000-0ff1-ce00-000000000000`, the extracted realm, and `generate_jwt(..., "none")` to produce forged tokens placed in both `Authorization: Bearer ...AAA` and `X-PROOF_TOKEN` headers.
- Confirming success via AND matcher on response body 2 containing the words `LoginName`, `Email`, and `IsSiteAdmin` (JSON site user data returned without valid credentials).

## References
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-29357
- https://srcincite.io/advisories/src-2020-0022/
- https://github.com/Chocapikk/CVE-2023-29357
- https://sec.vnpt.vn/2023/08/phan-tich-cve-2023-29357-microsoft-sharepoint-validatetokenissuer-authentication-bypass-vulnerability/
- https://starlabs.sg/blog/2023/09-sharepoint-pre-auth-rce-chain/
