---
cve_id: CVE-2023-51449
template_path: nuclei-templates/http/cves/2023/CVE-2023-51449.yaml
affected_product: Gradio
severity: high
authentication: none
external_callback: false
affected_versions: 3.0 to <3.33, 4.0 to 4.10
preconditions: [authentication must not be enabled]
poc_classification: info-leak
---

## Vulnerability

CVE-2023-51449 is a Local File Inclusion (LFI) vulnerability in Gradio, a Python framework for building machine learning web interfaces. The vulnerability affects Gradio versions 3.0 through 3.32 and versions 4.0 through 4.10. This flaw allows unauthenticated attackers to read arbitrary files from the server when authentication is not enabled on the Gradio instance.

The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS v3.1 score of 7.5 (High severity). The attack vector is network-based, requires low complexity, no privileges, and no user interaction. The primary impact is on confidentiality, potentially exposing sensitive configuration files, credentials, and other system files.

The vulnerability is particularly concerning for Gradio instances deployed on platforms like Hugging Face Spaces, where it could be exploited to steal secrets and sensitive data from machine learning applications.

## PoC / Detection

Classification: info-leak

The Nuclei template performs a two-step detection process to verify the LFI vulnerability:

1. **File Upload**: The template first sends a POST request to `/upload` with a multipart form-data payload containing a file with a random 8-character string as content. This upload operation returns a download path that the template extracts using regex pattern matching.

2. **Path Traversal Exploitation**: Using the extracted download path, the template sends a GET request to `/file={{download_path}}{{path}}` with path traversal payloads attempting to access:
   - Windows: `..\..\..\..\..\..\..\..\..\..\..\..\..\..\windows\win.ini`
   - Linux: `../../../../../../../../../../../../../../../etc/passwd`

The template confirms successful exploitation by matching:
- Content from `/etc/passwd` (lines matching `root:.*:0:0:`)
- Content from `win.ini` (sections like `[fonts]`, `[extensions]`, or `[files]`)
- Response content-type of `text/plain`
- HTTP status code 200

The detection is marked as intrusive and stops at the first successful match.

## References

- https://www.horizon3.ai/attack-research/disclosures/exploiting-file-read-vulnerabilities-in-gradio-to-steal-secrets-from-hugging-face-spaces/
- https://github.com/gradio-app/gradio/security/advisories/GHSA-6qm2-wpxq-7qh2
- https://nvd.nist.gov/vuln/detail/CVE-2023-51449
