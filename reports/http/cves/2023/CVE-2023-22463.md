---
cve_id: CVE-2023-22463
template_path: nuclei-templates/http/cves/2023/CVE-2023-22463.yaml
affected_product: KubePi
severity: critical
authentication: none
external_callback: false
affected_versions: â‰¤1.6.2
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2023-22463 is a critical authentication bypass vulnerability in KubePi, a Kubernetes management panel. The vulnerability stems from the use of a hard-coded JWT signing key (`JwtSigKey`) in the authentication mechanism through version 1.6.2. Since all KubePi installations share the same hard-coded signing key, an attacker can forge arbitrary JWT tokens to impersonate any user, including administrators, without requiring valid credentials.

The hard-coded key is present in `session.go` and allows attackers to craft valid JWT tokens that the application will accept as legitimate. This enables complete takeover of the administrator account on any vulnerable KubePi instance, which in turn can lead to unauthorized control of the underlying Kubernetes cluster managed by the compromised panel.

The vulnerability is classified as CWE-798 (Use of Hard-coded Credentials) with a CVSS score of 9.8, indicating critical severity with network-based attack vector, low complexity, and no privileges or user interaction required.

## PoC / Detection

Classification: auth-bypass

The template exploits the authentication bypass by using a pre-forged JWT token with administrator privileges. The token contains claims indicating `"isAdministrator": true` and is signed with the known hard-coded key. The template sends a POST request to `/kubepi/api/v1/users` with this forged token in the Authorization header, attempting to create a new administrative user account with randomly generated credentials.

The detection verifies successful exploitation by checking for:
- HTTP 200 status response
- JSON content type in the response header
- Response body containing user creation confirmation fields (`"password":`, `"isAdmin":`, `"createAt":`)

The successful creation of an administrative user account without valid authentication credentials confirms the presence of the hard-coded JWT signing key vulnerability.

## References

- https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/KubePi/KubePi%20JwtSigKey%20%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2023-22463.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-22463
- https://github.com/KubeOperator/KubePi/blob/da784f5532ea2495b92708cacb32703bff3a45a3/internal/api/v1/session/session.go#L35
- https://github.com/KubeOperator/KubePi/commit/3be58b8df5bc05d2343c30371dd5fcf6a9fbbf8b
- https://github.com/KubeOperator/KubePi/releases/tag/v1.6.3
