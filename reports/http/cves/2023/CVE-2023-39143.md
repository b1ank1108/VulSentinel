---
cve_id: CVE-2023-39143
template_path: nuclei-templates/http/cves/2023/CVE-2023-39143.yaml
affected_product: PaperCut
severity: critical
authentication: none
external_callback: false
affected_versions: < 22.1.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
PaperCut NG and PaperCut MF before 22.1.3 are vulnerable to path traversal (CWE-22, CVSS 9.8 Critical, AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Unauthenticated remote attackers can read, delete, and upload arbitrary files on the server filesystem, leading to sensitive data exposure or potential remote code execution.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing a single unauthenticated GET request to `{{BaseURL}}/custom-report-example/..\\..\\..\\deployment\\sharp\\icons\\home-app.png` (using Windows-style backslash traversal) and confirming successful file retrieval via combined matchers: HTTP 200 status, exact Content-Length 1655, Content-Type containing "image/png", and PNG magic bytes (89504e470d0a1a0a) present in the hex-encoded body.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-39143
- https://www.horizon3.ai/cve-2023-39143-papercut-path-traversal-file-upload-rce-vulnerability/
- https://www.papercut.com/kb/Main/securitybulletinjuly2023/
- https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-131a
- https://github.com/nomi-sec/PoC-in-GitHub
