---
cve_id: CVE-2023-48022
template_path: nuclei-templates/http/cves/2023/CVE-2023-48022.yaml
affected_product: Anyscale Ray
severity: critical
authentication: none
external_callback: false
affected_versions: 2.6.3 and 2.8.0
preconditions: network access to the Ray Dashboard API
poc_classification: rce
---

## Vulnerability
Anyscale Ray 2.6.3 and 2.8.0 contain a remote code execution vulnerability (CVE-2023-48022, CWE-78) due to insecure job submission API in the Ray Dashboard. Unauthenticated attackers with network access to the Ray Dashboard API can execute arbitrary code remotely as root, leading to complete system compromise.  
CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: Upgrade to version 2.6.4 or later, or version 2.8.1 or later, and restrict network access to the Ray Dashboard API.

## PoC / Detection
Classification: rce  
The template detects the vulnerability by submitting a job via POST /api/jobs/ with entrypoint set to the benign command "id" and a random submission_id, issuing a GET / after an 8-second wait ({{wait_for(8)}}), then retrieving logs via GET /api/jobs/{{jobid}}/logs. It matches on status_code 200, JSON content containing "logs":, and regex("uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)", body) to confirm command execution output.

## References
- https://bishopfox.com/blog/ray-versions-2-6-3-2-8-0
- https://vulncheck.com/xdb/497d7fb3b118
- https://github.com/jakabakos/ShadowRay-RCE-PoC-CVE-2023-48022
- https://vulncheck.com/xdb/d3bafad9c9f6
- https://github.com/0x656565/CVE-2023-48022
- https://nvd.nist.gov/vuln/detail/cve-2023-48022
