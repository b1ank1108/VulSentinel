---
cve_id: CVE-2023-2734
template_path: nuclei-templates/http/cves/2023/CVE-2023-2734.yaml
affected_product: MStore API
severity: critical
authentication: none
external_callback: false
affected_versions: <= 3.9.1
preconditions: [Attacker must have access to a valid user ID on the target WordPress site]
poc_classification: auth-bypass
---

## Vulnerability

The MStore API plugin for WordPress versions up to and including 3.9.1 contains an authentication bypass vulnerability. The flaw exists due to insufficient verification of the user being supplied during cart synchronization from mobile REST API requests. This allows unauthenticated attackers to log in as any existing user on the site, including administrators, if they have access to the user ID. The vulnerability is classified as CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) with a CVSS score of 9.8, indicating critical severity. Successful exploitation grants attackers full control over the compromised account, potentially leading to complete site takeover if an administrator account is targeted.

## PoC / Detection

Classification: auth-bypass

The template performs a three-stage detection process:

1. **User Enumeration**: Attempts to retrieve user information via WordPress REST API endpoints (`/wp-json/wp/v2/users` or `?rest_route=/wp/v2/users`) to extract a valid user ID from the response.

2. **Authentication Bypass Exploitation**: Sends a POST request to `/wp-json/api/flutter_woo/cart` with a JSON payload containing the extracted user ID (`{"customer_id":<user_id>}`). This triggers the vulnerable cart sync functionality that improperly authenticates the user without proper verification.

3. **Verification**: Attempts to access the WordPress admin dashboard (`/wp-admin/index.php`) to confirm successful authentication. The template checks for the presence of dashboard elements ("Dashboard", "Plugins", "Edit Profile") and verifies that a `wordpress_logged_in_` cookie was set during the cart sync request, confirming the authentication bypass was successful.

## References

- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/mstore-api/mstore-api-391-authentication-bypass
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2915729%40mstore-api&old=2913397%40mstore-api&sfp_email=&sfph_mail=#file59
- https://nvd.nist.gov/vuln/detail/CVE-2023-2734
