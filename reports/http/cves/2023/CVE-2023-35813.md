---
cve_id: CVE-2023-35813
template_path: nuclei-templates/http/cves/2023/CVE-2023-35813.yaml
affected_product: Sitecore Experience Manager/Platform/Commerce
severity: critical
authentication: none
external_callback: false
affected_versions: through 10.3
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2023-35813 is a critical remote code execution vulnerability affecting multiple Sitecore products including Experience Manager, Experience Platform, and Experience Commerce through version 10.3. The vulnerability exists in the XAML parser component, which fails to properly sanitize user-supplied input before processing it. Unauthenticated attackers can exploit this flaw by injecting malicious ASP.NET markup through the XAML parser, allowing them to execute arbitrary code on the Sitecore server. This can lead to complete compromise of the content management system and unauthorized access to sensitive customer data. The vulnerability is associated with CWE-22 (Path Traversal) and CWE-23 (Relative Path Traversal), with a CVSS score of 9.8. The EPSS score of 0.93522 (99.821 percentile) indicates a very high probability of active exploitation in the wild.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a crafted POST request to the `/sitecore_xaml.ashx/-/xaml/Sitecore.Xaml.Tutorials.Styles.Index` endpoint. The payload exploits the XAML parser by injecting a malicious ASP.NET control registration that references the `System.Runtime.Remoting.Services` namespace. The injected XAML markup includes a `RemotingService` control with a custom `Context-Response-ContentType` property set to a randomly generated string. This payload is URL-encoded and passed through the `ParseControl()` function via the `__PARAMETERS` POST parameter.

The template verifies successful exploitation by checking three conditions: (1) the HTTP response Content-Type header contains the randomly generated string (proving the injected XAML was parsed and executed), (2) the response body contains specific keywords ('commands', 'command', 'value') indicating successful XAML processing, and (3) the HTTP status code is 200. The presence of the random string in the Content-Type header confirms that arbitrary ASP.NET code execution occurred through the XAML parser.

## References

- https://support.sitecore.com/kb?id=kb_article_view\u0026sysparm_article=KB1002979
- https://code-white.com/blog/exploiting-asp.net-templateparser-part-1/
- https://nvd.nist.gov/vuln/detail/CVE-2023-35813
- https://support.sitecore.com/kb?id=kb_article_view&sysparm_article=KB1002979
- https://github.com/BagheeraAltered/CVE-2023-35813-PoC
