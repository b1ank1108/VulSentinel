---
cve_id: CVE-2023-35843
template_path: nuclei-templates/http/cves/2023/CVE-2023-35843.yaml
affected_product: NocoDB
severity: high
authentication: none
external_callback: false
affected_versions: <= 0.106.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
NocoDB through version 0.106.1 contains a path traversal vulnerability (CWE-22) in the `/download` route's path parameter handling within attachment controllers. An unauthenticated remote attacker can manipulate the path to read arbitrary files on the server filesystem (e.g., configuration files, source code, credentials, database contents).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact includes high-confidentiality data exposure.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing a single GET request to `{{BaseURL}}/download/{{repeat('..%2F', 5)}}etc%2Fpasswd` (five levels of encoded directory traversal targeting `/etc/passwd`) and confirms success with an AND matcher requiring HTTP status 200 plus regex match for the pattern `root:[x*]:0:0`.

## References
- https://advisory.dw1.io/60
- https://nvd.nist.gov/vuln/detail/CVE-2023-35843
- https://github.com/nocodb/nocodb/blob/6decfa2b20c28db9946bddce0bcb1442b683ecae/packages/nocodb/src/lib/controllers/attachment.ctl.ts#L62-L74
- https://github.com/nocodb/nocodb/blob/f7ee7e3beb91d313a159895d1edc1aba9d91b0bc/packages/nocodb/src/controllers/attachments.controller.ts#L55-L66
- https://github.com/0x783kb/Security-operation-book
