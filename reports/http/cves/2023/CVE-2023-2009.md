---
cve_id: CVE-2023-2009
template_path: nuclei-templates/http/cves/2023/CVE-2023-2009.yaml
affected_product: WordPress Pretty Url plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 1.5.4
preconditions: [High-privilege user account (administrator or similar role with access to plugin settings), WordPress multisite setup where unfiltered_html capability is typically restricted]
poc_classification: state-change
---

## Vulnerability

CVE-2023-2009 is a Stored Cross-Site Scripting (XSS) vulnerability in the Pretty Url WordPress plugin affecting versions 1.5.4 and earlier. The vulnerability exists due to insufficient sanitization and escaping of the URL field in the plugin's settings page. This allows high-privilege authenticated users (administrators) to inject malicious JavaScript code that persists in the database and executes when other users view the affected settings page.

The vulnerability is particularly significant in WordPress multisite environments where the `unfiltered_html` capability is typically disabled for security reasons. Even with this restriction in place, attackers with high-privilege access can exploit this flaw to perform stored XSS attacks, potentially compromising other administrator accounts or escalating privileges within the WordPress installation.

The flaw is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 4.8 (AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N), indicating medium severity with requirements for high privileges and user interaction.

## PoC / Detection

Classification: state-change

The Nuclei template performs an authenticated exploitation test that both verifies the vulnerability and demonstrates the stored XSS condition:

1. **Authentication**: Sends a POST request to `/wp-login.php` with administrator credentials to establish an authenticated session
2. **Settings Page Access**: Retrieves the Pretty Url plugin settings page at `/wp-admin/admin.php?page=prettyurls` and extracts the WordPress nonce token required for CSRF protection
3. **XSS Injection**: Submits a POST request to the plugin settings endpoint with a malicious payload in the `url` parameter: `<img src=x onerror=alert(document.domain)>`. This payload attempts to inject a stored XSS vector into the plugin configuration
4. **Verification**: Confirms successful exploitation by checking that the response contains the injected payload verbatim in the HTML output, indicating the malicious script was stored without proper sanitization and is reflected back in the settings page

The template validates exploitation through three conditions: HTTP 200 response, presence of the injected XSS payload in the response body, and confirmation that the response is from the prettyurls settings page.

## References

- https://wpscan.com/vulnerability/f7988a18-ba9d-4ead-82c8-30ea8223846f
- https://nvd.nist.gov/vuln/detail/CVE-2023-2009
- https://wordpress.org/plugins/pretty-url/
