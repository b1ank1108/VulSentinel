---
cve_id: CVE-2023-5360
template_path: nuclei-templates/http/cves/2023/CVE-2023-5360.yaml
affected_product: WordPress Royal Elementor Addons Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 1.3.78
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Royal Elementor Addons plugin versions <= 1.3.78 contains an arbitrary file upload vulnerability (CWE-434) via the `wpr_addons_upload_file` admin-ajax action. Unauthenticated attackers can upload arbitrary files (including PHP webshells disguised with .ph$p extension) to `/wp-content/uploads/wpr-addons/forms/`, leading to remote code execution and full site compromise.

CVSS 3.1 score: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Fixed in 1.3.79.

## PoC / Detection
Classification: rce

The template detects the vulnerability through a multi-step process:
- Issues a GET request to `/` to extract the publicly available `wpr_addons_nonce` value from the `WprConfig` JavaScript object in the HTML response.
- Sends a crafted multipart/form-data POST to `/wp-admin/admin-ajax.php?action=wpr_addons_upload_file`, uploading a test PHP payload (echoing an MD5 hash and self-deleting) with a `.ph$p` filename and `allowed_file_types=ph$p`.
- Performs a final GET to the uploaded file location (`/wp-content/uploads/wpr-addons/forms/{random}.php`) and matches for the expected MD5 string to confirm successful upload and execution of the PHP code.

## References
- https://wordpress.org/plugins/royal-elementor-addons/
- https://wpscan.com/vulnerability/281518ff-7816-4007-b712-63aed7828b34/
- https://nvd.nist.gov/vuln/detail/CVE-2023-5360
- http://packetstormsecurity.com/files/175992/WordPress-Royal-Elementor-Addons-And-Templates-Remote-Shell-Upload.html
