---
cve_id: CVE-2023-50290
template_path: nuclei-templates/http/cves/2023/CVE-2023-50290.yaml
affected_product: Apache Solr
severity: medium
authentication: none
external_callback: false
affected_versions: < 9.3.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Apache Solr Metrics API exposes all unprotected host environment variables via the `/solr/admin/metrics` endpoint. The Solr Metrics API publishes environment variables available to each Apache Solr instance; users can specify which to hide, however the default list is designed only for known secret Java system properties. Environment variables cannot be strictly defined in Solr (unlike Java system properties which are set per-Java-process) and may be set for the entire host. This leads to exposure of sensitive information to an unauthorized actor.

## PoC / Detection
Classification: info-leak

The template performs a single GET request to `{{BaseURL}}/solr/admin/metrics` and matches on a 200 status code, `application/json` Content-Type header, and JSON body containing `"responseHeader":`, `"solr.jetty":`, and `system.env` (all required) to confirm the environment-variable leak.

## References
- https://solr.apache.org/security.html#cve-2023-50290-apache-solr-allows-read-access-to-host-environment-variables
- https://x.com/sirifu4k1/status/1746755165066236216?s=20
- https://nvd.nist.gov/vuln/detail/CVE-2023-50290
- https://github.com/wy876/POC
- https://github.com/wy876/wiki
