---
cve_id: CVE-2023-34960
template_path: nuclei-templates/http/cves/2023/CVE-2023-34960.yaml
affected_product: Chamilo
severity: critical
authentication: none
external_callback: false
affected_versions: v1.11.* up to v1.11.18
preconditions: []
poc_classification: rce
---

## Vulnerability

Chamilo LMS versions 1.11.* up to 1.11.18 contain a critical command injection vulnerability in the wsConvertPpt component. The vulnerability exists in a SOAP API endpoint that processes PowerPoint file conversions. Attackers can inject arbitrary operating system commands through a crafted PowerPoint filename parameter in SOAP API calls to `/main/webservices/additional_webservices.php`. The vulnerability is classified as CWE-77 (Improper Neutralization of Special Elements used in a Command) and has a CVSS score of 9.8, indicating critical severity with network-based attack vector, low attack complexity, and no authentication or user interaction required.

Successful exploitation allows attackers to execute arbitrary system commands on the server, leading to unauthorized access, data leakage, and potential complete system compromise. The EPSS score of 0.93989 (99.886th percentile) indicates this vulnerability is highly likely to be exploited in the wild.

## PoC / Detection

Classification: rce

The template detects this command injection vulnerability by sending a SOAP API request to the `/main/webservices/additional_webservices.php` endpoint. The request invokes the `wsConvertPpt` web service method with a maliciously crafted `file_name` parameter containing command injection payloads: `` `{}`.pptx'|" |cat /etc/passwd||a # ``. This payload attempts to break out of the expected filename context and execute the `cat /etc/passwd` command.

The template verifies successful exploitation by checking for three conditions:
1. The response body contains the regex pattern `root:.*:0:0:` (indicating `/etc/passwd` contents were returned)
2. The response Content-Type header is `text/xml`
3. The HTTP status code is 200

The detection confirms that arbitrary commands can be executed through the vulnerable SOAP endpoint without authentication.

## References

- https://sploitus.com/exploit?id=FD666992-20E1-5D83-BA13-67ED38E1B83D
- https://github.com/Aituglo/CVE-2023-34960/blob/master/poc.py
- http://chamilo.com
- http://packetstormsecurity.com/files/174314/Chamilo-1.11.18-Command-Injection.html
- https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-112-2023-04-20-Critical-impact-High-risk-Remote-Code-Execution
