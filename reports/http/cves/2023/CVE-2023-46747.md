---
cve_id: CVE-2023-46747
template_path: nuclei-templates/http/cves/2023/CVE-2023-46747.yaml
affected_product: F5 BIG-IP
severity: critical
authentication: none
external_callback: false
affected_versions: BIG-IP 17.1.0, 16.1.0 - 16.1.4, 15.1.0 - 15.1.10, 14.1.0 - 14.1.5, and 13.1.0 - 13.1.5
preconditions: []
poc_classification: rce
---

## Vulnerability
F5 BIG-IP Configuration utility (TMUI) is affected by CVE-2023-46747: unauthenticated authentication bypass via AJP request smuggling that leads to remote code execution. CVSSv3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-306, CWE-288. Unauthenticated remote attacker can create admin user, change password, obtain auth token, and execute arbitrary commands on the BIG-IP system.

## PoC / Detection
Classification: rce
Template exploits the flaw in a multi-step chain: (1) POST /tmui/login.jsp with Transfer-Encoding: chunked,chunked smuggling an embedded AJP request (hex-encoded) to create a new admin user (random hex username/password); (2) PATCH /mgmt/tm/auth/user/<user> with Basic auth to set new password; (3) POST /mgmt/shared/authn/login to obtain X-F5-Auth-Token; (4) POST /mgmt/tm/util/bash with token running `id`. Success confirmed by regex match on "commandResult" containing "uid=" in final response.

## References
- https://www.praetorian.com/blog/refresh-compromising-f5-big-ip-with-request-smuggling-cve-2023-46747/
- https://my.f5.com/manage/s/article/K000137353
- http://packetstormsecurity.com/files/175673/F5-BIG-IP-TMUI-AJP-Smuggling-Remote-Command-Execution.html
- https://www.secpod.com/blog/f5-issues-warning-big-ip-vulnerability-used-in-active-exploit-chain/
- https://github.com/f1tao/awesome-iot-security-resource
