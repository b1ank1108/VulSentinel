---
cve_id: CVE-2023-33629
template_path: nuclei-templates/http/cves/2023/CVE-2023-33629.yaml
affected_product: H3C Magic R300-2100M
severity: high
authentication: required
external_callback: false
affected_versions: R300-2100MV100R004
preconditions: [high-privilege authentication required]
poc_classification: rce
---

## Vulnerability
H3C Magic R300-2100M firmware version R300-2100MV100R004 contains a stack overflow in the DeltriggerList interface at `/goform/aspForm`. Command injection is possible via the DelL2tpLNSList parameter in the `param` field. Authenticated high-privilege attackers can execute arbitrary commands with root privileges. CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (7.2). CWE-787.

## PoC / Detection
Classification: rce

The template sends a POST request to `/goform/aspForm` with `CMD=DelL2tpLNSList&GO=vpn_l2tp_session.asp&param=1; $(ls>/www/{{filename}});` (random 7-char lowercase filename) and expects HTTP 302 containing `do_cmd.asp`. It then issues a GET to `/{{filename}}` and matches HTTP 200 with body containing both `www` and `www_multi` to confirm the `ls` command executed and the file was written to the web root.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-33629
- https://hackmd.io/@0dayResearch/r1UjggZfh
- https://hackmd.io/%400dayResearch/r1UjggZfh
- https://github.com/20142995/sectool
