---
cve_id: CVE-2023-31548
template_path: nuclei-templates/http/cves/2023/CVE-2023-31548.yaml
affected_product: ChurchCRM
severity: medium
authentication: required
external_callback: false
affected_versions: 4.5.3
preconditions: [authenticated user with permissions to edit FundRaisers]
poc_classification: state-change
---

## Vulnerability
A stored Cross-Site Scripting (XSS) vulnerability in the FundRaiserEditor.php component of ChurchCRM v4.5.3 allows authenticated attackers to inject arbitrary web scripts or HTML via a crafted payload in the Title field of a fundraiser submission. The malicious input is stored server-side without sanitization and reflected in subsequent HTML responses viewed by other users.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4, CWE-79).

## PoC / Detection
Classification: state-change

The template first authenticates by sending POST /session/begin with `User={{username}}&Password={{password}}`, then issues POST /FundRaiserEditor.php?linkBack=&FundRaiserID=-1 containing `FundRaiserSubmit=Save&Date=2023-06-24&Title=%22+onfocus%3D%22alert%28document.domain%29%22+autofocus%3D%22&Description=test`. Detection confirms the vulnerability if response 2 returns status_code 200, text/html content-type, the exact unsanitized payload string `onfocus="alert(document.domain)" autofocus=""></td>` in body_2, and the string `ChurchCRM`.

## References
- https://github.com/10splayaSec/CVE-Disclosures/tree/main/ChurchCRM/CVE-2023-31548
- https://nvd.nist.gov/vuln/detail/CVE-2023-31548
- https://github.com/10splayaSec/CVE-Disclosures
