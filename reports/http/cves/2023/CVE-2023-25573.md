---
cve_id: CVE-2023-25573
template_path: nuclei-templates/http/cves/2023/CVE-2023-25573.yaml
affected_product: Metersphere
severity: high
authentication: none
external_callback: false
affected_versions: prior to 1.20.20 LTS and 2.7.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Metersphere open source continuous testing platform contains an improper access control vulnerability (CWE-862) in the `/api/jmeter/download/files` endpoint. This allows any unauthenticated attacker to download arbitrary files from the filesystem accessible to the running process, potentially exposing sensitive data like configuration files and credentials (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, score 7.5).

## PoC / Detection
Classification: info-leak

The template performs detection by sending a raw POST request to `/api/jmeter/download/files` with JSON body `{"reportId":"{{rand_base(4)}}","bodyFiles":[{"id":"{{rand_base(3)}}","name":"/etc/passwd"}]}`. It matches for the string '/etc/passwd' in the body, presence of 'filename="{{rand_base(4)}}.zip"' AND 'application/octet-stream' in headers, and HTTP status code 200.

## References
- https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Metersphere%20file%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2023-25573.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-25573
- https://github.com/metersphere/metersphere/security/advisories/GHSA-mcwr-j9vm-5g8h
- https://github.com/20142995/sectool
- https://github.com/KayCHENvip/vulnerability-poc
