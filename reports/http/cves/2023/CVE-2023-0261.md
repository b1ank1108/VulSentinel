---
cve_id: CVE-2023-0261
template_path: nuclei-templates/http/cves/2023/CVE-2023-0261.yaml
affected_product: WordPress WP TripAdvisor Review Slider plugin
severity: high
authentication: required
external_callback: false
affected_versions: <10.8
preconditions: [User account with subscriber role or higher required]
poc_classification: info-leak
---

## Vulnerability

WordPress WP TripAdvisor Review Slider plugin versions before 10.8 contain an authenticated SQL injection vulnerability. The plugin fails to properly sanitize and escape a parameter before using it in a SQL statement, allowing SQL injection attacks by users with roles as low as subscriber. The vulnerability exists in the `parse-media-shortcode` AJAX action handler, which processes the `shortcode` parameter containing a `tid` attribute without adequate input validation.

Successful exploitation enables authenticated attackers to execute arbitrary SQL queries against the WordPress database. This can result in unauthorized access to sensitive information (including user credentials, personal data, and site configuration), modification of database records, and potential privilege escalation to administrative access. The low privilege requirement (subscriber role) significantly increases the attack surface, as subscriber accounts are commonly available through public registration on WordPress sites.

The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS v3.1 score of 8.8 (High severity), indicating network-based exploitation with low attack complexity, requiring low privileges and no user interaction.

## PoC / Detection

Classification: info-leak

The template performs time-based blind SQL injection detection through the following steps:

1. **Authentication**: Sends a POST request to `/wp-login.php` with username and password credentials to establish an authenticated WordPress session
2. **SQL Injection Probe**: Sends a POST request to `/wp-admin/admin-ajax.php` with:
   - Action: `parse-media-shortcode`
   - Payload: `[wptripadvisor_usetemplate tid="1 AND (SELECT 42 FROM (SELECT(SLEEP(6)))b)"]`
   - The payload injects a SQL SLEEP(6) command into the `tid` parameter

The template confirms the vulnerability by verifying:
- Response time is 6 seconds or greater (indicating successful SQL execution delay)
- HTTP status code 200
- Content-Type header contains "application/json"
- Response body contains `"data":{` (expected JSON structure)

The time-based approach confirms SQL injection without requiring visible error messages or data extraction, making it effective against blind SQL injection scenarios.

## References

- https://wpscan.com/vulnerability/6a3b6752-8d72-4ab4-9d49-b722a947d2b0
- https://wordpress.org/plugins/wp-tripadvisor-review-slider/
- https://nvd.nist.gov/vuln/detail/CVE-2023-0261
- https://github.com/ARPSyndicate/cvemon
