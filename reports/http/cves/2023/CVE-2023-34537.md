---
cve_id: CVE-2023-34537
template_path: nuclei-templates/http/cves/2023/CVE-2023-34537.yaml
affected_product: Hoteldruid
severity: medium
authentication: required
external_callback: false
affected_versions: 3.0.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Hoteldruid 3.0.5 (digitaldruid) is affected by CVE-2023-34537 (CWE-79), a reflected cross-site scripting vulnerability.  
**CVSS v3.1:** 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
An attacker can supply a malicious payload in an affected parameter (e.g., `tipotariffa`) to inject and execute arbitrary JavaScript in the victim's browser context. Successful exploitation enables data theft, session hijacking, or page defacement. Remediation requires upgrading to a patched release. Metadata confirms the exact vulnerable version via CPE `cpe:2.3:a:digitaldruid:hoteldruid:3.0.5:*:*:*:*:*:*:*`.

## PoC / Detection
Classification: info-leak  

The template detects the flaw with a two-request authenticated flow. It first POSTs valid credentials (`nome_utente_phpr`/`password_phpr`) to `/inizio.php` to establish a session, then immediately POSTs to `/creaprezzi.php` embedding the XSS payload `a19yc"><script>alert(document.domain)</script>mjf9oc2183m` inside the `tipotariffa` form field. It asserts success when the second response returns HTTP 200, `text/html` content-type, the literal unsanitized `<script>alert(document.domain)</script>` string, and the string "HotelDruid" in the body.

## References
- https://github.com/leekenghwa/CVE-2023-34537---XSS-reflected--found-in-HotelDruid-3.0.5
- https://nvd.nist.gov/vuln/detail/CVE-2023-34537
- https://github.com/ARPSyndicate/cvemon
- https://github.com/nomi-sec/PoC-in-GitHub
