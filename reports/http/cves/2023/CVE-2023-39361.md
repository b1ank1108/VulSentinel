---
cve_id: CVE-2023-39361
template_path: nuclei-templates/http/cves/2023/CVE-2023-39361.yaml
affected_product: Cacti
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.2.25
preconditions: guest users enabled
poc_classification: state-change
---

## Vulnerability
Cacti is an open-source operational monitoring and fault management framework. Versions prior to 1.2.25 are vulnerable to SQL injection in `graph_view.php` (parameter `rfilter`). Guest users can access the endpoint without authentication by default when enabled, allowing unauthenticated attackers to execute arbitrary SQL queries. Exploitation may result in data leakage, data manipulation, administrative privilege usurpation, or remote code execution. Fixed in 1.2.25; no workarounds exist.

## PoC / Detection
Classification: state-change

The template issues a single raw GET request to `/graph_view.php?action=tree_content&node=1-1-tree_anchor&rfilter=%22or+%22%22%3D%22%28%28%22%29%29%3BSELECT+SLEEP%2810%29%3B--+-` (time-based blind SQLi payload triggering `SLEEP(10)`). Detection matches when response duration is >=10 seconds, status_code is 200, and body contains both "Tree Mode" and "cacti".

## References
- https://github.com/Cacti/cacti/security/advisories/GHSA-6r43-q2fw-5wrg
- https://nvd.nist.gov/vuln/detail/CVE-2023-39361
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CFH3J2WVBKY4ZJNMARVOWJQK6PSLPHFH/
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WZGB2UXJEUYWWA6IWVFQ3ZTP22FIHMGN/
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WOQFYGLZBAWT4AWNMO7DU73QXWPXTCKH/
