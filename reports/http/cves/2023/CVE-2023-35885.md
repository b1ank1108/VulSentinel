---
cve_id: CVE-2023-35885
template_path: nuclei-templates/http/cves/2023/CVE-2023-35885.yaml
affected_product: CloudPanel
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.3.1
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2023-35885 is a critical remote code execution vulnerability in CloudPanel 2 versions prior to 2.3.1. The vulnerability stems from insecure file-manager cookie authentication that allows attackers to bypass authentication controls. The flaw enables unauthorized attackers to leverage the file manager functionality to create and execute arbitrary PHP files on the target system, leading to complete system compromise. The vulnerability has a CVSS score of 9.8 (Critical) and an EPSS score of 0.94122 (99.909th percentile), indicating active exploitation in the wild. The vulnerability is classified under CWE-565 (Reliance on Cookies without Validation and Integrity Checking).

## PoC / Detection

Classification: rce

The template exploits the vulnerability through a multi-step attack chain that demonstrates remote code execution capability:

1. **Initial Access**: Sends a GET request to `/file-manager/` with a hardcoded session cookie (`clp-fm`) that bypasses authentication due to insecure cookie validation
2. **File Creation**: Creates a new PHP file with a random name in `/htdocs/app/files/public/` directory using the file manager's `makefile` endpoint
3. **Code Injection**: Writes malicious PHP code to the created file via the `text` endpoint. The payload executes `md5()` on a test string and then deletes itself using `unlink(__FILE__)`
4. **Permission Modification**: Sets file permissions to 0777 using the `permissions` endpoint to ensure executability
5. **Execution Verification**: Accesses the created PHP file directly via HTTP GET request and verifies successful code execution by matching the MD5 hash output

The template confirms RCE by detecting the expected MD5 hash in the response body, proving arbitrary PHP code execution on the target system.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-35885
- https://www.datack.my/fallingskies-cloudpanel-0-day/
- https://github.com/datackmy/FallingSkies-CVE-2023-35885
- https://www.cloudpanel.io/docs/v2/changelog/
- https://github.com/Tropinene/Yscanner
