---
cve_id: CVE-2023-4220
template_path: nuclei-templates/http/cves/2023/CVE-2023-4220.yaml
affected_product: Chamilo LMS
severity: medium
authentication: none
external_callback: false
affected_versions: <= 1.11.24
preconditions: []
poc_classification: rce
---

## Vulnerability
Chamilo LMS <= 1.11.24 contains an unrestricted file upload vulnerability in the big file upload functionality at `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`. Unauthenticated attackers can upload arbitrary files, including web shells, resulting in stored cross-site scripting and remote code execution that can compromise the entire learning management system.

## PoC / Detection
Classification: rce

The template detects the flaw with a two-request sequence that performs a safe upload test:  
1. A POST to `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` using multipart/form-data to upload a randomly named `{{filename}}.txt` file containing the MD5 hash of a random integer.  
2. A subsequent GET to `/main/inc/lib/javascript/bigupload/files/{{filename}}.txt` that verifies the uploaded content matches the MD5 hash and both requests return HTTP 200.  
This confirms the endpoint accepts and persistently serves arbitrary files without validation, which is directly exploitable for RCE by substituting a web-shell payload.

## References
- https://github.com/Ziad-Sakr/Chamilo-LMS-CVE-2023-4220-Exploit
- https://github.com/charlesgargasson/CVE-2023-4220
- https://starlabs.sg/advisories/23/23-4220/
- https://nvd.nist.gov/vuln/detail/CVE-2023-4220
