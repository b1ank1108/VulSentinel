---
cve_id: CVE-2023-50968
template_path: nuclei-templates/http/cves/2023/CVE-2023-50968.yaml
affected_product: Apache OFBiz
severity: high
authentication: none
external_callback: true
affected_versions: < 18.12.11
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Apache OFBiz versions before 18.12.11 is vulnerable to an unauthenticated Server Side Request Forgery (SSRF) that also allows arbitrary file properties reading. Attackers can exploit specific URI calls in the /partymgr/control endpoint without any authorization to perform SSRF attacks and read sensitive file properties, potentially exposing internal resources or configuration files.

CVSS v3.1 score: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). CWE-918 (SSRF), CWE-200 (Information Disclosure).

## PoC / Detection
Classification: info-leak

The template performs detection by sending unauthenticated POST requests to `/partymgr/control/getJSONuiLabel` and `/partymgr/control/getJSONuiLabelArray` using clusterbomb payloads. The request body injects an attacker-controlled URL via JSON like `{"http://{{interactsh-url}}/api":"{{rand_base(6)}}"}` to trigger SSRF. Success is confirmed if an HTTP callback is received on interactsh and the response header contains `OFBiz.Visitor=`.

## References
- https://lists.apache.org/thread/x5now4bk3llwf3k58kl96qvtjyxwp43q
- http://www.openwall.com/lists/oss-security/2023/12/26/2
- https://nvd.nist.gov/vuln/detail/CVE-2023-50968
- https://issues.apache.org/jira/browse/OFBIZ-12875
- https://ofbiz.apache.org/download.html
