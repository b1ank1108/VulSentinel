---
cve_id: CVE-2023-2948
template_path: nuclei-templates/http/cves/2023/CVE-2023-2948.yaml
affected_product: OpenEMR
severity: medium
authentication: none
external_callback: false
affected_versions: < 7.0.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected Cross-Site Scripting (XSS) in OpenEMR < 7.0.1. Unauthenticated attackers can inject malicious JavaScript via the `list_id` parameter in `/library/custom_template/share_template.php`. Impact: potential theft of user credentials or execution of unauthorized actions in the context of other users' browsers. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1). CWE-79. Remediation: upgrade to 7.0.1 or later.

## PoC / Detection
Classification: info-leak

The template issues one unauthenticated GET request to `{{BaseURL}}/library/custom_template/share_template.php?list_id=1}});}}alert(document.domain);function%20x(){if(1){a=({a:{a:1` and matches on status_code == 200, text/html Content-Type, and body containing the exact unsanitized payload fragment plus page strings "select at least one Provider" and "Save</span>" to confirm reflection.

## References
- https://huntr.com/bounties/3842486f-38b1-4150-9f78-b81d0ae580c4
- https://github.com/openemr/openemr/commit/af1ecf78d1342519791bda9d3079e88f7d859015
- https://nvd.nist.gov/vuln/detail/CVE-2023-2948
