---
cve_id: CVE-2023-3197
template_path: nuclei-templates/http/cves/2023/CVE-2023-3197.yaml
affected_product: WordPress MStore API plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 4.0.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

The MStore API plugin for WordPress versions up to and including 4.0.1 contains an unauthenticated blind SQL injection vulnerability. The flaw exists due to insufficient escaping and sanitization of the 'id' parameter in SQL queries within the plugin's API endpoints. Specifically, the `/wp-json/api/flutter_multi_vendor/product-categories` endpoint fails to properly validate user-supplied input in the 'id' parameter before incorporating it into database queries.

This critical vulnerability allows remote, unauthenticated attackers to inject arbitrary SQL commands into the application's database queries. The blind nature of the SQL injection means attackers cannot directly see query results but can infer information through time-based techniques or other side-channel methods. Successful exploitation enables attackers to extract sensitive database information including user credentials, personal data, and other confidential information stored in the WordPress database, potentially leading to complete compromise of the website and its data.

## PoC / Detection

Classification: info-leak

The template performs a two-stage detection process to identify the SQL injection vulnerability:

1. **Baseline Check**: Sends a GET request to `/wp-json/api/flutter_multi_vendor/product-categories` to verify the MStore API endpoint is accessible and responding correctly. The template checks for a 200 status code and the presence of expected JSON fields ("has_children", "display") in the response body.

2. **Time-Based SQL Injection Probe**: If the baseline check succeeds, the template sends a crafted request with a malicious 'id' parameter: `id=1 AND (SELECT 1 FROM (SELECT SLEEP(6))a)`. This payload attempts to inject a SQL SLEEP command that would delay the database response by 6 seconds. The template uses a 15-second timeout and verifies that the response duration is at least 6 seconds while maintaining a 200 status code, confirming the SQL injection is executable.

The detection method uses time-based blind SQL injection techniques to confirm the vulnerability without extracting actual data.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-3197
- https://www.wordfence.com/threat-intel/vulnerabilities/id/30aab1af-a78f-4bac-b3c5-30ea854ccef7?source=cve
