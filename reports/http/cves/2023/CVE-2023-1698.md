---
cve_id: CVE-2023-1698
template_path: nuclei-templates/http/cves/2023/CVE-2023-1698.yaml
affected_product: WAGO
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
In multiple products of WAGO, a critical vulnerability (CVE-2023-1698, CWE-78) allows an unauthenticated remote attacker to perform OS command injection. Exploitation enables creation of new users, modification of device configuration, unintended behavior, Denial of Service, and full system compromise. CVSS 3.1 score: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Affects multiple WAGO products including Compact Controller 100 Firmware (per metadata and CPE).

## PoC / Detection
Classification: rce

The template sends a single POST request to `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` with the JSON payload `{"package":";id;#"}` to test for command injection. Success is determined by a 200 OK response containing both license/name JSON fields and the output of the injected `id` command (`uid=` and `gid=` strings).

## References
- https://onekey.com/blog/security-advisory-wago-unauthenticated-remote-command-execution/
- https://nvd.nist.gov/vuln/detail/CVE-2023-1698
- https://cert.vde.com/en/advisories/VDE-2023-007/
- https://github.com/codeb0ss/CVE-2023-1698-PoC
- https://github.com/deIndra/CVE-2023-1698
