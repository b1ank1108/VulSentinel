---
cve_id: CVE-2023-30868
template_path: nuclei-templates/http/cves/2023/CVE-2023-30868.yaml
affected_product: CMS Tree Page View plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.6.7
preconditions: [CMS Tree Page View plugin installed and active on WordPress, administrator privileges]
poc_classification: info-leak
---

## Vulnerability
Reflected Cross-Site Scripting (XSS) in the CMS Tree Page View WordPress plugin. The `post_type` GET parameter on `/wp-admin/edit.php?page=cms-tpv-page-post` is not sanitized or escaped, allowing injection of arbitrary JavaScript.  
Authenticated high-privilege (admin) attackers can craft malicious URLs that, when visited by other administrators, execute attacker-controlled JS in the victim's browser context.  
Impact includes session theft, account compromise, or persistent access. Fixed in 1.6.7.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1).

## PoC / Detection
Classification: info-leak  
The template first POSTs valid administrator credentials to `/wp-login.php` to establish an authenticated session, then issues a GET to the vulnerable admin endpoint with `post_type=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`. Detection succeeds if the second response is HTTP 200 with HTML content-type, contains the string "CMS Tree Page View", and reflects the unsanitized payload substring `%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E` in the body (confirming lack of HTML escaping).

## References
- https://www.exploit-db.com/exploits/51507
- https://wpscan.com/vulnerability/407c62af-8e2d-441d-8332-0afad5d07014
- https://nvd.nist.gov/vuln/detail/CVE-2023-30868
- http://packetstormsecurity.com/files/172730/WordPress-Tree-Page-View-1.6.7-Cross-Site-Scripting.html
- https://patchstack.com/database/vulnerability/cms-tree-page-view/wordpress-cms-tree-page-view-plugin-1-6-7-cross-site-scripting-xss-vulnerability?_s_id=cve
