---
cve_id: CVE-2023-49070
template_path: nuclei-templates/http/cves/2023/CVE-2023-49070.yaml
affected_product: Apache OFBiz
severity: critical
authentication: none
external_callback: true
affected_versions: before 18.12.10
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache OFBiz < 18.12.10 is affected by a pre-authentication remote code execution vulnerability (CVE-2023-49070, CWE-94) via the legacy XML-RPC endpoint that remains present despite being unmaintained. An unauthenticated attacker can submit a crafted XML-RPC payload triggering Java deserialization of a malicious gadget, resulting in arbitrary code execution and full server compromise.

**CVSS 3.1**: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Impact**: Complete server takeover.  
**Remediation**: Upgrade to 18.12.10 or later.

## PoC / Detection
Classification: rce

The template issues one raw POST request to `/webtools/control/xmlrpc;/?USERNAME&PASSWORD=s&requirePasswordChange=Y` containing an XML `<methodCall>` with a `<serializable>` gadget generated via `generate_java_gadget("dns", "http://{{interactsh-url}}", "base64")`. Detection succeeds when a DNS interaction is received on the interactsh domain **and** the response body contains `<name>faultString</name>` (confirming the deserialization path was exercised).

## References
- https://lists.apache.org/thread/jmbqk2lp4t4483whzndp5xqlq4f3otg3
- https://seclists.org/oss-sec/2023/q4/257
- https://twitter.com/Siebene7/status/1731870759130427726
- https://nvd.nist.gov/vuln/detail/CVE-2023-49070
- https://issues.apache.org/jira/browse/OFBIZ-12812
