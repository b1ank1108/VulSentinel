---
cve_id: CVE-2023-27350
template_path: nuclei-templates/http/cves/2023/CVE-2023-27350.yaml
affected_product: PaperCut MF/NG
severity: critical
authentication: none
external_callback: true
affected_versions: 22.0.5 (Build 63914) and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2023-27350 is an unauthenticated remote code execution vulnerability in PaperCut NG/MF. The vulnerability exists within the SetupCompleted class and results from improper access control. An attacker can bypass authentication mechanisms without any credentials and execute arbitrary code in the context of SYSTEM privileges. The flaw allows remote attackers to completely compromise affected installations.

The vulnerability has a CVSS score of 9.8 (Critical) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-based exploitation with low complexity, no privileges required, no user interaction needed, and high impact on confidentiality, integrity, and availability. This vulnerability is tracked as ZDI-CAN-18987 and is associated with CWE-284 (Improper Access Control).

## PoC / Detection

Classification: rce

The template performs a multi-step exploitation chain to verify the vulnerability:

1. Accesses the `/app?service=page/SetupCompleted` endpoint to bypass authentication
2. Submits a POST request to the SetupCompleted form to establish an authenticated session
3. Navigates to the ConfigEditor to enable print scripting by setting `print-and-device.script.enabled` to "Y"
4. Disables script sandboxing by setting `print.script.sandboxed` to "N"
5. Retrieves the printer list and extracts a printer ID
6. Selects a specific printer and accesses its options tab
7. Injects a malicious JavaScript payload into the printer's script body that executes `java.lang.Runtime.getRuntime().exec()` with an nslookup command pointing to an Interactsh URL

The template confirms successful exploitation by detecting DNS callbacks to the Interactsh server and checking for the presence of specific text ('Avanceret kontering') in the response body, indicating successful access to the printer configuration interface.

## References

- https://www.horizon3.ai/papercut-cve-2023-27350-deep-dive-and-indicators-of-compromise/
- https://nvd.nist.gov/vuln/detail/CVE-2023-27350
- https://www.papercut.com/kb/Main/PO-1216-and-PO-1219
- https://www.zerodayinitiative.com/advisories/ZDI-23-233/
- http://packetstormsecurity.com/files/171982/PaperCut-MF-NG-Authentication-Bypass-Remote-Code-Execution.html
