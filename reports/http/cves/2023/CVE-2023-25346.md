---
cve_id: CVE-2023-25346
template_path: nuclei-templates/http/cves/2023/CVE-2023-25346.yaml
affected_product: ChurchCRM
severity: medium
authentication: required
external_callback: false
affected_versions: 4.5.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-25346 is a reflected cross-site scripting (XSS) vulnerability in ChurchCRM version 4.5.3. The vulnerability exists in the `/v2/person/not-found` endpoint where the `id` parameter is not properly sanitized before being reflected in the HTML response. Remote attackers can inject arbitrary web script or HTML through this parameter, which executes in the context of authenticated users' browsers.

Successful exploitation allows attackers to inject malicious scripts into web pages viewed by authenticated ChurchCRM users. This can lead to data theft, session hijacking, credential harvesting, or website defacement. The vulnerability requires user interaction (UI:R in CVSS) as victims must click on a crafted malicious link while authenticated to the application.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope affecting confidentiality and integrity at a low level.

## PoC / Detection

Classification: info-leak

The Nuclei template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/session/begin` with username and password credentials to establish an authenticated session
2. **XSS Probe**: Sends a GET request to `/v2/person/not-found` with a crafted `id` parameter containing the payload `"><script>alert(document.domain)</script>`

The template verifies the vulnerability by checking that:
- The response returns HTTP 200 status
- The content type is `text/html`
- The injected script payload `<script>alert(document.domain)</script>` is reflected unencoded in the response body
- The response contains "ChurchCRM" confirming the target application

This detection method confirms that user-supplied input is reflected without proper sanitization, allowing arbitrary JavaScript execution in the victim's browser context.

## References

- https://github.com/10splayaSec/CVE-Disclosures/tree/main/ChurchCRM/CVE-2023-25346
- https://nvd.nist.gov/vuln/detail/CVE-2023-25346
- https://github.com/ChurchCRM/CRM
- https://github.com/10splayaSec/CVE-Disclosures
- https://github.com/ARPSyndicate/cvemon
