---
cve_id: CVE-2023-47873
template_path: nuclei-templates/http/cves/2023/CVE-2023-47873.yaml
affected_product: WordPress WP Child Theme Generator
severity: critical
authentication: required
external_callback: false
affected_versions: < 1.1.3
preconditions: WP Child Theme Generator plugin installed and activated
poc_classification: rce
---

## Vulnerability
The WordPress WP Child Theme Generator plugin (by WEN Solutions) contains an unrestricted upload of file with dangerous type vulnerability (CWE-434). Authenticated administrators can upload arbitrary PHP files disguised as theme screenshot files during child theme creation.  

This issue affects versions < 1.1.3. CVSS 3.1 score: 9.1 (AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H). Exploitation results in remote code execution on the WordPress server and complete site compromise.  

Remediation: Update to version 1.1.3 or later.

## PoC / Detection
Classification: rce  

The multi-step flow first authenticates via POST to `/wp-login.php` using supplied credentials, verifies successful admin login, then GETs the plugin admin page `/wp-admin/themes.php?page=custom-child-theme` to extract the `wp-easy-nonce`. It then performs a multipart POST to `/wp-admin/admin-post.php` (action=child_theme) that creates a random-named child theme while uploading a PHP payload (disguised as `image/png` with `<?php echo "random-string"; ?>` content) named `screenshot.php`. Finally, it GETs `/wp-content/themes/[random-name]/screenshot.php` and confirms execution by matching the injected random string in the response body.

## References
- https://github.com/certuscyber/cve-pocs/tree/main/CVE-2023-47873
- https://patchstack.com/database/wordpress/plugin/wp-child-theme-generator/vulnerability/wordpress-wp-child-theme-generator-plugin-1-0-8-arbitrary-file-upload-vulnerability
- https://en-ca.wordpress.org/plugins/wp-child-theme-generator/
- https://patchstack.com/database/vulnerability/wp-child-theme-generator/wordpress-wp-child-theme-generator-plugin-1-0-8-arbitrary-file-upload-vulnerability?_s_id=cve
