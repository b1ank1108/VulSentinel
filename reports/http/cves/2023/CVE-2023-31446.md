---
cve_id: CVE-2023-31446
template_path: nuclei-templates/http/cves/2023/CVE-2023-31446.yaml
affected_product: Cassia Gateway Firmware
severity: critical
authentication: none
external_callback: true
affected_versions: XC1000_2.1.1.2303082218, XC2000_2.1.1.2303090947
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2023-31446 is a critical remote code execution vulnerability in Cassia Gateway firmware versions XC1000_2.1.1.2303082218 and XC2000_2.1.1.2303090947. The vulnerability exists in the `/bypass/config` endpoint where the `queueUrl` parameter is not properly sanitized. This lack of input validation allows unauthenticated attackers to inject arbitrary Bash code that executes with root privileges when the device starts up.

The vulnerability affects Cassia Bluetooth Gateway devices, which serve as management platforms for Bluetooth IoT device networks. Successful exploitation grants attackers complete control over the gateway with root-level access, potentially compromising the gateway itself and all connected IoT devices in the Bluetooth network.

The CVSS v3.1 score is 9.8 (Critical) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-based exploitation requiring no privileges, no user interaction, and resulting in high impact to confidentiality, integrity, and availability. The EPSS score of 0.92671 (99.74th percentile) indicates an extremely high probability of active exploitation.

## PoC / Detection

Classification: rce

The Nuclei template detects this vulnerability by sending a GET request to the `/bypass/config` endpoint with crafted parameters including `type=sqs`, `keyId=test`, `key=security`, and critically, a `queueUrl` parameter set to an Interactsh callback URL. The template uses a 20-second timeout to allow for the out-of-band interaction.

The detection mechanism verifies two conditions:
1. A DNS interaction is received at the Interactsh server, confirming that the injected URL in the `queueUrl` parameter is processed by the device
2. The HTTP response body matches the regex pattern `^OK$`, indicating the configuration was accepted

The successful DNS callback demonstrates that the device processes and attempts to connect to the attacker-controlled URL, proving the parameter injection vulnerability exists. While the template itself only triggers a DNS lookup for detection purposes, the underlying vulnerability allows injection of arbitrary Bash commands that execute with root privileges on device startup.

## References

- https://github.com/advisories/GHSA-89ph-wr9x-hcfc
- https://github.com/Dodge-MPTC/CVE-2023-31446-Remote-Code-Execution
- https://vuldb.com/?id.250210
- https://blog.kscsc.online/cves/202331446/md.html
- https://www.cassianetworks.com
