---
cve_id: CVE-2023-26842
template_path: nuclei-templates/http/cves/2023/CVE-2023-26842.yaml
affected_product: ChurchCRM
severity: medium
authentication: required
external_callback: false
affected_versions: 4.5.3
preconditions: []
poc_classification: state-change
---

## Vulnerability
ChurchCRM 4.5.3 is affected by a stored Cross-Site Scripting (XSS) vulnerability in OptionManager.php. Authenticated attackers can inject arbitrary web script or HTML via the newFieldName parameter when managing person classifications (ListID=1, mode=classes).  

Successful exploitation could allow data theft, session hijacking, or defacement for users viewing the affected pages. CVSS 3.1: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N). CWE-79.

## PoC / Detection
Classification: state-change

The template logs in via POST /session/begin with username/password credentials. It then submits a POST to /OptionManager.php containing the XSS payload `" onfocus=alert(document.domain) autofocus="` in the newFieldName field. Detection succeeds if the response body stores and returns the raw payload alongside HTTP 200 and ChurchCRM indicators.

## References
- https://github.com/10splayaSec/CVE-Disclosures/tree/main/ChurchCRM/CVE-2023-26842
- https://nvd.nist.gov/vuln/detail/CVE-2023-26842
- https://github.com/10splayaSec/CVE-Disclosures
