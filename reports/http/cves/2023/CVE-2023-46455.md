---
cve_id: CVE-2023-46455
template_path: nuclei-templates/http/cves/2023/CVE-2023-46455.yaml
affected_product: GL.iNet
severity: high
authentication: none
external_callback: false
affected_versions: <= 4.3.7
preconditions: []
poc_classification: state-change
---

## Vulnerability
GL.iNet firmware <= 4.3.7 contains an arbitrary file write vulnerability (CWE-22) via the `/upload` endpoint. Unauthenticated remote attackers can supply a multipart/form-data POST with attacker-controlled `path` and `file` parameters to overwrite arbitrary files on the target filesystem (e.g., configuration files or binaries in `/tmp`). Successful exploitation enables full device compromise, configuration tampering, and persistent access. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N (7.5). Impact confirmed by template payload that writes arbitrary content.

## PoC / Detection
Classification: state-change

The template first issues an internal GET `/` request and matches the word "GL.iNet" (case-insensitive) in the response body to fingerprint the device. It then performs a POST `/upload` with a crafted multipart/form-data payload (boundary `---------------------------81419250823331111993422505835`) containing:
- `sid` set to `{{auth_token}}` (undefined â†’ empty string for unauthenticated use),
- `size=4`,
- `path=/tmp/{{rand_text_alpha(5)}}`,
- `file` part with filename `{{rand_text_alpha(4)}}` and body content `{{rand_text_alpha(5)}}`.

Detection succeeds if the response body contains "File uploaded successfully" and status is 200. The request is marked intrusive; the actual file write occurs during detection.

## References
- https://github.com/cyberaz0r/GL.iNet-Multiple-Vulnerabilities/blob/main/CVE-2023-46455.py
- https://nvd.nist.gov/vuln/detail/CVE-2023-46455
