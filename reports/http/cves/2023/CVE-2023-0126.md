---
cve_id: CVE-2023-0126
template_path: nuclei-templates/http/cves/2023/CVE-2023-0126.yaml
affected_product: SonicWall SMA1000
severity: high
authentication: none
external_callback: false
affected_versions: 12.4.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-0126 is a pre-authentication path traversal vulnerability affecting SonicWall SMA1000 appliances running firmware version 12.4.2. The vulnerability allows an unauthenticated remote attacker to access arbitrary files and directories stored outside the web root directory by exploiting improper path validation. This is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory). The CVSS v3.1 score is 7.5 (High), with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction. The vulnerability has a high EPSS score of 0.93027 (99.776th percentile), indicating active exploitation in the wild is highly likely.

Successful exploitation enables attackers to read sensitive files on the affected device, potentially exposing configuration files, credentials, cryptographic keys, and other confidential information that could facilitate further attacks or unauthorized access to the network infrastructure.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending an HTTP GET request to the target SMA1000 appliance with a crafted path traversal payload. The request attempts to access `/images//////////////////../../../../../../../../etc/passwd` using multiple forward slashes and directory traversal sequences to escape the web root and read the system's password file.

The template confirms successful exploitation through three conditions:
1. The HTTP response status is 200 (OK)
2. The response header contains `content/unknown`, indicating the server is serving a file type it doesn't recognize
3. The response body matches the regex pattern `root:[x*]:0:0`, confirming the contents of the `/etc/passwd` file are returned

This detection method verifies that unauthenticated path traversal is possible and that sensitive system files can be read, demonstrating the information disclosure vulnerability without causing any state changes to the target system.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-0126
- https://github.com/advisories/GHSA-mr28-27qx-phg3
- https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2023-0001
- https://github.com/Gerxnox/One-Liner-Collections
- https://github.com/thecybertix/One-Liner-Collections
