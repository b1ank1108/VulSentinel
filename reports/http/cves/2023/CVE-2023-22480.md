---
cve_id: CVE-2023-22480
template_path: nuclei-templates/http/cves/2023/CVE-2023-22480.yaml
affected_product: KubeOperator
severity: critical
authentication: none
external_callback: false
affected_versions: <= 3.16.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
KubeOperator versions 3.16.3 and below expose an improper authorization flaw (CWE-863, CWE-285) on the API endpoint `/api/v1/clusters/kubeconfig/k8s`. Unauthenticated attackers can directly download the sensitive foreground kubeconfig file containing cluster credentials and configuration. This information disclosure carries CVSS 3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8) and can enable full cluster takeover under certain conditions. Fixed in v3.16.4.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/api/v1/clusters/kubeconfig/k8s` and confirms the vulnerability when the response simultaneously satisfies three matchers: body contains both `apiVersion:` and `clusters:`, `Content-Type` header contains `application/download`, and status code is 200.

## References
- https://github.com/KubeOperator/KubeOperator/security/advisories/GHSA-jxgp-jgh3-8jc8
- https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/KubeOperator/KubeOperator%20kubeconfig%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2023-22480.md?plain=1
- https://nvd.nist.gov/vuln/detail/CVE-2023-22480
- https://github.com/KubeOperator/KubeOperator/commit/7ef42bf1c16900d13e6376f8be5ecdbfdfb44aaf
- https://github.com/KubeOperator/KubeOperator/releases/tag/v3.16.4
