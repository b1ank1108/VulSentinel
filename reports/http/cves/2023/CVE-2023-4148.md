---
cve_id: CVE-2023-4148
template_path: nuclei-templates/http/cves/2023/CVE-2023-4148.yaml
affected_product: Ditty
severity: medium
authentication: required
external_callback: false
affected_versions: < 3.1.25
preconditions: [Ditty WordPress plugin installed and activated]
poc_classification: info-leak
---

## Vulnerability
Ditty WordPress plugin before 3.1.25 fails to sanitize and escape certain parameters and generated URLs before outputting them in HTML attributes. This produces Reflected Cross-Site Scripting (CWE-79) exploitable via the `ditty_export` admin page.  

Unauthenticated attackers can craft malicious links containing injected JavaScript; when a logged-in high-privilege user (e.g., administrator) visits the link, the payload executes in the victim's browser, allowing theft of session cookies and full account takeover.  

CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Fixed in 3.1.25.

## PoC / Detection
Classification: info-leak  

The template first POSTs to `/wp-login.php` with `{{username}}` and `{{password}}` to establish an authenticated admin session, then issues a GET to `/wp-admin/edit.php?post_type=ditty&page=ditty_export&tab=export_ditty&"><script>alert(/XSS/)</script>` containing a reflected XSS payload. It verifies exploitation by confirming HTTP 200, presence of the unsanitized `<script>alert(/XSS/)</script>` string inside an HTML response body that also contains the string "ditty".

## References
- https://wpscan.com/vulnerability/aa39de78-55b3-4237-84db-6fdf6820c58d
- https://nvd.nist.gov/vuln/detail/CVE-2023-4148
