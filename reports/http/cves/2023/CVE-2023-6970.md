---
cve_id: CVE-2023-6970
template_path: nuclei-templates/http/cves/2023/CVE-2023-6970.yaml
affected_product: WP Recipe Maker
severity: medium
authentication: none
external_callback: false
affected_versions: <= 9.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The WP Recipe Maker plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the 'Referer' header in all versions up to, and including, 9.1.0 due to insufficient input sanitization and output escaping. The Referer header value is used directly in the href attribute of the "Back" button on the print page without proper escaping. Attackers can execute arbitrary scripts in the context of the victim's browser, potentially leading to session hijacking or defacement. Remediation: Update to the latest version of WP Recipe Maker plugin.

## PoC / Detection
Classification: info-leak

The template first issues a GET request to `{{BaseURL}}/wp-json/wp/v2/wprm_recipe?per_page=5` and extracts recipe IDs from the JSON response. It then iterates over each extracted recipe ID and sends a second GET request to `{{BaseURL}}/?wprm_print={{recipe_id}}` while injecting the payload `{{BaseURL}}/\"><script>alert(document.domain)</script>\""` into the Referer header. Detection succeeds if the response status is 200, the body contains the string `wprm-print-button-back`, and the unsanitized `<script>alert(document.domain)</script>` payload appears verbatim in the rendered page source.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-recipe-maker/wp-recipe-maker-910-reflected-cross-site-scripting-via-referer
- https://nvd.nist.gov/vuln/detail/CVE-2023-6970
- https://plugins.trac.wordpress.org/changeset/3019769/wp-recipe-maker/trunk/templates/public/print.php
