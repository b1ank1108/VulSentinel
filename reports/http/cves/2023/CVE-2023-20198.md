---
cve_id: CVE-2023-20198
template_path: nuclei-templates/http/cves/2023/CVE-2023-20198.yaml
affected_product: Cisco IOS XE Web UI
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability

A command injection vulnerability in the Cisco IOS XE Web UI (SOAP wsma-exec endpoint) allows unauthenticated remote attackers to execute arbitrary CLI commands with root privileges on the underlying operating system. The flaw stems from missing input validation on the `execCLI` request inside crafted HTTP POSTs to obfuscated paths (`/webui_wsma_Http` and double-encoded variants). Successful exploitation yields full device compromise, including arbitrary code execution, configuration changes, and traffic interception on affected Cisco IOS XE routers.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

## PoC / Detection

Classification: rce

The template issues three sequential raw POST requests (stop-at-first-match) to encoded endpoints `/webui_wsma_Http`, `/webui_wsma_Http` (double URL-encoded), and `/webui_wsma_https` carrying a SOAP envelope with `wsse:UsernameToken` (dummy admin/*****) and an `<execCLI>` payload executing the variable `cmd` (`uname -a` by default). It fingerprints successful command execution by requiring all of: `XMLSchema`, `execLog`, `Cisco Systems`, `<text>`, `<received>` strings in the response body, then extracts the command output via regex on the `<text>` element.

## References
- https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z
- https://www.rapid7.com/blog/post/2023/10/16/etr-cisco-ios-xe-web-ui-cve-2023-20198-active-exploitation/
