---
cve_id: CVE-2023-43261
template_path: nuclei-templates/http/cves/2023/CVE-2023-43261.yaml
affected_product: Milesight Routers
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Milesight Routers suffer from an information disclosure vulnerability (CVE-2023-43261) caused by directory listing being enabled on the web interface. Log files such as `/lang/log/httpd.log` are publicly accessible and contain encrypted admin and user passwords. The JavaScript code exposes a hardcoded AES secret key and initialization vector, enabling attackers to decrypt the credentials and obtain full administrative access.  
Impact: Unauthenticated credential compromise leading to complete router takeover.  
CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). CWE-532.

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/lang/log/httpd.log` (max-size limited to 5000 bytes) and applies a regex extractor to locate JSON-like entries matching `"username":"([^"]+)","password":"(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)"` within the response body. Successful extraction of username/password pairs confirms the exposed credential logs.

## References
- https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
- https://github.com/win3zz/CVE-2023-43261
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43261
- http://milesight.com
- http://ur5x.com
