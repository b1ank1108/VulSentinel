---
cve_id: CVE-2023-30212
template_path: nuclei-templates/http/cves/2023/CVE-2023-30212.yaml
affected_product: OURPHP
severity: medium
authentication: none
external_callback: false
affected_versions: <= 7.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OURPHP <= 7.2.0 is vulnerable to reflected Cross-Site Scripting (XSS) via `/client/manage/ourphp_out.php`. The `out` GET parameter (paired with `ourphp_admin=logout`) is reflected without sanitization into a JavaScript `location.href` context, enabling arbitrary script injection that executes in the victim's browser.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1), CWE-79.  
Successful exploitation can lead to data theft, session hijacking, or website defacement for users who visit the crafted URL.  
Remediation: upgrade to 7.2.1 or higher.

## PoC / Detection
Classification: info-leak

The template sends one GET request to `{{BaseURL}}/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(document.domain)</script>`. It matches if the response body contains the unsanitized payload string inside a `location.href` statement, the `Content-Type` header includes `text/html`, and the status code is 200.

## References
- https://www.ourphp.net/
- https://wanheiqiyihu.top/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/
- https://nvd.nist.gov/vuln/detail/CVE-2023-30212
- https://github.com/JasaluRah/Creating-a-Vulnerable-Docker-Environment-CVE-2023-30212-
- https://github.com/arunsnap/CVE-2023-30212-POC
