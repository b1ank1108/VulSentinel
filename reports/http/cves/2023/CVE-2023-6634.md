---
cve_id: CVE-2023-6634
template_path: nuclei-templates/http/cves/2023/CVE-2023-6634.yaml
affected_product: LearnPress
severity: critical
authentication: none
external_callback: true
affected_versions: up to, and including, 4.2.5.7
preconditions: []
poc_classification: rce
---

## Vulnerability
The LearnPress WordPress plugin is vulnerable to command injection in the `get_content` function through unsafe use of `call_user_func` with user-controlled input. This affects all versions up to and including 4.2.5.7 and allows unauthenticated attackers to execute any public PHP function accepting a single parameter. PHP object deserialization gadget chains (leveraging WP core classes) enable arbitrary command execution, resulting in full remote code execution. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-77. Impact includes complete server compromise on affected WordPress installations. Remediation: update to 4.2.5.8.

## PoC / Detection
Classification: rce

The template issues three sequential raw GET requests to the public `/wp-json/lp/v1/load_content_via_ajax/` endpoint. Requests embed crafted `callback` JSON parameters containing URL-encoded PHP serialized objects/gadgets (first using `LP_Debug::var_dump` for reflection testing; subsequent using `LP_Helper::maybe_unserialize` with `WP_HTML_Token`, `WP_Theme`, `WP_Block_List`, `WpOrg\Requests\Session`, and `WpOrg\Requests\Hooks` chains). These force execution of `system("curl {{interactsh-url}}")`. Stops at first match. Verifies success through interactsh OOB (HTTP/DNS), body containing "Error: data content invalid!", random string reflection, and HTTP 200.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/learnpress/learnpress-4257-command-injection
- https://wpscan.com/vulnerability/909580f4-1306-4e61-ac7d-e7a2eb0961f8/
- https://nvd.nist.gov/vuln/detail/CVE-2023-6634
- https://plugins.trac.wordpress.org/changeset/3013957/learnpress
- https://www.wordfence.com/threat-intel/vulnerabilities/id/21291ed7-cdc0-4698-9ec4-8417160845ed?source=cve
