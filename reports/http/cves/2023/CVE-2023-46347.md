---
cve_id: CVE-2023-46347
template_path: nuclei-templates/http/cves/2023/CVE-2023-46347.yaml
affected_product: PrestaShop Step by Step products Pack
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.5.6
preconditions: ndk_steppingpack module installed on PrestaShop
poc_classification: info-leak
---

## Vulnerability
SQL injection in the `search_query` parameter of `/modules/ndk_steppingpack/search-result.php` in the “Step by Step products Pack” (ndk_steppingpack) PrestaShop module versions up to 1.5.6. A guest (unauthenticated) attacker can execute arbitrary SQL queries. Impact includes extraction of sensitive database information such as user credentials and payment data. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-89. Remediation: update module to 1.5.7 or later.

## PoC / Detection
Classification: info-leak

The template verifies the SQL injection by issuing two POST requests to `/modules/ndk_steppingpack/search-result.php` with `Content-Type: application/x-www-form-urlencoded`:

- Time-based payload: `search_query=1");select 0x73656c65637420736c6565702836293b into @a;prepare b from @a;execute b;--` followed by matcher checking `status_code != 404`, `duration >= 6`, HTML content-type, and presence of “prestashop” or “xipblog”.
- Union-based payload: `search_query=1")+UNION+ALL+SELECT+...+CONCAT(md5(999999999))+...` followed by matcher checking `md5(999999999)` in response body.

`stop-at-first-match: true`; uses `@timeout: 15s` and `host-redirects`.

## References
- https://security.friendsofpresta.org/modules/2023/10/24/ndk_steppingpack.html
- https://stack.chaitin.com/poc/detail/3977
