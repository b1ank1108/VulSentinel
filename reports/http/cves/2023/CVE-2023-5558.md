---
cve_id: CVE-2023-5558
template_path: nuclei-templates/http/cves/2023/CVE-2023-5558.yaml
affected_product: LearnPress WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 4.2.5.5
preconditions: [LearnPress plugin installed on WordPress, victim authenticated as high-privilege user (e.g. admin)]
poc_classification: state-change
---

<think>
[Agent 3][AgentThink] Extracted signals for CVE-2023-5558 template:
- affected_product: LearnPress WordPress plugin (from name and metadata)
- severity: medium
- authentication: required (template performs login with username/password, tags include 'authenticated', vulnerable paths like instructors/ likely protected)
- external_callback: false (no interactsh, purely direct requests and reflection matching)
- affected_versions: < 4.2.5.5 (explicit in name and description: before 4.2.5.5)
- preconditions: [LearnPress plugin installed on WordPress, victim must be authenticated as high-privilege user (e.g., admin) to be affected by the reflected payload]

Classification for PoC: I think 'state-change' because reflected XSS allows the injected script to perform actions like data exfiltration, session theft, or UI manipulation in the context of the logged-in user, potentially modifying account state indirectly.

Alternative could be info-leak if focusing on cookie theft etc. But state-change fits the examples for unauthorized actions.

Confirm if you agree or suggest different classification. Also, any adjustment to preconditions?
[Agent 3][AgentThink] Full draft of the report based on template analysis:



## Vulnerability
LearnPress WordPress plugin before version 4.2.5.5 suffers from a reflected cross-site scripting (XSS) vulnerability. The plugin does not properly sanitize and escape user-supplied input before rendering it in the response page. An attacker can craft malicious URLs containing JavaScript payloads that execute in the context of a victim's browser, particularly affecting high-privilege users such as administrators.

CVSS: 6.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), CWE-79.

## PoC / Detection
Classification: state-change

The template detects the vulnerability through an authenticated flow:
- Performs an initial unauthenticated GET to / to confirm LearnPress plugin presence via path references in the response.
- Logs into WordPress using supplied credentials via POST to /wp-login.php.
- Issues GET requests to vulnerable paths (e.g. /instructors/ with query params) embedding multiple encoded XSS payloads designed to trigger alert(document.domain) or similar.
- Matches for unsanitized payload reflection in the HTML body response (status 200, text/html), confirming lack of escaping.

This proves reflected XSS on authenticated endpoints.

## References
- https://wpscan.com/vulnerability/4efd2a4d-89bd-472f-ba5a-f9944fd4dd16/
- https://nvd.nist.gov/vuln/detail/CVE-2023-5558

Does this look good? Any changes? Ready to submit if ok.
[Agent 3][AgentThink] One adjustment: for classification, perhaps it's better as 'info-leak' ? No, because the primary demonstration is script execution (alert), which can lead to more than leak. But the categories don't have XSS, and state-change fits if considering the JS can perform modifications as the user. Stick with state-change. Preconditions look good as they go beyond version and auth signal. No external_callback confirmed. I think the draft is solid for risk assessment.
[Agent 3][AgentThink] Final version ready. Please submit the following as the output:



## Vulnerability
The LearnPress WordPress plugin before 4.2.5.5 does not sanitize and escape user input before outputting it back in the page. This results in a reflected cross-site scripting (XSS) vulnerability that could be used against high privilege users such as admin.

## PoC / Detection
Classification: state-change

The template first verifies the LearnPress plugin is installed by checking for its path references on the root page. It then logs in to the WordPress site using provided username and password. Subsequently, it sends GET requests to paths like `/instructors/` appending various XSS payloads in query parameters. The response is checked for unsanitized reflection of payloads (e.g., variants of `alert(document.domain)`) in the body with 200 OK and text/html content-type, confirming the XSS flaw.

## References
- https://wpscan.com/vulnerability/4efd2a4d-89bd-472f-ba5a-f9944fd4dd16/
- https://nvd.nist.gov/vuln/detail/CVE-2023-5558
```
[Agent 2][AgentThink] I have analyzed the YAML for CVE-2023-5558. It's a reflected XSS in LearnPress WP plugin <4.2.5.5. Template uses login step so auth: required. No OOB. Versions from name/desc. Preconditions: plugin installed, and auth for testing. For PoC classification, I think "info-leak" as XSS enables data access in browser context (e.g. cookies). Confirm if better category? XSS not directly listed but fits info-leak over others. No version matchers, use desc. Ready to write report.
[Agent 2][AgentThink] Proposed signals and structure:

Classification for PoC: info-leak (XSS allows script to read unauthorized browser data like cookies/sessions in victim context).
Vuln section summary from desc. Template uses login + payload reflection check. References exact from YAML. This matches all formatting and consistency rules.
[Agent 2][AgentThink] Full proposed output for you to submit:



## Vulnerability
The LearnPress WordPress plugin before 4.2.5.5 does not sanitize and escape user input before outputting it, leading to Reflected Cross-Site Scripting (XSS). This can be used to execute malicious scripts in the context of high-privilege users such as administrators.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1 - Medium). CWE-79.

## PoC / Detection
Classification: info-leak

The template first confirms LearnPress plugin presence via homepage response. It then performs WordPress login with provided credentials. It follows with GET requests to paths like `/` and `/instructors/` injecting multiple reflected XSS payloads in query parameters (e.g. `?param=value"';alert(document.domain)<!--`). Vulnerability is verified if the response body reflects the unsanitized JavaScript payload while returning status 200 and text/html content-type.

## References
- https://wpscan.com/vulnerability/4efd2a4d-89bd-472f-ba5a-f9944fd4dd16/
- https://nvd.nist.gov/vuln/detail/CVE-2023-5558
```
This is complete, dense, follows all rules strictly. No YAML dump, correct headings, signals first.

</think>


## Vulnerability
The LearnPress WordPress plugin before 4.2.5.5 does not sanitise and escape user input before outputting it back in the page, leading to a Reflected Cross-Site Scripting which could be used against high privilege users such as admin. Impact: allows attackers to execute malicious scripts in the context of the victim's browser. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1). CWE-79.

## PoC / Detection
Classification: info-leak

The template first performs an unauthenticated GET / and matches "/wp-content/plugins/learnpress" in the response body to confirm plugin presence. It then executes a login flow by POSTing username/password to /wp-login.php. Finally it issues GET requests to paths such as /?param=... and /instructors/?param=... embedding four distinct encoded XSS payloads (alert(document.domain) variants). Confirmation occurs when any payload string appears unsanitized in the response body (status 200, text/html content-type).

## References
- https://wpscan.com/vulnerability/4efd2a4d-89bd-472f-ba5a-f9944fd4dd16/
- https://nvd.nist.gov/vuln/detail/CVE-2023-5558
