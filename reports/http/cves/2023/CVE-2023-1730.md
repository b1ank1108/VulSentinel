---
cve_id: CVE-2023-1730
template_path: nuclei-templates/http/cves/2023/CVE-2023-1730.yaml
affected_product: SupportCandy WordPress plugin
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.1.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The SupportCandy WordPress plugin before 3.1.5 fails to validate and escape user input before using it in an SQL statement, enabling unauthenticated attackers to perform SQL injection attacks (CWE-89). 

Attackers can execute arbitrary SQL queries via the `wpsc_guest_login_auth` cookie (email parameter), potentially resulting in data leakage, unauthorized database access, or data manipulation. CVSS 3.1 score: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Fixed in version 3.1.5.

## PoC / Detection
Classification: info-leak

The template performs detection by issuing a GET request to the root path (`/`) with a crafted `wpsc_guest_login_auth` cookie embedding a time-based blind SQLi payload (`' AND (SELECT 42 FROM (SELECT(SLEEP(6)))NNTu)-- cLmu`) that invokes `SLEEP(6)`. It matches on response duration of at least 6 seconds, HTTP 200 status, and the presence of "supportcandy" in the body to confirm the plugin context.

## References
- https://wpscan.com/vulnerability/44b51a56-ff05-4d50-9327-fc9bab74d4b7
- https://wordpress.org/plugins/supportcandy/
- https://nvd.nist.gov/vuln/detail/CVE-2023-1730
- https://github.com/tanjiti/sec_profile
