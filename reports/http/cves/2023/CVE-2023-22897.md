---
cve_id: CVE-2023-22897
template_path: nuclei-templates/http/cves/2023/CVE-2023-22897.yaml
affected_product: Securepoint UTM
severity: medium
authentication: none
external_callback: false
affected_versions: <12.2.5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-22897 is an information disclosure vulnerability in Securepoint UTM versions prior to 12.2.5.1. The vulnerability exists in the firewall's `/spcgi.cgi` endpoint and allows leakage of uninitialized memory contents. The flaw is classified as CWE-908 (Use of Uninitialized Resource), where the endpoint returns memory data that has not been properly cleared or initialized. An attacker can obtain a sessionid through a specific request pattern but does not need to use it to trigger the memory disclosure. This allows retrieval of sensitive information that may be present in the device's memory, including potentially credentials, configuration data, or other confidential information stored in uninitialized memory regions.

The CVSS v3.1 score is 6.5 (Medium), with the vector string indicating network-based attack vector, low attack complexity, low privileges required, no user interaction needed, and high confidentiality impact with no integrity or availability impact.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending an unauthenticated POST request to `/spcgi.cgi` with an empty JSON payload (`{}`). The template verifies the vulnerability by checking for three conditions:

1. The response body contains both `"sessionid":` and `"mode":` JSON fields
2. The response Content-Type header is `application/json`
3. The HTTP status code is 200

The presence of a sessionid in the response to an empty request indicates that the endpoint is returning uninitialized or improperly handled memory contents, confirming the information disclosure vulnerability. The template does not require authentication credentials and demonstrates that the vulnerability can be exploited without prior authentication.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2023-22897
- https://github.com/MrTuxracer/advisories/blob/master/CVEs/CVE-2023-22897.txt
- https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/
- https://rcesecurity.com
- https://github.com/MrTuxracer/advisories
