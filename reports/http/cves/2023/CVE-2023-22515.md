---
cve_id: CVE-2023-22515
template_path: nuclei-templates/http/cves/2023/CVE-2023-22515.yaml
affected_product: Atlassian Confluence
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Atlassian Confluence Data Center and Server contains a broken access control vulnerability that allows an attacker to create unauthorized Confluence administrator accounts and access Confluence. Unauthenticated attackers can exploit broken access control to create unauthorized Confluence administrator accounts and gain complete administrative access to Atlassian Confluence installations. Remediation: Update to the latest version of Confluence.

## PoC / Detection
Classification: auth-bypass

The template verifies the vulnerability via a 6-step raw HTTP chain that fully exploits it:
- GET `/setup/setupadministrator-start.action` (body_1 checked for "Setup is already complete")
- GET `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=0&cache<rand>` to force setup state
- GET `/setup/setupadministrator-start.action` again (body_3 checked for "Please configure the system administrator account...")
- POST `/setup/setupadministrator.action` (form: randomized lowercase username, fullName=admin, randomized email/password) 
- POST `/dologin.action` (os_username/os_password from created creds, expects 302 location containing `/index.action`)
- GET `/welcome.action` (body_6 checked for "Administration")

All matchers must pass (DSL `and` condition). On success the template extracts and reports the created USER and PASS values.

## References
- https://attackerkb.com/topics/Q5f0ItSzw5/cve-2023-22515/rapid7-analysis
- https://confluence.atlassian.com/security/cve-2023-22515-privilege-escalation-vulnerability-in-confluence-data-center-and-server-1295682276.html
- https://confluence.atlassian.com/kb/faq-for-cve-2023-22515-1295682188.html
- https://jira.atlassian.com/browse/CONFSERVER-92475
- https://www.cisa.gov/news-events/alerts/2023/10/05/cisa-adds-three-known-exploited-vulnerabilities-catalog
