---
cve_id: CVE-2023-20073
template_path: nuclei-templates/http/cves/2023/CVE-2023-20073.yaml
affected_product: Cisco VPN Routers
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
A vulnerability in the web-based management interface of Cisco VPN Routers (RV340, RV340W, RV345, and RV345P Dual WAN Gigabit VPN Routers) allows an unauthenticated remote attacker to upload arbitrary files due to insufficient authorization enforcement in the file upload functionality. An attacker can send a crafted HTTP request to the affected device.

**CVSS Metrics:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8)  
**CWE:** CWE-434  
**Impact:** Successful exploitation could lead to remote code execution or unauthorized access to sensitive information.  
**Remediation:** Apply the latest security patches provided by Cisco.  
**Metadata:** Vendor Cisco; product rv340_firmware; verified true.

## PoC / Detection
Classification: rce

The template detects the vulnerability through a three-request sequence that proves unauthenticated arbitrary file upload:  
1. GET `/index.html` to extract the original page body.  
2. POST `/api/operations/ciscosb-file:form-file-upload` (multipart/form-data; dummy `Authorization: 1` header) with `pathparam=Portal`, `fileparam=index.html`, and a crafted `index.html` payload that appends a unique HTML comment `<!-- {{randstr}} -->`.  
3. GET `/index.html` again and matches the injected comment in the response body to confirm the upload succeeded and overwrote the file.  

This is a safe, non-destructive probe verifying the underlying arbitrary-file-upload flaw (no OOB interaction or destructive payload used).

## References
- https://unsafe.sh/go-173464.html
- https://gist.github.com/win3zz/076742a4e365b1bba7e2ba0ebea9253f
- https://github.com/RegularITCat/CVE-2023-20073/tree/main
- https://nvd.nist.gov/vuln/detail/CVE-2023-20073
- https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sb-rv-afu-EXxwA65V
