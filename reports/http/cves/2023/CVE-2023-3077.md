---
cve_id: CVE-2023-3077
template_path: nuclei-templates/http/cves/2023/CVE-2023-3077.yaml
affected_product: MStore API
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.9.8
preconditions: []
poc_classification: info-leak
---

## Vulnerability

The MStore API WordPress plugin versions prior to 3.9.8 contain a Blind SQL Injection vulnerability in the `product_id` parameter of the `/wp-json/api/flutter_booking/get_staffs` endpoint. This critical vulnerability allows unauthenticated attackers to inject malicious SQL queries into the database through the vulnerable parameter. The flaw exists due to insufficient input validation and sanitization of user-supplied data before it is used in SQL queries. Successful exploitation enables attackers to extract sensitive data from the database, including user credentials, personal information, and other confidential data stored in the WordPress database. The vulnerability has a CVSS score of 9.8, indicating maximum severity with no authentication required and network-based attack vector.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Version Check**: Sends a GET request to `/wp-content/plugins/mstore-api/readme.txt` to verify the presence of the MStore API plugin by checking for a 200 status code and the string "MStore API" in the response body.

2. **Time-Based SQL Injection Probe**: Executes a time-based blind SQL injection attack by sending a GET request to `/wp-json/api/flutter_booking/get_staffs?product_id=%27+or+ID=sleep(6)--+-`. The payload injects a SQL `sleep(6)` command through the `product_id` parameter. The template confirms the vulnerability if the response takes 6 seconds or longer to return (indicating successful SQL injection execution) and returns a 200 status code. The timeout is set to 15 seconds to accommodate the delay.

## References

- https://wpscan.com/vulnerability/9480d0b5-97da-467d-98f6-71a32599a432
- https://nvd.nist.gov/vuln/detail/CVE-2023-3077
