---
cve_id: CVE-2023-34752
template_path: nuclei-templates/http/cves/2023/CVE-2023-34752.yaml
affected_product: bloofoxCMS
severity: critical
authentication: required
external_callback: false
affected_versions: v0.5.2.1
preconditions: [authenticated admin access required]
poc_classification: info-leak
---

## Vulnerability

bloofoxCMS v0.5.2.1 contains a SQL injection vulnerability in the admin panel's language settings functionality. The vulnerability exists in the `lid` parameter at `admin/index.php?mode=settings&page=lang&action=edit`. Authenticated attackers with admin access can exploit this SQL injection flaw to extract database contents, manipulate CMS data, and potentially execute commands on the underlying database server. The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8, indicating critical severity despite requiring authentication.

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection attack to detect the vulnerability. It first authenticates to the bloofoxCMS admin panel by sending a POST request with username and password credentials to `/admin/index.php`. After successful authentication, it sends a second POST request to the language editing endpoint (`/admin/index.php?mode=settings&page=lang&action=edit`) with a malicious payload in the `lid` parameter: `'+AND+(SELECT+7401+FROM+(SELECT(SLEEP(6)))hwrS)--+`. 

The template verifies the vulnerability by checking three conditions:
1. The response time is 6 seconds or greater (indicating the SQL SLEEP command executed)
2. The response contains `text/html` content type
3. The response body contains the string "bloofoxCMS Admincenter"

This time-based approach confirms the SQL injection vulnerability without extracting actual data, making it a detection method for an info-leak vulnerability that could be exploited to exfiltrate database contents.

## References

- https://www.bloofox.com
- https://ndmcyb.hashnode.dev/bloofox-v0521-was-discovered-to-contain-many-sql-injection-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2023-34752
- http://bloofoxcms.com
- https://www.bloofox.com/
