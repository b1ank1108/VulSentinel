---
cve_id: CVE-2023-4284
template_path: nuclei-templates/http/cves/2023/CVE-2023-4284.yaml
affected_product: WordPress Post Timeline Plugin
severity: high
authentication: required
external_callback: false
affected_versions: < 2.2.6
preconditions: Post Timeline plugin installed and activated on a WordPress site
poc_classification: state-change
---

## Vulnerability
The WordPress Post Timeline Plugin before version 2.2.6 contains a reflected cross-site scripting vulnerability. The plugin does not properly sanitize and escape an invalid nonce before outputting it back in an AJAX response. This could allow authenticated attackers to inject malicious JavaScript through the `asl-nounce` parameter in the `ptl_ajax_handler` action, executing arbitrary code in an administrator's browser context and potentially hijacking WordPress sites. CVSS 7.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N), CWE-79.

## PoC / Detection
Classification: state-change

The template first issues a GET / to the target and matches the string "post-timeline" in the body to confirm plugin presence. It then performs a POST to /wp-login.php with supplied `username`/`password` credentials to obtain an authenticated session, followed by a GET to /wp-admin/admin-ajax.php?action=ptl_ajax_handler&asl-nounce=%3Cimg%20src%20onerror%3Dalert%28document.domain%29%3E. Detection succeeds if the exact payload string appears in the response body, the Content-Type header contains "text/html", and status is 200.

## References
- https://wpscan.com/vulnerability/1c126869-0afa-456f-94cc-10334964e5f9
- https://nvd.nist.gov/vuln/detail/CVE-2023-4284
