---
cve_id: CVE-2023-2949
template_path: nuclei-templates/http/cves/2023/CVE-2023-2949.yaml
affected_product: OpenEMR
severity: medium
authentication: none
external_callback: false
affected_versions: < 7.0.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-2949 is a reflected Cross-Site Scripting (XSS) vulnerability in OpenEMR versions prior to 7.0.1. The vulnerability exists in the `providerID` parameter of the `/interface/forms/eye_mag/js/eye_base.php` endpoint. Unauthenticated attackers can inject malicious JavaScript code through this parameter, which is reflected back in the HTTP response without proper sanitization or encoding. This allows attackers to execute arbitrary JavaScript in the context of a victim's browser session when they are tricked into clicking a crafted link.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) and has a CVSS v3.1 score of 6.1 (Medium severity) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N. The attack requires no privileges (PR:N) but does require user interaction (UI:R), such as clicking a malicious link. The scope is changed (S:C), meaning the vulnerable component impacts resources beyond its security scope, with low impact to confidentiality and integrity.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the vulnerable endpoint with a proof-of-concept XSS payload in the `providerID` parameter: `<img src=x onerror=alert(document.domain);>`. The template verifies the vulnerability by checking three conditions:

1. The HTTP response status code is 200
2. The response Content-Type header contains "text/html"
3. The response body contains both the injected payload (`<img src=x onerror=alert(document.domain);>`) and the string "openemr"

If all three conditions are met, the template confirms that the XSS payload is reflected in the response without proper sanitization, indicating the presence of CVE-2023-2949. While the underlying vulnerability could be exploited for credential theft or unauthorized actions (as noted in the impact description), the template itself performs a benign detection check using a harmless JavaScript alert.

## References

- https://huntr.com/bounties/3842486f-38b1-4150-9f78-b81d0ae580c4
- https://github.com/openemr/openemr/commit/af1ecf78d1342519791bda9d3079e88f7d859015
- https://nvd.nist.gov/vuln/detail/CVE-2023-2949
