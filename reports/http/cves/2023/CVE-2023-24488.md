---
cve_id: CVE-2023-24488
template_path: nuclei-templates/http/cves/2023/CVE-2023-24488.yaml
affected_product: Citrix Gateway and Citrix ADC
severity: medium
authentication: none
external_callback: false
affected_versions: <13.1-45.61, <13.0-90.11, <12.1-65.35
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-24488 is a cross-site scripting (XSS) vulnerability affecting Citrix ADC and Citrix Gateway. The vulnerability stems from improper input validation in the OAuth logout endpoint (`/oauth/idp/logout`), specifically in the `post_logout_redirect_uri` parameter. An attacker can inject malicious JavaScript code through this parameter by using CRLF injection sequences (`%0D%0A`) to break out of the HTTP response context and inject arbitrary HTML/JavaScript content.

The vulnerability affects versions before 13.1-45.61, 13.0-90.11, and 12.1-65.35. Successful exploitation allows an attacker to execute arbitrary scripts in the context of a victim's browser session, potentially leading to session hijacking, credential theft, defacement, or other malicious actions. The vulnerability has a CVSS score of 6.1 (Medium severity) and requires user interaction (UI:R) but no authentication (PR:N), with a scope change (S:C) indicating the vulnerable component impacts resources beyond its security scope.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending GET requests to the OAuth logout endpoint with two different XSS payloads injected into the `post_logout_redirect_uri` parameter:

1. A payload using CRLF injection to insert a `<body>` tag with an `onload` event handler: `%0D%0A%0D%0A%3Cbody+x=%27&%27onload=%22(alert)(%27citrix+akamai+bypass%27)%22%3E`
2. A payload using CRLF injection to insert a `<script>` tag: `%0d%0a%0d%0a<script>alert(document.domain)</script>`

The template verifies the vulnerability by checking for:
- The presence of the injected HTML/JavaScript code in the response body (either the `<body>` tag with onload handler or the `<script>` tag)
- A Content-Type header indicating HTML content
- An HTTP 302 redirect status code

The template uses `stop-at-first-match: true` to halt testing once a successful detection occurs with either payload.

## References

- https://support.citrix.com/article/CTX477714/citrix-adc-and-citrix-gateway-security-bulletin-for-cve202324487-cve202324488
- https://blog.assetnote.io/2023/06/29/citrix-xss-advisory/
- https://nvd.nist.gov/vuln/detail/CVE-2023-24488
- https://twitter.com/infosec_au/status/1674786106381070342
- https://twitter.com/bxmbn/status/1675250259608449026
