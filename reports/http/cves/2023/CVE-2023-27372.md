---
cve_id: CVE-2023-27372
template_path: nuclei-templates/http/cves/2023/CVE-2023-27372.yaml
affected_product: SPIP
severity: critical
authentication: none
external_callback: false
affected_versions: before 4.2.1 (fixed in 3.2.18, 4.0.10, 4.1.8, 4.2.1)
preconditions: []
poc_classification: rce
---

## Vulnerability
SPIP before 4.2.1 allows Remote Code Execution via form values in the public area because serialization is mishandled. The fixed versions are 3.2.18, 4.0.10, 4.1.8, and 4.2.1.

**Impact:** Successful exploitation of this vulnerability could allow an attacker to execute arbitrary commands on the target system.

**Remediation:** Apply the latest security patches or upgrade to a patched version of SPIP.

**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**CPE:** cpe:2.3:a:spip:spip:*:*:*:*:*:*:*:*

**Metadata:** verified true, max-request 2, vendor spip, product spip

**Shodan:** html:"spip.php?page=backend", http.html:"spip.php?page=backend", cpe:"cpe:2.3:a:spip:spip"

**FOFA:** body="spip.php?page=backend"

**Tags:** cve,cve2023,packetstorm,spip,rce,vkev,vuln

## PoC / Detection
Classification: rce

The template first issues a GET to `/spip.php?page=spip_pass` and extracts the CSRF token (`formulaire_action_args`) via regex. It then sends a POST to the same endpoint containing `page=spip_pass&formulaire_action=oubli&formulaire_action_args={{csrf}}&oubli=s:19:"<?php phpinfo(); ?>";`. Success is confirmed by status 200 and presence of "PHP Extension", "PHP Version", and "<!DOCTYPE html" in the second response body, proving execution of injected PHP code.

## References
- https://packetstormsecurity.com/files/171921/SPIP-Remote-Command-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27372
- https://github.com/nuts7/CVE-2023-27372
- http://packetstormsecurity.com/files/171921/SPIP-Remote-Command-Execution.html
- http://packetstormsecurity.com/files/173044/SPIP-4.2.1-Remote-Code-Execution.html
