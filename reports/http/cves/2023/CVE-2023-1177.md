---
cve_id: CVE-2023-1177
template_path: nuclei-templates/http/cves/2023/CVE-2023-1177.yaml
affected_product: Mlflow
severity: critical
authentication: none
external_callback: false
affected_versions: <2.2.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Mlflow before 2.2.1 is susceptible to local file inclusion due to path traversal `\..\filename` in the mlflow/mlflow repository. An attacker can potentially obtain sensitive information, modify data, and/or execute unauthorized administrative operations.  
Successful exploitation allows an attacker to read arbitrary files on the server.  
Remediation requires upgrading to version 2.2.1 or later.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE: CWE-29, CWE-22  
CVE: CVE-2023-1177

## PoC / Detection
Classification: info-leak

The template verifies the LFI by chaining three HTTP requests:  
1. POST /ajax-api/2.0/mlflow/registered-models/create to register a model using a random name.  
2. POST /ajax-api/2.0/mlflow/model-versions/create with source="file:///etc/" to register a model version that triggers the path-traversal logic.  
3. GET /model-versions/get-artifact?path=passwd&name=<random>&version=<extracted> to retrieve the artifact, which resolves to /etc/passwd when the vulnerability is present.  

Matchers require HTTP 200 and the regex `root:.*:0:0:` in the response body. An internal regex extractor pulls the Mlflow version string from the server response for correlation.

## References
- https://huntr.dev/bounties/1fe8f21a-c438-4cba-9add-e8a5dab94e28/
- https://github.com/mlflow/mlflow/commit/7162a50c654792c21f3e4a160eb1a0e6a34f6e6e
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1177
- https://huntr.dev/bounties/1fe8f21a-c438-4cba-9add-e8a5dab94e28
- https://nvd.nist.gov/vuln/detail/CVE-2023-1177
