---
cve_id: CVE-2023-22478
template_path: nuclei-templates/http/cves/2023/CVE-2023-22478.yaml
affected_product: KubePi
severity: high
authentication: none
external_callback: false
affected_versions: <= v1.6.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
KubePi (<= v1.6.4) modern Kubernetes panel is affected by missing authorization (CWE-862) on the LoginLogsSearch API endpoint. Unauthenticated attackers can access login logs containing sensitive user information (user names, UUIDs, API versions). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5 High). Impact: unauthorized access to sensitive information. Patched in v1.6.4; no known workarounds.

## PoC / Detection
Classification: info-leak

The template issues an unauthenticated POST request with empty JSON body (`{}`) to `/kubepi/api/v1/systems/login/logs/search?pageNum=1&&pageSize=10` and confirms vulnerability by matching HTTP 200 status, `application/json` Content-Type header, and response body containing the strings `"apiVersion":`, `"uuid":`, and `"userName":`.

## References
- https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/KubePi/KubePi%20LoginLogsSearch%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%20CVE-2023-22478.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-22478
- https://github.com/1Panel-dev/KubePi/security/advisories/GHSA-gqx8-hxmv-c4v4
- https://github.com/KubeOperator/KubePi/commit/0c6774bf5d9003ae4d60257a3f207c131ff4a6d6
- https://github.com/KubeOperator/KubePi/releases/tag/v1.6.4
