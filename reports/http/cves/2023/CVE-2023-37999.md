---
cve_id: CVE-2023-37999
template_path: nuclei-templates/http/cves/2023/CVE-2023-37999.yaml
affected_product: HT Mega – Absolute Addons for Elementor
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.2.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
HT Mega – Absolute Addons for Elementor WordPress plugin (CVE-2023-37999) contains a missing authorization vulnerability in versions <= 2.2.0. The `htmega_ajax_register` function fails to validate the `reg_role` parameter, enabling unauthenticated attackers to register new administrator accounts.

This results in full privilege escalation. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-269. Remediation: update to version > 2.2.0.

## PoC / Detection
Classification: state-change

The template detects the issue by:
1. Issuing a POST to `/wp-admin/admin-ajax.php?action=htmega_ajax_register` with randomized username, password, email and `reg_role=administrator`. Matches on "Successfully Register" response.
2. Performing a subsequent login POST to `/wp-login.php` with the created credentials.
3. Verifying success via `wordpress_logged_in` cookie presence and 302 redirect to admin dashboard. Extracts credentials for proof.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ht-mega-for-elementor/ht-mega-absolute-addons-for-elementor-220-missing-authorization-to-privilege-escalation
- https://plugins.trac.wordpress.org/changeset/2934204/ht-mega-for-elementor/trunk/includes/helper-function.php?contextall=1&old=2899662&old_path=%2Fht-mega-for-elementor%2Ftrunk%2Fincludes%2Fhelper-function.php
- https://patchstack.com/database/vulnerability/ht-mega-for-elementor/wordpress-ht-mega-absolute-addons-for-elementor-plugin-2-2-0-unauthenticated-privilege-escalation-vulnerability?_s_id=cve
- https://nvd.nist.gov/vuln/detail/CVE-2023-37999
