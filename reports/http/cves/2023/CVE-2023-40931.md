---
cve_id: CVE-2023-40931
template_path: nuclei-templates/http/cves/2023/CVE-2023-40931.yaml
affected_product: Nagios XI
severity: medium
authentication: required
external_callback: false
affected_versions: 5.11.0 - 5.11.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
SQL injection (CWE-89) in Nagios XI 5.11.0–5.11.1 allows authenticated attackers to execute arbitrary SQL commands via the `id` parameter in POST `/nagiosxi/admin/banner_message-ajaxhelper.php` (action=acknowledge_banner_message).  
CVSS 3.1: 6.5 (Medium) – AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N.  
Impact: high-confidentiality data access through arbitrary SQL execution.

## PoC / Detection
Classification: info-leak

The template first GETs `/nagiosxi/login.php` and extracts the NSP token (regex `name=['"]nsp['"] value=['"](.*)['"]>`). It then POSTs credentials (`nsp`, `username`, `password`) to complete login, followed by a POST to the vulnerable endpoint with `id=*`. Detection matches HTTP 200 responses containing all three strings in body: "Failed to acknowledge", "SQL Error", and "right syntax to use near".

## References
- https://rootsecdev.medium.com/notes-from-the-field-exploiting-nagios-xi-sql-injection-cve-2023-40931-9d5dd6563f8c
- https://nvd.nist.gov/vuln/detail/CVE-2023-40931
