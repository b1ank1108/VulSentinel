---
cve_id: CVE-2023-4966
template_path: nuclei-templates/http/cves/2023/CVE-2023-4966.yaml
affected_product: Citrix NetScaler ADC and NetScaler Gateway
severity: high
authentication: none
external_callback: false
affected_versions: NetScaler ADC and Gateway 14.1 before 14.1-8.50, 13.1 before 13.1-49.15, 13.0 before 13.0-92.19, and 12.1 (EOL)
preconditions: configured as a Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) or AAA virtual server
poc_classification: info-leak
---

## Vulnerability
Citrix Bleed (CVE-2023-4966) enables sensitive information disclosure in NetScaler ADC and NetScaler Gateway. Unauthenticated remote attackers can leak session tokens from server memory when the target is configured as a Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) or AAA virtual server.  

Impact: leaked NSC_AAAC session tokens allow hijacking of active authenticated sessions and unauthorized access to protected Gateway resources.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). CWE-119 buffer errors.

## PoC / Detection
Classification: info-leak

The template triggers and verifies the leak with two chained unsafe raw requests. First it sends `GET /oauth/idp/.well-known/openid-configuration` containing a random 4-char header and an oversized `Host` header (24812 repeated 'a' characters) to cause memory disclosure. A regex extractor (internal) pulls candidate session tokens matching the pattern `[a-f0-9]{100}45525d5f4f58455e445a4a42` from the first response body. It then issues `POST /logon/LogonPoint/Authentication/GetUserName` injecting the extracted token as `Cookie: NSC_AAAC=...`. Matchers require both `NSC_AAAC=` plus `HTTP/1.1` and the OpenID JSON `{"issuer":` pattern in responses to confirm successful session-token leakage.

## References
- https://github.com/assetnote/exploits/blob/main/citrix/CVE-2023-4966/exploit.py
- https://github.com/Chocapikk/CVE-2023-4966
- https://www.assetnote.io/resources/research/citrix-bleed-leaking-session-tokens-with-cve-2023-4966
- https://x.com/assetnote/status/1716757539323564196?s=20
- https://www.netscaler.com/blog/news/cve-2023-4966-critical-security-update-now-available-for-netscaler-adc-and-netscaler-gateway/
