---
cve_id: CVE-2023-0777
template_path: nuclei-templates/http/cves/2023/CVE-2023-0777.yaml
affected_product: modoboa
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 2.0.4
preconditions: default administrator credentials (admin:password) unchanged
poc_classification: auth-bypass
---

## Vulnerability
Modoboa email server prior to 2.0.4 contains an authentication bypass (CWE-305) by primary weakness. Unauthenticated attackers can gain full administrator access using default credentials, resulting in complete compromise of Modoboa installations.

**Impact:** Unauthenticated attackers can exploit authentication bypass using default credentials to gain administrator access and completely compromise Modoboa email server installations.  
**Remediation:** Update to version 2.0.4.  
**CVSS 3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: auth-bypass

The template detects the vulnerability by simulating the admin takeover:
- GET /accounts/login/ extracts the CSRF token from the Set-Cookie header.
- POST /accounts/login/ submits `csrfmiddlewaretoken=<token>&username=admin&password=password`.
- GET /dashboard/ verifies success with status_code == 200, HTML content-type, and body containing both "Dashboard" and "Hello admin".

## References
- https://huntr.dev/bounties/a17e7a9f-0fee-4130-a522-5a0466fc17c7/
- http://packetstormsecurity.com/files/171744/modoboa-2.0.4-Admin-Takeover.html
- https://github.com/modoboa/modoboa/commit/47d17ac6643f870719691073956a26e4be0a4806
- https://github.com/7h3h4ckv157/7h3h4ckv157
