---
cve_id: CVE-2023-35162
template_path: nuclei-templates/http/cves/2023/CVE-2023-35162.yaml
affected_product: XWiki
severity: medium
authentication: none
external_callback: false
affected_versions: < 14.10.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2023-35162 is a reflected Cross-Site Scripting (XSS) vulnerability in XWiki Platform affecting versions prior to 14.10.5. The vulnerability exists in the previewactions template (previewactions.vm) where user input from the `xcontinue` parameter is not properly sanitized before being reflected in the HTML response. An attacker can inject arbitrary JavaScript code through this parameter, which will execute in the context of a victim's browser when they visit a specially crafted URL. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), indicating network-based exploitation requiring no privileges but user interaction, with potential for cross-site scope and limited confidentiality and integrity impact.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the XWiki instance targeting the FlamingoThemes/Cerulean page with specific parameters: `xpage=xpart`, `vm=previewactions.vm`, and `xcontinue=javascript:alert(document.domain)`. The detection verifies the presence of the XSS vulnerability by checking if the injected JavaScript payload is reflected unsanitized in the response body within an HTML attribute (`name="xcontinue" value="javascript:alert(document.domain)"`). The template confirms a vulnerable instance when all of the following conditions are met: the response contains the reflected payload in the xcontinue attribute, references previewactions.vm, returns a content-type of text/html, and responds with HTTP status 200. While the underlying vulnerability could enable session hijacking or credential theft (info-leak), the template uses a harmless proof-of-concept payload that only demonstrates the XSS condition without causing actual harm.

## References

- https://jira.xwiki.org/browse/XWIKI-20342
- https://github.com/xwiki/xwiki-platform/blob/244dbbaa0738a0c40b19929c0369c8b62ae5236e/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo/previewactions.vm#L48
- https://nvd.nist.gov/vuln/detail/CVE-2023-35162
