---
cve_id: CVE-2023-29204
template_path: nuclei-templates/http/cves/2023/CVE-2023-29204.yaml
affected_product: XWiki
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 13.10.10, 14.4.4 and 14.8RC1
preconditions: []
poc_classification: detect-only
---

## Vulnerability
XWiki Commons (technical libraries shared across XWiki platform projects) is vulnerable to an open redirect (CWE-601) because existing security filters on the `xredirect` parameter can be bypassed with protocol-relative URLs (`//mydomain.com`) or malformed URLs (`http:/mydomain.com`). The flaw was patched in XWiki 13.10.10, 14.4.4 and 14.8RC1. CVSS 3.1 vector: AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Successful exploitation lets an attacker redirect users to malicious sites, enabling phishing or malware delivery.

## PoC / Detection
Classification: detect-only

The template sends two unauthenticated GET requests to `{{BaseURL}}/bin/login/XWiki/XWikiLogin` with `xredirect` payloads set to `//www.oast.me` and `http:/www.oast.me`. It confirms the bypass by matching a regex on the `Location` response header that detects when the server reflects the attacker-controlled domain in the redirect.

## References
- https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xwph-x6xj-wggv
- https://jira.xwiki.org/browse/XWIKI-10309
- https://jira.xwiki.org/browse/XWIKI-19994
- https://nvd.nist.gov/vuln/detail/CVE-2023-29204
