---
cve_id: CVE-2023-27584
template_path: nuclei-templates/http/cves/2023/CVE-2023-27584.yaml
affected_product: Dragonfly2
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.1.0-beta.1
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Dragonfly2 < 2.1.0-beta.1 is an open-source CNCF-incubating P2P-based file distribution and image acceleration system that uses JWT for user verification with a hardcoded secret key "Secret Key". This enables unauthenticated remote attackers to forge valid JWT tokens (HS256) claiming admin user ID 1 and perform any action as administrator, including accessing all distributed files and fully compromising the P2P system. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-321. No workarounds. Fixed in 2.0.9 with a properly generated secret.

## PoC / Detection
Classification: auth-bypass

The template generates a JWT token with the known hardcoded secret "Secret Key", using payload `{"id":1,"exp":... ,"orig_iat":...}` (valid recent timestamps), places it in the `jwt` cookie, and issues a GET request to `/api/v1/users`. Success is confirmed by HTTP 200 status, `application/json` content-type, and presence of user fields `"id"`, `"created_at"`, `"updated_at"`, `"state"` in the body.

## References
- https://github.com/advisories/GHSA-hpc8-7wpm-889w
- https://github.com/dragonflyoss/Dragonfly2/releases/tag/v2.0.9
- https://github.com/dragonflyoss/Dragonfly2/security/advisories/GHSA-hpc8-7wpm-889w
- https://nvd.nist.gov/vuln/detail/cve-2023-27584
