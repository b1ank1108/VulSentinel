---
cve_id: CVE-2023-45826
template_path: nuclei-templates/http/cves/2023/CVE-2023-45826.yaml
affected_product: Leantime
severity: medium
authentication: required
external_callback: false
affected_versions: < 2.4-beta-4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Leantime open-source project management system contains an authenticated SQL injection in the `userId` parameter handled by `app/domain/files/repositories/class.files.php`. The parameter is not sanitized or parameterized before use in a database query. An authenticated attacker can craft a POST request to `/api/jsonrpc` (method `leantime.rpc.files.getFilesByModule`) to perform UNION-based extraction of arbitrary database contents. Impact is strictly confidentiality (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N); no write, RCE, or DoS capability is present in the flaw. Fixed by parameterized queries in 2.4-beta-4; no workarounds exist.

## PoC / Detection
Classification: info-leak

Template first issues a POST `/auth/login` (form-urlencoded with supplied username/password) and confirms successful session creation by matching `/dashboard/home` in the response body. It then issues a second POST `/api/jsonrpc` containing a malicious JSON-RPC payload where the `userId` value is `"9 union select concat(0x{{hex_marker}},0x3a,user()),2,3,4,5,6,7,8,9,10,11-- -"` (random hex marker inserted). Detection succeeds when the 200 OK response body simultaneously contains the literal string `Request was successful` and the injected marker string. A regex extractor captures the leaked `user()` value from the JSON response for confirmation of data exfiltration.

## References
- https://github.com/advisories/GHSA-c39w-3pjx-qc7m
