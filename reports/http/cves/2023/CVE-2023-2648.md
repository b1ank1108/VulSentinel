---
cve_id: CVE-2023-2648
template_path: nuclei-templates/http/cves/2023/CVE-2023-2648.yaml
affected_product: Weaver E-Office
severity: critical
authentication: none
external_callback: false
affected_versions: 9.5
preconditions: []
poc_classification: rce
---

## Vulnerability
Weaver E-Office 9.5 contains a critical unrestricted file upload vulnerability (CWE-434) in `/inc/jquery/uploadify/uploadify.php`. Remote unauthenticated attackers can manipulate the `Filedata` argument to upload arbitrary PHP files, resulting in remote code execution. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Public exploit disclosed; vendor contacted but did not respond.

## PoC / Detection
Classification: rce

The template detects by sending a multipart POST to `/inc/jquery/uploadify/uploadify.php` with a randomized PHP payload `<?php echo md5("CVE-2023-2648");unlink(__FILE__);?>` uploaded as `{{file}}.php.` (Content-Type image/jpeg). It extracts the numeric attachment `name` via regex `([0-9]+)` from the first response body, then issues a second POST to `/attachment/{{name}}/{{file}}.php` and verifies the MD5 hash appears in the second response body with status 200, confirming PHP execution (payload self-deletes).

## References
- https://github.com/sunyixuan1228/cve/blob/main/weaver.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-2648
- https://vuldb.com/?ctiid.228777
- https://vuldb.com/?id.228777
- https://github.com/bingtangbanli/cve-2023-2523-and-cve-2023-2648
