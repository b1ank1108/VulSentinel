---
cve_id: CVE-2023-1892
template_path: nuclei-templates/http/cves/2023/CVE-2023-1892.yaml
affected_product: Sidekiq
severity: critical
authentication: none
external_callback: false
affected_versions: < 7.0.8
preconditions: Sidekiq admin panel accessible
poc_classification: info-leak
---

## Vulnerability
Sidekiq versions below 7.0.8 contain a reflected cross-site scripting (XSS) vulnerability in the admin panel's metrics endpoints. The `period` query parameter is not properly sanitized or encoded, allowing unauthenticated injection of arbitrary JavaScript (CWE-79). 

When an administrator visits a crafted URL, the payload executes in their browser session context (scope change), enabling theft of administrator session cookies and disclosure of sensitive job queue information and worker statistics. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H (9.6).

## PoC / Detection
Classification: info-leak

The template first sends a GET to `{{BaseURL}}/queues` and internally matches the body for both "Sidekiq" and "Dashboard</a>" to fingerprint the Sidekiq dashboard. It then issues GET requests (stopping at first match) to `/metrics`, `/metrics/SanityChecksJob`, and `/metrics/ActiveStorage::PurgeJob` with the reflected payload `period=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E`. Success is confirmed when the raw unsanitized payload string appears in the response body, Content-Type is `text/html`, and status is 200.

## References
- https://huntr.com/bounties/e35e5653-c429-4fb8-94a3-cbc123ae4777
- https://github.com/sidekiq/sidekiq/commit/458fdf74176a9881478c48dc5cf0269107b22214
- https://nvd.nist.gov/vuln/detail/CVE-2023-1892
