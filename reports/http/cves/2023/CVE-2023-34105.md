---
cve_id: CVE-2023-34105
template_path: nuclei-templates/http/cves/2023/CVE-2023-34105.yaml
affected_product: SRS (Simple Realtime Server)
severity: high
authentication: none
external_callback: true
affected_versions: v5.0.137 to v5.0.156, v6.0.18 to v6.0.47
preconditions: [User interaction required (drive-by attack)]
poc_classification: rce
---

## Vulnerability

CVE-2023-34105 is a command injection vulnerability in SRS (Simple Realtime Server) affecting versions v5.0.137 through v5.0.156 and v6.0.18 through v6.0.47. The vulnerability exists in the api-server component's snapshots API endpoint, specifically in how it processes the `app` parameter. Unauthenticated attackers can inject arbitrary commands through this parameter, but exploitation requires user interaction, making this a "drive-by" command injection attack. The vulnerability is classified as CWE-77 (Command Injection) and CWE-78 (OS Command Injection), with a CVSS score of 7.5 (High severity). The EPSS score of 0.82764 (99.219th percentile) indicates a high probability of exploitation in the wild.

The flaw stems from improper input sanitization in the api-server's snapshots endpoint, allowing shell metacharacters to be interpreted and executed by the underlying operating system when processing snapshot requests.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to the `/api/v1/snapshots` endpoint with a JSON payload containing an `on_publish` action. The `app` parameter is crafted with a command injection payload using backticks to execute a `nslookup` command that queries an Interactsh server controlled by the tester: `` `nslookup {{interactsh-url}}` ``.

The template verifies successful exploitation through multiple conditions:
1. DNS interaction is received at the Interactsh server, confirming command execution
2. The response body contains JSON structure with `"code":` and `"data":` fields
3. The response Content-Type is `application/json`
4. The HTTP status code is 200

This detection method confirms that arbitrary commands can be executed on the SRS server through the vulnerable parameter, demonstrating remote code execution capability.

## References

- https://github.com/ossrs/srs/security/advisories/GHSA-vpr5-779c-cx62
- https://github.com/ossrs/srs/blob/1d11d02e4b82fc3f37e4b048cff483b1581482c1/trunk/research/api-server/server.go#L761
