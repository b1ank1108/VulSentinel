---
cve_id: CVE-2023-27847
template_path: nuclei-templates/http/cves/2023/CVE-2023-27847.yaml
affected_product: PrestaShop xipblog
severity: critical
authentication: none
external_callback: false
affected_versions: xipblog module < 2.0.1 (patched in 2.0.1 but version number not incremented)
preconditions: [xipblog module installed]
poc_classification: info-leak
---

## Vulnerability
SQL injection vulnerability (CVE-2023-27847, CWE-89) in PrestaShop xipblog blog module. An anonymous user can perform arbitrary SQL queries via the `/module/xipblog/archive` endpoint by manipulating parameters such as `subpage_type` and `rewrite`. The module was patched in version 2.0.1; however, the version number was not incremented at the time.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation enables execution of arbitrary SQL queries, potentially leading to unauthorized access and data leakage.

## PoC / Detection
Classification: info-leak

The template verifies the vulnerability with a 5-request flow:

- GET `/` confirms module presence by matching `xipblog` in body (internal).
- Time-based blind SQLi: injects `"+AND+(SELECT+5728+FROM+(SELECT(SLEEP(5)))AuDU)--+` into archive endpoint; matches `duration >= 5` and `status_code != 404`.
- Boolean-based true condition: injects `"+AND+5484=5484--+` ; matches presence of `kr_blog_post_area` string in body (internal).
- Boolean-based false condition: injects `"+AND+5484=5485--+` ; matches absence of the marker string.
- Union-based: injects `"+UNION+ALL+SELECT+...+CONCAT(md5(999999999))+...--+-` ; matches `status_code != 404` and presence of the computed MD5 hash in body.

All requests target the vulnerable endpoint with host-redirects enabled and appropriate timeouts. No authentication or external interaction required.

## References
- https://security.friendsofpresta.org/modules/2023/03/23/xipblog.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27847
