---
cve_id: CVE-2023-37266
template_path: nuclei-templates/http/cves/2023/CVE-2023-37266.yaml
affected_product: CasaOS
severity: critical
authentication: none
external_callback: false
affected_versions: < 0.4.4
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
CasaOS is an open-source Personal Cloud system. Unauthenticated attackers can craft arbitrary JWTs (fixed payload signed with HS256) and access features that usually require authentication, including the ability to execute arbitrary commands as `root`. Fixed by improved JWT validation in commit `705bf1f` (part of CasaOS 0.4.4).  
Impact: Successful exploitation allows unauthorized access to the CasaOS system.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)  
CWE-287

## PoC / Detection
Classification: auth-bypass  
The template defines a fixed JWT payload `{"iss":"casaos","exp":1790210322,"nbf":1790199522,"iat":1790199522}` and generates a token via `generate_jwt(..., "HS256")`. It issues a GET request to `{{BaseURL}}/v1/folder?path=%2F` with `Authorization: {{jwt_token}}` and matches on the JSON response containing all of `"success":200`, `"message":"ok"`, `content`, and `is_dir` to confirm the bypass succeeded and a protected folder endpoint is reachable.

## References
- https://github.com/IceWhaleTech/CasaOS/commit/705bf1facbffd2ca40b159b0303132b6fdf657ad
- https://github.com/IceWhaleTech/CasaOS/security/advisories/GHSA-m5q5-8mfw-p2hr
