---
cve_id: CVE-2023-37462
template_path: nuclei-templates/http/cves/2023/CVE-2023-37462.yaml
affected_product: XWiki Platform
severity: high
authentication: none
external_callback: false
affected_versions: prior to 14.4.8, 14.10.4 and 15.0-rc-1
preconditions: view rights on SkinsCode.XWikiSkinsSheet
poc_classification: rce
---

## Vulnerability
XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Improper escaping in the document `SkinsCode.XWikiSkinsSheet` leads to an injection vector from view rights on that document to programming rights, enabling execution of arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. The attack works by opening a non-existing page with a name crafted to contain a dangerous payload.

**CVSS:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-74  
**Impact:** Successful exploitation allows an attacker to execute arbitrary code on the affected system.  
**Remediation:** Upgrade to XWiki 14.4.8, 14.10.4 or 15.0-rc-1 (and later).

## PoC / Detection
Classification: rce

The template detects the flaw via two sequential GET requests. The first targets `{{BaseURL}}/bin/view/[URL-encoded crafted non-existent page name embedding {{async async="true" cached="false" context="doc.reference"}}{{python}}print(3724348 * 8473334){{/python}}{{/async}}]?sheet=SkinsCode.XWikiSkinsSheet&xpage=view`. Regex extractors internally capture the async client ID (`data-xwiki-async-client-id`) and URL (`data-xwiki-async-id`) from the response. The second request polls `/asyncrenderer/{{url}}?clientId={{id}}&timeout=500&wiki=xwiki`. Confirmation requires `body_2 == "31557644536232"`, `contains(header_2, "text/html")` and `status_code_2 == 200`.

## References
- https://github.com/xwiki/xwiki-platform/commit/d9c88ddc4c0c78fa534bd33237e95dea66003d29
- https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h4vp-69r8-gvjg
- https://jira.xwiki.org/browse/XWIKI-20457
- https://github.com/fkie-cad/nvd-json-data-feeds
