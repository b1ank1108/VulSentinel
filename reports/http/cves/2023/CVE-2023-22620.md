---
cve_id: CVE-2023-22620
template_path: nuclei-templates/http/cves/2023/CVE-2023-22620.yaml
affected_product: SecurePoint UTM
severity: high
authentication: none
external_callback: false
affected_versions: before 12.2.5.1
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
An issue was discovered in SecurePoint UTM before 12.2.5.1. The firewall endpoint `/spcgi.cgi` leaks the `sessionid` via an invalid authentication attempt. This sessionid can then be reused to bypass authentication entirely and gain access to the administrative interface.  

Impact: Successful exploitation leads to unauthorized access to sensitive information and the ability to perform actions on behalf of legitimate users.  

CVSS: 7.5 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H)  
CWE: 863 (Incorrect Authorization)  
Remediation: Upgrade to version 12.2.5.1 or newer.

## PoC / Detection
Classification: auth-bypass

The template executes a two-step unauthenticated detection:  
1. Sends a POST to `/spcgi.cgi` with `{"module":"auth","command":["login"],"sessionid":"","arguments":{"user":"","pass":""}}` to trigger the sessionid leak and extracts the value via regex `("sessionid": "([a-z0-9]+)")`.  
2. Reuses the extracted sessionid in a second POST (`{"module":"system","command":["config","get"],"sessionid":"{{session}}"}`) to retrieve system configuration.  

Matchers confirm exploitation success by checking for `"status":"OK"` in the second response body and `application/json` in the response header.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2023-22620
- https://github.com/MrTuxracer/advisories/blob/master/CVEs/CVE-2023-22620.txt
- https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/
- https://packetstormsecurity.com/files/171924/SecurePoint-UTM-12.x-Session-ID-Leak.html
- https://rcesecurity.com
