---
cve_id: CVE-2023-3277
template_path: nuclei-templates/http/cves/2023/CVE-2023-3277.yaml
affected_product: MStore API
severity: critical
authentication: none
external_callback: false
affected_versions: <= 4.10.7
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

The MStore API plugin for WordPress contains a critical authentication bypass vulnerability in versions up to and including 4.10.7. The vulnerability stems from an improper implementation of the Apple login feature that fails to properly validate authentication tokens. This flaw allows unauthenticated attackers to log in as any user account by simply knowing the target user's email address. The attacker can craft a malicious token containing the victim's email address and authenticate as that user without requiring any legitimate credentials. This leads to unauthorized account access and privilege escalation, potentially allowing attackers to gain administrative access if they target administrator accounts.

## PoC / Detection

Classification: auth-bypass

The template exploits the vulnerable Apple login endpoint by crafting a fake authentication token. It constructs a base64-encoded JSON payload containing only an email address (no signature or cryptographic validation), wraps it with periods to mimic a JWT-like structure, and sends it to the `/wp-json/api/flutter_user/apple_login` endpoint along with randomly generated first and last names. The template verifies successful exploitation by checking for authentication artifacts in the response: the presence of `wp_user_id`, `cookie`, and `user_login` fields in a JSON response with HTTP 200 status. These fields indicate that the server has successfully authenticated the attacker and issued valid session credentials for the targeted user account.

## References

- https://www.wordfence.com/threat-intel/vulnerabilities/id/1c7c0c35-5f44-488f-9fe1-269ea4a73854?source=cve
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2988788%40mstore-api%2Ftrunk&old=2985882%40mstore-api%2Ftrunk&sfp_email=&sfph_mail=
- https://plugins.trac.wordpress.org/browser/mstore-api/trunk/controllers/flutter-user.php#L821
- https://nvd.nist.gov/vuln/detail/CVE-2023-3277
