---
cve_id: CVE-2023-2252
template_path: nuclei-templates/http/cves/2023/CVE-2023-2252.yaml
affected_product: Directorist
severity: low
authentication: required
external_callback: false
affected_versions: < 7.5.4
preconditions: [Directorist plugin installed on WordPress]
poc_classification: info-leak
---

## Vulnerability
Directorist WordPress plugin (wpwax) before 7.5.4 fails to validate the `file` parameter when importing CSV files via the admin tools interface, resulting in local file inclusion (CWE-22).  
CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N (score 2.7).  
Successful exploitation allows authenticated high-privileged users to read arbitrary local files, enabling information disclosure with potential for further compromise including RCE and full system takeover.  
Fixed in version 7.5.4.

## PoC / Detection
Classification: info-leak  
The template first sends a POST to `/wp-login.php` with `log={{username}}&pwd={{password}}` to authenticate, then issues a GET to `/wp-admin/edit.php?post_type=at_biz_dir&page=tools&step=2&file=%2Fetc%2Fpasswd&delimiter=%3B`. It verifies success by matching regex `root:[x*]:0:0` in the response body and HTTP status 200.

## References
- https://wpscan.com/vulnerability/9da6eede-10d0-4609-8b97-4a5d38fa8e69
- https://wordpress.org/plugins/directorist/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2023-2252
