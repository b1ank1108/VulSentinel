---
cve_id: CVE-2008-1059
template_path: nuclei-templates/http/cves/2008/CVE-2008-1059.yaml
affected_product: WordPress Sniplets plugin
severity: high
authentication: none
external_callback: false
affected_versions: 1.1.2 and 1.2.2
preconditions: [Sniplets plugin installed on WordPress]
poc_classification: rce
---

## Vulnerability
PHP remote file inclusion vulnerability in `modules/syntax_highlight.php` of the WordPress Sniplets plugin (versions 1.1.2 and 1.2.2). Remote unauthenticated attackers can execute arbitrary PHP code by supplying a URL in the `libpath` parameter. Successful exploitation leads to unauthorized access to sensitive files, remote code execution, and potential full compromise of the WordPress installation.  
CVSS v2.0: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P). CWE-94.  

## PoC / Detection
Classification: rce  
The template performs a single unauthenticated GET request to `{{BaseURL}}/wp-content/plugins/sniplets/modules/syntax_highlight.php?libpath=../../../../wp-config.php` and verifies exploitation conditions by checking that the response body contains both `DB_NAME` and `DB_PASSWORD` strings (AND condition) with HTTP status 200. This harmless local-file probe confirms the inclusion flaw is present (and therefore exploitable for arbitrary PHP/RCE).  

## References
- https://www.exploit-db.com/exploits/5194
- https://wpscan.com/vulnerability/d0278ebe-e6ae-4f7c-bcad-ba318573f881
- https://nvd.nist.gov/vuln/detail/CVE-2008-1059
- http://securityreason.com/securityalert/3706
- https://exchange.xforce.ibmcloud.com/vulnerabilities/40829
