---
cve_id: CVE-2008-5587
template_path: nuclei-templates/http/cves/2008/CVE-2008-5587.yaml
affected_product: phpPgAdmin
severity: medium
authentication: none
external_callback: false
affected_versions: <=4.2.1
preconditions: register_globals enabled
poc_classification: info-leak
---

## Vulnerability
phpPgAdmin <=4.2.1 is vulnerable to local file inclusion in `libraries/lib.inc.php` when PHP `register_globals` is enabled. Remote attackers can read arbitrary files via path traversal (`..`) in the `_language` parameter to `index.php`.

**Impact:** An attacker can exploit this vulnerability to read sensitive files on the server and potentially execute arbitrary code.

**Remediation:** Upgrade phpPgAdmin to a version higher than 4.2.1 or apply the necessary patches provided by the vendor.

**CVSS v2:** 4.3 (AV:N/AC:M/Au:N/C:P/I:N/A:N) â€¢ CWE-22

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by sending a single unauthenticated GET request to `{{BaseURL}}/phpPgAdmin/index.php?_language=../../../../../../../../etc/passwd%00` and checking for HTTP 200 status plus regex match on `root:[x*]:0:0` in the response body.

## References
- https://www.exploit-db.com/exploits/7363
- https://nvd.nist.gov/vuln/detail/CVE-2008-5587
- http://lists.opensuse.org/opensuse-security-announce/2009-02/msg00002.html
- http://lists.opensuse.org/opensuse-updates/2012-04/msg00033.html
- http://securityreason.com/securityalert/4737
