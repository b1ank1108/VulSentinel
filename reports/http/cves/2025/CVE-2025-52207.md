---
cve_id: CVE-2025-52207
template_path: nuclei-templates/http/cves/2025/CVE-2025-52207.yaml
affected_product: MikoPBX
severity: critical
authentication: required
external_callback: false
affected_versions: through 2024.1.114
preconditions: []
poc_classification: rce
---

## Vulnerability
MikoPBX through 2024.1.114 contains an authenticated unrestricted file upload vulnerability in `PBXCoreREST/Controllers/Files/PostController.php` that permits PHP script uploads.

Authenticated attackers can upload and execute arbitrary PHP scripts, achieving remote code execution and full system compromise.

CVSS: 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L)  
CWE: CWE-23

Remediation: Update to a version beyond 2024.1.114.

## PoC / Detection
Classification: rce

The template detects the vulnerability by:  
1. Authenticating via POST `/admin-cabinet/session/start` with supplied `{{username}}`/`{{password}}` and verifying successful session start.  
2. Performing a multipart resumable upload of a test PHP file (`{{rand}}.php` containing `<?php echo(base64_encode("{{filename}}")); ?>`) to `/pbxcore/api/files/uploadFile`.  
3. Extracting the uploaded cache path from the JSON response and issuing a GET to `/pbxcore/files/cache/{{extracted_path}}`, confirming PHP execution when the body exactly matches the base64-encoded filename.

## References
- https://github.com/mikopbx/Core/commit/3ee785429d3f1b33c9ab387ef4221127c9b8c5f3
