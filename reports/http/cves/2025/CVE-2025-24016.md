---
cve_id: CVE-2025-24016
template_path: nuclei-templates/http/cves/2025/CVE-2025-24016.yaml
affected_product: Wazuh
severity: critical
authentication: required
external_callback: false
affected_versions: >= 4.4.0 and < 4.9.1
preconditions: authenticated API access
poc_classification: rce
---

## Vulnerability
Unsafe deserialization in Wazuh server (wazuh-manager package, DistributedAPI component, `framework/wazuh/core/cluster/common.py:as_wazuh_object`). JSON-serialized parameters are deserialized without sanitization; attacker-supplied dictionary with `__unhandled_exc__` gadget triggers arbitrary Python code execution.

Description: critical RCE in versions >= 4.4.0 and < 4.9.1 via injection into DAPI requests (specifically `/security/user/authenticate/run_as`).

Impact: arbitrary code as wazuh-manager process â†’ full system compromise, data exfiltration, lateral movement, DoS. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H (score 9.9). CWE-502.

Remediation: upgrade to >= 4.9.1. Workarounds: IP-restrict API, network segment Wazuh servers, monitor `/security/user/authenticate/run_as`, deploy WAF.

## PoC / Detection
Classification: rce

Template executes two-step flow:  
1. GET `/` (internal baseline, negative matcher for "NameError").  
2. POST `/security/user/authenticate/run_as` (Basic `{{base64(username:password)}}`, Content-Type application/json) with payload `{"__unhandled_exc__":{"__class__": "NotARealClass", "__args__": []}}`.  

Confirms via AND matchers: body contains "NameError" and status 500.

## References
- https://github.com/MuhammadWaseem29/CVE-2025-24016
- https://github.com/wazuh/wazuh/security/advisories/GHSA-hcrc-79hj-m3qh
- https://nvd.nist.gov/vuln/detail/CVE-2025-24016
