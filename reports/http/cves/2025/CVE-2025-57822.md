---
cve_id: CVE-2025-57822
template_path: nuclei-templates/http/cves/2025/CVE-2025-57822.yaml
affected_product: Next.js Middleware
severity: medium
authentication: none
external_callback: true
affected_versions: prior to 14.2.32 and 15.4.7
preconditions: middleware insecurely passing request headers to NextResponse.next()
poc_classification: info-leak
---

## Vulnerability
Next.js Middleware prior to versions 14.2.32 and 15.4.7 is vulnerable to Server-Side Request Forgery (SSRF, CWE-918). The flaw occurs when request headers are insecurely passed to `NextResponse.next()` inside middleware, allowing header manipulation (e.g. `Location`, `X-Middleware-Rewrite`) to force the server into issuing requests to arbitrary internal or external URLs.

**Impact:** Attackers can target internal services, perform port scanning, or exfiltrate data via SSRF.  
**CVSS:** 6.5 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:L/A:N)  
**Remediation:** Upgrade to Next.js 14.2.32, 15.4.7 or later.

## PoC / Detection
Classification: info-leak

The template first fingerprints Next.js by issuing a GET to `{{BaseURL}}` and matching the string `_next/static` in the response body (internal matcher). It then performs a second GET to `{{BaseURL}}/?cb={{rand_text_alpha(10)}}` while injecting the headers `Location: https://oast.me` and `X-Middleware-Rewrite: https://oast.me`. A vulnerable instance triggers SSRF, causing the server to fetch content from the OOB domain; detection succeeds when the response body contains `<h1> Interactsh Server </h1>`.

## References
- https://github.com/vercel/next.js/security/advisories/GHSA-4342-x723-ch2f
- https://vercel.com/changelog/cve-2025-57822
- https://nvd.nist.gov/vuln/detail/CVE-2025-57822
