---
cve_id: CVE-2025-54123
template_path: nuclei-templates/http/cves/2025/CVE-2025-54123.yaml
affected_product: Hoverfly
severity: critical
authentication: none
external_callback: false
affected_versions: <= 1.11.3
preconditions: []
poc_classification: rce
---

## Vulnerability
Hoverfly versions 1.11.3 and below are vulnerable to remote code execution (RCE) via command injection in the middleware API endpoint (/api/v2/hoverfly/middleware). Insufficient validation of the 'binary' and 'script' parameters allows an unauthenticated attacker to execute arbitrary commands on the host system.  
**Impact:** Unauthenticated attackers can inject arbitrary operating system commands through the middleware API endpoint, achieving complete server compromise.  
**Remediation:** Upgrade Hoverfly to a version later than 1.11.3 that properly validates the binary and script parameters in the middleware endpoint.

## PoC / Detection
Classification: rce  
The template issues a single unauthenticated PUT request to `/api/v2/hoverfly/middleware` carrying a JSON payload that sets `"binary": "/bin/sh"` and `"script": "cat /etc/passwd"`. Detection succeeds when the response satisfies all three conditions simultaneously: HTTP status code exactly 422, the regex `root:x:0:0` appears in the body (proving command output leakage), and the body contains both the literal strings `STDOUT:` and `hoverfly`.

## References
- https://github.com/advisories/GHSA-r4h8-hfp2-ggmf
- https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-r4h8-hfp2-ggmf
