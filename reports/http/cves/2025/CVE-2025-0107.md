---
cve_id: CVE-2025-0107
template_path: nuclei-templates/http/cves/2025/CVE-2025-0107.yaml
affected_product: Palo Alto Networks Expedition
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
An OS command injection vulnerability in Palo Alto Networks Expedition enables an unauthenticated attacker to run arbitrary OS commands as the www-data user in Expedition. This results in the disclosure of usernames, cleartext passwords, device configurations, and device API keys for firewalls running PAN-OS software.  
Impact: Unauthenticated attackers can execute arbitrary OS commands on Expedition servers, leading to full compromise of connected PAN-OS firewalls via stolen credentials and configurations.  
CVSS: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: rce  
The template issues a single unauthenticated raw GET request to `/API/regionsDiscovery.php` with the `master` parameter set to `spark://{{interactsh-url}}:443` (plus crafted values for `mask`, `project`, `devices`, `mtserver`, `mtuser`, `mtpassword`, `task-id`, `mode`, `regions`, `parquetPath`, `timezone`, `mlserver`, `debug`, `initDate`, `endDate`). It detects success via AND matchers on the JSON response body containing both `'msg":"Started'` and `'"success":true'`, plus confirmation of a DNS interaction on the interactsh domain.

## References
- https://security.paloaltonetworks.com/PAN-SA-2025-0001
- https://ssd-disclosure.com/ssd-advisory-palo-alto-expedition-rce-regionsdiscovery/
- https://nvd.nist.gov/vuln/detail/CVE-2025-0107
