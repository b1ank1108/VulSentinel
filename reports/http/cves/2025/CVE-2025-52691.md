---
cve_id: CVE-2025-52691
template_path: nuclei-templates/http/cves/2025/CVE-2025-52691.yaml
affected_product: SmarterMail
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
SmarterMail mail server contains an unrestricted file upload vulnerability (CVE-2025-52691). Unauthenticated attackers can upload arbitrary files (including .aspx webshells) to any filesystem location by abusing path traversal in the `contextData` GUID field (`{"guid":"dag/../../{random}"}`) combined with the `/api/upload` multipart endpoint. Successful upload enables remote code execution and full server compromise.

## PoC / Detection
Classification: rce

The template issues one raw POST to `/api/upload` with multipart/form-data boundary. Fields include `context=attachment`, `resumableIdentifier=fakeID`, `resumableFilename={random}.aspx`, `contextData={"guid":"dag/../../{rand_string}"}`, and a file part containing the string "Detection Artifact Generator". Detection succeeds on HTTP 200 + body containing both `"fileName":` and `{"key":`.

## References
- https://github.com/watchtowrlabs/watchTowr-vs-SmarterMail-CVE-2025-52691
- https://www.csa.gov.sg/alerts-and-advisories/alerts/al-2025-124/
