---
cve_id: CVE-2025-49706
template_path: nuclei-templates/http/cves/2025/CVE-2025-49706.yaml
affected_product: Microsoft SharePoint Server
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
CVE-2025-49706 is an improper authentication issue (CWE-287) in Microsoft SharePoint Server.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N (score 6.5).  
Unauthenticated remote attackers can spoof authentication by manipulating the Referer header, gaining access to the ToolPane.aspx endpoint (DisplayMode=Edit) and performing unauthorized actions on SharePoint sites.  
Impact: network-based spoofing that bypasses authentication controls.  
Remediation: apply Microsoft SharePoint Server security patches per the MSRC update guide.

## PoC / Detection
Classification: auth-bypass

The template detects the flaw with a two-step HTTP flow on the target SharePoint instance:  
1. POST `/\_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` (no special Referer, form data `MSOTlPn_Uri=&MSOTlPn_DWP=`) – internal matcher expects 301/302 redirect, `Microsoftsharepointteamservices` header, and “object moved” in body.  
2. Identical POST but with `Referer: /_layouts/SignOut.aspx` – matcher expects HTTP 400 and the same SharePoint header.  
Both steps must succeed for a positive detection, confirming the Referer-based authentication bypass.

## References
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49706
- https://securelist.com/toolshell-explained/117045/
- https://www.wiz.io/blog/sharepoint-vulnerabilities-cve-2025-53770-cve-2025-53771-everything-you-need-to-k
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/sharepoint_toolpane_rce.rb
- https://nvd.nist.gov/vuln/detail/CVE-2025-49706
