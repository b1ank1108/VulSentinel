---
cve_id: CVE-2025-64764
template_path: nuclei-templates/http/cves/2025/CVE-2025-64764.yaml
affected_product: Astro
severity: high
authentication: none
external_callback: false
affected_versions: < 5.15.8
preconditions: use of server islands in the application
poc_classification: rce
---

## Vulnerability
Reflected XSS in Astro due to improper sanitization when processing the server islands feature endpoint. Remote attackers can craft a URL that injects arbitrary JavaScript executed in the victim's browser context upon visit, enabling session hijacking, credential theft, or arbitrary client-side actions. The flaw is triggered only when the target application actively uses server islands (evidenced by _server-islands paths in HTML). Fixed in Astro 5.15.8; all earlier versions are affected.

## PoC / Detection
Classification: rce

The template executes a two-request workflow to verify exploitable reflection:  
1. GET to `{{BaseURL}}/` (following redirects) with an internal regex matcher/extractor that locates and captures the dynamic server-islands path from body content matching `/_server-islands/[^?]+\?e=`.  
2. Raw GET to the extracted path with query `?e=file&p=&s={"{{rand}}":"<img+src=x+onerror=alert(0)>"}`, followed by a DSL matcher confirming status_code == 200 AND the exact unsanitized `<img src=x onerror=alert(0)>` string appears in the response body.

## References
- https://zhero-web-sec.github.io/research-and-things/unlocking-reflected-xss-in-the-astro-framework
