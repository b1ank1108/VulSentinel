---
cve_id: CVE-2025-68613
template_path: nuclei-templates/http/cves/2025/CVE-2025-68613.yaml
affected_product: n8n
severity: critical
authentication: required
external_callback: false
affected_versions: (>= 0.211.0 && < 1.120.4) || (>= 1.121.0 && < 1.121.1)
preconditions: ability to create and execute workflows
poc_classification: rce
---

## Vulnerability
n8n workflow automation platform contains a remote code execution vulnerability due to insufficient isolation in workflow expression evaluation. Authenticated attackers can inject Node.js expressions (e.g., via Set node) that bypass sandboxing to require('child_process').execSync and run arbitrary OS commands with n8n process privileges.

**Impact**: Full system compromise possible.  
**Remediation**: Upgrade to 1.120.4, 1.121.1, or 1.122.0 or later.  
**CVSS**: 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)  
**CWE**: CWE-94

## PoC / Detection
Classification: rce

The template detects the vulnerability by:
- Fetching /signin and parsing base64-encoded n8n config meta tag to extract version string.
- Applying DSL matchers for vulnerable ranges.
- (If n8n_email/n8n_password supplied) Logging in via POST /rest/login.
- Creating a temporary workflow via POST /rest/workflows containing a Manual Trigger + Set node with malicious expression `={{ (function() { var require = this.process.mainModule.require; var execSync = require('child_process').execSync; return execSync('whoami && id && uname -a').toString(); })() }}`.
- Running the workflow via POST /rest/workflows/{id}/run.
- Polling GET /rest/executions/{id} and matching command output (uid= pattern) in JSON response.
- Cleaning up via archive + DELETE on the workflow.

This is a full intrusive exploit verification (max 7 requests).

## References
- https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp
- https://nvd.nist.gov/vuln/detail/CVE-2025-68613
