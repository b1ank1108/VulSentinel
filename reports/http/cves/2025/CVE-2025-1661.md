---
cve_id: CVE-2025-1661
template_path: nuclei-templates/http/cves/2025/CVE-2025-1661.yaml
affected_product: HUSKY – Products Filter Professional for WooCommerce
severity: critical
authentication: none
external_callback: false
affected_versions: <= 1.3.6.5
preconditions: []
poc_classification: rce
---

## Vulnerability

The HUSKY – Products Filter Professional for WooCommerce plugin for WordPress contains a critical Local File Inclusion (LFI) vulnerability in all versions up to and including 1.3.6.5. The vulnerability exists in the `template` parameter of the `woof_text_search` AJAX action, which fails to properly validate and sanitize user input. This allows unauthenticated attackers to include and execute arbitrary files on the server through path traversal sequences. The flaw can be exploited to execute arbitrary PHP code present in included files, bypass access controls, obtain sensitive data (such as database credentials from wp-config.php), or achieve remote code execution when combined with file upload capabilities. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS score of 9.8, and has an EPSS score of 0.91448 (99.653rd percentile), indicating a very high probability of active exploitation.

## PoC / Detection

Classification: rce

The template performs a two-step detection process to verify the Local File Inclusion vulnerability:

1. **First request**: Sends a POST request to `/wp-admin/admin-ajax.php` with the `action` parameter set to `woof_text_search` and a `template` parameter containing a path traversal payload (`../../../../../../../wp-config`). The matcher checks if the response body contains specific strings ('options', 'min_symbols', and the escaped path traversal sequence), indicating successful file inclusion processing.

2. **Second request**: Sends a similar POST request but with an intentionally invalid file path (`wp-configx` instead of `wp-config`). This control request verifies the vulnerability by checking for error messages ('Wrong path to template', 'woof_husky_txt-option-title', 'woof_husky_txt-option-text') that confirm the plugin is processing the template parameter and attempting file inclusion.

Both requests must succeed (flow: http(1) && http(2)) to confirm the vulnerability. The template uses differential analysis between a valid and invalid path to definitively identify the LFI flaw without actually executing malicious code.

## References

- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/woocommerce-products-filter/husky-products-filter-professional-for-woocommerce-1365-unauthenticated-local-file-inclusion
- https://plugins.trac.wordpress.org/browser/woocommerce-products-filter/trunk/ext/by_text/index.php
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3249621%40woocommerce-products-filter&new=3249621%40woocommerce-products-filter&sfp_email=&sfph_mail=
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3253169%40woocommerce-products-filter&new=3253169%40woocommerce-products-filter&sfp_email=&sfph_mail=
- https://www.wordfence.com/threat-intel/vulnerabilities/id/9ae7b6fc-2120-4573-8b1b-d5422d435fa5?source=cve
