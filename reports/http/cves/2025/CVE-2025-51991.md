---
cve_id: CVE-2025-51991
template_path: nuclei-templates/http/cves/2025/CVE-2025-51991.yaml
affected_product: XWiki
severity: critical
authentication: required
external_callback: false
affected_versions: <= 17.3.0
preconditions: authenticated administrator access to Administration interface HTTP Meta Info field
poc_classification: rce
---

## Vulnerability
XWiki <= 17.3.0 suffers from server-side template injection (SSTI) due to missing sanitization of Apache Velocity template code entered in the Administration interface HTTP Meta Info field (XWiki.XWikiPreferences_0_meta, Presentation section). Authenticated administrators can inject and execute arbitrary Velocity directives.  
Impact: arbitrary template logic execution that can expose internal server data or achieve remote code execution.  
CVSS 3.1: 9.1 (AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)  
CWE-94 (Improper Control of Generation of Code)

## PoC / Detection
Classification: rce  
The template verifies the flaw via a five-request authenticated flow:  
1. GET /bin/login/XWiki/XWikiLogin to extract login form_token.  
2. POST /bin/loginsubmit/XWiki/XWikiLogin with supplied {{username}}/{{password}} to establish admin session.  
3. GET /bin/admin/XWiki/XWikiPreferences?editor=globaladmin&section=Presentation to extract form_token.  
4. POST /bin/saveandcontinue/XWiki/XWikiPreferences injecting payload `#set($x=7*7)$x` into the meta parameter.  
5. GET /bin/view/XWiki/XWikiPreferences and match `regex("XWikiPreferences\"[^>]*>\\s*49\\s*<", body)` to confirm the template engine evaluated 7*7 â†’ 49.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2025-51991
- https://github.com/malcxlmj/cve-writeups/blob/main/CVE-2025-51991.md
