---
cve_id: CVE-2025-23061
template_path: nuclei-templates/http/cves/2025/CVE-2025-23061.yaml
affected_product: Mongoose
severity: critical
authentication: none
external_callback: false
affected_versions: < 8.9.5
preconditions: Application uses populate() function's match option with user-controlled input
poc_classification: rce
---

## Vulnerability
NoSQL injection in Mongoose (Node.js MongoDB ODM) versions < 8.9.5 affecting the populate() function's match option. This is an incomplete fix for prior CVE-2024-53900. Attackers can bypass the $where block by nesting $where operators inside logical operators such as $and, enabling execution of arbitrary JavaScript code directly on the MongoDB server.  

Consequences include authentication bypass, exfiltration of sensitive administrative data, and potential full database compromise.  
CVSS 3.1: 9.0 (AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H) • CWE-94 (Code Injection) • CPE: cpe:2.3:a:mongoosejs:mongoose:*:*:*:*:*:node.js:*:*  
**Impact:** Arbitrary JS execution on MongoDB server, auth bypass, data access, integrity compromise.  
**Remediation:** Upgrade to Mongoose 8.9.5 or later.

## PoC / Detection
Classification: rce  
The template issues a single unauthenticated GET request to `{{BaseURL}}/posts?authorMatch={"$and":[{"$where":"this.isAdmin"}]}` and verifies exploitation by matching:  
- HTTP status 200  
- Content-Type containing `application/json`  
- Response body simultaneously containing the strings `"isAdmin":true`, `"title":`, and `"username":` (AND condition).  

This probe triggers the nested $where injection inside the match option (used by vulnerable populate() calls) and confirms arbitrary JS execution by forcing disclosure of administrative data that would otherwise be inaccessible.

## References
- https://github.com/Automattic/mongoose/commit/64a9f9706f2428c49e0cfb8e223065acc645f7bc
- https://github.com/Automattic/mongoose/releases/tag/8.9.5
- https://github.com/NamhyeonKo/mongoose-cve-lab
- https://nvd.nist.gov/vuln/detail/CVE-2025-23061
