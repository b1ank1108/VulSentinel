---
cve_id: CVE-2025-24813
template_path: nuclei-templates/http/cves/2025/CVE-2025-24813.yaml
affected_product: Apache Tomcat
severity: critical
authentication: none
external_callback: true
affected_versions: versions prior to 9.0.98, 10.1.35, and 11.0.3
preconditions: [write enabled Default Servlet]
poc_classification: rce
---

## Vulnerability

Apache Tomcat suffers from a path equivalence vulnerability involving internal dots in 'file.Name' that bypasses security checks in the Default Servlet when write is enabled. This leads to remote code execution, information disclosure, and the ability to add malicious content to uploaded files.

The vulnerability allows unauthenticated attackers to upload malicious files disguised through path equivalence and achieve arbitrary code execution via Java deserialization gadgets in session handling.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8 - Critical)

## PoC / Detection
Classification: rce

The template first performs a GET / request to confirm Apache Tomcat presence via the "Apache" header. It then issues a PUT request to /{{random}}.session with a Content-range header and a body containing a serialized Java gadget configured for DNS callback to interactsh. This is followed by a GET request to /{{random}} using a JSESSIONID cookie set to .{{random}} to trigger the path equivalence and gadget deserialization, matching on the resulting DNS interaction and 201 status code from the upload.

## References
- https://scrapco.de/blog/analysis-of-cve-2025-24813-apache-tomcat-path-equivalence-rce.html
- https://lists.apache.org/thread/j5fkjv2k477os90nczf2v9l61fb0kkgq
- http://www.openwall.com/lists/oss-security/2025/03/10/5
- https://nvd.nist.gov/vuln/detail/CVE-2025-24813
- https://security.netapp.com/advisory/ntap-20250321-0001/
