---
cve_id: CVE-2025-57819
template_path: nuclei-templates/http/cves/2025/CVE-2025-57819.yaml
affected_product: FreePBX
severity: critical
authentication: none
external_callback: false
affected_versions: 15, 16, and 17
preconditions: []
poc_classification: rce
---

## Vulnerability
FreePBX 15, 16, and 17 contain a remote code execution caused by insufficiently sanitized user-supplied data in endpoints, letting unauthenticated attackers manipulate the database and execute code remotely. Unauthenticated attackers can manipulate database records through SQL injection and achieve remote code execution through file upload path traversal, achieving complete system compromise.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: rce  
The template executes a multi-step chain (flow: http(1) || http(2) && http(3) && http(4)) that performs full exploitation with cleanup:  
1. GET to `/admin/ajax.php?module=FreePBX%5Cmodules%5Cendpoint%5Cajax&command=model&template=x&model=model&brand=...` with EXTRACTVALUE SQLi payload to trigger XPATH syntax error, confirm vulnerability, and extract DB user.  
2. Raw SQLi INSERT into `cron_jobs` table to schedule a command that base64-decodes a PHP payload (executes `uname -a`, sets `x_poc: CVE-2025-57819` header, self-deletes) and writes it as `/var/www/html/{{random}}.php`.  
3. GET to the dropped PHP file (80s timeout + wait_for) to trigger execution and match on custom header for RCE success.  
4. Raw SQLi DELETE of the inserted cron job entry for cleanup.  
Uses random filename/username; all steps target the vulnerable endpoint module AJAX handler.

## References
- https://github.com/FreePBX/security-reporting/security/advisories/GHSA-m42g-xg4c-5f3h
- https://community.freepbx.org/t/security-advisory-please-lock-down-your-administrator-access/107203
- https://github.com/watchtowrlabs/watchTowr-vs-FreePBX-CVE-2025-57819
- https://labs.watchtowr.com/you-already-have-our-personal-data-take-our-phone-calls-too-freepbx-cve-2025-57819/
