---
cve_id: CVE-2025-1098
template_path: nuclei-templates/http/cves/2025/CVE-2025-1098.yaml
affected_product: Ingress-Nginx Controller
severity: high
authentication: required
external_callback: false
affected_versions: unknown
preconditions: [user has permissions to create Ingress resources, ingress-nginx controller deployed in Kubernetes cluster]
poc_classification: rce
---

## Vulnerability
A security issue was discovered in ingress-nginx where the `mirror-target` and `mirror-host` Ingress annotations can be used to inject arbitrary configuration into nginx. This leads to arbitrary code execution in the context of the ingress-nginx controller and disclosure of Secrets accessible to the controller (all Kubernetes Secrets cluster-wide in default installations).

**Impact:** Authenticated users with Ingress creation permissions can inject arbitrary nginx configuration through mirror annotations.  
**Remediation:** Upgrade to the patched version of ingress-nginx that properly sanitizes mirror-target and mirror-host annotations.  
**CVSS:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-20

## PoC / Detection
Classification: rce

The template sends a single raw POST request containing a crafted Kubernetes AdmissionReview JSON to simulate creation of a minimal Ingress object. The payload embeds a malicious `nginx.ingress.kubernetes.io/mirror-target` annotation along with an injected `load_module test;` directive in the metadata UID field. It verifies exploitation conditions by matching the response body for the words 'AdmissionReview', 'load_module', and 'directive is specified too late' (indicating unsanitized configuration reached the nginx parser).

## References
- https://github.com/kubernetes/kubernetes/issues/131008
- https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
- https://nvd.nist.gov/vuln/detail/CVE-2025-1098
