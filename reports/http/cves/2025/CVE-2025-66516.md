---
cve_id: CVE-2025-66516
template_path: nuclei-templates/http/cves/2025/CVE-2025-66516.yaml
affected_product: Apache Tika
severity: high
authentication: none
external_callback: false
affected_versions: tika-core (1.13-3.2.1), tika-pdf-module (2.0.0-3.2.1), tika-parsers (1.13-1.28.5)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Apache Tika tika-core (1.13-3.2.1), tika-pdf-module (2.0.0-3.2.1), and tika-parsers (1.13-1.28.5) contain an XML External Entity injection when processing crafted XFA files inside PDFs. Remote attackers can submit malicious PDFs to the /tika endpoint to trigger XXE.

**Impact:** Arbitrary local file read or denial of service, exposing sensitive information or disrupting service.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)  
**CWE:** CWE-611  
**Remediation:** Upgrade tika-core to >= 3.2.2 and update tika-pdf-module/tika-parsers to latest versions.

## PoC / Detection
Classification: info-leak

The template sends two PUT /tika requests (Content-Type: application/pdf) with base64-decoded crafted PDF payloads containing XXE in XFA XML structures. The first references file:///etc/passwd; matcher checks body_1 for "root:.*:0:0:". The second references a non-existent file; matcher verifies status_code_2 == 200 AND body_2 contains "FileNotFoundException", "No such file", or "xxe_test_nonexistent". Uses stop-at-first-match and extracts leaked data via regex on body_1.

## References
- https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC
- https://nvd.nist.gov/vuln/detail/CVE-2025-66516
