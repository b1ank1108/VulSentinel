---
cve_id: CVE-2025-34040
template_path: nuclei-templates/http/cves/2025/CVE-2025-34040.yaml
affected_product: Zhiyuan OA Platform
severity: critical
authentication: none
external_callback: false
affected_versions: 5.0, 5.1 - 5.6sp1, 6.0 - 6.1sp2, 7.0, 7.0sp1 - 7.1, 7.1sp1, and 8.0 - 8.0sp2
preconditions: []
poc_classification: rce
---

## Vulnerability
Zhiyuan OA Platform contains an arbitrary file upload vulnerability in the wpsAssistServlet interface. Improper validation of the realFileType and fileId parameters during multipart uploads permits unauthenticated path traversal (e.g. ../../../../ApacheJetspeed/webapps/ROOT/), allowing attackers to place crafted JSP files directly in the web root where they are executed by the server.

## PoC / Detection
Classification: rce

The template first issues a POST to `/seeyon/wpsAssistServlet?flag=save&realFileType=../../../../ApacheJetspeed/webapps/ROOT/{{filename}}.jsp&fileId=2` with a multipart/form-data payload (Content-Type: application/vnd.ms-excel) containing a JSP snippet that decodes and outputs a random marker string. Success is verified internally by matching "officeTransResultFlag" and '"success":true' in the response body. A follow-up GET to `/{{filename}}.jsp` then confirms RCE by checking the body for the marker.

## References
- https://www.cve.org/CVERecord?id=CVE-2025-34040
- https://www.cnblogs.com/pursue-security/p/17677130.html
