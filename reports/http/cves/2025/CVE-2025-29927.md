---
cve_id: CVE-2025-29927
template_path: nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
affected_product: Next.js
severity: critical
authentication: none
external_callback: false
affected_versions: 11.1.4 through 15.2.2
preconditions: Next.js application using middleware for security controls
poc_classification: auth-bypass
---

## Vulnerability
Next.js versions 11.1.4 through 15.2.2 contain a critical middleware bypass vulnerability (CVE-2025-29927, CWE-287). Attackers can circumvent middleware security controls, including authorization checks, by supplying a specially crafted `x-middleware-subrequest` header (long chain value targeting middleware paths). This results in unauthorized access to protected resources.

**Impact:** Unauthenticated remote attackers can achieve high confidentiality and integrity impact (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N score 9.1) by bypassing access restrictions.

**Remediation:** Upgrade to Next.js 14.2.25 or 15.2.3 or later. Block the `x-middleware-subrequest` header at WAF or server level if immediate upgrade is not possible.

## PoC / Detection
Classification: auth-bypass

The template implements a multi-step detection flow (`base_check || endpoint_check`). It first identifies middleware-enabled setups by requesting `/` with `X-Nextjs-Data: 1` header and matching for internal redirect headers (`x-middleware-rewrite`, `x-nextjs-redirect`, etc.) with 307 status. It then tests the bypass using a long `X-Middleware-Subrequest` header chain (e.g., `src/middleware:nowaf:...:pages/_middleware`). For discovered endpoints (extracted via regex from page body hrefs), it confirms protection is in place on normal requests (non-200 or unauthorized redirect) but bypassed (200 OK) with the malicious header.

## References
- https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware
- https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw
- https://slcyber.io/assetnote-security-research-center/doing-the-due-diligence-analysing-the-next-js-middleware-bypass-cve-2025-29927/
