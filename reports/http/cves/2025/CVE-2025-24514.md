---
cve_id: CVE-2025-24514
template_path: nuclei-templates/http/cves/2025/CVE-2025-24514.yaml
affected_product: Ingress-Nginx Controller
severity: high
authentication: required
external_callback: false
affected_versions: unknown
preconditions: [authenticated Kubernetes user with RBAC permissions to create Ingress resources, default ingress-nginx installation]
poc_classification: rce
---

## Vulnerability
A security issue was discovered in ingress-nginx where the `auth-url` Ingress annotation can be used to inject configuration into nginx. This can lead to arbitrary code execution in the context of the ingress-nginx controller, and disclosure of Secrets accessible to the controller (Note that in the default installation, the controller can access all Secrets cluster-wide). Authenticated users with Ingress creation permissions can inject nginx configuration through the auth-url annotation. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8). CWE-20.

## PoC / Detection
Classification: rce

The template sends a raw POST `/` AdmissionReview JSON payload to the admission webhook simulating creation of a test Ingress resource (namespace `default`, ingressClassName `nginx`) that contains the poisoned annotation `nginx.ingress.kubernetes.io/auth-url: http://example.com#;load_module test;\n`. It detects successful unsanitized processing (i.e. the annotation value reached nginx config parsing) by matching the response body for the exact combination of strings `'AdmissionReview'`, `'directive is not allowed here'`, and `'load_module'`.

## References
- https://github.com/kubernetes/kubernetes/issues/131006
- https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
- https://nvd.nist.gov/vuln/detail/CVE-2025-24514
