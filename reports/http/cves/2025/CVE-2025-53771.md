---
cve_id: CVE-2025-53771
template_path: nuclei-templates/http/cves/2025/CVE-2025-53771.yaml
affected_product: Microsoft SharePoint Server
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Microsoft SharePoint Server is affected by an improper authentication vulnerability (CVE-2025-53771, CWE-287) in its ToolShell component. Attackers can bypass authentication by sending a crafted POST request to `/_layouts/15/ToolPane.aspx` with a forged `Referer: /_layouts/SignOut.aspx` header. This grants unauthorized access to protected administrative endpoints. It serves as a patch bypass for CVE-2025-49706. When chained with the deserialization vulnerability CVE-2025-53770, it enables unauthenticated remote code execution leading to full system compromise.  
CVSS v3.1 score: 6.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N).

## PoC / Detection
Classification: auth-bypass  
The template uses a JavaScript flow to dynamically construct LosFormatter deserialization gadgets (including XamlAssemblyLoadFromFile payloads and DataSet variants). It issues two POST requests to `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` embedding the base64/gzip/compressed gadget in the `MSOTlPn_DWP` parameter (pointing `MSOTlPn_Uri` to AclEditor.ascx). Requests feature the spoofed Referer header to simulate the bypass. Verification succeeds if the server processes the request (indicating auth bypass) and returns the custom `X-Nuclei: CVE-2025-53771` response header or "MSOTlPn_DWP" in body.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2025-53771
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53771
- https://www.wiz.io/blog/sharepoint-vulnerabilities-cve-2025-53770-cve-2025-53771-everything-you-need-to-k
- https://orca.security/resources/blog/toolshell-sharepoint-exploit-cve-2025-53770-53771/
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/sharepoint_toolpane_rce.rb
