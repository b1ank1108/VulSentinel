---
cve_id: CVE-2025-30220
template_path: nuclei-templates/http/cves/2025/CVE-2025-30220.yaml
affected_product: GeoServer WFS
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: [WFS service enabled]
poc_classification: info-leak
---

## Vulnerability
GeoServer Web Feature Service (WFS) is vulnerable to an XML External Entity (XXE) processing attack due to improper handling of XML input in the GeoTools library. Unauthenticated remote attackers can exploit this to perform out-of-band (OOB) data exfiltration and Server-Side Request Forgery (SSRF), potentially accessing internal services and sensitive data.

CVSS: 9.9 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L) | CWE-611

## PoC / Detection
Classification: info-leak

The template first issues GET requests to common WFS GetCapabilities endpoints (`/geoserver/wfs`, `/geoserver/ows`, `/wfs`, `/ows`) to confirm the service is active (matching on `wfs:WFS_Capabilities` in XML response with 200 status) and extracts the first FeatureType name via XPath. It then sends a POST GetFeature request with a crafted XML payload embedding `xsi:schemaLocation` pointing to `http://{{interactsh-url}}/xxe.xsd`. Detection succeeds when a DNS interaction reaches interactsh **and** the server returns a 200 response containing `java.lang.NullPointerException`.

## References
- https://github.com/geoserver/geoserver/security/advisories/GHSA-jj54-8f66-c5pc
- https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
- https://github.com/geonetwork/core-geonetwork/pull/8757
- https://github.com/geonetwork/core-geonetwork/pull/8803
- https://github.com/geonetwork/core-geonetwork/pull/8812
- https://geoserver.org/vulnerability/2025/06/10/cve-disclosure.html
