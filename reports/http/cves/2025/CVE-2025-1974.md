---
cve_id: CVE-2025-1974
template_path: nuclei-templates/http/cves/2025/CVE-2025-1974.yaml
affected_product: Ingress-Nginx Controller
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 1.12.1 and prior to 1.11.5
preconditions: ["access to the pod network"]
poc_classification: rce
---

## Vulnerability
A critical remote code execution vulnerability (CVE-2025-1974, CWE-653) in the Kubernetes Ingress-Nginx Controller. Under certain conditions an unauthenticated attacker with access to the pod network can achieve arbitrary code execution in the context of the ingress-nginx controller. This leads to disclosure of Secrets accessible to the controller (cluster-wide by default in standard installations) and potential complete cluster takeover.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

Impact: full unauthorized access to all secrets across namespaces.

Remediation: update to version 1.12.1 or later, or 1.11.5 or later.

## PoC / Detection
Classification: rce

The template sends a single raw POST / request containing a crafted AdmissionReview JSON payload for a dry-run CREATE operation on an Ingress resource. The payload injects the string `InjectTest#;\n\n}\n}\n}\nload_module test;` into the object metadata.uid field (along with a mirror-target annotation) to exploit nginx configuration parsing. Detection matches the response body for the words 'AdmissionReview', 'load_module', and 'directive is specified too late' (AND condition) to confirm the injected directive reached the nginx parser.

## References
- https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
- https://projectdiscovery.io/blog/ingressnightmare-unauth-rce-in-ingress-nginx
- https://nvd.nist.gov/vuln/detail/CVE-2025-1974
- https://https://github.com/kubernetes/kubernetes/issues/131009
- https://github.com/eeeeeeeeee-code/POC
