---
cve_id: CVE-2025-48954
template_path: nuclei-templates/http/cves/2025/CVE-2025-48954.yaml
affected_product: Discourse OAuth Social Login
severity: high
authentication: none
external_callback: false
affected_versions: prior to 3.5.0.beta6
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Discourse OAuth Social Login contains a stored Cross-Site Scripting (XSS) vulnerability (CVE-2025-48954, CWE-79) in versions prior to 3.5.0.beta6. The root cause is missing Content-Security-Policy enforcement when processing OAuth/social login failure responses, allowing the `provider` parameter to be reflected unsanitized.  

CVSS 3.1: 8.1 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N).  
Impact includes arbitrary JavaScript execution in the victim's browser context, enabling session hijacking.  
Remediation requires updating to 3.5.0.beta6 or later.

## PoC / Detection
Classification: auth-bypass

The template issues two unauthenticated GET requests to `{{BaseURL}}/auth/failure?provider=<payload>`.  
- Payload 1 (`%3Cmeta http-equiv=%22refresh%22 content=%220;url=https://evil.com%22%3E`) checks for open-redirect via injected meta-refresh tag.  
- Payload 2 (`<svg/onload=alert('XSS-CVE-2025-48954')>`) checks for raw XSS reflection.  

Matchers verify: status 200, Discourse page indicators in body, injected payload present in response, and (for XSS) absence of `content-security-policy` header. Additional regex extractors pull the Discourse version from generator meta tags, headers, assets, and JSON. The template therefore confirms unsafe reflection of the `provider` value without CSP, proving the stored XSS condition that enables session hijacking.

## References
- https://github.com/discourse/discourse/security/advisories/GHSA-26p5-mjjh-wfcf
- https://nvd.nist.gov/vuln/detail/CVE-2025-48954
