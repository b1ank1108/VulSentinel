---
cve_id: CVE-2025-48828
template_path: nuclei-templates/http/cves/2025/CVE-2025-48828.yaml
affected_product: vBulletin
severity: critical
authentication: none
external_callback: false
affected_versions: 5.0.0 through 6.0.3
preconditions: []
poc_classification: rce
---

## Vulnerability
vBulletin versions 5.0.0 through 6.0.3 contain a critical remote code execution vulnerability (CVE-2025-48828) in the `ajax/api/ad/replaceAdTemplate` endpoint. The flaw is caused by improper use of PHP's Reflection API, permitting unauthenticated attackers to invoke protected controller methods. Attackers inject a crafted `<vb:if>` conditional to execute arbitrary PHP code (e.g. `passthru($_POST[<param>])`), triggered via a follow-up request to `ajax/render/ad_<location>`.

**Impact:** Allows execution of arbitrary system commands as the web server user, enabling full system compromise.  
**CVSS:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)  
**CWE:** CWE-424

## PoC / Detection
Classification: rce

The template detects the RCE through a two-step HTTP interaction:  
1. POST to `/` setting `routestring=ajax/api/ad/replaceAdTemplate` with a malicious template containing `<vb:if condition='"var_dump"("{{rand_value}}")'></vb:if>` to register executable code.  
2. POST to trigger rendering at `ajax/render/ad_{{rand_string}}`.  

Matchers verify successful execution by checking for `string(5)` and the random value in the response body from the `var_dump` output. This confirms arbitrary code execution capability.

## References
- https://karmainsecurity.com/pocs/vBulletin-replaceAdTemplate-RCE.php
- https://karmainsecurity.com/dont-call-that-protected-method-vbulletin-rce
- https://nvd.nist.gov/vuln/detail/CVE-2025-48827
- https://nvd.nist.gov/vuln/detail/CVE-2025-48828
