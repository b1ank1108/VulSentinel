---
cve_id: CVE-2025-27892
template_path: nuclei-templates/http/cves/2025/CVE-2025-27892.yaml
affected_product: Shopware
severity: critical
authentication: required
external_callback: false
affected_versions: < 6.5.8.13
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Shopware application API search functionality is vulnerable to SQL injection. Searches can be aggregated using the "aggregations" object; the nested "name" field is unsanitized and accepts arbitrary SQL parameters.

Authenticated attackers can execute arbitrary SQL queries via the aggregations parameter in the search API (e.g. `/api/search/order`), enabling extraction of sensitive database data (high confidentiality impact) plus limited data modification and availability disruption.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:L (score 6.8). Remediation: upgrade to 6.5.8.13 or later.

## PoC / Detection
Classification: info-leak

The template performs a single authenticated POST to `/api/search/order` (Bearer token) with a JSON payload injecting time-based blind SQLi (`SLEEP(7)` and malformed backtick/parameter syntax) into both the `filter` value and nested `aggregations` `name` field. Detection matches on combined response duration (>=5s), HTTP 500 status, JSON content-type, and PHP error string "Warning: Undefined array" in the body.

## References
- https://www.redteam-pentesting.de/en/advisories/rt-sa-2025-001/
- https://nvd.nist.gov/vuln/detail/CVE-2025-27892
