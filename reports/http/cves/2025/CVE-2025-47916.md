---
cve_id: CVE-2025-47916
template_path: nuclei-templates/http/cves/2025/CVE-2025-47916.yaml
affected_product: Invision Community
severity: critical
authentication: none
external_callback: false
affected_versions: 5.0.0 before 5.0.7
preconditions: []
poc_classification: rce
---

## Vulnerability
Invision Community 5.0.0 before 5.0.7 is vulnerable to unauthenticated remote code execution via server-side template injection. The flaw resides in the themeeditor controller at `/applications/core/modules/front/system/themeeditor.php`. The protected `customCss` method (invokable by unauthenticated users) passes the attacker-controlled `content` parameter directly to `Theme::makeProcessFunction()`, which evaluates it via the template engine. This allows injection and execution of arbitrary PHP code through crafted template strings such as `{expression=...}`.

Impact: Unauthenticated attackers achieve complete server compromise.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (score: 10.0). CWE-1336.

## PoC / Detection
Classification: rce  
The template sends a single POST request to `/` using `application/x-www-form-urlencoded` body data (`app=core&module=system&controller=themeeditor&do=customCss&content=%7Bexpression%3D%22die%28%27CVE%27.base64_decode%28%27{{base64(marker)}}%3D%27%29%29%22%7D`). It substitutes a random marker string and matches for the exact substring `CVE{{marker}}` in the response body to confirm that the injected PHP expression executed successfully.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2025-47916
- https://karmainsecurity.com/pocs/CVE-2025-47916.php
- https://invisioncommunity.com/release-notes-v5/507-r41/
- https://karmainsecurity.com/KIS-2025-02
- http://seclists.org/fulldisclosure/2025/May/4
