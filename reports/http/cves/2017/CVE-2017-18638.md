---
cve_id: CVE-2017-18638
template_path: nuclei-templates/http/cves/2017/CVE-2017-18638.yaml
affected_product: Graphite
severity: high
authentication: none
external_callback: true
affected_versions: <=1.1.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Graphite versions up to and including 1.1.5 contain a server-side request forgery (SSRF) vulnerability in the `send_email` function located in `graphite-web/webapp/graphite/composer/views.py`. The vulnerability allows an unauthenticated attacker to force the Graphite web server to make arbitrary HTTP requests to any resource, including internal network resources. The response from the SSRF request is encoded into an image file and sent to an attacker-controlled email address, enabling complete exfiltration of the response data. This vulnerability is classified as CWE-918 (Server-Side Request Forgery) with a CVSS score of 7.5 (High severity), indicating high confidentiality impact with no authentication required for exploitation.

## PoC / Detection

Classification: info-leak

The template detects this SSRF vulnerability by sending a GET request to the `/composer/send_email` endpoint with two parameters: a randomly generated email address (`to` parameter) and a URL pointing to an Interactsh callback server (`url` parameter). The vulnerable endpoint attempts to fetch the attacker-supplied URL and encode it into an image for email delivery. Detection is confirmed when the template receives an HTTP callback at the Interactsh server, proving that the Graphite server made an outbound request to the attacker-controlled resource. This demonstrates the server's ability to be used as a proxy for arbitrary HTTP requests, which can be leveraged to exfiltrate data from internal resources by encoding responses into email attachments.

## References

- http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html
- https://github.com/graphite-project/graphite-web/issues/2008
- https://github.com/advisories/GHSA-vfj6-275q-4pvm
- https://nvd.nist.gov/vuln/detail/CVE-2017-18638
- https://github.com/graphite-project/graphite-web/pull/2499
