---
cve_id: CVE-2017-4011
template_path: nuclei-templates/http/cves/2017/CVE-2017-4011.yaml
affected_product: McAfee Network Data Loss Prevention
severity: medium
authentication: none
external_callback: false
affected_versions: 9.3.x
preconditions: []
poc_classification: info-leak
---

## Vulnerability
McAfee Network Data Loss Prevention 9.3.x contains a reflected cross-site scripting (XSS) vulnerability (CWE-79) in User-Agent header processing. The application echoes the raw User-Agent value into the response body (`var ua='...'`) without sanitization. 

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Remote attackers can inject arbitrary JavaScript via a crafted User-Agent, leading to session/cookie theft or session hijacking in the victim's browser context.

Impact: Successful exploitation could allow an attacker to execute arbitrary script code in the context of the targeted user's browser, potentially leading to session hijacking or unauthorized access to sensitive information.

Remediation: Apply the latest security patches or updates provided by McAfee to mitigate the XSS vulnerability.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}` with a malicious User-Agent header containing the payload `Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1';alert(/XSS/);//`. Detection succeeds if the exact payload string appears unescaped in the response body (inside a `var ua=` assignment) and the `Content-Type` header contains `text/html`.

## References
- https://medium.com/@david.valles/cve-2017-4011-reflected-xss-found-in-mcafee-network-data-loss-prevention-ndlp-9-3-x-cf20451870ab
- https://kc.mcafee.com/corporate/index?page=content&id=SB10198
- https://nvd.nist.gov/vuln/detail/CVE-2017-4011
- http://www.securitytracker.com/id/1038523
- https://github.com/ARPSyndicate/kenzer-templates
