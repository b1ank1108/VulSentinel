---
cve_id: CVE-2017-12611
template_path: nuclei-templates/http/cves/2017/CVE-2017-12611.yaml
affected_product: Apache Struts2
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0.0 through 2.3.33 and 2.5 through 2.5.10.1
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache Struts2 S2-053 suffers from remote code execution due to improper handling of OGNL expressions in Freemarker templates, where an expression is used instead of string literals. This allows unauthenticated attackers to execute arbitrary system commands on affected versions.

CVSS: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE: CWE-20

## PoC / Detection
Classification: rce

The template issues a POST request to `{{BaseURL}}/?name=` containing a highly encoded OGNL payload that sets full member access via `OgnlContext@DEFAULT_MEMBER_ACCESS`, constructs a `ProcessBuilder`, and runs `cat /etc/passwd` (adapting for Windows via `cmd.exe`). Detection succeeds if the HTTP response status is 200 and contains regex match for `root:.*:0:0:` indicating command output in the body.

## References
- https://struts.apache.org/docs/s2-053.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-12611
- https://kb.netapp.com/support/s/article/ka51A000000CgttQAC/NTAP-20170911-0001
- http://www.arubanetworks.com/assets/alert/ARUBA-PSA-2017-003.txt
- http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-9805-3889403.html
