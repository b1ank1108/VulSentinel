---
cve_id: CVE-2017-9791
template_path: nuclei-templates/http/cves/2017/CVE-2017-9791.yaml
affected_product: Apache Struts2 S2-053
severity: critical
authentication: none
external_callback: false
affected_versions: 2.1.x and 2.3.x
preconditions: [Struts 1 plugin enabled]
poc_classification: rce
---

## Vulnerability
Apache Struts 2.1.x and 2.3.x with the Struts 1 plugin allow remote code execution via OGNL expression injection in a malicious field value passed in a raw message to the ActionMessage.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-20 (Improper Input Validation)  
**Impact:** Full remote code execution  
**Remediation:** Apply latest security patches or upgrade to a non-vulnerable version of Apache Struts2.

## PoC / Detection
Classification: rce

The template sends a single POST request to `{{BaseURL}}/integration/saveGangster.action` with `Content-Type: application/x-www-form-urlencoded`. The `name` parameter contains a URL-encoded OGNL payload that bypasses member-access restrictions and evaluates a harmless expression computing the product of two random integers (generated via template variables). Detection succeeds if the response body (status 200) contains both the computed numeric result string and the phrase "added successfully".

## References
- http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-9805-3889403.html
- http://struts.apache.org/docs/s2-048.html
- http://web.archive.org/web/20211207175819/https://securitytracker.com/id/1038838
- http://www.securitytracker.com/id/1038838
- https://security.netapp.com/advisory/ntap-20180706-0002/
