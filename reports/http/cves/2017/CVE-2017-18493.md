---
cve_id: CVE-2017-18493
template_path: nuclei-templates/http/cves/2017/CVE-2017-18493.yaml
affected_product: Custom Admin Page by BestWebSoft
severity: medium
authentication: required
external_callback: false
affected_versions: < 0.1.2
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2017-18493 is a Cross-Site Scripting (XSS) vulnerability affecting the Custom Admin Page plugin by BestWebSoft for WordPress versions prior to 0.1.2. The plugin contains multiple XSS issues that allow authenticated attackers to inject and execute arbitrary JavaScript code in victims' browsers. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

Successful exploitation enables attackers to steal session cookies, capture credentials, or perform unauthorized actions on behalf of authenticated users who interact with the malicious payload.

## PoC / Detection

Classification: state-change

The template performs authenticated detection of the XSS vulnerability through a three-step process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Injection**: Sends a GET request to `/wp-admin/admin.php?page=bws_panel&category=` with an XSS payload (`"></script><script>alert(document.domain)</script>`) injected into the `category` parameter
3. **Version Verification**: Retrieves `/wp-content/plugins/custom-admin-page/readme.txt` to confirm the plugin is installed

The template verifies successful exploitation by checking that:
- The XSS injection request returns HTTP 200 with `text/html` content type
- The response body reflects the injected payload unescaped: `"></script><script>alert(document.domain)</script>">`
- The readme file confirms the Custom Admin Page plugin is present

## References

- https://wpscan.com/vulnerability/efd816c3-90d4-40bf-850a-0e4c1a756694
- https://nvd.nist.gov/vuln/detail/CVE-2017-18493
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18493
- https://wordpress.org/plugins/custom-admin-page/#developers
