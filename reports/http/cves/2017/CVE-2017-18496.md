---
cve_id: CVE-2017-18496
template_path: nuclei-templates/http/cves/2017/CVE-2017-18496.yaml
affected_product: Htaccess by BestWebSoft
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.7.6
preconditions: []
poc_classification: state-change
---

## Vulnerability

The Htaccess plugin by BestWebSoft for WordPress versions prior to 1.7.6 contains multiple Cross-Site Scripting (XSS) vulnerabilities (CWE-79). The vulnerability allows authenticated attackers to inject and execute arbitrary JavaScript code in victims' browsers. The XSS flaw exists in the plugin's admin panel interface, specifically in the `bws_panel` page where the `category` parameter is not properly sanitized before being reflected in the HTML response.

The CVSS v3.0 score is 6.1 (Medium), with the vector string AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, indicating network-based exploitation with low complexity, requiring user interaction, and resulting in low confidentiality and integrity impact with changed scope.

Successful exploitation could allow attackers to steal session cookies, capture credentials, perform actions on behalf of authenticated users, or deface the administrative interface.

## PoC / Detection

Classification: state-change

The template performs a three-step detection process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with username and password credentials to establish an authenticated WordPress session.

2. **XSS Injection**: Sends a GET request to `/wp-admin/admin.php?page=bws_panel` with a malicious `category` parameter containing the payload: `"></script><script>alert(document.domain)</script>`. This tests whether the parameter value is reflected unsanitized in the HTML response.

3. **Version Verification**: Retrieves the plugin's `readme.txt` file from `/wp-content/plugins/htaccess/readme.txt` to confirm the presence of the Htaccess plugin.

The template confirms the vulnerability when all conditions are met: the XSS payload is successfully reflected in the HTML response (status 200, content-type text/html), the specific vulnerable HTML pattern is present in the response body, and the readme file confirms the plugin identity.

## References

- https://wpscan.com/vulnerability/efd816c3-90d4-40bf-850a-0e4c1a756694
- https://nvd.nist.gov/vuln/detail/CVE-2017-18496
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18496
- https://wordpress.org/plugins/htaccess/#developers
