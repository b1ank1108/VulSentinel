---
cve_id: CVE-2017-14622
template_path: nuclei-templates/http/cves/2017/CVE-2017-14622.yaml
affected_product: WordPress 2kb Amazon Affiliates Store plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <2.1.1
preconditions: [2kb Amazon Affiliates Store plugin installed and activated on WordPress]
poc_classification: info-leak
---

## Vulnerability
WordPress 2kb Amazon Affiliates Store plugin before 2.1.1 contains multiple reflected cross-site scripting (XSS) vulnerabilities (CWE-79). Arbitrary web script or HTML can be injected via the `page` or `kbAction` parameters when accessing `/wp-admin/admin.php?page=kbAmz`. This enables theft of cookie-based authentication credentials and launch of other client-side attacks.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).

## PoC / Detection
Classification: info-leak

The template first posts credentials to `/wp-login.php` (using `{{username}}`/`{{password}}`) to establish an authenticated session, then sends a GET to `/wp-admin/admin.php?page=kbAmz&kbAction=demo%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`. Detection succeeds if the second response has status 500, HTML content-type, reflects the unsanitized `<script>alert(document.domain)</script>` payload in the body, and contains the plugin identifier string.

## References
- https://packetstormsecurity.com/files/144261/WordPress-2kb-Amazon-Affiliates-Store-2.1.0-Cross-Site-Scripting.html
- https://wordpress.org/plugins/2kb-amazon-affiliates-store/#developers
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14622
- https://nvd.nist.gov/vuln/detail/CVE-2017-14622
- https://github.com/ARPSyndicate/cvemon
