---
cve_id: CVE-2017-18557
template_path: nuclei-templates/http/cves/2017/CVE-2017-18557.yaml
affected_product: Google Maps by BestWebSoft
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.3.6
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2017-18557 is a Cross-Site Scripting (XSS) vulnerability affecting the Google Maps by BestWebSoft WordPress plugin versions prior to 1.3.6. The vulnerability exists due to multiple XSS issues in the plugin that allow authenticated attackers to inject and execute arbitrary JavaScript code in victims' browsers. The flaw is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low impact to confidentiality and integrity.

Successful exploitation enables attackers to steal session cookies, capture credentials, or perform unauthorized actions on behalf of authenticated users who interact with the malicious payload. The vulnerability was fixed in version 1.3.6 of the plugin.

## PoC / Detection

Classification: state-change

The Nuclei template performs a three-step detection process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Payload Injection**: Sends a GET request to `/wp-admin/admin.php?page=bws_panel&category=` with an XSS payload (`"></script><script>alert(document.domain)</script>`) injected into the `category` parameter
3. **Version Verification**: Retrieves `/wp-content/plugins/bws-google-maps/readme.txt` to confirm the plugin identity

The template confirms the vulnerability by verifying:
- The XSS payload is reflected in the response body without proper sanitization
- The response returns HTTP 200 with `text/html` content type
- The reflected payload appears in the expected context: `"></script><script>alert(document.domain)</script>">All</a></li>`
- The readme file confirms the presence of "Google Maps by BestWebSoft" plugin

## References

- https://wpscan.com/vulnerability/efd816c3-90d4-40bf-850a-0e4c1a756694
- https://nvd.nist.gov/vuln/detail/CVE-2017-18557
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18557
- https://wordpress.org/plugins/bws-google-maps/#developers
