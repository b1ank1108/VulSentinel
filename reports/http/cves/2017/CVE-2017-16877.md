---
cve_id: CVE-2017-16877
template_path: nuclei-templates/http/cves/2017/CVE-2017-16877.yaml
affected_product: Nextjs
severity: high
authentication: none
external_callback: false
affected_versions: <2.4.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
ZEIT Next.js before 2.4.1 is susceptible to local file inclusion via the /_next and /static request namespace, allowing attackers to obtain sensitive information (CWE-22). CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact: Successful exploitation could allow an attacker to read sensitive files on the server, leading to unauthorized access and potential data leakage. Remediation: Upgrade Nextjs to version 2.4.1 or above.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/_next/../../../../../../../../../../etc/passwd` and matches on HTTP 200 status plus regex `root:.*:0:0:` in the response body to confirm the path-traversal LFI.

## References
- https://medium.com/@theRaz0r/arbitrary-file-reading-in-next-js-2-4-1-34104c4e75e9
- https://github.com/zeit/next.js/releases/tag/2.4.1
- https://nvd.nist.gov/vuln/detail/CVE-2017-16877
- https://github.com/vercel/next.js/commit/02fe7cf63f6265d73bdaf8bc50a4f2fb539dcd00
- https://github.com/ARPSyndicate/cvemon
