---
cve_id: CVE-2017-18362
template_path: nuclei-templates/http/cves/2017/CVE-2017-18362.yaml
affected_product: Kaseya VSA 2017 ConnectWise ManagedITSync
severity: critical
authentication: none
external_callback: false
affected_versions: through 2017
preconditions: ManagedIT.asmx page available via the Kaseya VSA web interface
poc_classification: rce
---

## Vulnerability
ConnectWise ManagedITSync integration through 2017 for Kaseya VSA allows unauthenticated remote arbitrary SQL queries (read and write) via the ManagedIT.asmx endpoint, granting full direct access to the Kaseya VSA database. Actively exploited in February 2019 to download and execute ransomware on all managed endpoints.

**Impact:** Unauthenticated attackers can read/modify the database, deploy ransomware across customer infrastructures, and achieve full compromise.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-89 (SQL Injection)  
**Remediation:** Disable/remove the ConnectWise ManagedITSync integration or restrict access to ManagedIT.asmx and apply patches.

## PoC / Detection
Classification: rce

The template sends a benign GET request to `/KaseyaCwWebService/ManagedIT.asmx` and matches on HTTP 200 with body containing `ManagedIT.asmx?op=` and `ExecuteSQLQuery`. This confirms the presence of the exposed unauthenticated SOAP service that permits arbitrary SQL execution (leveragable for full remote code execution on managed endpoints).

## References
- https://github.com/kbni/owlky
- https://www.huntress.com/blog/cve-2017-18362-arbitrary-sql-injection-in-mangeditsync-integration-ba142ff24f4d
