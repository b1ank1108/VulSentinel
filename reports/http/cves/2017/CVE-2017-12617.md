---
cve_id: CVE-2017-12617
template_path: nuclei-templates/http/cves/2017/CVE-2017-12617.yaml
affected_product: Apache Tomcat
severity: high
authentication: none
external_callback: false
affected_versions: 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81
preconditions: HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of the Default servlet to false)
poc_classification: rce
---

## Vulnerability
When running Apache Tomcat versions 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81 with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of the Default servlet to false) it was possible to upload a JSP file to the server via a specially crafted request. This JSP could then be requested and any code it contained would be executed by the server.

Successful exploitation allows remote attackers to execute arbitrary code on the affected server.

Remediation: Upgrade to Apache Tomcat version 7.0.80 or later.

CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (score 8.1)  
CWE-434 (Unrestricted Upload of File with Dangerous Type)

## PoC / Detection
Classification: rce  
The template issues a PUT request to `/{{randstr}}.jsp/` uploading a minimal JSP payload that prints the marker string "CVE-2017-12617", followed by a GET request to the same path. It matches on the string appearing in the second response body together with HTTP 200 status, confirming the upload-and-execute path works.

## References
- https://versa-networks.com/blog/apache-tomcat-remote-code-execution-vulnerability-cve-2017-12617/
- https://github.com/cyberheartmi9/CVE-2017-12617
- https://www.exploit-db.com/exploits/43008
- https://nvd.nist.gov/vuln/detail/CVE-2017-12617
- http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
