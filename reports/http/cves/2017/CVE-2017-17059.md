---
cve_id: CVE-2017-17059
template_path: nuclei-templates/http/cves/2017/CVE-2017-17059.yaml
affected_product: WordPress amtyThumb Posts
severity: medium
authentication: none
external_callback: false
affected_versions: 8.1.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress amtyThumb Posts (amty-thumb-recent-post) plugin 8.1.3 is vulnerable to reflected cross-site scripting (XSS) via unsanitized query-string input in `amtyThumbPostsAdminPg.php`.  

An attacker can craft a malicious URL that injects arbitrary JavaScript executed in the victim's browser context when the link is visited (changed scope).  

**Impact** (from template): execution of arbitrary JavaScript in the victim's browser.  
**CVSS v3.0**: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE-79**, **CVE-2017-17059**  
**Remediation**: update to a patched version of the plugin.  

No configuration options, feature flags, or deployment modes beyond the vulnerable plugin version are required.

## PoC / Detection
Classification: info-leak  

The template performs a two-step HTTP flow:  
1. GET `/wp-content/plugins/amty-thumb-recent-post/readme.txt` (internal matcher) confirms plugin installation by requiring both `Amty Thumb` and `Tags:` strings (case-insensitive).  
2. POST to `{{BaseURL}}/wp-content/plugins/amty-thumb-recent-post/amtyThumbPostsAdminPg.php?</script><script>alert(document.domain)</script>=1` with body `amty_hidden=1`.  

Matchers verify:  
- payload `</script><script>alert(document.domain)</script>` appears unescaped in response body,  
- `Content-Type` contains `text/html`,  
- HTTP status 200.  

This confirms the query parameter is reflected without HTML escaping, proving the reflected XSS condition.

## References
- https://github.com/NaturalIntelligence/wp-thumb-post/issues/1
- https://packetstormsecurity.com/files/145044/WordPress-amtyThumb-8.1.3-Cross-Site-Scripting.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-17059
- https://github.com/ARPSyndicate/kenzer-templates
