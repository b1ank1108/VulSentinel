---
cve_id: CVE-2017-12615
template_path: nuclei-templates/http/cves/2017/CVE-2017-12615.yaml
affected_product: Apache Tomcat
severity: high
authentication: none
external_callback: false
affected_versions: 7.0.0 to 7.0.79
preconditions: PUT method enabled
poc_classification: rce
---

## Vulnerability
Apache Tomcat servers 7.0.0 to 7.0.79 are susceptible to remote code execution. By design, you are not allowed to upload JSP files via the PUT method. This is likely a security measure to prevent an attacker from uploading a JSP shell and gaining remote code execution on the server. However, due to the insufficient checks, an attacker could gain remote code execution on Apache Tomcat servers that have enabled PUT method by using a specially crafted HTTP request.

Impact: Successful exploitation of this vulnerability allows an attacker to execute arbitrary code on the affected server.

Remediation: Apply the latest security patches or upgrade to a non-vulnerable version of Apache Tomcat.

CVSS: 8.1 (CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE: CWE-434

## PoC / Detection
Classification: rce

The template uploads a malicious JSP webshell (that executes system commands from the `cmd` parameter) via a PUT request to `{{BaseURL}}/poc.jsp/`, followed by a GET request to `{{BaseURL}}/poc.jsp?cmd=cat+%2Fetc%2Fpasswd`. It confirms successful RCE by checking for HTTP 200 status and a regex match for `root:.*:0:0:` in the response body.

## References
- https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2017-12615
- https://lists.apache.org/thread.html/8fcb1e2d5895413abcf266f011b9918ae03e0b7daceb118ffbf23f8c@%3Cannounce.tomcat.apache.org%3E
- http://web.archive.org/web/20211206035549/https://securitytracker.com/id/1039392
- https://nvd.nist.gov/vuln/detail/CVE-2017-12615
- http://breaktoprotect.blogspot.com/2017/09/the-case-of-cve-2017-12615-tomcat-7-put.html
