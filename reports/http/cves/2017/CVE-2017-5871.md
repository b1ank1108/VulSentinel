---
cve_id: CVE-2017-5871
template_path: nuclei-templates/http/cves/2017/CVE-2017-5871.yaml
affected_product: Odoo
severity: medium
authentication: none
external_callback: true
affected_versions: <= 8.0-20160726 and 9.0
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Odoo versions <= 8.0-20160726 and 9.0 contain an open redirect (CWE-601, CVE-2017-5871) in the `/web/session/logout` and `/web/dbredirect` endpoints. A crafted `redirect` query parameter causes the server to return a `Location` header pointing to an attacker-controlled domain. No authentication is required. CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N (score 5.4). Successful use enables phishing attacks or information theft by redirecting authenticated or unauthenticated users to malicious sites. Update to the latest patched version.

## PoC / Detection
Classification: detect-only

The template issues three GET requests (stopping at first match) to `{{BaseURL}}/web/session/logout?redirect=https://oast.me`, the URL-encoded variant, and `{{BaseURL}}/web/dbredirect?redirect=https%3a%2f%2foast.me%2f`. It succeeds if the `Location` response header matches the regex `(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$`, confirming the endpoint reflects the supplied external domain without sanitization.

## References
- https://sysdream.com/cve-2017-5871-odoo-url-redirection-to/
- https://nvd.nist.gov/vuln/detail/CVE-2017-5871
