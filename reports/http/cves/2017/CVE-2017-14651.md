---
cve_id: CVE-2017-14651
template_path: nuclei-templates/http/cves/2017/CVE-2017-14651.yaml
affected_product: WSO2 Data Analytics Server
severity: medium
authentication: none
external_callback: false
affected_versions: 3.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected cross-site scripting (XSS) in WSO2 Data Analytics Server 3.1.0 via unsanitized `collectionName` or `parentPath` parameters in `/carbon/resources/add_collection_ajaxprocessor.jsp`.  
CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (4.8, Medium) | CWE-79.  
Successful exploitation executes arbitrary JavaScript in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak  
The template issues a single unauthenticated GET request to `{{BaseURL}}/carbon/resources/add_collection_ajaxprocessor.jsp?collectionName=%3Cimg%20src=x%20onerror=alert(document.domain)%3E&parentPath=%3Cimg%20src=x%20onerror=alert(document.domain)%3E`, injecting a classic reflected XSS payload. Detection succeeds when the response body simultaneously contains the unsanitized payload string and the error message "Failed to add new collection" while the Content-Type header is `text/html`.

## References
- https://github.com/cybersecurityworks/Disclosed/issues/15
- https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2017-0265
- https://cybersecurityworks.com/zerodays/cve-2017-14651-wso2.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-14651
- https://github.com/ARPSyndicate/cvemon
