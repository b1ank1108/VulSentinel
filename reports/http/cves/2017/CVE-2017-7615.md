---
cve_id: CVE-2017-7615
template_path: nuclei-templates/http/cves/2017/CVE-2017-7615.yaml
affected_product: MantisBT
severity: high
authentication: none
external_callback: false
affected_versions: <=2.3.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
MantisBT through 2.3.0 allows arbitrary password reset and unauthenticated admin access via an empty confirm_hash value to verify.php. Successful exploitation leads to unauthorized password resets and unauthorized administrative access. Remediation requires upgrading MantisBT to a version higher than 2.30. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8), CWE-640.

## PoC / Detection
Classification: state-change

The template sends unauthenticated GET requests to five candidate paths for the verify.php endpoint (`/verify.php?id=1&confirm_hash=`, `/mantis/verify.php?id=1&confirm_hash=`, `/mantisBT/verify.php?id=1&confirm_hash=`, `/mantisbt-2.3.0/verify.php?id=1&confirm_hash=`, `/bugs/verify.php?confirm_hash=&id=1`), stopping at the first match. It verifies exploitation conditions with a combined matcher requiring HTTP 200 status and the presence of the hidden form field `<input type="hidden" name="account_update_token" value="([a-zA-Z0-9_-]+)">` in the response body (indicating successful bypass of the confirmation step and direct access to the password update form). The probe targets user ID 1 by default (common admin account).

## References
- https://sourceforge.net/projects/mantisbt/files/mantis-stable/
- http://hyp3rlinx.altervista.org/advisories/MANTIS-BUG-TRACKER-PRE-AUTH-REMOTE-PASSWORD-RESET.txt
- https://www.exploit-db.com/exploits/41890
- http://www.openwall.com/lists/oss-security/2017/04/16/2
- https://nvd.nist.gov/vuln/detail/CVE-2017-7615
