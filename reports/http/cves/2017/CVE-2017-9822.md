---
cve_id: CVE-2017-9822
template_path: nuclei-templates/http/cves/2017/CVE-2017-9822.yaml
affected_product: DotNetNuke
severity: high
authentication: required
external_callback: false
affected_versions: 5.0.0 - 9.3.0
preconditions: []
poc_classification: rce
---

## Vulnerability
DotNetNuke (DNN) versions 5.0.0â€“9.3.0 are affected by unsafe deserialization of the `DNNPersonalization` cookie. The cookie value is processed without validation or type filtering, enabling attackers to supply malicious .NET object graphs (ExpandedWrapper`2 + ObjectDataProvider) that invoke arbitrary methods on trusted classes such as `DotNetNuke.Common.Utilities.FileSystemUtils`, resulting in remote code execution. CVSS 3.1 score 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H). Remediation is to upgrade beyond 9.3.0.

## PoC / Detection
Classification: rce

The template issues a single raw GET request to the non-existent path `/__` carrying a crafted `DNNPersonalization` cookie that embeds an XML-serialized gadget chain. The payload constructs an `ExpandedWrapperOfFileSystemUtilsObjectDataProvider` whose `ProjectedProperty0` calls `WriteFile("C:\Windows\win.ini")` via `ObjectDataProvider`. Detection succeeds when the 404 response body contains the exact strings `[extensions]` and `for 16-bit app support` (contents of the target win.ini file), confirming that the deserialization gadget executed on the server. Although the probe performs a file-read side-effect, the underlying flaw permits full arbitrary command execution.

## References
- https://github.com/murataydemir/CVE-2017-9822
- https://nvd.nist.gov/vuln/detail/CVE-2017-9822
- http://www.dnnsoftware.com/community/security/security-center
- http://packetstormsecurity.com/files/157080/DotNetNuke-Cookie-Deserialization-Remote-Code-Execution.html
- https://github.com/xbl3/awesome-cve-poc_qazbnm456
