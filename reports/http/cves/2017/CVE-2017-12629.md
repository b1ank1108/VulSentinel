---
cve_id: CVE-2017-12629
template_path: nuclei-templates/http/cves/2017/CVE-2017-12629.yaml
affected_product: Apache Solr
severity: critical
authentication: none
external_callback: true
affected_versions: <= 7.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Apache Solr <= 7.1 is vulnerable to XML Entity Injection (XXE) in the XML Query Parser (available by default via `defType=xmlparser` parameter). This enables out-of-band interactions, blind XXE for arbitrary local file reads (e.g. FTP wrapper), and malicious data uploads to the /upload handler. In conjunction with the Config API add-listener command, it allows reaching RunExecutableListener for remote code execution. Elasticsearch is not affected. Impact: information disclosure, denial of service (CVSS 9.8 Critical, CWE-611).

## PoC / Detection
Classification: info-leak

The template first issues a GET request to `/solr/admin/cores?wt=json` to enumerate core names and extracts one via regex. It then sends a crafted GET request to `/solr/{{core}}/select` containing a malicious XML DOCTYPE with an external entity `SYSTEM "https://{{interactsh-url}}/"` processed via `wt=xml&defType=xmlparser`. It matches for an HTTP interaction callback from the Solr server to confirm successful XXE entity expansion and outbound request.

## References
- https://twitter.com/honoki/status/1298636315613974532
- https://github.com/vulhub/vulhub/tree/master/solr/CVE-2017-12629-XXE
- https://github.com/vulhub/vulhub/tree/master/solr/CVE-2017-12629-RCE
- https://nvd.nist.gov/vuln/detail/CVE-2017-12629
- http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E
