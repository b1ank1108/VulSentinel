---
cve_id: CVE-2017-12583
template_path: nuclei-templates/http/cves/2017/CVE-2017-12583.yaml
affected_product: DokuWiki
severity: medium
authentication: none
external_callback: false
affected_versions: through 2017-02-19b
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DokuWiki through 2017-02-19b contains a reflected cross-site scripting (XSS) vulnerability in the DATE_AT parameter (passed as `at`) to `doku.php`. An unauthenticated attacker can supply a malicious payload (e.g., `<svg onload=alert(document.domain)>`) that is reflected unsanitized in the error response. Successful exploitation allows arbitrary JavaScript execution in the victim's browser context, enabling session hijacking via cookie theft, website defacement, or theft of sensitive information.  
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1).

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/dokuwiki/doku.php?id=wiki:welcome&at=<svg%20onload=alert(document.domain)>` and confirms the flaw when the response body contains the exact unsanitized payload inside the error string `"Unable to parse at parameter \"<svg onload=alert(document.domain)>\".</div>"`, the status code is 200, and the Content-Type header contains `text/html`.

## References
- https://github.com/splitbrain/dokuwiki/issues/2061
- https://nvd.nist.gov/vuln/detail/CVE-2017-12583
- https://github.com/ARPSyndicate/kenzer-templates
