---
cve_id: CVE-2017-18518
template_path: nuclei-templates/http/cves/2017/CVE-2017-18518.yaml
affected_product: SMTP by BestWebSoft
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The bws-smtp WordPress plugin by BestWebSoft versions before 1.1.0 contains multiple reflected cross-site scripting (XSS) vulnerabilities (CWE-79). Authenticated attackers can inject arbitrary JavaScript via the unsanitized `category` parameter on the admin `bws_panel` page. Impact includes execution of malicious JS in the victim's browser context (scope changed), enabling session cookie theft, credential exposure, or actions performed on behalf of the logged-in user. CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Fixed in version 1.1.0.

## PoC / Detection
Classification: info-leak

The template first authenticates to WordPress by submitting credentials via POST to `/wp-login.php`. It then issues a GET request to `/wp-admin/admin.php?page=bws_panel` embedding the reflected XSS payload `"></script><script>alert(document.domain)</script>` in the `category` query parameter. Detection succeeds if the response contains the unsanitized payload in the body (indicating lack of output encoding) along with a successful 200 status and HTML content-type. A supplementary request to the plugin's `readme.txt` confirms "SMTP by BestWebSoft" to validate the component presence.

## References
- https://wpscan.com/vulnerability/efd816c3-90d4-40bf-850a-0e4c1a756694
- https://nvd.nist.gov/vuln/detail/CVE-2017-18518
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18518
- https://wordpress.org/plugins/bws-smtp/#developers
