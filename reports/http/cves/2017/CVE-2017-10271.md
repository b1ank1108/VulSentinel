---
cve_id: CVE-2017-10271
template_path: nuclei-templates/http/cves/2017/CVE-2017-10271.yaml
affected_product: Oracle WebLogic Server
severity: high
authentication: none
external_callback: true
affected_versions: 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Oracle WebLogic Server component of Oracle Fusion Middleware (WLS Security subcomponent) is susceptible to remote command execution via Java deserialization in the WorkContext SOAP header. Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0. This easily exploitable vulnerability allows unauthenticated attackers with network access via T3 to compromise Oracle WebLogic Server. Successful exploitation allows remote attackers to execute arbitrary commands with the privileges of the WebLogic server.

## PoC / Detection
Classification: rce

The template sends two raw POST requests to `/wls-wsat/CoordinatorPortType` containing SOAP envelopes with a `<work:WorkContext>` header. The first embeds an XMLDecoder payload that instantiates `java.lang.ProcessBuilder` to run `ping -c 1 {{interactsh-url}}`. The second uses reflection on the current thread/response to write `{{randstr}}` directly to the servlet output stream. Detection uses `stop-at-first-match` with OR condition: first matcher requires regex faultstring for ProcessBuilder + interactsh DNS interaction + 500 status; second requires exact body match to randstr on 200 status.

## References
- https://github.com/vulhub/vulhub/tree/fda47b97c7d2809660a4471539cd0e6dbf8fac8c/weblogic/CVE-2017-10271
- https://github.com/SuperHacker-liuan/cve-2017-10271-poc
- http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-10271
- http://www.securitytracker.com/id/1039608
