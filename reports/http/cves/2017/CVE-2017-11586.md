---
cve_id: CVE-2017-11586
template_path: nuclei-templates/http/cves/2017/CVE-2017-11586.yaml
affected_product: FineCMS
severity: medium
authentication: required
external_callback: true
affected_versions: <5.0.9
preconditions: []
poc_classification: detect-only
---

## Vulnerability
FineCMS <5.0.9 contains an open redirect (CWE-601) via the `url` parameter in the `weixin/sync` action. Attacker-supplied URL is reflected unsanitized in a `Refresh` header after a login flow, enabling redirection of authenticated users to arbitrary external domains.  
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1).  
Impact: phishing, potential theft of session tokens or credentials via malicious landing pages.  
Remediation: upgrade to 5.0.9 or later.

## PoC / Detection
Classification: detect-only  
The template first POSTs to `/index.php?s=member&c=login&m=index` with `data[username]` and `data[password]` to obtain a session, then GETs `/index.php?c=weixin&m=sync&url=http://interact.sh`. Matcher checks the response `Refresh` header for reflection of the external `interact.sh` domain.

## References
- http://lorexxar.cn/2017/07/20/FineCMS%20multi%20vulnerablity%20before%20v5.0.9/#URL-Redirector-Abuse
- https://nvd.nist.gov/vuln/detail/CVE-2017-11586
