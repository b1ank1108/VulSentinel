---
cve_id: CVE-2017-15715
template_path: nuclei-templates/http/cves/2017/CVE-2017-15715.yaml
affected_product: Apache httpd
severity: high
authentication: none
external_callback: false
affected_versions: 2.4.0 to 2.4.29
preconditions: Apache configured with <FilesMatch> restricting uploads by trailing filename match using $
poc_classification: rce
---

## Vulnerability
Apache httpd 2.4.0 to 2.4.29 is susceptible to arbitrary file upload via <FilesMatch> expressions: the '$' anchor can match a newline character in a malicious filename instead of strictly the end of the string. This bypasses upload filters that block files solely by trailing filename portions (e.g., blocking .php). Impact: attacker can upload malicious files leading to remote code execution or unauthorized access. Remediation: upgrade to a version higher than 2.4.29 or apply patches. CVSS 3.0: 8.1 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: rce

The template actively exploits by issuing a multipart/form-data POST to / with a file named "{{randstr}}.php" containing random payload data, but with the form-data "name" field set to "{{randstr}}.php\x0A" to trigger the newline bypass. It then performs a GET /{{randstr}}.php\x0A and matches if the response body contains the original random payload, confirming successful upload and retrieval despite any trailing-match restrictions.

## References
- https://github.com/vulhub/vulhub/tree/master/httpd/CVE-2017-15715
- https://httpd.apache.org/security/vulnerabilities_24.html
- http://www.openwall.com/lists/oss-security/2018/03/24/6
- https://nvd.nist.gov/vuln/detail/CVE-2017-15715
- http://www.securitytracker.com/id/1040570
