---
cve_id: CVE-2017-3133
template_path: nuclei-templates/http/cves/2017/CVE-2017-3133.yaml
affected_product: Fortinet FortiOS
severity: medium
authentication: required
external_callback: false
affected_versions: versions 5.6.0 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
A Cross-Site Scripting vulnerability in Fortinet FortiOS versions 5.6.0 and earlier allows attackers to execute unauthorized code or commands via the Replacement Message HTML for SSL-VPN.

**Impact:** Successful exploitation could lead to execution of malicious javascript.  
**Remediation:** Apply the latest security patches or upgrade to a newer version to mitigate the XSS vulnerability.  
**CVSS v3.0:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**CPE example:** cpe:2.3:o:fortinet:fortios:5.4.0:*:*:*:*:*:*:*  
**Tags:** cve, cve2017, fortinet, fortios, xss, authenticated, vuln  
**Metadata:** vendor=fortinet, product=fortios; Shodan queries include `http.html:"/remote/login" "xxxxxxxx"`, `http.favicon.hash:945408572`, `cpe:"cpe:2.3:o:fortinet:fortios"`.

## PoC / Detection
Classification: rce

The template first authenticates by sending username/password to `/logincheck`, extracts the CSRF token with a regex on the response header (`ccsrftoken_...`), then issues a POST to `/p/system/replacemsg/edit/sslvpn/sslvpn-login/` containing the raw payload `ABC</textarea>\n<script>alert(document.domain)</script>\n` inside the buffer field, and finally performs a GET on `/p/system/replacemsg-group/edit/None/sslvpn/sslvpn-login/` to confirm the exact unsanitized string `</textarea><script>alert(document.domain)</script>` appears in `body_3` together with status 200 and `text/html` content-type.

## References
- https://www.exploit-db.com/exploits/42388
- https://nvd.nist.gov/vuln/detail/CVE-2017-3133
