---
cve_id: CVE-2017-9805
template_path: nuclei-templates/http/cves/2017/CVE-2017-9805.yaml
affected_product: Apache Struts2
severity: high
authentication: none
external_callback: true
affected_versions: 2.1.1 through 2.3.x before 2.3.34 and 2.5.x before 2.5.13
preconditions: REST Plugin enabled
poc_classification: rce
---

## Vulnerability
The REST Plugin in Apache Struts2 2.1.1 through 2.3.x before 2.3.34 and 2.5.x before 2.5.13 uses an XStreamHandler with an unfiltered XStream instance for XML deserialization, allowing arbitrary gadget chain execution and remote code execution.

## PoC / Detection
Classification: rce
The template performs a POST to `{{BaseURL}}/struts2-rest-showcase/orders/3` or `{{BaseURL}}/orders/3` with `Content-Type: application/xml` containing a crafted XStream payload that deserializes to a `ProcessBuilder` executing `wget --post-file /etc/passwd {{interactsh-url}}`. Detection matches on HTTP 500 status code together with the strings "Debugging information" and "com.thoughtworks.xstream.converters.collections.MapConverter" in the response body.

## References
- http://www.oracle.com/technetwork/security-advisory/alert-cve-2017-9805-3889403.html
- https://struts.apache.org/docs/s2-052.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-9805
- http://www.securitytracker.com/id/1039263
- https://blogs.apache.org/foundation/entry/apache-struts-statement-on-equifax
