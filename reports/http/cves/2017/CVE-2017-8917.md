---
cve_id: CVE-2017-8917
template_path: nuclei-templates/http/cves/2017/CVE-2017-8917.yaml
affected_product: Joomla!
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.7.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Joomla! versions prior to 3.7.1 contain a critical SQL injection vulnerability (CWE-89). The vulnerability exists in the com_fields component and allows unauthenticated attackers to inject arbitrary SQL commands through the `list[fullordering]` parameter. This flaw enables attackers to extract sensitive information from the database, modify data, and execute unauthorized administrative operations. The vulnerability has a CVSS score of 9.8 (Critical) with an EPSS score of 0.94513, indicating a very high probability of exploitation in the wild. No authentication or special preconditions are required to exploit this vulnerability.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a GET request to the Joomla! installation targeting the com_fields component. It crafts a malicious payload in the `list[fullordering]` parameter using the `updatexml()` MySQL function to execute an SQL injection. The payload attempts to inject `updatexml(0x23,concat(1,md5({{num}})),1)` where `{{num}}` is a variable set to "999999999". If the injection is successful, the MD5 hash of the number will be computed by the database and reflected in the response body. The template verifies the vulnerability by checking if the response contains the MD5 hash of the injected number, confirming that arbitrary SQL commands can be executed.

## References

- https://developer.joomla.org/security-centre/692-20170501-core-sql-injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-8917
- https://web.archive.org/web/20211207050608/http://www.securitytracker.com/id/1038522
- http://www.securitytracker.com/id/1038522
- https://github.com/binfed/cms-exp
