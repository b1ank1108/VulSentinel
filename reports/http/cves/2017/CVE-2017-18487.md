---
cve_id: CVE-2017-18487
template_path: nuclei-templates/http/cves/2017/CVE-2017-18487.yaml
affected_product: AdPush
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.44
preconditions: WordPress site with adsense-plugin installed and activated
poc_classification: info-leak
---

## Vulnerability
AdPush < 1.44 (adsense-plugin aka Google AdSense for WordPress) suffers from reflected Cross-Site Scripting (XSS) via the unsanitized `category` parameter on the `bws_panel` admin page.  
Authenticated attackers who trick a logged-in user (typically an administrator) into visiting a crafted URL can execute arbitrary JavaScript in the victim's browser context.  
Impact includes session-cookie theft, credential harvesting, or performing actions on behalf of the victim.  
CVSS v3.0: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) â€¢ CWE-79.

## PoC / Detection
Classification: info-leak

The template first performs a POST login to `/wp-login.php` using supplied `{{username}}` / `{{password}}` credentials, then issues a GET request to `/wp-admin/admin.php?page=bws_panel&category=%22%3E%3C/script%3E%3Cscript%3Ealert(document.domain)%3C/script%3E` and checks whether the response body contains the unsanitized payload reflected as `></script><script>alert(document.domain)</script>\">All</a></li>`. A final GET to `/wp-content/plugins/adsense-plugin/readme.txt` confirms the presence of the vulnerable plugin by matching the string "Google AdSense".

## References
- https://wpscan.com/vulnerability/efd816c3-90d4-40bf-850a-0e4c1a756694
- https://nvd.nist.gov/vuln/detail/CVE-2017-18487
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18487
- https://wordpress.org/plugins/adsense-plugin/#developers
