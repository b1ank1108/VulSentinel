---
cve_id: CVE-2017-18349
template_path: nuclei-templates/http/cves/2017/CVE-2017-18349.yaml
affected_product: Fastjson
severity: critical
authentication: none
external_callback: true
affected_versions: < 1.2.25
preconditions: []
poc_classification: rce
---

## Vulnerability
Alibaba Fastjson versions before 1.2.25 contain an insecure deserialization vulnerability in the `parseObject` method. Remote unauthenticated attackers can achieve remote code execution by sending crafted JSON payloads that abuse `@type` annotations to instantiate `com.sun.rowset.JdbcRowSetImpl` with a `dataSourceName` field pointing to an attacker-controlled RMI or LDAP server. This issue affects applications (such as Pippo 1.11.0) that use Fastjson to parse untrusted JSON input.

CVSS 3.0 score: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact includes full system compromise, arbitrary command execution, and data access.

## PoC / Detection
Classification: rce

The template sends unauthenticated POST requests with `Content-Type: application/json` to common endpoints (`/json`, `/api/json`, `/parse`, `/deserialize`) using multiple payload wrappers (root level, under "data" key, under "b" key). Payloads trigger the JdbcRowSetImpl gadget chain with RMI/LDAP URLs containing interactsh domains. Detection relies on observing OOB DNS callbacks from the target and specific response indicators like 'set property error' combined with JSON content-type.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2017-18349
- https://github.com/alibaba/fastjson/wiki/security_update_20170315
- https://github.com/pippo-java/pippo/issues/466
- https://github.com/h0cksr/Fastjson--CVE-2017-18349-
- https://fortiguard.com/encyclopedia/ips/44059
- https://www.exploit-db.com/exploits/45983
