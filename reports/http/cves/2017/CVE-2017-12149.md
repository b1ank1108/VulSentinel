---
cve_id: CVE-2017-12149
template_path: nuclei-templates/http/cves/2017/CVE-2017-12149.yaml
affected_product: JBoss Application Server
severity: critical
authentication: none
external_callback: false
affected_versions: Red Hat Enterprise Application Platform 5.2
preconditions: HTTP Invoker enabled
poc_classification: rce
---

## Vulnerability
JBoss Application Server as shipped with Red Hat Enterprise Application Platform 5.2 is susceptible to a remote code execution vulnerability (CVE-2017-12149, CWE-502) because the doFilter method in the ReadOnlyAccessFilter of the HTTP Invoker does not restrict classes for which it performs deserialization, thus allowing an attacker to execute arbitrary code via crafted serialized data.

CVSS v3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Successful exploitation leads to full server compromise.

## PoC / Detection
Classification: rce

The template sends three POST requests with `Content-Type: application/octet-stream` containing a base64-decoded serialized `java.util.ArrayList` payload (two harmless string elements) to `/invoker/JMXInvokerServlet/`, `/invoker/EJBInvokerServlet/`, and `/invoker/readonly`. Detection matches on status 200/500 responses that contain both the words "JBoss" and "ClassCastException" (case-insensitive).

## References
- https://chowdera.com/2020/12/20201229190934023w.html
- https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149
- https://nvd.nist.gov/vuln/detail/CVE-2017-12149
- https://bugzilla.redhat.com/show_bug.cgi?id=1486220
- https://access.redhat.com/errata/RHSA-2018:1607
