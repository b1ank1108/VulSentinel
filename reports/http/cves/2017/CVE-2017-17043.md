---
cve_id: CVE-2017-17043
template_path: nuclei-templates/http/cves/2017/CVE-2017-17043.yaml
affected_product: WordPress Emag Marketplace Connector plugin
severity: medium
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: WordPress installation with Emag Marketplace Connector plugin installed
poc_classification: info-leak
---

## Vulnerability
Reflected cross-site scripting (XSS) in WordPress Emag Marketplace Connector plugin 1.0. The `post` parameter to `/wp-content/plugins/emag-marketplace-connector/templates/order/awb-meta-box.php` is not properly sanitized.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

Impact includes potential theft of sensitive information like cookies, session hijacking, and arbitrary JavaScript execution in the victim's browser context.

Remediation is to update to plugin version 1.1.

## PoC / Detection
Classification: info-leak

The template uses a conditional two-step HTTP detection flow. It first GETs `{{BaseURL}}` and internally confirms the plugin by matching `/wp-content/plugins/emag-marketplace-connector/` in the response. It then GETs the vulnerable path with the encoded payload `post=</script><script>alert(document.domain)</script>` and matches for unescaped reflection of the script tag in the body, text/html content-type, and HTTP 200 status.

## References
- https://wordpress.org/support/topic/wordpress-emag-marketplace-connector-1-0-cross-site-scripting-vulnerability/
- https://packetstormsecurity.com/files/145060/wpemagmc10-xss.txt
- https://wpvulndb.com/vulnerabilities/8964
- https://nvd.nist.gov/vuln/detail/CVE-2017-17043
- https://github.com/ARPSyndicate/cvemon
