---
cve_id: CVE-2017-15944
template_path: nuclei-templates/http/cves/2017/CVE-2017-15944.yaml
affected_product: Palo Alto Network PAN-OS
severity: critical
authentication: none
external_callback: false
affected_versions: Palo Alto Network PAN-OS and Panorama before 6.1.19, 7.0.x before 7.0.19, 7.1.x before 7.1.14, and 8.0.x before 8.0.6
preconditions: management interface accessible
poc_classification: rce
---

## Vulnerability
Palo Alto Network PAN-OS and Panorama before 6.1.19, 7.0.x before 7.0.19, 7.1.x before 7.1.14, and 8.0.x before 8.0.6 allows remote attackers to execute arbitrary code via vectors involving the management interface.

CVSS v3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
Impact: Successful exploitation could allow an attacker to execute arbitrary code on the affected system.  
Remediation: Apply the latest security patches and updates provided by Palo Alto Networks.  
Vendor/Product: paloaltonetworks / pan-os  
Tags: cve2017,cve,kev,edb,rce,vpn,panos,globalprotect,paloaltonetworks,vkev,vuln

## PoC / Detection
Classification: rce

The template sends a single unauthenticated GET request to `/esp/cms_changeDeviceContext.esp?device=aaaaa:a%27";user|s."1337";` (with a random `PHPSESSID` cookie) and detects the flaw by matching the literal string `@start@Success@end@` in the response body plus HTTP 200 status. This confirms the command-injection vector is reachable without performing actual code execution.

## References
- https://www.exploit-db.com/exploits/43342
- https://security.paloaltonetworks.com/CVE-2017-15944
- http://blog.orange.tw/2019/07/attacking-ssl-vpn-part-1-preauth-rce-on-palo-alto.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-15944
- http://www.securitytracker.com/id/1040007
