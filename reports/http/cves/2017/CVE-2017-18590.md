---
cve_id: CVE-2017-18590
template_path: nuclei-templates/http/cves/2017/CVE-2017-18590.yaml
affected_product: Timesheet Plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 0.1.5
preconditions: [Timesheet plugin installed and activated on WordPress, access to wp-admin bws_panel page]
poc_classification: state-change
---

## Vulnerability
Timesheet Plugin for WordPress before 0.1.5 suffers from multiple reflected cross-site scripting (XSS) vulnerabilities (CVE-2017-18590, CWE-79). The `category` query parameter in `/wp-admin/admin.php?page=bws_panel` reflects unsanitized user input.

Authenticated attackers can inject arbitrary JavaScript that executes in the context of a victim's browser (typically logged-in administrators), enabling session-cookie theft, credential exfiltration, or actions performed on behalf of the victim user.  
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
Remediation: Update to version 0.1.5 or later.

## PoC / Detection
Classification: state-change

The template verifies the reflected XSS by:
- Issuing an internal GET / request and confirming the plugin is present via `contains(body, "/wp-content/plugins/timesheet")`.
- Performing a login POST to `/wp-login.php` with supplied `{{username}}` and `{{password}}` credentials.
- Sending a crafted GET to `/wp-admin/admin.php?page=bws_panel&category=%22%3E%3C/script%3E%3Cscript%3Ealert(document.domain)%3C/script%3E`.
- Matching on HTTP 200, `text/html` Content-Type, and exact payload reflection in the response body (`"></script><script>alert(document.domain)</script>">All</a></li>`).

## References
- https://wpscan.com/vulnerability/efd816c3-90d4-40bf-850a-0e4c1a756694/
- https://nvd.nist.gov/vuln/detail/CVE-2017-18590
- https://downloads.wordpress.org/plugin/timesheet
