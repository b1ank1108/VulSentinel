---
cve_id: CVE-2017-17731
template_path: nuclei-templates/http/cves/2017/CVE-2017-17731.yaml
affected_product: DedeCMS
severity: critical
authentication: none
external_callback: false
affected_versions: through 5.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DedeCMS through 5.7 has SQL Injection via the `$_FILES` superglobal to `plus/recommend.php`.  
Successful exploitation allows an attacker to execute arbitrary SQL queries, potentially leading to unauthorized access, data leakage, or data manipulation (CWE-89, CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8).

## PoC / Detection
Classification: info-leak

The template sends one GET request to `{{BaseURL}}/plus/recommend.php` with `_FILES[type][tmp_name]` set to a UNION SELECT payload injecting `md5(999999999)` (plus crafted name/type/size fields simulating a file upload) and checks that the response body contains the resulting MD5 hash string while returning HTTP 200.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17731
- https://nvd.nist.gov/vuln/detail/CVE-2017-17731
- https://blog.csdn.net/nixawk/article/details/24982851
- https://github.com/Lucifer1993/AngelSword/blob/232258e42201373fef1f323864366dc1499581fc/cms/dedecms/dedecms_recommend_sqli.py#L25
- https://github.com/20142995/Goby
