---
cve_id: CVE-2017-17092
template_path: nuclei-templates/http/cves/2017/CVE-2017-17092.yaml
affected_product: WordPress
severity: medium
authentication: required
external_callback: false
affected_versions: < 4.9.1
preconditions: authenticated user with upload permissions
poc_classification: state-change
---

## Vulnerability
WordPress before 4.9.1 contains a cross-site scripting vulnerability caused by not requiring the `unfiltered_html` capability for uploading `.js` files. Authenticated remote attackers with upload permissions can upload crafted JavaScript files that are served from the `wp-content/uploads` directory and execute in the context of the site.

**Impact:** Arbitrary JavaScript execution, leading to session hijacking or defacement.  
**CVSS:** 5.4 (CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**Remediation:** Update to WordPress 4.9.1 or later.

## PoC / Detection
Classification: state-change

The template performs a multi-step authenticated flow to verify the capability bypass and data-write flaw:  
- POST to `/wp-login.php` with `{{username}}`/`{{password}}` and checks for `wordpress_logged_in` cookie (status 302).  
- GET `/wp-admin/upload.php` to extract `_wpnonce` via regex.  
- Multipart POST to `/wp-admin/async-upload.php` uploading a random `{{filename}}.js` containing a unique marker comment.  
- GET the uploaded file at `/wp-content/uploads/{{year}}/{{month}}/{{filename}}.js` and confirms the marker is returned verbatim (status 200).  

This demonstrates the server accepts and serves arbitrary JavaScript content without the required capability check.

## References
- https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/
- https://wpscan.com/vulnerability/0d2323bd-aecd-4d58-ba4b-597a43034f57
- https://nvd.nist.gov/vuln/detail/CVE-2017-17092
- https://lists.debian.org/debian-lts-announce/2017/12/msg00019.html
- https://wpvulndb.com/vulnerabilities/8966
