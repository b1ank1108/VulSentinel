---
cve_id: CVE-2017-11610
template_path: nuclei-templates/http/cves/2017/CVE-2017-11610.yaml
affected_product: supervisor
severity: high
authentication: required
external_callback: true
affected_versions: before 3.0.1, 3.1.x before 3.1.4, 3.2.x before 3.2.4, and 3.3.x before 3.3.3
preconditions: [XML-RPC server enabled]
poc_classification: rce
---

## Vulnerability
The XML-RPC server in supervisor before 3.0.1, 3.1.x before 3.1.4, 3.2.x before 3.2.4, and 3.3.x before 3.3.3 allows remote authenticated users to execute arbitrary commands via a crafted XML-RPC request exploiting nested supervisor namespace lookups (CWE-276).  
CVSS 3.0: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).  
Successful exploitation results in full arbitrary code execution on the target system.

## PoC / Detection
Classification: rce

The template sends a single unauthenticated POST /RPC2 containing a crafted `<methodCall>` to `supervisor.supervisord.options.warnings.linecache.os.system` with payload `nslookup {{interactsh-url}}`. Detection confirms the RCE by matching an out-of-band DNS interaction on interactsh, `text/xml` Content-Type header, and `<methodResponse>` body containing `<int>`.

## References
- https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/linux/http/supervisor_xmlrpc_exec.md
- https://nvd.nist.gov/vuln/detail/CVE-2017-11610
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/JXGWOJNSWWK2TTWQJZJUP66FLFIWDMBQ/
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DTPDZV4ZRICDYAYZVUHSYZAYDLRMG2IM/
- http://www.debian.org/security/2017/dsa-3942
