---
cve_id: CVE-2017-7269
template_path: nuclei-templates/http/cves/2017/CVE-2017-7269.yaml
affected_product: Windows Server 2003 & IIS 6.0
severity: critical
authentication: none
external_callback: false
affected_versions: IIS 6.0 in Microsoft Windows Server 2003 R2
preconditions: [WebDAV enabled]
poc_classification: rce
---

## Vulnerability
Buffer overflow in the `ScStoragePathFromUrl` function of the WebDAV service in Internet Information Services (IIS) 6.0 on Microsoft Windows Server 2003 R2. Remote attackers can execute arbitrary code via a PROPFIND request containing a long header beginning with "If: <http://".

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8)  
CWE-119  
Tagged KEV and vKEV.

Impact: full remote code execution on the target system.  
Remediation: upgrade to a supported Windows Server/IIS version or apply security patches (product is end-of-life).

## PoC / Detection
Classification: rce

The template issues a single HTTP OPTIONS request to `{{BaseURL}}` and checks the response for:
- Server header containing "IIS/6.0"
- WebDAV indicators: `<DAV:sql>` in DASL header, PROPFIND method listed in Public/Allow headers
- HTTP 200 status

This safely fingerprints vulnerable IIS 6.0 instances with WebDAV enabled; the actual RCE requires a crafted long-header PROPFIND (not sent by the template).

## References
- https://blog.0patch.com/2017/03/0patching-immortal-cve-2017-7269.html
- https://github.com/danigargu/explodingcan/blob/master/explodingcan.py
- https://nvd.nist.gov/vuln/detail/CVE-2017-7269
- https://github.com/edwardz246003/IIS_exploit
- http://www.securitytracker.com/id/1038168
