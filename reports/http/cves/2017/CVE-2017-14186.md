---
cve_id: CVE-2017-14186
template_path: nuclei-templates/http/cves/2017/CVE-2017-14186.yaml
affected_product: FortiGate FortiOS SSL VPN Web Portal
severity: medium
authentication: none
external_callback: false
affected_versions: 6.0.0 to 6.0.4, 5.6.0 to 5.6.7, and 5.4 and below
preconditions: SSL VPN Web Portal enabled
poc_classification: info-leak
---

## Vulnerability
FortiGate FortiOS SSL VPN Web Portal contains a reflected cross-site scripting (XSS) vulnerability (CVE-2017-14186, CWE-79). The `redir` parameter on the `/remote/loginredir` endpoint is unsanitized, allowing arbitrary JavaScript injection (e.g., `javascript:alert(document.domain)`) that executes in the victim's browser in the site context.

CVSS v3.0: 5.4 (Medium) â€“ AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N.  
**Impact:** Session hijacking via cookie theft, client-side data exfiltration, URL redirection, or page defacement.  
**Remediation:** Apply the latest Fortinet firmware updates.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/remote/loginredir?redir=javascript:alert(document.domain)` and verifies reflection of the unsanitized payload via these matchers (AND condition):  
- Response body contains `location=decodeURIComponent("javascript%3Aalert%28document.domain%29")`  
- `Content-Type` header contains `text/html`  
- HTTP status 200  

This confirms the reflected XSS flaw on the login portal. Exploitation requires tricking a victim into visiting the crafted URL while authenticated to the portal.

## References
- https://www.fortiguard.com/psirt/FG-IR-17-242
- https://fortiguard.com/advisory/FG-IR-17-242
- https://web.archive.org/web/20210801135714/http://www.securitytracker.com/id/1039891
- https://nvd.nist.gov/vuln/detail/CVE-2017-14186
- http://www.securitytracker.com/id/1039891
