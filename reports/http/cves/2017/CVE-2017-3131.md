---
cve_id: CVE-2017-3131
template_path: nuclei-templates/http/cves/2017/CVE-2017-3131.yaml
affected_product: FortiOS
severity: medium
authentication: required
external_callback: false
affected_versions: 5.4.0 through 5.4.4 and 5.6.0
preconditions: Authenticated access to FortiView Applications
poc_classification: rce
---

## Vulnerability
Fortinet FortiOS versions 5.4.0 through 5.4.4 and 5.6.0 contain a reflected cross-site scripting vulnerability in the FortiView "Applications" filter input. An attacker supplies a malicious payload via the URL path that is reflected unsanitized in the HTML response, allowing execution of unauthorized JavaScript code or commands in the victim's browser.  
CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4)  
CWE-79

## PoC / Detection
Classification: rce  
The template first sends a POST to `/logincheck` with `ajax=1&username={{username}}&secretkey={{password}}` to establish an authenticated session, then issues a GET to `/ng/fortiview/app/15832%22%20onmouseover=alert(document.domain)%20x=%22y` embedding the reflected XSS payload. Detection succeeds if the second response body contains the unsanitized string `id_15832" onmouseover="alert(document.domain)"`, the content-type is `text/html`, and the status code is 200.

## References
- https://www.exploit-db.com/exploits/42388
- https://nvd.nist.gov/vuln/detail/CVE-2017-3131
