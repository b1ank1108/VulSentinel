---
cve_id: CVE-2024-4180
template_path: nuclei-templates/http/cves/2024/CVE-2024-4180.yaml
affected_product: The Events Calendar
severity: medium
authentication: none
external_callback: false
affected_versions: < 6.4.0.1
preconditions: ["user interaction required for exploitation"]
poc_classification: state-change
---

## Vulnerability
The Events Calendar WordPress plugin < 6.4.0.1 contains a stored XSS caused by improper sanitization of user-submitted content when rendering views via AJAX. This lets attackers inject and execute arbitrary scripts in the context of the affected site. Exploitation requires user interaction. Impact includes potential session hijacking or defacement. Remediation requires updating to version 6.4.0.1 or later. CPE: cpe:2.3:a:stellarwp:the_events_calendar:*:*:*:*:*:wordpress:*:*. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N (9.1).

## PoC / Detection
Classification: state-change

The template sends a single unauthenticated POST request to `/wp-admin/admin-ajax.php` with `action=tribe_events_views_v2_fallback&view=reflector&view_data[lala]='<svg alert(document.domain)>'`. It verifies the flaw by confirming the response is HTTP 200, `text/html`, and the body contains the unsanitized payload plus the string `event_display_mode`. This confirms lack of sanitization in the AJAX view-rendering code (tribe_events_views_v2_fallback reflector).

## References
- https://wpscan.com/vulnerability/b2a92316-e404-4a5e-8426-f88df6e87550/
- https://wordpress.org/plugins/the-events-calendar/
- https://nvd.nist.gov/vuln/detail/CVE-2024-4180
