---
cve_id: CVE-2024-6651
template_path: nuclei-templates/http/cves/2024/CVE-2024-6651.yaml
affected_product: WordPress File Upload Plugin
severity: high
authentication: required
external_callback: false
affected_versions: < 4.24.8
preconditions: [wp-file-upload plugin installed and activated on a WordPress site]
poc_classification: info-leak
---

## Vulnerability
The WordPress File Upload plugin before version 4.24.8 is affected by a reflected cross-site scripting (XSS) vulnerability. The 'dir' parameter in the file browser page (`/wp-admin/options-general.php?page=wordpress_file_upload&action=file_browser`) is not properly sanitized or escaped before being output, allowing arbitrary JavaScript execution in an authenticated administrator's browser context when a crafted URL is visited.

CVSS v3.1 score: 7.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N)  
CWE: CWE-79

## PoC / Detection
Classification: info-leak

The nuclei template verifies the issue through a multi-step process:  
- Performs an initial request to the root path to internally confirm the presence of the wp-file-upload plugin by matching 'wp-file-upload/' in the response body.  
- Authenticates to the WordPress site via POST to `/wp-login.php` using supplied credentials.  
- Issues a GET request to the vulnerable file browser endpoint injecting a reflected XSS payload in the `dir` parameter: `7b2BEyT8ArR1jaD9"><script>alert(document.domain)</script><test test=`.  
- Confirms success if the exact unsanitized payload string appears in the response body, the status code is 200, and the Content-Type is text/html.  

This demonstrates the lack of output encoding on the `dir` parameter, confirming the reflected XSS condition.

## References
- https://wpscan.com/vulnerability/65e2c77d-09bd-4a44-81d9-d7a5db0e0f84
- https://nvd.nist.gov/vuln/detail/CVE-2024-6651
