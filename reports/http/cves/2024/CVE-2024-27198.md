---
cve_id: CVE-2024-27198
template_path: nuclei-templates/http/cves/2024/CVE-2024-27198.yaml
affected_product: TeamCity
severity: critical
authentication: none
external_callback: false
affected_versions: < 2023.11.4
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
JetBrains TeamCity before 2023.11.4 contains an authentication bypass (CWE-288) that permits unauthenticated attackers to reach internal REST endpoints and execute administrative actions.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Impact: full server takeover, build-pipeline compromise, source-code exposure.  
Remediation: update to 2023.11.4 or later.

## PoC / Detection
Classification: auth-bypass

The template issues a single unauthenticated GET request to `{{BaseURL}}/hax?jsp=/app/rest/server;.jsp`. Detection succeeds when the response meets all conditions simultaneously: HTTP 200, Content-Type containing `application/xml` or `text/xml`, response body contains the strings `buildNumber`, `server version` and `internalId`, and the body contains neither `Authentication required` nor `login.html`.

## References
- https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/
- https://nvd.nist.gov/vuln/detail/CVE-2024-27198
- https://www.darkreading.com/cyberattacks-data-breaches/jetbrains-teamcity-mass-exploitation-underway-rogue-accounts-thrive
- https://github.com/rampantspark/CVE-2024-27198
- https://github.com/fireinrain/github-trending
