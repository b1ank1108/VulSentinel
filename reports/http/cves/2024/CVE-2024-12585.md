---
cve_id: CVE-2024-12585
template_path: nuclei-templates/http/cves/2024/CVE-2024-12585.yaml
affected_product: PropertyHive
severity: medium
authentication: required
external_callback: false
affected_versions: <= 2.1.0
preconditions: [PropertyHive plugin installed and activated on WordPress; authenticated administrator tricked into visiting crafted URL]
poc_classification: info-leak
---

## Vulnerability
The PropertyHive plugin for WordPress is vulnerable to reflected cross-site scripting via the `ph_message` parameter in all versions up to and including 2.1.0. Insufficient input sanitization and output escaping allow unauthenticated attackers to inject arbitrary web scripts that execute in the browser of any user (typically an administrator) who visits a crafted link to the `ph-settings` admin page. This can lead to arbitrary script execution in the context of high-privilege users, potentially resulting in account compromise or data theft. Update to version 2.1.1 or later.

## PoC / Detection
Classification: info-leak

The template first issues a POST to `/wp-login.php` with supplied `username`/`password` credentials and internally verifies a successful login via 302 status and `wordpress_logged_in` cookie presence. It then sends a GET request to `/wp-admin/admin.php?page=ph-settings&ph_message="><script>alert(document.domain)</script>` and confirms the vulnerability if the response returns HTTP 200, `text/html` content-type, and the response body simultaneously contains the unsanitized injected `<script>alert(document.domain)</script>` payload, the literal string `ph_message`, and the PropertyHive settings page identifier.

## References
- https://www.wordfence.com/th
