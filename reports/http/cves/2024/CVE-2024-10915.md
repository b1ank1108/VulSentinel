---
cve_id: CVE-2024-10915
template_path: nuclei-templates/http/cves/2024/CVE-2024-10915.yaml
affected_product: D-Link NAS
severity: critical
authentication: none
external_callback: false
affected_versions: D-Link DNS-320, DNS-320LW, DNS-325 and DNS-340L up to 20241028
preconditions: []
poc_classification: rce
---

## Vulnerability
A critical OS command injection (CWE-78) exists in the `cgi_user_add` function of `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` in D-Link DNS-320, DNS-320LW, DNS-325 and DNS-340L firmware up to 20241028. Unauthenticated remote attackers can inject arbitrary OS commands via the `group` parameter, resulting in full device compromise (CVSS 3.1: 9.8, AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: rce

The template performs active detection by issuing a raw GET request to `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&group=%27;{{command}};%27` (no authentication, cookies or headers), injecting either the `id` or `ifconfig` payload. It then evaluates the response with DSL matchers that succeed on:
- regex match for command output (`uid=... gid=...` or `inet addr:` / `Mask:` strings) OR
- a 200 OK response containing `Content-type: text/html`.

Stop-at-first-match is enabled; the probe is harmless and only confirms exploitability.

## References
- https://www.usom.gov.tr/bildirim/tr-24-1836
- https://netsecfish.notion.site/Command-Injection-Vulnerability-in-group-parameter-for-D-Link-NAS-12d6b683e67c803fa1a0c0d236c9a4c5?pvs=4
- https://nvd.nist.gov/vuln/detail/CVE-2024-10915
