---
cve_id: CVE-2024-34102
template_path: nuclei-templates/http/cves/2024/CVE-2024-34102.yaml
affected_product: Adobe Commerce & Magento
severity: critical
authentication: none
external_callback: true
affected_versions: 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
Adobe Commerce & Magento versions 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 and earlier are affected by an Improper Restriction of XML External Entity Reference (XXE) vulnerability (CWE-611) known as CosmicSting. Unauthenticated remote attackers can exploit nested deserialization in the REST API to achieve arbitrary code execution (CVSS 9.8).

## PoC / Detection
Classification: rce

The template sends a single POST request to `/rest/V1/guest-carts/1/estimate-shipping-methods` with a JSON body containing a malicious `sourceData` object where `dataIsURL` is set to `true` and `data` points to `http://{{interactsh-url}}/xxe.xml`. Detection succeeds when a DNS interaction is recorded by interactsh **and** the response satisfies all of: `content_type` contains `application/json`, `body` contains `message`, and `body` contains any of `log file` / `cartId` / `no Route`.

## References
- https://github.com/spacewasp/public_docs/blob/main/CVE-2024-34102.md
- https://www.assetnote.io/resources/research/why-nested-deserialization-is-harmful-magento-xxe-cve-2024-34102
