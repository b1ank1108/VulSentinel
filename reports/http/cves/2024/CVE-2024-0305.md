---
cve_id: CVE-2024-0305
template_path: nuclei-templates/http/cves/2024/CVE-2024-0305.yaml
affected_product: Ncast busiFacade
severity: high
authentication: none
external_callback: false
affected_versions: 2017 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
Ncast busiFacade component in the Ncast Yingshi high-definition intelligent recording and playback system contains a remote command execution vulnerability. Unauthenticated attackers can inject and execute arbitrary OS commands via the `param` field in requests to the `SysManager` service.  
**Impact**: Remote arbitrary code execution (confirmed by payload executing `id` and returning UID/GID output).  
**CVSS v3.1**: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).  
**Remediation**: Apply latest vendor security patches.

## PoC / Detection
Classification: rce  
The template issues one unauthenticated POST request to `/classes/common/busiFacade.php` (Content-Type: application/x-www-form-urlencoded) containing the body `{"name":"ping","serviceName":"SysManager","userTransaction":false,"param":["ping 127.0.0.1 | id"]}`. It detects successful exploitation by matching HTTP 200 status AND regex patterns `uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)` and `#str` in the response body, confirming command output leakage.

## References
- https://cxsecurity.com/cveshow/CVE-2024-0305
- https://nvd.nist.gov/vuln/detail/CVE-2024-0305
- https://vuldb.com/?id.249872
- https://vuldb.com/?ctiid.249872
- https://github.com/Marco-zcl/POC
