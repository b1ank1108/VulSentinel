---
cve_id: CVE-2024-11305
template_path: nuclei-templates/http/cves/2024/CVE-2024-11305.yaml
affected_product: Altenergy Power Control Software
severity: medium
authentication: required
external_callback: false
affected_versions: up to 20241108
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A SQL injection vulnerability affects Altenergy Power Control Software up to 20241108. It impacts the `get_status_zigbee` function in the file `/index.php/display/status_zigbee` through manipulation of the `date` argument. Authenticated remote attackers can exploit this flaw.  

Impact: Authenticated attackers can execute SQL injection via the `date` parameter to extract sensitive power system data including energy metrics and device configurations.  

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L (6.3)  
CWE-74

## PoC / Detection
Classification: info-leak

The template sends a single POST request to `/index.php/display/status_zigbee` containing a crafted `date` parameter: `2024-11-06%' UNION ALL SELECT 11,CHAR(113)||CHAR(75,101,86,69,115,83,113,89,100,122,121,102,83,83,113,86,84,112,100,103,69,75,80,117,88,109,83,105,89,116,110,120,76,84,73,109,115,100,83,107)||CHAR(113,118,98,98,113),11-- wPIB`. It verifies exploitation by checking that the response body simultaneously contains the string "Status(ZigBee)", the injected marker `qKeVEsSqYdzyfSSqVTpdgEKPuXmSiYtnxLTImsdSkqvbbq`, HTTP status 200, and `text/html` content-type.

## References
- https://blog.csdn.net/ZeroDay001/article/details/143878599
- https://cn-sec.com/archives/3447233.html
- https://nvd.nist.gov/vuln/detail/CVE-2024-11305
