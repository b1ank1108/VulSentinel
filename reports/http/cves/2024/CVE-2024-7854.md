---
cve_id: CVE-2024-7854
template_path: nuclei-templates/http/cves/2024/CVE-2024-7854.yaml
affected_product: Woo Inquiry
severity: critical
authentication: none
external_callback: false
affected_versions: <= 0.1
preconditions: Woo Inquiry plugin installed and active on a WordPress site
poc_classification: info-leak
---

## Vulnerability
Woo Inquiry WordPress plugin versions <= 0.1 is vulnerable to unauthenticated SQL injection in the `dbid` parameter of the `woo_wpinq_times_up` AJAX action due to insufficient escaping and lack of prepared statements. Unauthenticated attackers can append arbitrary SQL queries to extract sensitive database information. Full impact includes extraction, modification, or deletion of database data, potentially compromising user credentials and the entire WordPress site.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-89.

## PoC / Detection
Classification: info-leak

The template detects via a two-step HTTP flow:  
1. GET `/` (internal matcher) confirms plugin presence by checking `contains(body, "/wp-content/plugins/woo-inquiry")`.  
2. POST `/wp-admin/admin-ajax.php` sends `action=woo_wpinq_times_up&dbid=(SELECT(0)FROM(SELECT(SLEEP(6)))a)` with 20s timeout; vulnerability is confirmed if `duration>=6`, status_code==200, and content_type contains "text/html".

## References
- https://github.com/RandomRobbieBF/CVE-2024-7854
- https://www.wordfence.com/threat-intel/vulnerabilities/id/312a6601-c914-4661-82ff-6f8bac849442?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-7854
