---
cve_id: CVE-2024-6646
template_path: nuclei-templates/http/cves/2024/CVE-2024-6646.yaml
affected_product: Netgear WN604
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Netgear WN604 wireless router downloadFile.php endpoint exposes an information disclosure vulnerability (CVE-2024-6646, CWE-200). Unauthenticated remote attackers can retrieve the full configuration file (including administrator username and password) by requesting `/downloadFile.php?file=config`. Successful exploitation grants full control of the router backend, enabling wireless network takeover or further attacks.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (score 5.3). Impact: complete router compromise via leaked admin credentials.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/downloadFile.php?file=config` and applies an AND matcher condition: response body must contain both `system:basicSettings` and `system:staSettings`, Content-Type header must be `application/force-download`, and HTTP status must be 200. Positive match confirms the vulnerable endpoint is leaking the configuration file.

## References
- https://github.com/wy876/POC/blob/main/Ncast%E9%AB%98%E6%B8%85%E6%99%BA%E8%83%BD%E5%BD%95%E6%92%AD%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
- https://github.com/mikutool/vul/issues/1
- https://vuldb.com/?ctiid.271052
- https://vuldb.com/?id.271052
- https://vuldb.com/?submit.367382
