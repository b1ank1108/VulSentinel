---
cve_id: CVE-2024-30194
template_path: nuclei-templates/http/cves/2024/CVE-2024-30194.yaml
affected_product: Sunshine Photo Cart
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Sunshine Photo Cart (WordPress plugin) <= 3.1.1 contains a reflected cross-site scripting vulnerability (CWE-79) caused by improper neutralization of input during web page generation. The flaw occurs on the admin reports page when the `report` query parameter is reflected unsanitized into the HTML response. An attacker crafts a malicious URL containing JavaScript payload; a logged-in administrator who visits the link triggers execution in their browser context. CVSS 3.1: 6.1 (Medium), vector AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N. Impact includes session hijacking, page defacement, or arbitrary redirection. Remediation is to update beyond 3.1.1.

## PoC / Detection
Classification: info-leak

The template first sends a POST to `/wp-login.php` with `{{username}}`/`{{password}}` and `wordpress_test_cookie`, confirming successful authentication via 302 redirect and presence of `wordpress_logged_in` cookie in headers (internal matcher). It then issues a GET to `/wp-admin/edit.php?post_type=sunshine-gallery&page=sunshine-reports&report=orders%22%20onmouseover=alert(document.domain)%3Bthis.remove()%3B%20style=position:fixed%3Bleft:0%3Btop:0%3Bwidth:100vw%3Bheight:100vh%3B`. Detection succeeds if the response is HTTP 200 and the body simultaneously contains the exact unsanitized payload string plus the string "Sunshine Photo Cart", confirming reflection in the plugin-generated page without any out-of-band interaction or server-side modification.

## References
- https://wpscan.com/vulnerability/8fe6645b-c11d-4075-89c1-f6a01dfb3a0e/
- https://patchstack.com/database/vulnerability/sunshine-photo-cart/wordpress-sunshine-photo-cart-plugin-3-1-1-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-30194
