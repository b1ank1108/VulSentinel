---
cve_id: CVE-2024-9617
template_path: nuclei-templates/http/cves/2024/CVE-2024-9617.yaml
affected_product: Danswer
severity: medium
authentication: required
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Danswer is affected by an Insecure Direct Object Reference (IDOR, CVE-2024-9617, CWE-284) vulnerability in its chat module. The application does not verify whether the authenticated requester is the creator/owner of a file or chat session when processing GET /api/chat/file/{file_id} or GET /api/chat/get-chat-session requests. Authenticated attackers can therefore directly retrieve chat files and session data belonging to any other user.

Impact: unauthorized disclosure of sensitive chat files and data.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (score 6.5).  
Remediation: update Danswer to a version that enforces ownership checks on these endpoints.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}/api/chat/get-chat-session/1?is_shared=True` and verifies exploitation conditions via a DSL matcher requiring HTTP 200 status, `application/json` Content-Type, and the simultaneous presence of the strings `chat_session_id`, `description`, and `persona_id` in the response body. This probe confirms the missing authorization check by successfully retrieving chat-session data that an unprivileged or cross-user request should be denied.

## References
- https://huntr.com/bounties/8f683ff6-3a99-41c6-b763-a8f7b73bd146
- https://github.com/danswer-ai/danswer
