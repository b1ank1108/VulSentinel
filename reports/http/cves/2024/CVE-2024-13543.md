---
cve_id: CVE-2024-13543
template_path: nuclei-templates/http/cves/2024/CVE-2024-13543.yaml
affected_product: Zarinpal Paid Download WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: v2.3
preconditions: [plugin installed and active on WordPress; requires tricking logged-in admin to visit crafted link]
poc_classification: state-change
---

## Vulnerability
Zarinpal Paid Download WordPress plugin v2.3 is affected by reflected cross-site scripting due to lack of sanitization and escaping of the `ty` parameter before output on `/wp-admin/admin.php?page=paid-downloads-add`. An attacker can craft a malicious link that, when visited by a high-privilege user (e.g., admin), executes arbitrary JavaScript in the victim's browser context with the victim's permissions. CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N); CWE-79. Impact includes session hijacking and full account compromise.

## PoC / Detection
Classification: state-change

The template first performs POST to `/wp-login.php` with supplied `{{username}}`/`{{password}}` credentials and internally verifies successful authentication via presence of `wordpress_logged_in` cookie in headers. It then sends GET to the vulnerable admin endpoint with `ty=1"></script><script>alert(document.domain)</script><script>` payload and confirms vulnerability if HTTP 200 is returned and response body contains both the unsanitized payload and `zarinpal-paid-download` string.

## References
- https://wpscan.com/vulnerability/04a545c4-75d3-4672-8530-00bb879991ca/
- https://nvd.nist.gov/vuln/detail/CVE-2024-13543
