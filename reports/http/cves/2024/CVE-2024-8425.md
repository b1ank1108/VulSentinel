---
cve_id: CVE-2024-8425
template_path: nuclei-templates/http/cves/2024/CVE-2024-8425.yaml
affected_product: WooCommerce Ultimate Gift Card
severity: critical
authentication: none
external_callback: false
affected_versions: ≤ 2.6.0
preconditions: []
poc_classification: rce
---

## Vulnerability
WooCommerce Ultimate Gift Card WordPress plugin (by wpswings) is vulnerable to unauthenticated arbitrary file upload (CWE-434) due to insufficient file type validation in the `mwb_wgm_preview_mail` and `mwb_wgm_woocommerce_add_cart_item_data` functions in all versions up to and including 2.6.0. Attackers can upload arbitrary files—including PHP webshells—to `/wp-content/uploads/mwb_browse/`, enabling remote code execution and complete server compromise. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: rce

The template detects the flaw via a two-step unauthenticated HTTP flow:  
1. POSTs a multipart/form-data request to `/wp-admin/admin-ajax.php?action=mwb_wgm_preview_mail` containing a randomly named `.txt` file (Content-Type: image/jpeg) with random test content.  
2. GETs `/wp-content/uploads/mwb_browse/{{filename}}` and verifies the exact file content is returned, confirming successful arbitrary file write and retrieval.

## References
- https://github.com/KTN1990/CVE-2024-8425
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/woocommerce-ultimate-gift-card/woocommerce-ultimate-gift-card-260-unauthenticated-arbitrary-file-upload
- https://nvd.nist.gov/vuln/detail/CVE-2024-8425
