---
cve_id: CVE-2024-7340
template_path: nuclei-templates/http/cves/2024/CVE-2024-7340.yaml
affected_product: W&B Weave Server
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
W&B Weave Server is affected by a path traversal vulnerability in the Weave server API file retrieval endpoint. Lack of input validation on the file path parameter allows remote users to traverse the filesystem and leak arbitrary files. In common deployment scenarios this enables low-privileged users to read sensitive configuration files and credentials, facilitating escalation to server administrator privileges.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). Remediation requires updating to the version containing the fix from PR #1657.

## PoC / Detection
Classification: info-leak

The template sends a raw GET request `GET /__weave/file/tmp/weave/fs/../../../etc/passwd` and confirms the vulnerability via an AND matcher on the response: regex match for `root:.*:0:0:` in body (proving /etc/passwd was read), both `application/octet-stream` and `filename=passwd` present in headers, and HTTP status 200.

## References
- https://github.com/advisories/GHSA-r49h-6qxq-624f
- https://github.com/wandb/weave/pull/1657
- https://research.jfrog.com/vulnerabilities/wandb-weave-server-remote-arbitrary-file-leak-jfsa-2024-001039248/
