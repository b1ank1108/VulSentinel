---
cve_id: CVE-2024-34351
template_path: nuclei-templates/http/cves/2024/CVE-2024-34351.yaml
affected_product: Next.js
severity: high
authentication: none
external_callback: true
affected_versions: < 14.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Next.js, inferior to version 14.1.1, has its image optimization built-in component prone to SSRF.  
Unauthenticated attackers can force the Next.js server to make requests to arbitrary internal or external resources.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5) | CWE-918.

## PoC / Detection
Classification: info-leak  
The template sends GET requests to `{{BaseURL}}/_next/image?w=16&q=10&url=http://{{interactsh-url}}` and the HTTPS variant (stop-at-first-match). It verifies the SSRF by matching an HTTP out-of-band interaction (`interactsh_protocol: http`) together with the exact body string "The requested resource isn't a valid image".

## References
- https://www.assetnote.io/resources/research/digging-for-ssrf-in-nextjs-apps
- https://nvd.nist.gov/vuln/detail/CVE-2024-34351
- https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g
- https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085
- https://github.com/vercel/next.js/pull/62561
