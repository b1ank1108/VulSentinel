---
cve_id: CVE-2024-12734
template_path: nuclei-templates/http/cves/2024/CVE-2024-12734.yaml
affected_product: Advance Post Prefix WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: through 1.1.1
preconditions: Advance Post Prefix plugin installed and activated on WordPress; requires logged-in administrator to visit crafted URL
poc_classification: state-change
---

## Vulnerability
Reflected cross-site scripting (XSS) in Advance Post Prefix WordPress plugin through 1.1.1 due to unsanitized and unescaped `post` parameter output on `/wp-admin/admin.php?page=add-prefix`. Attackers can inject arbitrary JavaScript executed in the browser of high-privilege users (e.g., admins) via crafted requests. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Impact includes account compromise and unauthorized actions performed in the victim's authenticated session.

## PoC / Detection
Classification: state-change

The template first performs an internal POST to `/wp-login.php` using `{{username}}` and `{{password}}` credentials and verifies successful authentication via the presence of `wordpress_logged_in` in the response headers. It then sends a GET request to `/wp-admin/admin.php?page=add-prefix&post="></script><script>alert(document.domain)</script><script>` and confirms exploitation if status_code is 200 and the response body reflects the unsanitized payload alongside the string "advance-post-prefix". This verifies the lack of output escaping on the vulnerable admin endpoint.

## References
- https://wpscan.com/vulnerability/038b44dc-0495-4f56-ae7e-c78a265aa535/
- https://nvd.nist.gov/vuln/detail/cve-2024-12734
