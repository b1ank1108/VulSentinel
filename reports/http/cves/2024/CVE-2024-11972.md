---
cve_id: CVE-2024-11972
template_path: nuclei-templates/http/cves/2024/CVE-2024-11972.yaml
affected_product: Hunk Companion
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.9.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
The Hunk Companion WordPress plugin < 1.9.0 does not correctly authorize the `/wp-json/hc/v1/themehunk-import` REST API endpoint. Unauthenticated attackers can therefore install and activate arbitrary plugins from the WordPress.org repository, including vulnerable or closed (potentially malicious) ones. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Full site compromise is possible via installation of malicious plugins.

## PoC / Detection
Classification: state-change

The template issues a GET request to `/` followed by a POST request to `/wp-json/hc/v1/themehunk-import` containing a JSON payload with a randomly generated plugin name (and randomized X-WP-Nonce header) that attempts installation/activation. The request contains no authentication material. Detection succeeds on HTTP 200 status, `application/json` content-type, and presence of the string `"\"https:\\\/\\\/"` in the response body.

## References
- https://wpscan.com/vulnerability/4963560b-e4ae-451d-8f94-482779c415e4/
- https://github.com/JunTakemura/exploit-CVE-2024-11972
- https://github.com/Nxploited/CVE-2024-11972-PoC
- https://github.com/RonF98/CVE-2024-11972-POC
