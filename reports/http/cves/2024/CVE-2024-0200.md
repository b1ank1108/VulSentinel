---
cve_id: CVE-2024-0200
template_path: nuclei-templates/http/cves/2024/CVE-2024-0200.yaml
affected_product: GitHub Enterprise Server
severity: critical
authentication: required
external_callback: true
affected_versions: all versions prior to 3.12 (fixed in 3.8.13, 3.9.8, 3.10.5, 3.11.3)
preconditions: organization owner role required
poc_classification: rce
---

## Vulnerability
Unsafe reflection vulnerability (CWE-470) in GitHub Enterprise Server enabling reflection injection and remote code execution. Authenticated attackers with organization owner privileges can trigger user-controlled method execution leading to full instance compromise, repository/data access, and arbitrary code execution on the self-hosted GHES server. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Remediation requires upgrade to one of the patched releases.

## PoC / Detection
Classification: rce

The template executes a full authenticated exploit chain to verify the RCE:
- Basic-auth API calls to list orgs and confirm `"role": "admin"` membership for the supplied credentials.
- Creates a test repository in the target org.
- Performs web login flow (CSRF token extraction + form POST) to establish session.
- Leaks `ENTERPRISE_SESSION_SECRET` via regex on the `/organizations/.../settings/actions` page.
- Builds padded/base64 Ruby Marshal gadget (`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy` â†’ `Aqueduct::Worker::Worker#kill_child`) embedding an `interactsh-url` DNS callback.
- Computes SHA1-HMAC signature with leaked secret and sets signed `_gh_render` cookie.
- Issues GET to `/` with malicious cookie; matches HTTP 500 + DNS interactsh callback to confirm successful RCE trigger.

## References
- https://starlabs.sg/blog/2024/04-sending-myself-github-com-environment-variables-and-ghes-shell/
- https://blog.convisoappsec.com/en/analysis-of-github-enterprise-vulnerabilities-cve-2024-0507-cve-2024-0200/
- https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.5
- https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.3
- https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.13
