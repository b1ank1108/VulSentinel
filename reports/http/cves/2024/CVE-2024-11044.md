---
cve_id: CVE-2024-11044
template_path: nuclei-templates/http/cves/2024/CVE-2024-11044.yaml
affected_product: Stable Diffusion Webui
severity: medium
authentication: none
external_callback: false
affected_versions: 1.10.0
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Stable Diffusion Webui 1.10.0 contains an open redirect vulnerability in the `/file=` endpoint. The `file` parameter accepts an arbitrary URL value, which is reflected unsanitized in the HTTP `Location` header, forcing the client browser to redirect to any attacker-chosen domain.  

Unauthenticated remote exploitation is possible with a single crafted URL.  

**Impact**  
Facilitates phishing campaigns and credential theft by luring victims to malicious sites that mimic legitimate interfaces.  

**Remediation**  
Update to any version newer than 1.10.0.

## PoC / Detection
Classification: detect-only  

The template executes a two-step flow:  
1. `GET {{BaseURL}}` with an internal DSL matcher confirming the presence of “stable-diffusion-webui”, “k-diffusion”, or the meta tag `content="stable diffusion"` to fingerprint the target.  
2. `GET {{BaseURL}}/file=https://oast.pro` followed by a regex matcher on the `Location` response header that succeeds only if the header value contains the injected external domain.  

This verifies the open-redirect condition through in-band header inspection; no payload execution, data exfiltration, or state change occurs.

## References
- https://huntr.com/bounties/ee942e5e-4987-4f81-ba83-014fec6b33b3
