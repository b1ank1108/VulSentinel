---
cve_id: CVE-2024-23917
template_path: nuclei-templates/http/cves/2024/CVE-2024-23917.yaml
affected_product: JetBrains TeamCity
severity: critical
authentication: none
external_callback: false
affected_versions: before 2023.11.3
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
In JetBrains TeamCity before 2023.11.3 an authentication bypass (CWE-306, CWE-288) permits unauthenticated remote attackers to create a valid Bearer token for the built-in administrator account (user ID 1) and obtain full administrative access, enabling potential remote code execution on the server.  
CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Unauthenticated attackers can bypass authentication to gain administrative access and potentially execute code on the TeamCity server.

## PoC / Detection
Classification: auth-bypass  
The template executes a two-request HTTP flow that directly exercises the bypass:  
1. POST to `{{BaseURL}}/app/rest/users/id:1/tokens/{{randstr}};.jsp?jsp_precompile=true` (no credentials, only `Content-Type: application/x-www-form-urlencoded`) creates a token for the admin user.  
2. The token value is extracted via regex from the XML response body.  
3. GET to `{{BaseURL}}/app/rest/server` with header `Authorization: Bearer {{authtoken}}` verifies privileged access by retrieving server project metadata.  
Matchers confirm success when both requests return HTTP 200, `application/xml` content-type, and expected XML fragments (`<token name=...>` and `<projects href=...>`).

## References
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://www.rapid7.com/db/vulnerabilities/jetbrains-teamcity-cve-2024-23917/
