---
cve_id: CVE-2024-0012
template_path: nuclei-templates/http/cves/2024/CVE-2024-0012.yaml
affected_product: PAN-OS Management Web Interface
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: network access to the management web interface
poc_classification: auth-bypass
---

## Vulnerability
An authentication bypass in Palo Alto Networks PAN-OS software enables an unauthenticated attacker with network access to the management web interface to gain PAN-OS administrator privileges to perform administrative actions, tamper with the configuration, or exploit other authenticated privilege escalation vulnerabilities.

Impact:  
Unauthenticated attackers with network access to the management interface can bypass authentication to gain full administrator privileges, allowing them to tamper with configurations, exploit additional vulnerabilities, and completely compromise the Palo Alto firewall and connected networks.

Remediation:  
Upgrade to the latest patched version of PAN-OS as specified in the vendor security advisory.

Classification:  
- CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
- CWE: CWE-306  
- CVE: CVE-2024-0012  
- EPSS: 0.94285 (99.936 percentile)

## PoC / Detection
Classification: auth-bypass  
The template sends a single raw GET request to `/php/ztp_gate.php/.js.map` with the header `X-PAN-AUTHCHECK: off`. Detection succeeds when the response meets all of the following: HTTP status 200, body contains `<title>Zero Touch Provisioning` (or `Zero Touch Provisioning (ZTP)`), body contains `/scripts/cache/mainui.javascript`, and `Set-Cookie` header includes `PHPSESSID=`.

## References
- https://security.paloaltonetworks.com/CVE-2024-0012
- https://labs.watchtowr.com/pots-and-pans-aka-an-sslvpn-palo-alto-pan-os-cve-2024-0012-and-cve-2024-9474/
- https://nvd.nist.gov/vuln/detail/CVE-2024-0012
