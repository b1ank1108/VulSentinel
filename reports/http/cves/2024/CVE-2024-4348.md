---
cve_id: CVE-2024-4348
template_path: nuclei-templates/http/cves/2024/CVE-2024-4348.yaml
affected_product: osCommerce
severity: medium
authentication: none
external_callback: false
affected_versions: 4.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
osCommerce 4.0 contains a reflected cross-site scripting vulnerability in an unknown function of `/catalog/all-products`. The `cat` parameter is unsanitized, enabling remote attackers to inject arbitrary JavaScript via a crafted URL. The flaw is exploitable without authentication and carries CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N (score 4.3). Attackers can inject malicious scripts via the `cat` parameter, potentially compromising user sessions.

## PoC / Detection
Classification: info-leak

The template issues two GET requests (stopping at first match) to `{{BaseURL}}/furniture/catalog/all-products` and `{{BaseURL}}/watch/catalog/all-products` appending `?cat=1&bhl4n%2522%253e%253cScRiPt%253ealert%2528'document_domain'%2529%253c%252fScRiPt%253eiyehb=1`. Detection succeeds if the response body simultaneously contains the unsanitized payload string `<ScRiPt>alert('document_domain')</ScRiPt>` and the phrase "Listing of all products on the site", the `Content-Type` header contains `text/html`, and the status code is 200.

## References
- https://packetstormsecurity.com/files/178375/osCommerce-4-Cross-Site-Scripting.html
- https://nvd.nist.gov/vuln/detail/CVE-2024-4348
- https://vuldb.com/?ctiid.262488
- https://vuldb.com/?id.262488
- https://vuldb.com/?submit.320855
