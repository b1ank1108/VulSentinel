---
cve_id: CVE-2024-39646
template_path: nuclei-templates/http/cves/2024/CVE-2024-39646.yaml
affected_product: WordPress Custom 404 Pro
severity: high
authentication: required
external_callback: false
affected_versions: <= 3.11.1
preconditions: [Custom 404 Pro plugin installed and activated]
poc_classification: info-leak
---

## Vulnerability
Reflected Cross-Site Scripting (XSS) vulnerability in WordPress Custom 404 Pro plugin <= 3.11.1 via the `c4pmessageType` parameter on `/wp-admin/admin.php?page=c4p-main`.

Improper Neutralization of Input During Web Page Generation allows reflected XSS. This issue affects Custom 404 Pro: from n/a through 3.11.1. CVSS 3.1 score 7.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L, CWE-79).

Impact: attackers can execute arbitrary scripts in victims' browsers (typically logged-in admins), leading to session hijacking, defacement, or redirection.

Remediation: update to version 3.11.2 or later.

## PoC / Detection
Classification: info-leak

The template first performs authentication by POSTing username/password to `/wp-login.php` and validating success via 302 redirect plus presence of `wordpress_logged_in_` cookie. It then issues a GET request to the plugin admin page injecting the payload `c4pmessageType=%22%20onmouseover%3Dalert(1)` and checks for exact unsanitized reflection of `" onmouseover=alert(1)` in the HTML body with `text/html` content-type.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/custom-404-pro/custom-404-pro-3111-reflected-cross-site-scripting
- https://plugins.trac.wordpress.org/changeset?old_path=/custom-404-pro/tags/3.11.1&new_path=/custom-404-pro/tags/3.11.2&sfp_email=&sfph_mail=
- https://patchstack.com/database/vulnerability/custom-404-pro/wordpress-custom-404-pro-plugin-3-11-1-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
