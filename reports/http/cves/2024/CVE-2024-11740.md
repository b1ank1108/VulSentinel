---
cve_id: CVE-2024-11740
template_path: nuclei-templates/http/cves/2024/CVE-2024-11740.yaml
affected_product: Download Manager
severity: high
authentication: none
external_callback: false
affected_versions: <= 3.3.03
preconditions: []
poc_classification: rce
---

## Vulnerability
The Download Manager plugin for WordPress (<= 3.3.03) suffers from unauthenticated arbitrary shortcode execution. The flaw is in the handling of the `__wpdmxp` parameter (and related action) which fails to validate input before invoking `do_shortcode()`. Unauthenticated attackers can thus execute arbitrary registered shortcodes, leading to information disclosure or unauthorized actions (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L score 7.3, CWE-94).

## PoC / Detection
Classification: rce

The detection template issues a single unauthenticated GET request to `/?__wpdmxp=%27][/wpdm_package][wpdm_all_packages][wpdm_package%20id=%27`, injecting the `wpdm_all_packages` shortcode. It confirms the vulnerability by matching on body content containing `"wpdm-all-packages"` and `wpdm-download-link download-on-click` while ensuring "No Packages Found" is absent.

## References
- https://github.com/advisories/GHSA-cq39-wq4r-hjrj
- https://plugins.trac.wordpress.org/browser/download-manager/tags/3.3.02/src/Package/Hooks.php#L42
- https://plugins.trac.wordpress.org/browser/download-manager/tags/3.3.02/src/Package/views/shortcode-iframe.php#L203
- https://www.wordfence.com/threat-intel/vulnerabilities/id/4a7be578-5883-4cd3-963d-bf81c3af2003?source=cve
