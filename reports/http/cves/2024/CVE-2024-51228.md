---
cve_id: CVE-2024-51228
template_path: nuclei-templates/http/cves/2024/CVE-2024-51228.yaml
affected_product: TOTOLINK CX-A3002RU
severity: medium
authentication: none
external_callback: false
affected_versions: TOTOLINK-CX-A3002RU V1.0.4-B20171106.1512, TOTOLINK-CX-N150RT V2.1.6-B20171121.1002, TOTOLINK-CX-N300RT V2.1.6-B20170724.1420, TOTOLINK-CX-N300RT V2.1.8-B20171113.1408, TOTOLINK-CX-N300RT V2.1.8-B20191010.1107, TOTOLINK-CX-N302RE V2.0.2-B20170511.1523
preconditions: []
poc_classification: rce
---

## Vulnerability
TOTOLINK CX-A3002RU (and variants) is affected by an OS command injection vulnerability (CWE-78) in the `/boafrm/formSysCmd` component. An issue in the listed firmware versions allows a remote attacker to execute arbitrary code via the `sysCmd` parameter.

**Impact:** Attackers can exploit this vulnerability to compromise system security and integrity.

**CVSS v3.1:** 6.8 (Medium) â€” AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

**Remediation:** Apply the latest security patches and updates.

## PoC / Detection
Classification: rce

The template sends a single POST request to `/boafrm/formSysCmd` containing `sysCmd=sleep%206` (application/x-www-form-urlencoded). Vulnerability is confirmed via DSL matchers if all three conditions hold: response duration >= 6 seconds (time-based command execution), Server header contains "Boa/0.94", and status_code == 302. This verifies blind command injection that can be escalated to full arbitrary command execution.

## References
- https://github.com/yckuo-sdc/totolink-boa-api-vulnerabilities
- https://totolink.tw/support_view/A3002RU
- https://totolink.tw/support_view/N150RT
- https://www.totolink.tw/products_view/N300RT
