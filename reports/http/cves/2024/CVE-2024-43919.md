---
cve_id: CVE-2024-43919
template_path: nuclei-templates/http/cves/2024/CVE-2024-43919.yaml
affected_product: YARPP
severity: critical
authentication: none
external_callback: false
affected_versions: all versions up to, and including, 5.30.10
preconditions: []
poc_classification: state-change
---

## Vulnerability
YARPP (Yet Another Related Posts Plugin) for WordPress is vulnerable to missing authorization (CWE-862) due to a missing capability check in `includes/yarpp_pro_set_display_types.php`. All versions up to and including 5.30.10 allow unauthenticated attackers to set display types, resulting in unauthorized plugin configuration changes.

**Impact:** Unauthenticated attackers can modify display types without proper authorization.  
**CVSS v3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Remediation:** Update to a version later than 5.30.10.

## PoC / Detection
Classification: state-change

The template first issues an internal GET to `/` and matches `"/plugins/yet-another-related-posts-plugin/"` in the response body to fingerprint the installed YARPP plugin on WordPress. It then sends the exploitation GET request `GET /wp-content/plugins/yet-another-related-posts-plugin/includes/yarpp_pro_set_display_types.php?ypsdt=false&types[]=post&types[]=page`. Success (vulnerability confirmed) is determined by the combined matcher: status_code == 200 && content_type contains "text/plain" && len(body) == 2 && body contains "ok". The request itself performs the unauthorized modification of display types.

## References
- https://github.com/RandomRobbieBF/CVE-2024-43919
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/yet-another-related-posts-plugin/yarpp-53010-missing-authorization
- https://patchstack.com/database/vulnerability/yet-another-related-posts-plugin/wordpress-yet-another-related-posts-plugin-yarpp-plugin-5-30-10-broken-access-control-vulnerability?_s_id=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-43919
