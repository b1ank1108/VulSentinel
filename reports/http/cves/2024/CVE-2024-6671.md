---
cve_id: CVE-2024-6671
template_path: nuclei-templates/http/cves/2024/CVE-2024-6671.yaml
affected_product: WhatsUp Gold
severity: critical
authentication: none
external_callback: false
affected_versions: versions released before 2024.0.0
preconditions: configured with only a single user
poc_classification: auth-bypass
---

## Vulnerability
In WhatsUp Gold versions released before 2024.0.0, when configured with only a single user, a SQL injection vulnerability in the DeviceStatisticalMonitors endpoint allows an unauthenticated attacker to retrieve encrypted user passwords, modify admin credentials, and achieve authentication bypass for full system access.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8) | CWE-89

## PoC / Detection
Classification: auth-bypass

The template actively exploits the SQL injection through a 5-step HTTP flow with client-side processing to verify full authentication bypass:  
- POST /NmConsole/WugSystemAppSettings/JMXSecurity sets keystore/truststore passwords to a random value and establishes session.  
- POST /NmConsole/Platform/Filter/DeviceStatisticalMonitors injects SQL to UPDATE ProActiveAlert, prefixing the GlobalSettings JavaKeyStorePwd value with 'psyduck'.  
- GET /NmConsole/Platform/Filter/AlertCenterItemsReportThresholds leaks the prefixed encrypted password via regex extraction.  
- Second POST /NmConsole/Platform/Filter/DeviceStatisticalMonitors injects SQL to UPDATE WebUser SET sPassword for the 'admin' account to the extracted value.  
- POST /NmConsole/User/LoginAjax logs in as admin with the known random password and confirms `"authenticated":true` and username match.

## References
- https://www.zerodayinitiative.com/advisories/ZDI-24-1186/
- https://community.progress.com/s/article/WhatsUp-Gold-Security-Bulletin-August-2024
- https://www.progress.com/network-monitoring
