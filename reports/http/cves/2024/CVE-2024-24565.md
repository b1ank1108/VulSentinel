---
cve_id: CVE-2024-24565
template_path: nuclei-templates/http/cves/2024/CVE-2024-24565.yaml
affected_product: CrateDB Database
severity: medium
authentication: required
external_callback: false
affected_versions: unknown
preconditions: authenticated SQL access
poc_classification: info-leak
---

## Vulnerability
CrateDB Database (distributed SQL database for real-time storage and analysis of massive data volumes) contains a flaw in the COPY FROM function used to import file data into tables. Authenticated attackers can import arbitrary local file content into database tables, resulting in information leakage of sensitive server files (including configuration files and system files such as /etc/passwd).

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (score 6.5) | CWE-22 (Path Traversal) | CPE: cpe:2.3:a:cratedb:cratedb:*:*:*:*:*:*:*:*

Impact: High confidentiality exposure. Remediation: Update CrateDB to a version addressing CVE-2024-24565.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing three sequential raw POST requests to the `/_sql?types` endpoint (using a randomly generated lowercase alphanumeric table name):

- CREATE TABLE `<random>`(info_leak STRING)
- COPY `<random>` FROM '/etc/passwd' with (format='csv', header=false)
- SELECT * FROM `<random>` limit 100

Matchers confirm success via regex('root:.*:0:0:', body_3), JSON content-type in all responses, and status_code 200 for every request. The sequence is intrusive (creates a persistent table in the target database).

## References
(No references listed in the template)
