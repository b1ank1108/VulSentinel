---
cve_id: CVE-2024-22927
template_path: nuclei-templates/http/cves/2024/CVE-2024-22927.yaml
affected_product: eyoucms
severity: medium
authentication: none
external_callback: false
affected_versions: 1.6.5
preconditions: []
poc_classification: rce
---

## Vulnerability
eyoucms v.1.6.5 contains a reflected Cross-Site Scripting (XSS) flaw in the `func` parameter inside the `info` JSON payload processed by the `/login.php?a=get_upload_list&c=Uploadimgnew` endpoint.  
A remote unauthenticated attacker supplies a crafted URL embedding an unsanitized `<ScRiPt>` payload, causing arbitrary JavaScript execution in the victim's browser context (UI interaction required).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1). CWE-79. CPE: cpe:2.3:a:eyoucms:eyoucms:1.6.5:*:*:*:*:*:*:*.  
Impact: malicious script execution on victim browser. Fixed by upgrading to 1.6.6 or later.

## PoC / Detection
Classification: rce  
The template issues one unauthenticated POST request to `{{BaseURL}}/login.php?a=get_upload_list&c=Uploadimgnew&info=eyJudW0iOiIxXCI%2BPFNjUmlQdCA%2BYWxlcnQoZG9jdW1lbnQuZG9tYWluKTwvU2NSaVB0PiIsInNpemUiOiIyMDk3MTUyIiwiaW5wdXQiOiIiLCJmdW5jIjoiaGVhZF9waWNfY2FsbF9iYWNrIiwicGF0aCI6ImFsbGltZyIsImlzX3dhdGVyIjoiMSIsImFsZyI6IkhTMjU2In0&lang=cn&m=admin&unneed_syn=`, injecting the XSS payload inside the encoded JSON "num" value.  
Matchers confirm reflection if the body simultaneously contains the exact strings `name="num" value="1"><ScRiPt >alert(document.domain)</ScRiPt>` and `id="eytime"`, the `Content-Type` header includes `text/html`, and status is 200.

## References
- https://github.com/weng-xianhu/eyoucms/issues/57
- https://nvd.nist.gov/vuln/detail/CVE-2024-22927
