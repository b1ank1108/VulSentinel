---
cve_id: CVE-2024-3469
template_path: nuclei-templates/http/cves/2024/CVE-2024-3469.yaml
affected_product: GP Premium
severity: medium
authentication: required
external_callback: false
affected_versions: <= 2.4.0
preconditions: [GP Premium plugin installed and activated on a WordPress site]
poc_classification: state-change
---

## Vulnerability
The GP Premium plugin for WordPress up to version 2.4.0 is vulnerable to reflected Cross-Site Scripting (XSS) via the `message` parameter in `inc/verify.php` (lines 95-101) when `sl_activation=false`. The parameter is URL-decoded and passed unsanitized to `add_settings_error()`, which renders it directly in admin notices.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Successful exploitation enables JavaScript execution in an authenticated administrator's browser context, allowing session hijacking via cookie theft, creation of rogue administrative accounts, actions performed on behalf of the victim, and website defacement.

## PoC / Detection
Classification: state-change

The template first authenticates by POSTing `log={{username}}&pwd={{password}}` to `/wp-login.php`. It then issues a GET to `/wp-admin/admin.php?page=generate-options&sl_activation=false&message=<script>alert(document.domain)</script>`. The matcher confirms exploitation by checking status_code == 200, HTML content-type, and the presence of both the raw `<script>alert(document.domain)</script>` payload and the string "setting-error-license_failed" in the response body, proving lack of output sanitization.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/gp-premium/gp-premium-240-reflected-cross-site-scripting
- https://nvd.nist.gov/vuln/detail/CVE-2024-3469
