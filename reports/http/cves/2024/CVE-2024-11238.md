---
cve_id: CVE-2024-11238
template_path: nuclei-templates/http/cves/2024/CVE-2024-11238.yaml
affected_product: Landray EKP
severity: medium
authentication: none
external_callback: false
affected_versions: up to 16.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Landray EKP up to version 16.0 is affected by a path traversal vulnerability (CVE-2024-11238, CWE-22) in the `delPreviewFile` function of `/sys/ui/sys_ui_component/sysUiComponent.do?method=delPreviewFile`. Manipulation of the `directoryPath` parameter allows remote unauthenticated attackers to delete arbitrary files. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L (6.5). Public exploit disclosed; vendor did not respond.

## PoC / Detection
Classification: state-change

The template performs a multi-step verification that actually deletes a known file to confirm the path traversal:

1. GET `/login.jsp` extracts the dynamic favicon resource path via regex from the HTML body (internal).
2. GET `/resource/{{faviconPath}}/favicon.ico` confirms the file exists (status 200, internal).
3. GET `/sys/ui/sys_ui_component/sysUiComponent.do?method=delPreviewFile&directoryPath=../{{faviconPath}}/` triggers deletion via traversal (status 200 and Content-Length: 0, internal).
4. Re-GET the favicon URL confirms deletion (status 404).

Marked `intrusive` and `lfi` due to destructive side effects on the target.

## References
- https://github.com/CoinIsMoney/TempGuide/blob/main/LL-exp-02.pdf
- https://nvd.nist.gov/vuln/detail/CVE-2024-11238
- https://vuldb.com/?ctiid.284673
