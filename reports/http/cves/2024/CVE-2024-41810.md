---
cve_id: CVE-2024-41810
template_path: nuclei-templates/http/cves/2024/CVE-2024-41810.yaml
affected_product: Twisted
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 24.7.0rc1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Twisted is an event-based framework for internet applications supporting Python 3.6+. The web framework's `redirectTo` function fails to sanitize user-controlled redirect URLs, resulting in open redirect and reflected XSS via the URL parameter. Fixed in 24.7.0rc1.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1).  
Impact: attackers controlling a redirect URL can force malicious redirects or inject executable JavaScript in the victim site's context.

## PoC / Detection
Classification: info-leak

The template first issues `GET /` (redirects enabled) and internally matches for Twisted fingerprints ("TWISTED_SESSION" or '["Twisted' in response body). It then issues `GET {{BaseURL}}?url=ws://example.com/"><script>alert(document.domain)</script>` (redirects enabled) and matches on 302 status, `Location` header exactly reflecting the unsanitized payload (including `<script>` tag), and `text/html` content-type. This confirms unsafe reflection enabling open redirect and reflected XSS.

## References
- https://github.com/advisories/GHSA-cf56-g6w6-pqq2
- https://nvd.nist.gov/vuln/detail/CVE-2024-41810
