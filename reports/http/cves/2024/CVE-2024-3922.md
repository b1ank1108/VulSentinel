---
cve_id: CVE-2024-3922
template_path: nuclei-templates/http/cves/2024/CVE-2024-3922.yaml
affected_product: Dokan Pro
severity: critical
authentication: none
external_callback: false
affected_versions: all versions up to, and including, 3.10.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Dokan Pro WordPress plugin (vendor: wedevs) is vulnerable to SQL injection via the `code` parameter (used in the `subscription_code` field of the `dokan-moip` webhook) due to insufficient escaping of user-supplied input and lack of proper SQL query preparation. Unauthenticated attackers can append arbitrary SQL queries to existing statements, enabling extraction of sensitive information from the database. Fixed in 3.11.0. EPS S-score: 0.88503 (99.486th percentile). CPE: cpe:2.3:a:wedevs:dokan:*:*:*:*:wordpress:*:*:*.

## PoC / Detection
Classification: info-leak

The template first internally fingerprints the plugin by issuing `GET /wp-content/plugins/dokan-pro/changelog.txt` and matching the word "Dokan product". It then sends a time-based blind SQL injection probe via `POST /wp-admin/admin.php?webhook=dokan-moip` containing the JSON payload `{"env":"1","event":"invoice.created","resource":{"subscription_code":"11111' and (select 1 from (select sleep( if(1=1,6,0) ))x )='"}` (with 20s timeout). Detection succeeds if response duration is >=6 seconds AND status code is 302.

## References
- https://dokan.co/docs/wordpress/changelog/
- https://nvd.nist.gov/vuln/detail/CVE-2024-3922
