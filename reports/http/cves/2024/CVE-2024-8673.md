---
cve_id: CVE-2024-8673
template_path: nuclei-templates/http/cves/2024/CVE-2024-8673.yaml
affected_product: Z-Downloads
severity: low
authentication: required
external_callback: false
affected_versions: < 1.11.7
preconditions: WordPress site with Z-Downloads plugin installed and activated; authenticated user with file upload permissions in plugin admin
poc_classification: info-leak
---

## Vulnerability
Z-Downloads WordPress plugin < 1.11.7 does not properly validate uploaded files, permitting SVGs that embed malicious JavaScript. Authenticated attackers can upload such SVGs; the JavaScript executes automatically when other users view the files (e.g., in the admin interface), enabling session hijacking and data theft. Fixed in 1.11.7. CVE-2024-8673, CVSS 3.5, CWE-79.

## PoC / Detection
Classification: info-leak

The template first authenticates to `/wp-login.php` with supplied credentials, extracts the upload nonce from the `z-downloads-add-file` admin page, then POSTs a multipart form containing an SVG file (`xss.svg`) that embeds `<script type="text/javascript">alert(document.domain);</script>` to `/wp-admin/admin.php?page=z-downloads-files`. It subsequently GETs the files listing page, regex-extracts the stored URL of the SVG (`/wp-content/uploads/z-downloads-[hash]/files/[hash]/xss.svg`), fetches that URL, and asserts the response is HTTP 200 with `image/svg+xml` content-type and the exact unsanitized script payload present in the body.

## References
- https://wpscan.com/vulnerability/fed2cd26-7ccb-419d-b589-978410953bf4/
