---
cve_id: CVE-2024-3273
template_path: nuclei-templates/http/cves/2024/CVE-2024-3273.yaml
affected_product: D-Link Network Attached Storage
severity: critical
authentication: none
external_callback: false
affected_versions: D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to 20240403
preconditions: []
poc_classification: rce
---

## Vulnerability
Critical command injection (CWE-77) in the HTTP GET Request Handler at `/cgi-bin/nas_sharing.cgi` of D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L Network Attached Storage devices. The `system` parameter can be manipulated to execute arbitrary OS commands after supplying the hardcoded backdoor account (`user=mydlinkBRionyg`, `passwd=YWJjMTIzNDVjYmE`). CVSSv3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Public exploit available; devices are end-of-life with no patches forthcoming. Vendor confirms products should be retired and replaced.

## PoC / Detection
Classification: rce

The template actively exploits the flaw by issuing a single GET request to `{{BaseURL}}/cgi-bin/nas_sharing.cgi?user=mydlinkBRionyg&passwd=YWJjMTIzNDVjYmE&cmd=15&system={{base64("id")}}`. Detection succeeds only if the response satisfies all three matchers: HTTP 200 status, `<auth_state>1</auth_state>` present in body, and regex match confirming `uid=… gid=…` output from the injected `id` command.

## References
- https://github.com/netsecfish/dlink
- https://www.bleepingcomputer.com/news/security/over-92-000-exposed-d-link-nas-devices-have-a-backdoor-account/#google_vignette
- https://news.ycombinator.com/item?id=39960107
- https://supportannouncement.us.dlink.com/security/publication.aspx?name=SAP10383
- https://vuldb.com/?ctiid.259284
