---
cve_id: CVE-2024-8856
template_path: nuclei-templates/http/cves/2024/CVE-2024-8856.yaml
affected_product: WP Time Capsule Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: all versions up to, and including, 1.22.21
preconditions: []
poc_classification: rce
---

## Vulnerability
The Backup and Staging by WP Time Capsule plugin for WordPress is vulnerable to arbitrary file uploads in `wp-tcapsule-bridge/upload/php/UploadHandler.php` due to missing file type validation and no direct file access prevention. Unauthenticated attackers can upload arbitrary PHP files to the server, enabling remote code execution and complete WordPress site compromise (CVSS 9.8: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, CWE-434).

## PoC / Detection
Classification: rce

The template verifies the flaw with a two-request flow: (1) POST multipart/form-data to `/wp-content/plugins/wp-time-capsule/wp-tcapsule-bridge/upload/php/index.php` containing a random `.php` file whose body is PHP code echoing a random marker string, then matches the upload response body for `url":"`, `"files":`, and `"deleteType":`; (2) GETs the uploaded file at `/wp-content/plugins/wp-time-capsule/wp-tcapsule-bridge/upload/php/files/{{randbase(2)}}.php` and confirms the marker appears in the response body, proving arbitrary PHP execution.

## References
- https://hacked.be/posts/CVE-2024-8856
- https://plugins.trac.wordpress.org/browser/wp-time-capsule/trunk/wp-tcapsule-bridge/upload/php/UploadHandler.php
- https://plugins.trac.wordpress.org/changeset/3188325/
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3153289%40wp-time-capsule&new=3153289%40wp-time-capsule&sfp_email=&sfph_mail=
- https://www.wordfence.com/threat-intel/vulnerabilities/id/fdc2de78-5601-461f-b2f0-c80b592ccb1b?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-8856
