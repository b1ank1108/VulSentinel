---
cve_id: CVE-2024-5827
template_path: nuclei-templates/http/cves/2024/CVE-2024-5827.yaml
affected_product: Vanna
severity: critical
authentication: none
external_callback: false
affected_versions: <=0.3.4
preconditions: DuckDB integration
poc_classification: rce
---

## Vulnerability
Vanna v0.3.4 is vulnerable to SQL injection in its DuckDB integration exposed to its Flask Web APIs. Unauthenticated attackers can inject malicious SQL training data and generate corresponding queries to write arbitrary files on the victim's file system (e.g. backdoor.php containing `<?php system($_GET[0]); ?>`). This leads to remote code execution or backdoor creation.

## PoC / Detection
Classification: rce

The template detects the flaw via a two-request flow that triggers the SQL injection in a read-only manner (harmless probe confirming the underlying arbitrary-file-write capability):
- POST /api/v0/train injects `{"sql":"SELECT pg_read_file('/etc/passwd', 0, 1000);"}` (internal matcher confirms 'id":' acceptance).
- GET /api/v0/generate_sql?question=What%20is%20the%20content%20of%20the%20first%201000%20characters%20of%20the%20%2Fetc%2Fpasswd%20file? follows up.
Matchers require regex "root:.*:0:0:" in JSON body, HTTP 200, and application/json header.

## References
- https://huntr.com/bounties/a3f913d6-c717-4528-b974-26d8d9e839ca
- https://nvd.nist.gov/vuln/detail/CVE-2024-5827
- https://huntr.com/bounties/e4e64a51-618b-41d0-8f56-1d2146d8825e
- https://github.com/fkie-cad/nvd-json-data-feeds
