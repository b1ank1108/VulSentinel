---
cve_id: CVE-2024-1071
template_path: nuclei-templates/http/cves/2024/CVE-2024-1071.yaml
affected_product: WordPress Ultimate Member plugin
severity: critical
authentication: none
external_callback: false
affected_versions: 2.1.3 to 2.8.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Ultimate Member - User Profile, Registration, Login, Member Directory, Content Restriction & Membership Plugin for WordPress is vulnerable to time-based blind SQL Injection via the `sorting` parameter in the member directory. Versions 2.1.3 to 2.8.2 fail to properly escape user-supplied input and prepare the SQL query, allowing unauthenticated attackers to inject additional queries. This can be exploited to extract the entire WordPress database, including user credentials and member profiles (CVSS 9.8 / CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, CWE-89).

## PoC / Detection
Classification: info-leak

The template detects the vulnerability through a two-request sequence. It first issues a GET request to `/?p=1` to extract a nonce value via regex from the response body. It then sends a POST request to `/wp-admin/admin-ajax.php?action=um_get_members` with the payload `directory_id=b9238&sorting=user_login,SLEEP(5)&nonce=...`. Vulnerability is confirmed if the second response takes >=5 seconds (indicating SLEEP execution) while returning expected member directory data (`current_page` and `total_pages`).

## References
- https://www.wordfence.com/blog/2024/02/2063-bounty-awarded-for-unauthenticated-sql-injection-vulnerability-patched-in-ultimate-member-wordpress-plugin/
- https://securityonline.info/cve-2024-1071-wordpress-ultimate-member-plugin-under-active-attack/
- https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076
- https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L666
- https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L858
