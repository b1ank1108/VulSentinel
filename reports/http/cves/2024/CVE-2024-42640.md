---
cve_id: CVE-2024-42640
template_path: nuclei-templates/http/cves/2024/CVE-2024-42640.yaml
affected_product: Angular-Base64-Upload
severity: critical
authentication: none
external_callback: false
affected_versions: prior to v0.1.21
preconditions: demo/server.php publicly accessible via node_modules/angular-base64-upload or bower_components
poc_classification: rce
---

## Vulnerability
Angular-Base64-Upload prior to v0.1.21 is vulnerable to unauthenticated remote code execution via the demo/server.php endpoint. An attacker can upload arbitrary content (including PHP files) which is saved to demo/uploads and becomes executable by the web server. This leads to full server code execution. The vulnerability only affects products no longer supported by the maintainer.

## PoC / Detection
Classification: rce

The template performs a two-stage detection:  
- Issues POST requests with JSON `{"base64": "{{base64(random_int)}}", "filename": "{{random}}.php"}` to `/node_modules/angular-base64-upload/demo/server.php` and `/bower_components/angular-base64-upload/demo/server.php`.  
- Parses the response for the upload path string and HTTP 200 status to confirm acceptance.  
- Follows with GET requests to the resulting `/uploads/{{random}}.php` path and verifies the original random integer appears in the body (status 200).  

This confirms arbitrary PHP file upload and retrieval, proving the RCE vector.

## References
- https://github.com/rvizx/CVE-2024-42640
- https://www.zyenra.com/blog/unauthenticated-rce-in-angular-base64-upload.html
- https://github.com/adonespitogo/angular-base64-upload
- https://nvd.nist.gov/vuln/detail/CVE-2024-42640
