---
cve_id: CVE-2024-12209
template_path: nuclei-templates/http/cves/2024/CVE-2024-12209.yaml
affected_product: WP Umbrella Update Backup Restore & Monitoring plugin
severity: critical
authentication: none
external_callback: false
affected_versions: all versions up to and including 2.17.0
preconditions: WP Umbrella plugin installed on WordPress
poc_classification: info-leak
---

## Vulnerability
The WP Umbrella: Update Backup Restore & Monitoring plugin for WordPress is vulnerable to Local File Inclusion (CWE-98) in all versions up to, and including, 2.17.0 via the `filename` parameter of the `umbrella-restore` action. This makes it possible for unauthenticated attackers to include and execute arbitrary files on the server, allowing the execution of any PHP code in those files. This can be used to bypass access controls, obtain sensitive data, or achieve code execution in cases where images and other “safe” file types can be uploaded and included.

**Impact:** Unauthenticated attackers can exploit local file inclusion through the filename parameter in the umbrella-restore action to read arbitrary server files including /etc/passwd, execute PHP code, and gain complete server compromise.

**CVSS v3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**Remediation:** Validate and sanitize user inputs to prevent directory traversal. Use a whitelist approach for file paths and restrict file access to intended directories only.

## PoC / Detection
Classification: info-leak

The template first sends `GET /` and matches `/wp-content/plugins/wp-health` in the response body (internal plugin fingerprint). It then sends `GET /?umbrella-restore=1&filename=../../../../../../etc/passwd` and verifies the LFI by checking that the body matches the regex `root:.*:0:0:`, the status code is 200, and the content-type contains `text/html`.

## References
- https://github.com/RandomRobbieBF/CVE-2024-12209
- https://plugins.trac.wordpress.org/browser/wp-health/tags/v2.16.4/src/Actions/RestoreRouter.php#L45
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3202883%40wp-health&new=3202883%40wp-health&sfp_email=&sfph_mail=
- https://www.wordfence.com/threat-intel/vulnerabilities/id/c74ce3e8-cab9-4cc6-a1ad-1e51f7268474?source=cve
