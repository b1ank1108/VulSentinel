---
cve_id: CVE-2024-6928
template_path: nuclei-templates/http/cves/2024/CVE-2024-6928.yaml
affected_product: Opti Marketing
severity: high
authentication: none
external_callback: false
affected_versions: <= 2.0.9
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Opti Marketing plugin for WordPress (<= 2.0.9) is vulnerable to SQL injection due to insufficient escaping on the user-supplied `postId` parameter and lack of sufficient preparation on the existing SQL query in the `save_article` AJAX action. Unauthenticated attackers can append additional SQL queries to extract sensitive information from the database (with potential for modification or deletion, enabling full compromise of the WordPress installation).

## PoC / Detection
Classification: info-leak

The template first issues GET / and internally matches for the string `/wp-content/plugins/opti-marketing` in the response body to confirm plugin presence. It then sends POST /wp-admin/admin-ajax.php containing `action=save_article&postId=(select*from(select(sleep(6)))a)` and confirms the time-based blind SQL injection if response duration >=6s and status_code == 200.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/opti-marketing/opti-marketing-209-unauthenticated-sql-injection
- https://wpscan.com/vulnerability/7bb9474f-2b9d-4856-b36d-a43da3db0245/
- https://nvd.nist.gov/vuln/detail/cve-2024-6928
