---
cve_id: CVE-2024-37393
template_path: nuclei-templates/http/cves/2024/CVE-2024-37393.yaml
affected_product: SecurEnvoy Two Factor Authentication
severity: critical
authentication: none
external_callback: false
affected_versions: before 9.4.514
preconditions: [DESKTOP service exposed on /secserver HTTP endpoint]
poc_classification: info-leak
---

## Vulnerability
SecurEnvoy Two Factor Authentication (MFA) before 9.4.514 contains multiple LDAP injection vulnerabilities caused by improper validation of user-supplied input. An unauthenticated remote attacker can perform blind LDAP injection attacks against the DESKTOP service on the /secserver HTTP endpoint to exfiltrate data from connected Active Directory environments, including the ms-Mcs-AdmPwd attribute that stores cleartext LAPS administrator passwords.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by sending two raw POST requests to `/secserver/?` (FLAG=DESKTOP, STATUS=INIT, MEMBEROF=Domain Users). The first request uses a randomized USERID value followed by LDAP injection payload `)(sAMAccountName=*`; the second uses `*)(sAMAccountName=*`. Detection succeeds when the first response body contains "Error checking Group" (status 200) and the second contains "GETPASSCODE" (status 200), confirming differential behavior indicative of successful blind LDAP injection.

## References
- https://www.tenable.com/cve/CVE-2024-37393
- https://www.optistream.io/blogs/tech/securenvoy-cve-2024-37393
- https://securenvoy.com
