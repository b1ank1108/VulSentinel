---
cve_id: CVE-2024-57049
template_path: nuclei-templates/http/cves/2024/CVE-2024-57049.yaml
affected_product: TP-Link Archer C20
severity: critical
authentication: none
external_callback: false
affected_versions: V6.6_230412 and earlier
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
A vulnerability in the TP-Link Archer C20 router with firmware version V6.6_230412 and earlier permits unauthorized individuals to bypass authentication on interfaces under the /cgi directory. Adding a Referer header with value "http://tplinkwifi.net" to requests causes the router to recognize the request as passing authentication.

CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | CWE-287

Impact: Unauthenticated attackers gain access to protected administration interfaces and router configuration.

Remediation: Update to firmware version later than V6.6_230412.

## PoC / Detection
Classification: auth-bypass

The template sends a POST request to `/cgi/getGDPRParm` including the Referer header `http://tplinkwifi.net`. It verifies the bypass by matching on HTTP status 200, Content-Type `application/javascript`, and body containing both `$.ret=0;` and `var `.

## References
- https://github.com/Shuanunio/CVE_Requests/blob/main/TP-Link/archer%20c20/ACL%20bypass%20Vulnerability%20in%20TP-Link%20archer%20c20.md
- https://nvd.nist.gov/vuln/detail/CVE-2024-57049
- https://github.com/advisories/GHSA-qr32-fcm4-m5h9
