---
cve_id: CVE-2024-6095
template_path: nuclei-templates/http/cves/2024/CVE-2024-6095.yaml
affected_product: LocalAI
severity: medium
authentication: none
external_callback: false
affected_versions: 2.15.0 (fixed in 2.17)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
LocalAI (mudler/localai) is affected by a Server-Side Request Forgery (SSRF) and partial Local File Inclusion (LFI) vulnerability in the `/models/apply` endpoint. The endpoint accepts both `http(s)://` and `file://` schemes; the latter enables LFI, but output is truncated by error-message length limits. Exploitation requires only network access to the LocalAI instance and can expose internal HTTP(S) services or partial local file contents (e.g., `/etc/passwd`). Fixed in version 2.17. CVSS 3.1: 5.8 (AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N). CWE-918.

## PoC / Detection
Classification: info-leak

The template performs a two-step detection: a POST to `/models/apply` with JSON `{"url":"file:///etc/passwd"}` to queue the job (UUID extracted from JSON response), followed by a GET to `/models/jobs/{{uuid}}`. It matches on HTTP 200, `application/json` content-type, and an unmarshal error string containing partial `/etc/passwd` content (`root:x:...`).

## References
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/sev-hack/sev-hack
- https://nvd.nist.gov/vuln/detail/CVE-2024-6095
