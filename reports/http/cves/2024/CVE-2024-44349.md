---
cve_id: CVE-2024-44349
template_path: nuclei-templates/http/cves/2024/CVE-2024-44349.yaml
affected_product: AnteeoWMS
severity: critical
authentication: none
external_callback: false
affected_versions: < v4.7.34
preconditions: []
poc_classification: info-leak
---

## Vulnerability
AnteeoWMS before v4.7.34 contains an unauthenticated SQL injection vulnerability in its login portal (`/default.aspx`). Attackers can inject arbitrary SQL via the username parameter in an ASPxCallbackPanel POST request, allowing execution of SQL commands on the backend Microsoft SQL Server database and disclosure of sensitive data (CWE-89, CVSS 9.8 AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: info-leak

The template first GETs `/default.aspx` to extract required ASP.NET ViewState, ViewStateGenerator, and EventValidation tokens via regex. It then sends a POST request injecting the payload `aa'union select cast(@@version as int),null,null-- -` into the `UsrAuthLogin` field. Detection succeeds if the response body contains the error string "Conversion failed when converting the nvarchar value &#39;Microsoft SQL Server", confirming error-based SQLi and database version disclosure.

## References
- https://blog.cybergon.com/posts/cve-2024-44349/
- http://nvd.nist.gov/vuln/detail/CVE-2024-44349
