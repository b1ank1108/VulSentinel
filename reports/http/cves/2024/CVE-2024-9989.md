---
cve_id: CVE-2024-9989
template_path: nuclei-templates/http/cves/2024/CVE-2024-9989.yaml
affected_product: Crypto
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.15
preconditions: [Knowledge of a valid username on the site]
poc_classification: auth-bypass
---

## Vulnerability
The Crypto plugin for WordPress is vulnerable to authentication bypass in versions up to and including 2.15. This stems from insufficient restrictions on arbitrary method calls to `crypto_connect_ajax_process::log_in` within the `crypto_connect_ajax_process` function (CWE-288). Unauthenticated attackers who know an existing username (such as 'admin') can log in as that user, including administrators, leading to full site takeover.

**Impact:** Unauthenticated attackers can bypass authentication to log in as any existing user including administrators if they know the username, gaining complete control of the WordPress site and all its data.

**CVSS:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: auth-bypass

The template detects the vulnerability by:
1. Sending a GET request to `/` and matching for the string `/wp-content/plugins/crypto` in the response body (to confirm plugin presence).
2. Issuing a GET request to `/wp-admin/admin-ajax.php?action=crypto_connect_ajax_process&method_name=register&param1=admin` to trigger the vulnerable code path with the target username.
3. Verifying success if the response contains a `wordpress_sec_` or `wordpress_logged_in_` cookie in the `Set-Cookie` header (OR), the body contains "error" AND "false" AND "success", and the status code is 200.

## References
- https://github.com/wy876/POC/blob/main/WordPress/WordPress%E6%8F%92%E4%BB%B6Crypto%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0(CVE-2024-9989).md
- https://mp.weixin.qq.com/s/hC8A1DeS-LWGpNIFKeiMBQ
- https://www.wordfence.com/threat-intel/vulnerabilities/id/e21bd924-1d96-4371-972a-5c99d67261cc?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-9989
- https://github.com/advisories/GHSA-hmfh-w3mx-w6j4
