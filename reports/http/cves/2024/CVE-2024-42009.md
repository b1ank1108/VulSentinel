---
cve_id: CVE-2024-42009
template_path: nuclei-templates/http/cves/2024/CVE-2024-42009.yaml
affected_product: Roundcube Webmail
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.5.7 || (>=1.6.0 && <=1.6.7)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Roundcube Webmail suffers from CVE-2024-42009, a Cross-Site Scripting (CWE-79) flaw due to a desanitization issue in `message_body()` (`program/actions/mail/show.php`). A remote attacker can supply a crafted e-mail that, when viewed, executes JavaScript in the victim's browser context (changed scope), allowing theft and transmission of the victim's emails.

CVSS v3.1: 9.3 (AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N)  
Impact: Privacy breach and potential account impersonation via stolen/sent emails.  
Remediation: Upgrade to 1.5.8 or 1.6.8+.

## PoC / Detection
Classification: info-leak

The template issues a single GET to `{{BaseURL}}`. Regex extractors pull major/minor/patch digits from the `rcversion` field in the response body; a DSL extractor assembles the full version string. Matchers then evaluate `compare_versions` against the vulnerable ranges, confirm the string "Roundcube" appears in the body, and require HTTP 200.

## References
- https://github.com/roundcube/roundcubemail/releases
- https://roundcube.net/news/2024/08/04/security-updates-1.6.8-and-1.5.8
- https://nvd.nist.gov/vuln/detail/CVE-2024-42009
