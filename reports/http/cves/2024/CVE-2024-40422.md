---
cve_id: CVE-2024-40422
template_path: nuclei-templates/http/cves/2024/CVE-2024-40422.yaml
affected_product: Devika
severity: critical
authentication: none
external_callback: false
affected_versions: v1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Devika v1 (stitionai) contains a path traversal (CWE-22) vulnerability in the `snapshot_path` parameter of the `/api/get-browser-snapshot` endpoint. Unauthenticated attackers can supply directory-traversal sequences (e.g. `../../../../etc/passwd`) to read arbitrary files on the server. This exposes sensitive system files and compromises confidentiality and integrity.

CVSS: 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)  
Impact: full file-system read access for unauthenticated remote attackers  
Remediation: update to a version later than v1

## PoC / Detection
Classification: info-leak

The template first issues `GET /api/data` (internal matcher) to fingerprint a live Devika instance: requires JSON body containing `"models"`, `"projects"`, `"OPENAI"`, `"OLLAMA"` and `Content-Type: application/json` with status 200.  
It then sends the actual exploit `GET /api/get-browser-snapshot?snapshot_path=../../../../etc/passwd` and confirms success when the response satisfies all three matchers simultaneously:  
- body regex `root:.*:0:0:` (proof of /etc/passwd contents)  
- `Content-Type: application/octet-stream` header  
- status 200  

## References
- https://nvd.nist.gov/vuln/detail/CVE-2024-40422
- https://cvefeed.io/vuln/detail/CVE-2024-40422
- https://github.com/alpernae/CVE-2024-40422
- https://github.com/stitionai/devika
- https://www.exploit-db.com/exploits/52066
