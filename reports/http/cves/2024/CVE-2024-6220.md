---
cve_id: CVE-2024-6220
template_path: nuclei-templates/http/cves/2024/CVE-2024-6220.yaml
affected_product: WordPress Keydatas plugin
severity: critical
authentication: none
external_callback: true
affected_versions: ≤ 2.5.2
preconditions: []
poc_classification: rce
---

## Vulnerability
The Keydatas plugin for WordPress (known in Chinese as "简数采集器") is vulnerable to unrestricted file uploads due to missing file-type validation in the `keydatas_downloadImages` function in all versions up to and including 2.5.2. An unauthenticated attacker can upload arbitrary files — including PHP webshells — achieving remote code execution and complete site compromise.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8)  
CWE-434: Unrestricted Upload of File with Dangerous Type  
Remediation: Update to version 2.5.3 or later.

## PoC / Detection
Classification: rce  
The template performs a two-step HTTP flow to confirm the flaw:  
1. POST `/?__kds_flag=post` with form data embedding an interactsh URL ending in a random `.php` filename inside `__kds_docImgs` (plus `__kds_download_imgs_flag=true`). Internal matcher verifies HTTP 200 and `{"rs":1}` response; folder path is extracted.  
2. GET `/wp-content/uploads/{{folder}}` and confirms: DNS callback on interactsh (proving server fetched the malicious URL), body containing `<html><head></head><body>`, and status 200.  

This verifies the server blindly downloads and saves the file in `wp-content/uploads` without extension or type checks, matching the underlying arbitrary-file-upload flaw that enables RCE.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/keydatas/keydatas-252-unauthenticated-arbitrary-file-upload
- https://github.com/advisories/GHSA-29rm-j4cx-hmc5
- https://nvd.nist.gov/vuln/detail/CVE-2024-6220
