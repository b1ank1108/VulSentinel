---
cve_id: CVE-2024-6782
template_path: nuclei-templates/http/cves/2024/CVE-2024-6782.yaml
affected_product: Calibre
severity: critical
authentication: none
external_callback: false
affected_versions: <= 7.14.0
preconditions: Calibre content server enabled
poc_classification: rce
---

## Vulnerability
Calibre <= 7.14.0 is affected by an unauthenticated remote code execution vulnerability in its content server. Unauthenticated attackers can execute arbitrary Python code through the template functionality, achieving complete system compromise.

## PoC / Detection
Classification: rce

The template detects/validates the vulnerability with a two-step HTTP interaction that performs actual command execution:
1. GET request to `/interface-data/books-init` extracts the first `book_ids[0]` value from the JSON response (stored internally).
2. POST request to `/cdb/cmd/list` with a JSON array payload injecting a malicious `python:def evaluate` template that runs `subprocess.check_output(['cmd.exe', '/c', 'whoami'])` or `sh -c whoami`.

Matchers confirm success via regex `b'([^']+)'` on the response body (capturing command output), `application/json` content-type, and HTTP 200 status.

## References
- https://starlabs.sg/advisories/24/24-6781/
