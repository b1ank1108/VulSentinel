---
cve_id: CVE-2024-6886
template_path: nuclei-templates/http/cves/2024/CVE-2024-6886.yaml
affected_product: Gitea
severity: medium
authentication: required
external_callback: false
affected_versions: 1.22.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Gitea 1.22.0 is vulnerable to stored Cross-Site Scripting (XSS) via repository descriptions (CWE-79). Authenticated attackers can inject malicious JavaScript that persists on the server and executes in the context of other users viewing the repository.

Impact: Authenticated attackers can inject malicious JavaScript into repository descriptions that executes in the context of other users' sessions when they view the repository. CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L (score 6.7).

Remediation: Update Gitea to version 1.22.1 or later.

## PoC / Detection
Classification: state-change

The template performs a 5-step authenticated workflow: POST /user/login with supplied credentials, GET / and GET /{{username}} to extract _csrf token and uid via regex, POST /repo/create with randstr repo_name and description payload `<a href="javascript:alert(document.domain)">XSS</a>`, followed by final GET /{{username}}. It then matches the unsanitized payload in body_5 along with text/html Content-Type and HTTP 200 to confirm the stored XSS condition.

## References
- https://www.exploit-db.com/exploits/52077
- https://nvd.nist.gov/vuln/detail/CVE-2024-6886
