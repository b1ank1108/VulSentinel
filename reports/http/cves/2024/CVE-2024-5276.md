---
cve_id: CVE-2024-5276
template_path: nuclei-templates/http/cves/2024/CVE-2024-5276.yaml
affected_product: Fortra FileCatalyst Workflow
severity: critical
authentication: optional
external_callback: false
affected_versions: 5.1.6 Build 135 and earlier
preconditions: anonymous access enabled (for unauthenticated exploitation)
poc_classification: state-change
---

## Vulnerability
Fortra FileCatalyst Workflow <= v5.1.6 (specifically versions 5.1.6 Build 135 and earlier) contains a critical SQL Injection vulnerability (CVE-2024-5276, CVSS 9.8, CWE-20) in the pdf_servlet endpoint via the JOBID parameter. The flaw allows injection of arbitrary SQL statements that modify application data in the backend database. Primary impacts: creation of new administrative (full-access) user accounts, deletion or alteration of existing records. Data exfiltration is not possible.  

Unauthenticated exploitation succeeds when anonymous access is enabled; otherwise an authenticated user session is required. Remediation: upgrade to 5.1.7 Build 136 or later.

## PoC / Detection
Classification: state-change

The template first requests `/workflow/` and `/workflow/jsp/logon.jsp` to extract JSESSIONID and the anonymous-login link (`logonAnonymousLink`), then follows that link. It next sends a crafted unauthenticated GET to `/workflow/servlet/pdf_servlet?JOBID=1';INSERT INTO DOCTERA_USERS (...) VALUES(...)-- -` that inserts a new full-access user (random lowercase username, MD5-hashed random password). Finally it extracts a fresh form token and JSESSIONID, performs a POST to `/workflow/logon.do` with the injected credentials, and matches on successful admin-panel title plus the test username (negative match on login-error strings) to confirm exploitation.

## References
- https://www.tenable.com/security/research/tra-2024-25
- https://support.fortra.com/filecatalyst/kb-articles/advisory-6-24-2024-filecatalyst-workflow-sql-injection-vulnerability-YmYwYWY4OTYtNTUzMi1lZjExLTg0MGEtNjA0NWJkMDg3MDA0
- https://www.fortra.com/security/advisory/fi-2024-008
- https://nvd.nist.gov/vuln/detail/CVE-2024-5276
