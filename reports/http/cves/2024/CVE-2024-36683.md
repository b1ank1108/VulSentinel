---
cve_id: CVE-2024-36683
template_path: nuclei-templates/http/cves/2024/CVE-2024-36683.yaml
affected_product: PrestaShop productsalert
severity: critical
authentication: none
external_callback: false
affected_versions: <= 1.7.4
preconditions: [Products Alert (productsalert) module installed]
poc_classification: info-leak
---

## Vulnerability
Unauthenticated time-based blind SQL injection (CWE-89) in the 'Products Alert' (productsalert) module up to version 1.7.4 from Smart Modules for PrestaShop. A guest attacker can inject arbitrary SQL via the `paemail` parameter, enabling execution of arbitrary SQL queries with potential for unauthorized access and data leakage (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8).

Remediation: Apply the latest security patches and updates from the vendor.

## PoC / Detection
Classification: info-leak
The template first issues an internal GET / request (host-redirects enabled) to confirm PrestaShop/productsalert presence (status_code == 200 && body contains "productsalert" or "prestashop"). It then sends two POST requests (stop-at-first-match) to /modules/productsalert/pasubmit.php and /module/productsalert/AjaxProcess with the time-based blind SQLi payload `paemail=1' AND (SELECT 2692 FROM (SELECT(SLEEP(8)))IuFA) AND 'pAlk'='pAlk` (30s timeout each). Vulnerability is verified if response duration >= 8s on either endpoint (status_code != 404).

## References
- https://security.friendsofpresta.org/modules/2024/06/20/productsalert.html
- https://nvd.nist.gov/vuln/detail/CVE-2024-36683
