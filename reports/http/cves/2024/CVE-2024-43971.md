---
cve_id: CVE-2024-43971
template_path: nuclei-templates/http/cves/2024/CVE-2024-43971.yaml
affected_product: Sunshine Photo Cart
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.5
preconditions: WordPress site with Sunshine Photo Cart plugin installed and activated; victim must be logged in as administrator and visit the crafted malicious URL
poc_classification: state-change
---

## Vulnerability
**CVE ID:** CVE-2024-43971  
**CWE:** CWE-79  
**CVSS v3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**EPSS:** 0.06468 (90.886th percentile)  

Reflected cross-site scripting in Sunshine Photo Cart (WordPress plugin) versions up to 3.2.5. The `section` query parameter on `/wp-admin/admin.php?page=sunshine` fails to neutralize input during page generation, allowing an attacker-supplied payload to be reflected unsanitized into the HTML response.  

Any authenticated administrator who visits an attacker-crafted link executes arbitrary JavaScript in their browser context (same-origin, full admin privileges).  

**Impact summary**  
- Theft of `wordpress_logged_in_*` cookies / session tokens  
- Arbitrary actions performed on behalf of the admin (data modification, account changes, plugin configuration)  
- Scope changed (S:C) due to admin context  

**Remediation**  
Update to Sunshine Photo Cart 3.2.6 or later.

## PoC / Detection
Classification: state-change  

The template first executes an authenticated login (POST `/wp-login.php` with `log={{username}}&pwd={{password}}`), confirming success via 302 redirect and `wordpress_logged_in` cookie in headers. It then issues a GET request to `/wp-admin/admin.php?page=sunshine&section=%22%20onmouseover=alert(document.domain)%3Bthis.remove()%3B%20style=position:fixed%3Bleft:0%3Btop:0%3Bwidth:100vw%3Bheight:100vh%3B` containing the reflected XSS payload. Detection succeeds when the response is HTTP 200 and the body simultaneously contains the exact unsanitized JavaScript string `alert(document.domain);this.remove(); style=position:fixed;left:0;top:0;width:100vw;height:100vh;` plus the marker `Sunshine Photo Cart`.

## References
- https://wpscan.com/vulnerability/fa4cd831-40f2-4fa2-9439-b4d7fb94ec1e/
- https://patchstack.com/database/vulnerability/sunshine-photo-cart/wordpress-sunshine-photo-cart-free-client-photo-galleries-for-photographers-plugin-3-2-5-cross-site-scripting-xss-vulnerability?_s_id=cve
