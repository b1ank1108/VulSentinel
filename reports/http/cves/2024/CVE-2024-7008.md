---
cve_id: CVE-2024-7008
template_path: nuclei-templates/http/cves/2024/CVE-2024-7008.yaml
affected_product: Calibre
severity: medium
authentication: none
external_callback: false
affected_versions: <= 7.15.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Calibre content server <= 7.15.0 contains a reflected cross-site scripting (XSS) vulnerability in the `/browse` endpoint. An attacker can craft a malicious URL that injects arbitrary JavaScript code, which executes in the victim's browser context when the link is visited. If the server runs with authentication enabled and the victim is logged in, this allows the attacker to perform unauthorized actions on the Calibre server using the victim's authenticated session.

Impact: Attackers can execute arbitrary JavaScript in victims' browsers, potentially leading to unauthorized actions. Remediation: Update Calibre to a version later than 7.15.0.

## PoC / Detection
Classification: state-change

The template sends a single raw GET request to `/browse/book/TEST&quot;;window.stop();alert(document.domain);%2f%2f` containing a breakout payload designed to trigger JavaScript execution. It verifies exploitation by matching HTTP 200 status, `text/html` Content-Type header, and unsanitized reflection of the injected payload in the response body JavaScript (`window.location.href = "/#book_id=TEST";window.stop();alert(document.domain);//`).

## References
- https://starlabs.sg/advisories/24/24-7008/
