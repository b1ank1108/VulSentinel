---
cve_id: CVE-2024-3234
template_path: nuclei-templates/http/cves/2024/CVE-2024-3234.yaml
affected_product: Chuanhu Chat
severity: critical
authentication: none
external_callback: false
affected_versions: prior to the fixed version released on 20240305
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Chuanhu Chat (gaizhenbiao/chuanhuchatgpt) is vulnerable to a path traversal attack due to its use of an outdated gradio component. The application is designed to restrict user access to resources within the `web_assets` folder. However, the outdated version of gradio it employs is susceptible to path traversal, as identified in CVE-2023-51449. This vulnerability allows unauthorized users to bypass the intended restrictions and access sensitive files, such as `config.json`, which contains API keys. The issue affects the latest version of chuanhuchatgpt prior to the fixed version released on 20240305.

**CVSS 3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** 22  
**Impact:** Unauthenticated attackers can read arbitrary files including API keys.

## PoC / Detection
Classification: info-leak

The template sends one unauthenticated raw GET request to `/file=web_assets/../config.json` and confirms exploitation if the response body contains both `"openai_api_key":` and `"openai_api_type":`, the `Content-Type` header is `application/json`, and HTTP status is 200.

## References
None listed in the template.
