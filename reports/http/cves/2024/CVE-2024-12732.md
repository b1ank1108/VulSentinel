---
cve_id: CVE-2024-12732
template_path: nuclei-templates/http/cves/2024/CVE-2024-12732.yaml
affected_product: AffiliateImporterEb WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 1.0.6
preconditions: [AffiliateImporterEb plugin installed and active in WordPress]
poc_classification: state-change
---

## Vulnerability
AffiliateImporterEb WordPress plugin through version 1.0.6 is vulnerable to reflected XSS (CWE-79) caused by unsanitized and unescaped output of the `module` query parameter on the `/wp-admin/admin.php?page=ebdn-settings` page. Attackers can craft a malicious URL that executes arbitrary JavaScript in the browser context of high-privilege users (e.g., administrators) who visit the link. Impact includes potential account compromise or unauthorized actions in the victim's session. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Remediation is to update beyond 1.0.6.

## PoC / Detection
Classification: state-change

The template first authenticates by POSTing `log={{username}}&pwd={{password}}` to `/wp-login.php`, then internally matches the `wordpress_logged_in` cookie in the response header. It follows with a GET to `/wp-admin/admin.php?page=ebdn-settings&module=1%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`` and succeeds if status_code is 200 and the body contains both `><script>alert(document.domain)</script>` and `affiliateimportereb`.

## References
- https://wpscan.com/vulnerability/bc46edd8-8d77-4567-873b-e9e90a01adcf/
