---
cve_id: CVE-2024-6517
template_path: nuclei-templates/http/cves/2024/CVE-2024-6517.yaml
affected_product: Contact Form 7 Math Captcha
severity: medium
authentication: none
external_callback: false
affected_versions: <= 2.0.1
preconditions: []
poc_classification: state-change
---

## Vulnerability
Contact Form 7 Math Captcha WordPress plugin (ds-cf7-math-captcha) through 2.0.1 suffers from reflected XSS (CVE-2024-6517, CWE-79). The `tagname` parameter passed to the `dscf7_refreshcaptcha` AJAX action is echoed unsanitized into the HTML response. CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Impact limited to high-privilege users (admins/editors) who visit attacker-crafted links; enables arbitrary JavaScript execution in victim browser context (session theft, data exfiltration, or on-behalf actions such as configuration changes). Remediation: upgrade to 2.0.2+.

## PoC / Detection
Classification: state-change

The template executes a two-step flow.  
1. `GET /` (internal matcher) confirms plugin presence via substring `/wp-content/plugins/ds-cf7-math-captcha` in body (status 200).  
2. `POST /wp-admin/admin-ajax.php` with `action=dscf7_refreshcaptcha&tagname="<script>alert(document.domain)</script>`; matches exact unsanitized payload in response body, `text/html` Content-Type, and status 200.  
This probe directly verifies the lack of output sanitization that enables reflected XSS and subsequent client-side state-changing actions.

## References
- https://wpscan.com/vulnerability/d04bab9c-7cb4-4d21-b70b-a4a7fabc3c20/
- https://nvd.nist.gov/vuln/detail/CVE-2024-6517
