---
cve_id: CVE-2024-34061
template_path: nuclei-templates/http/cves/2024/CVE-2024-34061.yaml
affected_product: Changedetection.io
severity: medium
authentication: none
external_callback: false
affected_versions: <=v0.45.21
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Changedetection.io versions <= v0.45.21 is affected by a reflected Cross-Site Scripting (XSS) vulnerability. The `notification_urls` parameter (under application settings) does not sanitize user input, allowing JavaScript injection. When an invalid URL triggers the error "is not a valid AppRise URL", the payload is reflected in the response body and executed in the browser context. This is a reflected XSS (CWE-79) requiring user interaction to trigger. Fixed in 0.45.22 with no known workarounds. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N (4.3). Attackers can inject malicious scripts, potentially compromising user sessions.

## PoC / Detection
Classification: auth-bypass

The template first issues GET / to extract the CSRF token via regex on the body. It then issues POST /settings (application/x-www-form-urlencoded) embedding the payload `"><img src=x onerror=alert(document.domain)>` inside the `application-notification_urls` field while supplying the extracted CSRF token. Detection succeeds if the response body simultaneously contains the exact injected `<img src=x onerror=alert(document.domain)>` string, the validation error "is not a valid AppRise URL", returns status 200, and has Content-Type text/html. This confirms unsanitized reflection, enabling malicious script execution that can compromise user sessions.

## References
- https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-pwgc-w4x9-gw67
- https://nvd.nist.gov/vuln/detail/CVE-2024-34061
