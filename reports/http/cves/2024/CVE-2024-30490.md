---
cve_id: CVE-2024-30490
template_path: nuclei-templates/http/cves/2024/CVE-2024-30490.yaml
affected_product: ProfileGrid
severity: critical
authentication: none
external_callback: false
affected_versions: up to, and including, 5.7.8
preconditions: []
poc_classification: state-change
---

## Vulnerability
ProfileGrid <= 5.7.8 - SQL Injection (CVE-2024-30490)  
The ProfileGrid â€“ User Profiles, Groups and Communities plugin for WordPress is vulnerable to SQL Injection due to insufficient escaping on the user-supplied `search` parameter and lack of sufficient preparation on the existing SQL query.  
Attackers can execute arbitrary SQL queries, potentially leading to data theft, data tampering, or database compromise.  
Remediation: Update to ProfileGrid version 5.7.9 or later.

## PoC / Detection
Classification: state-change  
The template sends a single unauthenticated POST request to `/wp-admin/admin-ajax.php` with `action=pm_get_all_groups`, a crafted `search=test'+AND+(SELECT+1+FROM+(SELECT(SLEEP(7)))a)--+-` payload, and other benign parameters. Detection succeeds if the response duration is >=7 seconds (SLEEP executed), status_code is 200, and body contains both "No group matches found." and "pm-".

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/profilegrid-user-profiles-groups-and-communities/profilegrid-578-unauthenticated-sql-injection
- https://wordpress.org/plugins/profilegrid-user-profiles-groups-and-communities/
- https://nvd.nist.gov/vuln/detail/CVE-2024-30490
