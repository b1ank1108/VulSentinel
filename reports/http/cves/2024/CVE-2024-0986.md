---
cve_id: CVE-2024-0986
template_path: nuclei-templates/http/cves/2024/CVE-2024-0986.yaml
affected_product: Issabel PBX
severity: medium
authentication: required
external_callback: false
affected_versions: 4.0.0
preconditions: authenticated as administrator
poc_classification: rce
---

## Vulnerability
OS command injection (CWE-78) in Issabel PBX 4.0.0 affecting unknown processing of `/index.php?menu=asterisk_cli` in the Asterisk-Cli component. Manipulation of the `Command`/`txtCommand` argument allows remote arbitrary OS command execution. Publicly disclosed (VDB-252251); vendor contacted with no response. 

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L (score 4.7). 

Impact: Authenticated administrators can inject and execute arbitrary OS commands remotely, potentially gaining full control over the Issabel PBX system.

Remediation: Update to a version newer than 4.0.0.

## PoC / Detection
Classification: rce

The template logs in via POST to `/` using supplied `{{username}}`/`{{password}}` credentials, then POSTs a crafted `txtCommand` payload (`xmldoc dump ... |{echo,...}|{base64,-d}|bash`) to the Asterisk CLI endpoint to inject and execute `cat ../../../../etc/passwd`. A follow-up GET to `/modules/backup_restore/restore.php?filename=...` with matching obfuscated payload retrieves the command output. Success is verified by regex match `root:.*:0:0:` on the third response body combined with HTTP 200 status.

## References
- https://github.com/issabel-org/issabel/issues
- https://vuldb.com/?ctiid.252251
- https://vuldb.com/?id.252251
- https://www.vicarius.io/vsociety/posts/issabel-authenticated-remote-code-execution-cve-2024-0986
- https://nvd.nist.gov/vuln/detail/CVE-2024-0986
