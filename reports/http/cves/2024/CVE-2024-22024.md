---
cve_id: CVE-2024-22024
template_path: nuclei-templates/http/cves/2024/CVE-2024-22024.yaml
affected_product: Ivanti Connect Secure
severity: high
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Ivanti Connect Secure is vulnerable to XXE (XML External Entity) injection.

The vulnerability occurs in the processing of the SAMLRequest parameter sent via POST to `/dana-na/auth/saml-sso.cgi`. Successful exploitation could lead to unauthorized access to sensitive information or remote code execution.

## PoC / Detection
Classification: info-leak

The template sends a single POST request to `/dana-na/auth/saml-sso.cgi` containing a base64-encoded XML payload with a malicious external entity (`<!ENTITY % watchTowr SYSTEM "http://{{interactsh-url}}/x">`) to trigger an out-of-band interaction. Detection succeeds if a DNS interaction is observed via interactsh and the response body contains both `/dana-na/` and `WriteCSS`.

## References
- https://labs.watchtowr.com/are-we-now-part-of-ivanti/
- https://twitter.com/h4x0r_dz/status/1755849867149103106/photo/1
