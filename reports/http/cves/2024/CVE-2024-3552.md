---
cve_id: CVE-2024-3552
template_path: nuclei-templates/http/cves/2024/CVE-2024-3552.yaml
affected_product: Web Directory Free
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.7.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Web Directory Free WordPress plugin < 1.7.0 does not sanitise and escape a parameter before using it in a SQL statement via an AJAX action available to unauthenticated users, leading to a SQL injection with different techniques like UNION, Time-Based and Error-Based. Unauthenticated attackers can execute time-based SQL injection attacks via the locations_ids parameter. Update to version 1.7.0 or later.

## PoC / Detection
Classification: info-leak

The template first issues a GET / request and internally matches "/wp-content/plugins/web-directory-free" in the body to confirm the plugin is present. It then sends a POST /wp-admin/admin-ajax.php request with action=w2dc_get_map_marker_info and the time-based blind SQLi payload locations_ids[]=(select+if(1=1,sleep(6),0)+from+(select+1)x). Detection succeeds when duration>=6, status_code==200 and body matches regex ^\[\]$.

## References
- https://vulners.com/wpvulndb/CVE-2024-3552
- https://wpscan.com/vulnerability/34b03ee4-de81-4fec-9f3d-e1bd5b94d136/
