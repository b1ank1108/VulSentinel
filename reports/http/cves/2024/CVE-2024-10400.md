---
cve_id: CVE-2024-10400
template_path: nuclei-templates/http/cves/2024/CVE-2024-10400.yaml
affected_product: Tutor LMS
severity: high
authentication: none
external_callback: false
affected_versions: <= 2.7.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Tutor LMS plugin for WordPress (<= 2.7.6) is vulnerable to SQL injection via the `rating_filter` parameter in the `load_filtered_instructor` AJAX action. Insufficient escaping of user input and lack of prepared statements allow unauthenticated attackers to append arbitrary SQL queries to existing statements, enabling extraction of sensitive database contents (user credentials, course data).

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). CWE-89.

## PoC / Detection
Classification: info-leak

Template first issues GET to `{{BaseURL}}/` and extracts `_tutor_nonce` value via regex from page body. It then sends POST to `/wp-admin/admin-ajax.php` with form data `action=load_filtered_instructor&_tutor_nonce={{nonce}}&rating_filter=1e0+and+1=0+Union+select+111,2222,3333,4,5,6,7,8,9,concat(md5(999999999),version()),11,12,14--+ -`. Matcher checks response body for the computed MD5 hash of 999999999 **and** `"success":true`.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/tutor/tutor-lms-276-unauthenticated-sql-injection-via-rating-filter
- https://nvd.nist.gov/vuln/detail/CVE-2024-10400
