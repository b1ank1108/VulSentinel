---
cve_id: CVE-2024-10914
template_path: nuclei-templates/http/cves/2024/CVE-2024-10914.yaml
affected_product: D-Link NAS
severity: critical
authentication: none
external_callback: false
affected_versions: D-Link DNS-320, DNS-320LW, DNS-325 and DNS-340L up to 20241028
preconditions: []
poc_classification: rce
---

## Vulnerability
Critical OS command injection (CVE-2024-10914, CVSS 9.8) in D-Link NAS devices (DNS-320, DNS-320LW, DNS-325, DNS-340L) firmware up to 20241028. The flaw lies in `cgi_user_add` function of `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add`; unsanitized `name` parameter enables OS command injection. Unauthenticated remote attackers can execute arbitrary OS commands, achieving full device compromise (C:H/I:H/A:H).

**Remediation:** Update to firmware released after 20241028.

## PoC / Detection
Classification: rce

The template issues a GET request to `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=%27;{{command}};%27` (payloads: `id`, `ifconfig`), then checks response body with DSL matchers for command execution artifacts: regex match on `uid=… gid=…` or `contains_all(body, 'inet addr:', 'Mask:')`, or fallback `contains(body, "Content-type: text/html") && status_code == 200`. Stops at first match.

## References
- https://github.com/verylazytech/CVE-2024-10914
- https://www.usom.gov.tr/bildirim/tr-24-1836
- https://nvd.nist.gov/vuln/detail/CVE-2024-10914
