---
cve_id: CVE-2024-24809
template_path: nuclei-templates/http/cves/2024/CVE-2024-24809.yaml
affected_product: Traccar
severity: high
authentication: required
external_callback: false
affected_versions: prior to 6.0
preconditions: registration allowed by default
poc_classification: rce
---

## Vulnerability
Traccar open-source GPS tracking system is vulnerable to path traversal combined with unrestricted upload of files with dangerous types. Versions prior to 6.0 allow default user registration; an attacker registers an ordinary account, then uploads files prefixed `device.` to any server directory via path traversal in the device `uniqueId` field. This enables phishing, cross-site scripting, and potential arbitrary command execution by placing malicious files in executable or web-accessible paths (e.g. `/opt/traccar/modern`). Fixed in version 6.0.  
Impact: authenticated arbitrary file write anywhere on the server, leading to code execution and system compromise (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:L, CWE-27).

## PoC / Detection
Classification: rce  
The template executes the complete 7-step exploit chain to verify the flaw: (1) registers a random user via POST /api/users, (2) logs in via POST /api/session to obtain session, (3) creates a device via POST /api/devices and extracts its ID, (4) uploads arbitrary payload via POST /api/devices/{id}/image (extracts `device.*` filename via regex), (5) updates device via PUT /api/devices/{id} injecting path-traversal payload `../../../../../opt/traccar/modern` into `uniqueId`, (6) re-uploads payload via the image endpoint, (7) retrieves the file via GET /{filename} and confirms HTTP 200. Success proves arbitrary file placement and retrieval at attacker-chosen paths.

## References
- https://github.com/traccar/traccar/commit/b099b298f90074c825ba68ce73532933c7b9d901
- https://github.com/traccar/traccar/security/advisories/GHSA-vhrw-72f6-gwp5
- https://nvd.nist.gov/vuln/detail/CVE-2024-24809
