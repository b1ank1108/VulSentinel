---
cve_id: CVE-2024-32738
template_path: nuclei-templates/http/cves/2024/CVE-2024-32738.yaml
affected_product: CyberPower PowerPanel Enterprise
severity: high
authentication: none
external_callback: false
affected_versions: prior to v2.8.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
SQL injection (CWE-89) in the `query_ptask_lean` function of MCUDBHelper. Unauthenticated remote attacker can leak sensitive information. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5). Remediation: upgrade to v2.8.3 or later.

## PoC / Detection
Classification: info-leak

Template sends unauthenticated GET `{{BaseURL}}/api/v1/ndconfig?mode=lean&uid=1'%20UNION%20select%201,2,3,sqlite_version();--`, then matches JSON body containing `:"finished"`, `"success":`, `modifiedtime":` (all AND), `application/json` Content-Type, and HTTP 200. Extracts `modifiedtime` via regex `"modifiedtime":"([0-9.]+)"`.

## References
- https://www.cyberpower.com/global/en/File/GetFileSampleByType?fileId=SU-18070002-07&fileSubType=FileReleaseNote
- https://www.tenable.com/security/research/tra-2024-14
- https://nvd.nist.gov/vuln/detail/CVE-2024-32738
