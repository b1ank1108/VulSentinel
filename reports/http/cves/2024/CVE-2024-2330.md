---
cve_id: CVE-2024-2330
template_path: nuclei-templates/http/cves/2024/CVE-2024-2330.yaml
affected_product: NS-ASG Application Security Gateway
severity: medium
authentication: required
external_callback: false
affected_versions: 6.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Netentsec NS-ASG Application Security Gateway 6.3 contains a SQL injection vulnerability (CWE-89) in the file `/protocol/index.php`. Manipulation of the `IPAddr` argument inside a JSON `messagecontent` array (protocolType `addmacbind`) allows remote injection. The flaw is exploitable by authenticated attackers and enables extraction of sensitive database information. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L (score 6.3). The exploit has been publicly disclosed. Remediation requires updating to a version newer than 6.3.

## PoC / Detection
Classification: info-leak

The template sends a raw POST request to `/protocol/index.php` (Content-Type `application/x-www-form-urlencoded`) with a `jsoncontent` payload setting `IPAddr` to `eth0'and(updatexml(1,concat(0x7e,(select+version())),1))='` to force an XPATH syntax error that leaks the database version. Detection succeeds when the response body contains both `XPATH syntax error:` and `alert`, `status_code == 200`, and the `Content-Type` header includes `text/html`. A regex extractor (`XPATH syntax error: '([~0-9.]+)'`) automatically pulls the leaked version string.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-2330
- https://nvd.nist.gov/vuln/detail/CVE-2024-2330
- https://github.com/jikedaodao/cve/blob/main/NS-ASG-sql-addmacbind.md
- https://vuldb.com/?ctiid.256281
- https://vuldb.com/?id.256281
