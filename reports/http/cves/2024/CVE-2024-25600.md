---
cve_id: CVE-2024-25600
template_path: nuclei-templates/http/cves/2024/CVE-2024-25600.yaml
affected_product: Bricks Builder
severity: critical
authentication: none
external_callback: false
affected_versions: <= 1.9.6
preconditions: []
poc_classification: rce
---

## Vulnerability
Bricks Builder is a popular WordPress development theme vulnerable to unauthenticated remote code execution (RCE) in versions <= 1.9.6. The flaw allows any unauthenticated attacker to run arbitrary commands on the site/server via the `/wp-json/bricks/v1/render_element` endpoint by injecting PHP code into the `queryEditor` field of a specially crafted POST request. This leads to complete site takeover and potential server compromise.

## PoC / Detection
Classification: rce
The template detects the vulnerability through a two-step process. First, it issues a GET request to `/` and extracts a nonce value from the response body using an internal regex extractor. Second, it sends a POST request to `/wp-json/bricks/v1/render_element` with a JSON body containing a malicious `queryEditor` payload: `ob_start();echo \`id\`;$output=ob_get_contents();ob_end_clean();throw new Exception($output);`. The response body is then checked with AND regex matchers for the strings "Exception:" and a Unix-style UID/GID output pattern to confirm successful execution of the `id` command.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25600
- https://wpscan.com/vulnerability/afea4f8c-4d45-4cc0-8eb7-6fa6748158bd/
- https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6
- https://github.com/Chocapikk/CVE-2024-25600
- https://op-c.net/blog/cve-2024-25600-wordpresss-bricks-builder-rce-flaw-under-active-exploitation
