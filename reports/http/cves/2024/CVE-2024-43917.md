---
cve_id: CVE-2024-43917
template_path: nuclei-templates/http/cves/2024/CVE-2024-43917.yaml
affected_product: WordPress TI WooCommerce Wishlist Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.8.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress TI WooCommerce Wishlist Plugin <= 2.8.2 contains an unauthenticated SQL injection (CVE-2024-43917, CWE-89) in the `/wp-json/wc/v3/wishlist/{share_key}/get_products` endpoint via the `order` parameter. 

No privileges required. Unauthenticated attackers can execute arbitrary SQL queries against the WordPress database. Impact focuses on time-based blind extraction of sensitive data (user accounts, password hashes, etc.). CVSS 3.1: 9.8 Critical (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Unpatched in version 2.8.2.

## PoC / Detection
Classification: info-leak

The template executes a 4-step HTTP flow to detect the underlying SQL injection flaw:

- GET `/?p=1` extracts WP nonce via regex.
- GET `/product-category/uncategorized/` extracts `product_id` via regex on `data-tinvwl_product_id` attribute.
- POST `/product-category/uncategorized/` (multipart form simulating wishlist add) extracts `share_key` from JSON response.
- GET `/wp-json/wc/v3/wishlist/{{share_key}}/get_products?order=,(select*from(select(sleep(6)))a)--+-` (with extracted nonce) triggers 6-second sleep payload and confirms via `duration>=6`, JSON content-type, and `product_id` in body.

## References
- https://patchstack.com/articles/unpatched-sql-injection-vulnerability-in-ti-woocommerce-wishlist-plugin/
- https://patchstack.com/database/vulnerability/ti-woocommerce-wishlist/wordpress-ti-woocommerce-wishlist-plugin-2-8-2-sql-injection-vulnerability?_s_id=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-43917
