---
cve_id: CVE-2024-23334
template_path: nuclei-templates/http/cves/2024/CVE-2024-23334.yaml
affected_product: aiohttp
severity: high
authentication: none
external_callback: false
affected_versions: < 3.9.2
preconditions: static routes configured with follow_symlinks=True
poc_classification: info-leak
---

## Vulnerability
aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. When configured as a web server with static routes and `follow_symlinks=True`, versions prior to 3.9.2 suffer from a directory traversal vulnerability (CWE-22) due to missing path validation outside the static root. Unauthenticated remote attackers can read arbitrary files on the server filesystem, including sensitive configuration files containing credentials. CVSS 3.1 score 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). Mitigation: update to 3.9.2+ or disable `follow_symlinks` and use a reverse proxy.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}/static/../../../../etc/passwd` and confirms successful traversal/LFI by matching (AND condition): regex `root:.*:0:0:` in response body, both `aiohttp` and `application/octet-stream` words in headers, and HTTP status 200.

## References
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD/
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7/
- https://x.com/W01fh4cker/status/1762491210953060827?s=20
