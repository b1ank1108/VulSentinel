---
cve_id: CVE-2024-21650
template_path: nuclei-templates/http/cves/2024/CVE-2024-21650.yaml
affected_product: XWiki
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 14.10.17, 15.5.3 and 15.8 RC1
preconditions: user registration enabled for guests
poc_classification: rce
---

## Vulnerability
XWiki is vulnerable to remote code execution via its guest user registration feature. Malicious payloads injected into the "first name" or "last name" fields are unsafely evaluated as Groovy code, allowing arbitrary command execution. The flaw affects all installations where guest registration is enabled.

**CVSS**: 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)  
**CWE**: CWE-95 (Improper Neutralization of Directives in Dynamically Evaluated Code)  
**Impact**: Successful exploitation leads to full remote code execution.  
**Remediation**: Update to XWiki 14.10.17, 15.5.3 or 15.8 RC1 (or later).

## PoC / Detection
Classification: rce

The template verifies the RCE by simulating an unauthenticated guest registration that triggers the vulnerable Groovy evaluation:  
- Issues a GET to `/bin/register/XWiki/XWikiRegister` (supporting base path `/xwiki` or root) to extract the `data-xwiki-form-token` via regex.  
- Submits a POST to the same endpoint with randomized username/password/email and a URL-encoded `register_first_name` payload `]]{{/html}}{{async}}{{groovy}}services.logging.getLogger("attacker").error("Attack succeeded"){{/groovy}}{{/async}}`.  
- Confirms exploitation if the response body contains both "Registration successful" and "Attack succeeded" (or the related Groovy execution message) on HTTP 200 status.  

The in-band check proves the injected Groovy code executed on the server.

## References
- https://jira.xwiki.org/browse/XWIKI-21173
- https://nvd.nist.gov/vuln/detail/CVE-2024-21650
