---
cve_id: CVE-2024-1380
template_path: nuclei-templates/http/cves/2024/CVE-2024-1380.yaml
affected_product: Relevanssi (A Better Search)
severity: medium
authentication: none
external_callback: false
affected_versions: <= 4.22.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Relevanssi Search plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check in all versions up to, and including, 4.22.0. This makes it possible for unauthenticated attackers to export the query log data containing search terms and potentially sensitive user information (user_id, session_id).  
CVSS v3.1: 5.3 (Medium) â€“ AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N.  
Remediation: Update to version 4.22.1 or later.

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated POST request to `/wp-admin/admin-ajax.php` with body `action=&relevanssi_export=1`. Detection succeeds if the server returns HTTP 200 with `Content-Disposition` header containing `filename=relevanssi_log.csv` and `application/download`, plus CSV body containing both `user_id` and `session_id` strings (confirming successful export of the query log).

## References
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3033880%40relevanssi&new=3033880%40relevanssi&sfp_email=&sfph_mail=
- https://www.wordfence.com/threat-intel/vulnerabilities/id/7b2a3b17-0551-4e02-8e6a-ae8d46da0ef8?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-1380
