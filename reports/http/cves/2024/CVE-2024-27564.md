---
cve_id: CVE-2024-27564
template_path: nuclei-templates/http/cves/2024/CVE-2024-27564.yaml
affected_product: ChatGPT个人专用版
severity: high
authentication: none
external_callback: true
affected_versions: commit f9f4bbc
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Server-Side Request Forgery (SSRF) in `pictureproxy.php` of ChatGPT个人专用版 at commit f9f4bbc. Attackers can inject crafted URLs into the `url` parameter to force the server to make arbitrary HTTP requests (including `file://` and internal endpoints).

Impact includes reading local files (e.g., `/etc/passwd`) and accessing internal network resources.  
Remediation: Update ChatGPT个人专用版 to a version addressing CVE-2024-27564.  
CPE: `cpe:2.3:a:chanzhaoyu:chatgpt_web:*:*:*:*:*:*:*:*` (verified: true).

## PoC / Detection
Classification: info-leak

The template detects the SSRF by issuing two GET requests to `{{BaseURL}}/pictureproxy.php` (stop-at-first-match: true):  
- `?url=file:///etc/passwd` matched on status 200 + `image/jpeg` header + `root:.*:0:0:` regex in body.  
- `?url=http://{{interactsh-url}}` matched on OOB DNS interaction + status 200 + `image/jpeg` header.

## References
- https://github.com/dirk1983/chatgpt/issues/114
- https://nvd.nist.gov/vuln/detail/CVE-2024-27564
