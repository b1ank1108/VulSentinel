---
cve_id: CVE-2024-36858
template_path: nuclei-templates/http/cves/2024/CVE-2024-36858.yaml
affected_product: Jan
severity: critical
authentication: none
external_callback: false
affected_versions: v0.4.12
preconditions: []
poc_classification: rce
---

## Vulnerability
An arbitrary file upload vulnerability (CWE-434) in the `/v1/app/writeFileSync` interface of Jan v0.4.12 allows unauthenticated attackers to upload crafted files and execute arbitrary code on the server. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Impact: full server compromise via unauthenticated file upload.

## PoC / Detection
Classification: rce

The template first fingerprints the target with a GET `/` request matching `<title>Jan</title>` and `text/html` content (status 200). It then performs a three-step exploit chain via POST requests:  
- `/v1/app/writeFileSync` with body `["/../../../../../tmp/{{filename}}.txt","{{randstr}}"]` (path-traversal write)  
- `/v1/app/appendFileSync` with body `["file:/../../../../../../tmp/{{filename}}.txt","{{string}}"]` (append)  
- `/v1/app/readFileSync` with body `["file:/../../../../../../tmp/{{filename}}.txt","utf-8"]` (read-back)  
Matchers succeed if all three status codes are 200 and the final response body contains the injected random string.

## References
- https://github.com/HackAllSec/CVEs/blob/main/Jan%20AFR%20vulnerability/README.md
