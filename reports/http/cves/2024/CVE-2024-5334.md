---
cve_id: CVE-2024-5334
template_path: nuclei-templates/http/cves/2024/CVE-2024-5334.yaml
affected_product: Devika
severity: high
authentication: none
external_callback: false
affected_versions: latest version
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Devika contains a local file inclusion vulnerability in the `/api/get-browser-snapshot` endpoint. The issue stems from insufficient sanitization of the `snapshot_path` parameter, allowing arbitrary file reads on the server. This affects the latest version of the stitionai/devika repository and can lead to unauthorized access to sensitive system files.

## PoC / Detection
Classification: info-leak

The template performs detection by issuing a GET request `GET /api/get-browser-snapshot?snapshot_path=/etc/passwd` and matching on:
- Body containing Linux passwd file signature (`root:.*:0:0:` regex)
- Response headers indicating file attachment (`attachment; filename=passwd` and `application/octet-stream`)
- HTTP 200 status code

This confirms the LFI by successfully retrieving a sensitive file.

## References
- https://huntr.com/bounties/7eec128b-1bf5-4922-a95c-551ad3695cf6
- https://github.com/stitionai/devika/commit/6acce21fb08c3d1123ef05df6a33912bf0ee77c2
- https://nvd.nist.gov/vuln/detail/CVE-2024-5334
