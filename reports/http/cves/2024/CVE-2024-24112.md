---
cve_id: CVE-2024-24112
template_path: nuclei-templates/http/cves/2024/CVE-2024-24112.yaml
affected_product: Exrick XMall
severity: critical
authentication: none
external_callback: false
affected_versions: 1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Exrick XMall v1.1 is vulnerable to SQL injection via the `orderDir` (mapped from `order[0][dir]`) parameter in the `/item/list` endpoint. 

Unauthenticated remote attackers can inject arbitrary SQL via a UNION SELECT payload, leading to extraction of sensitive database contents. The flaw is error-based, leveraging MySQL functions like `updatexml` to exfiltrate data through error messages. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-89. Vendor: exrick. Product confirmed via CPE and FOFA query `app="XMall-后台管理系统"`.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `/item/list` with parameters including a specially crafted `order[0][dir]` value: `desc)a+union+select+updatexml(1,concat(0x7e,{{md5(num)}},0x7e),1)%23`. It uses a random integer to generate an MD5 hash embedded in the payload. Detection matches on the response body containing both the computed MD5 value and the string "MySQLSyntaxErrorException" when status is 200.

## References
- https://github.com/Exrick/xmall/issues/78
- https://nvd.nist.gov/vuln/detail/CVE-2024-24112
