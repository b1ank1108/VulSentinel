---
cve_id: CVE-2024-5084
template_path: nuclei-templates/http/cves/2024/CVE-2024-5084.yaml
affected_product: Hash Form
severity: critical
authentication: none
external_callback: false
affected_versions: all versions up to, and including, 1.1.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Hash Form Drag & Drop Form Builder WordPress plugin versions up to and including 1.1.0 contains an arbitrary file upload vulnerability in the `file_upload_action` function due to missing file type validation. Unauthenticated attackers can upload arbitrary files to the affected site's server (specifically to `/wp-content/uploads/hashform/temp/`), which may make remote code execution possible.

## PoC / Detection
Classification: rce

The template detects the vulnerability through these steps:  
- Sends `GET /` to extract the `ajax_nounce` value from the response body using regex (`"ajax_nounce":"([0-9a-z]+)"`).  
- Performs a `POST /wp-admin/admin-ajax.php?action=hashform_file_upload_action&file_uploader_nonce=...&allowedExtensions%5B0%5D=txt&qqfile=...txt` uploading a randomly-named `.txt` file whose body is a unique MD5 string.  
- Follows up with `GET /wp-content/uploads/hashform/temp/{{filename}}.txt` to confirm the file was saved and contains the expected MD5 payload.  

Matchers require both the upload response to contain `"success","true","url"` (status 200) and the retrieved file to contain the MD5 string (status 200).

## References
- https://nvd.nist.gov/vuln/detail/CVE-2024-5084
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hash-form/hash-form-drag-drop-form-builder-110-unauthenticated-arbitrary-file-upload-to-remote-code-execution
- https://github.com/WOOOOONG/CVE-2024-5084/blob/main/CVE-2024-5084_exploit.py
