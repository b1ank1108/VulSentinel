---
cve_id: CVE-2024-56145
template_path: nuclei-templates/http/cves/2024/CVE-2024-56145.yaml
affected_product: Craft CMS
severity: critical
authentication: none
external_callback: false
affected_versions: <=5.5.2 (5.x), <=4.13.2 (4.x), <=3.9.14 (3.x)
preconditions: PHP register_argc_argv setting enabled
poc_classification: rce
---

## Vulnerability
Craft CMS contains a critical remote code execution vulnerability (CVE-2024-56145 / GHSA-2p6p-9rc9-62j9) due to improper handling of query parameters such as `--templatesPath` (and `--configPath`). These are misinterpreted as PHP CLI arguments when `register_argc_argv` is enabled, allowing unauthenticated attackers to load and execute arbitrary malicious Twig templates.  
**Impact:** Full unauthenticated RCE (CVSS 4.0: 9.3 / AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H).  
**Remediation:** Upgrade to >5.5.2 (5.x), >4.13.2 (4.x), or >3.9.14 (3.x); or disable PHP `register_argc_argv`.

## PoC / Detection
Classification: rce

The template detects the vulnerability by issuing a single GET request to `?--configPath=/nuclei_test/{{nonce}}` (where `{{nonce}}` is a 10-digit random integer) and matching on HTTP 503 status together with the nonce value plus PHP error strings ("mkdir()", "Permission denied", "No such file or directory") in the response body. This confirms the parameter is processed as a path argument, exposing the RCE vector (probe itself is non-destructive).

## References
- https://github.com/advisories/GHSA-2p6p-9rc9-62j9
- https://www.assetnote.io/resources/research/how-an-obscure-php-footgun-led-to-rce-in-craft-cms
- https://github.com/Chocapikk/CVE-2024-56145
- https://github.com/craftcms/cms/commit/82e893fb794d30563da296bca31379c0df0079b3
- https://github.com/craftcms/cms/security/advisories/GHSA-2p6p-9rc9-62j9
