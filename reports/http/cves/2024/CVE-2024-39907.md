---
cve_id: CVE-2024-39907
template_path: nuclei-templates/http/cves/2024/CVE-2024-39907.yaml
affected_product: 1Panel
severity: critical
authentication: required
external_callback: false
affected_versions: prior to 1.10.12-lts
preconditions: []
poc_classification: rce
---

## Vulnerability
1Panel (web-based Linux server management control panel) contains multiple authenticated SQL injection flaws caused by insufficient input filtering in several endpoints. These allow arbitrary SQL query execution, arbitrary file writes on the server filesystem, and ultimately full remote code execution (RCE). CVE-2024-39907 (CWE-89, CVSS 9.8). Resolved in 1.10.12-lts; no workarounds exist.

## PoC / Detection
Classification: rce

The template first authenticates by sending username/password to `/api/v1/auth/login` (with `ignoreCaptcha=true` and `authMethod=session`), extracts the session cookie, then sends a crafted POST to `/api/v1/hosts/command/search` injecting a multi-statement SQL payload into the `orderBy` parameter (`3;ATTACH DATABASE '/tmp/{{randstr}}.txt' AS test;create TABLE test.exp (data text);...`). It verifies exploitation success by checking that `body_2` contains both "SQL logic error" and "table exp already exists" while `header_1` contains the `psession` cookie.

## References
- https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-5grx-v727-qmq6
