---
cve_id: CVE-2024-21641
template_path: nuclei-templates/http/cves/2024/CVE-2024-21641.yaml
affected_product: Flarum
severity: medium
authentication: none
external_callback: true
affected_versions: < 1.8.5
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Flarum open source discussion platform software is affected by an open redirect in the `/logout` route. Prior to version 1.8.5 the `return` parameter is not sanitized, enabling any third party to force a redirect from the trusted Flarum domain to an arbitrary URL. Logged-in users must confirm logout before the redirect occurs; guests are redirected immediately. CVSS 4.7 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N), CWE-601. Unauthenticated attackers can craft phishing links that appear to originate from a legitimate Flarum installation.

## PoC / Detection
Classification: detect-only  
The template issues a single GET request to `{{BaseURL}}/logout?return=http://oast.pro` and applies an AND matcher requiring: HTTP 302 status, a `Location` header whose value matches the regex for an absolute redirect to the `oast.pro` domain, and the presence of a `Set-Cookie: flarum_session=` header. This probe confirms the redirect parameter is reflected without validation.

## References
- https://github.com/flarum/framework/security/advisories/GHSA-733r-8xcp-w9mr
- https://github.com/flarum/flarum-core/commit/ee8b3b4ad1413a2b0971fdd9e40f812d2a3a9d3a
- https://nvd.nist.gov/vuln/detail/CVE-2024-21641
