---
cve_id: CVE-2024-13221
template_path: nuclei-templates/http/cves/2024/CVE-2024-13221.yaml
affected_product: Fantastic ElasticSearch WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 4.1.0
preconditions: Plugin installed and active on WordPress; requires high-privilege user to visit crafted malicious URL while logged in
poc_classification: auth-bypass
---

## Vulnerability
Fantastic ElasticSearch WordPress plugin <= 4.1.0 suffers from reflected cross-site scripting via unsanitized output of the `tab` and `action` query parameters on the `/wp-admin/admin.php?page=elastic_search` endpoint (CWE-79).  

An attacker can craft a malicious link containing a breakout payload that, when visited by an authenticated high-privilege user (e.g., administrator), executes arbitrary JavaScript in that user's browser context. Impact includes session hijacking, credential theft, or privilege escalation inside the WordPress dashboard. CVSS 3.1 score 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Remediation is to update to 4.1.1 or later.

## PoC / Detection
Classification: auth-bypass

The template first authenticates by POSTing `log={{username}}&pwd={{password}}` to `/wp-login.php` and internally verifies the `wordpress_logged_in` cookie. It then sends a GET request to the admin page with a reflected XSS payload injected into the `tab` and `action` parameters (`index"></script><script>alert(document.domain)</script><script>`). Detection succeeds if the exact unsanitized payload string appears in the response body together with "ElasticSearch", `text/html` Content-Type, and HTTP 200.

## References
- https://wpscan.com/vulnerability/693f4cc4-a082-46bc-abc9-a08919f70157/
