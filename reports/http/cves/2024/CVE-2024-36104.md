---
cve_id: CVE-2024-36104
template_path: nuclei-templates/http/cves/2024/CVE-2024-36104.yaml
affected_product: Apache OFBiz
severity: critical
authentication: none
external_callback: false
affected_versions: before 18.12.14
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache OFBiz before 18.12.14 is vulnerable to path traversal (CWE-22) via the `/webtools/control/forgotPassword` endpoint. The flaw allows unauthenticated remote attackers to bypass directory restrictions using `../` sequences and reach the ProgramExport handler, enabling arbitrary Groovy script execution that results in remote code execution.

**CVSS 3.1 Score**: 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)  
**EPSS**: 0.93561 (99.825th percentile)  
**Impact**: Arbitrary command execution on the server, full system compromise, and access to sensitive data.

## PoC / Detection
Classification: rce

The template verifies exploitability by issuing two unauthenticated POST requests to the traversed path `/webtools/control/forgotPassword/%2e/%2e/ProgramExport` (using double-encoded `../`). Each request submits a `groovyProgram` form parameter containing URL-encoded Groovy that invokes `.execute().text` on system commands (`id` and `ipconfig`) inside a thrown Exception.  

Detection succeeds on any HTTP 200 response body that matches (via OR regex/word conditions):
- IPv4 address patterns (`IPv4 Address[\s.]*:\s*(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})`)
- Unix UID/GID patterns (`uid=\d+\(([^)]+)\) gid=\d+\(([^)]+)\)`)
- The string `java.lang.Exception`

## References
- http://www.openwall.com/lists/oss-security/2024/06/03/1
- https://issues.apache.org/jira/browse/OFBIZ-13092
- https://lists.apache.org/thread/sv0xr8b1j7mmh5p37yldy9vmnzbodz2o
- https://ofbiz.apache.org/download.html
- https://ofbiz.apache.org/security.html
