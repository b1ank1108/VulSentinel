---
cve_id: CVE-2024-6892
template_path: nuclei-templates/http/cves/2024/CVE-2024-6892.yaml
affected_product: Journyx
severity: medium
authentication: none
external_callback: false
affected_versions: 11.5.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected Cross-Site Scripting (XSS) in Journyx 11.5.4. Malicious URLs with XSS payloads in the `error_description` parameter of the `/jtcgi/r/adlogin/sso` endpoint cause arbitrary JavaScript execution in the victim's browser in the application's context (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N score 6.1; CWE-79, CWE-81). Impact includes potential data theft, session hijacking or phishing. Fixed by updating to 11.5.5 or later.

## PoC / Detection
Classification: info-leak
The template sends a single unauthenticated raw GET request to `/jtcgi/r/adlogin/sso?code=1337&state=foobar&id_token=zoinks&error_description=%3Csvg%2fonload%3dprompt(%27document.domain%27)%3E&error=error` and verifies the vulnerability if the response body contains the unsanitized payload reflected inside `<P>error <B><svg/onload=prompt('document.domain')></B></P>` along with the string "journyx" and `content-type: text/html`.

## References
- https://korelogic.com/Resources/Advisories/KL-001-2024-009.txt
- http://seclists.org/fulldisclosure/2024/Aug/7
- https://github.com/fkie-cad/nvd-json-data-feeds
