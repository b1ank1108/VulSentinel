---
cve_id: CVE-2024-20419
template_path: nuclei-templates/http/cves/2024/CVE-2024-20419.yaml
affected_product: Cisco SSM On-Prem
severity: critical
authentication: none
external_callback: false
affected_versions: <= 8-202206
preconditions: []
poc_classification: state-change
---

## Vulnerability
Cisco Smart Software Manager On-Prem (SSM On-Prem) <= 8-202206 contains an authentication flaw (CWE-620) due to improper implementation of the password-change process. An unauthenticated remote attacker can reset the password of any user account, including administrative accounts.

**CVSS**: 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)  
**Impact**: Attacker gains full access to the web UI or API using the compromised user’s privileges.

## PoC / Detection
Classification: state-change

The template executes a 4-request flow that fully exploits the flaw on the built-in “admin” account:  
1. GET /backend/settings/oauth_adfs?hostname=polar (extracts XSRF token)  
2. POST /backend/reset_password/generate_code with uid=admin (obtains auth_token)  
3. POST /backend/reset_password with new random password (confirms status=OK)  
4. POST /backend/auth/identity/callback with the new credentials (verifies session_key + role, extracts USER:PASS pair).  

The probe is intrusive and changes the target password.

## References
- https://www.0xpolar.com/blog/CVE-2024-20419
- https://nvd.nist.gov/vuln/detail/CVE-2024-20419
- https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cssm-auth-sLw3uhUy
- https://www.secpod.com/blog/critical-flaw-in-ciscos-secure-email-gateways-allows-attackers-to-control-the-device-completely/
- https://github.com/fkie-cad/nvd-json-data-feeds
