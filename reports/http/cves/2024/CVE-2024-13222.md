---
cve_id: CVE-2024-13222
template_path: nuclei-templates/http/cves/2024/CVE-2024-13222.yaml
affected_product: WordPress User Messages plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 1.2.4
preconditions: Plugin must be installed and active on a WordPress site; requires a high-privilege authenticated user to visit the maliciously crafted URL
poc_classification: auth-bypass
---

## Vulnerability
WordPress User Messages plugin <= 1.2.4 suffers from a reflected cross-site scripting vulnerability due to missing sanitization and escaping of the `view` and `filter_type` query parameters in `/wp-admin/admin.php?page=user-messages`. Attackers can craft a malicious URL that, when visited by a logged-in high-privilege user (administrator or equivalent), executes arbitrary JavaScript in the victim's browser context. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Impact includes session hijacking or privilege escalation.

## PoC / Detection
Classification: auth-bypass

The template first authenticates by sending a POST to `/wp-login.php` with supplied `username`/`password` credentials and confirms success via a 302 redirect containing the `wordpress_logged_in` cookie. It then sends a GET request to the vulnerable admin endpoint with reflected XSS payloads injected into the `view` (`%22%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E`) and `filter_type` (`testxss%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`) parameters. The request is detected as vulnerable if the 200 response body contains both the unsanitized `<script>alert(document.domain)</script>` string and the plugin identifier "user-messages".

## References
- https://wpscan.com/vulnerability/069e1f81-448d-4d27-b288-87111dade2f2/
- https://nvd.nist.gov/vuln/detail/CVE-2024-13222
