---
cve_id: CVE-2024-55591
template_path: nuclei-templates/http/cves/2024/CVE-2024-55591.yaml
affected_product: Fortinet FortiOS and FortiProxy
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Fortinet FortiOS (and FortiProxy) is affected by CVE-2024-55591: an authentication bypass (CWE-288) that manifests as information disclosure. Unauthenticated remote attackers can retrieve sensitive system information by requesting the exposed `/service-worker.js` endpoint, potentially leading to full unauthorized system access.  
Impact: bypass of authentication mechanisms granting access to sensitive data and systems.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: update FortiOS and FortiProxy to patched versions per Fortinet advisory.

## PoC / Detection
Classification: auth-bypass

The template uses a two-step HTTP flow to detect the flaw.  
1. GET `{{BaseURL}}/login?redir=/ng` (max 2 redirects, host-redirects enabled) with internal matcher for `<html class="main-app">` to fingerprint a valid Fortinet web UI.  
2. Raw GET `/service-worker.js?local_access_token={{randstr}}` with AND matchers confirming: HTTP 200, `application/javascript` Content-Type, and body containing both `api/v2/static` and `self.addEventListener`.  
Positive match indicates the authentication bypass is present (service-worker.js accessible without credentials).

## References
- https://github.com/watchtowrlabs/fortios-auth-bypass-poc-CVE-2024-55591/blob/main/CVE-2024-55591-PoC.py
- https://nvd.nist.gov/vuln/detail/cve-2024-55591
