---
cve_id: CVE-2009-1151
template_path: nuclei-templates/http/cves/2009/CVE-2009-1151.yaml
affected_product: PhpMyAdmin Scripts
severity: high
authentication: none
external_callback: false
affected_versions: 2.11.x before 2.11.9.5 and 3.x before 3.1.3.1
preconditions: []
poc_classification: rce
---

## Vulnerability
PhpMyAdmin Scripts 2.11.x before 2.11.9.5 and 3.x before 3.1.3.1 contain a remote code execution vulnerability in setup.php. Unauthenticated remote attackers can inject arbitrary PHP code into a configuration file via the save action. Combined with the ability to save files on the server, this allows execution of arbitrary PHP code (CVE-2009-1151).  
CVSS: 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P) | CWE-94.

## PoC / Detection
Classification: rce  
The template sends a single unauthenticated POST to `/scripts/setup.php` with `action=test` and `configuration=O:10:"PMA_Config":1:{s:6:"source",s:11:"/etc/passwd";}` (PHP serialized object). It verifies success via HTTP 200 status and regex match for `root:.*:0:0:` in the response body, confirming the configuration-processing flaw that enables arbitrary PHP code injection and RCE.

## References
- https://www.phpmyadmin.net/security/PMASA-2009-3/
- https://github.com/vulhub/vulhub/tree/master/phpmyadmin/WooYun-2016-199433
- http://phpmyadmin.svn.sourceforge.net/viewvc/phpmyadmin/branches/MAINT_2_11_9/phpMyAdmin/scripts/setup.php?r1=11514&r2=12301&pathrev=12301
- http://www.phpmyadmin.net/home_page/security/PMASA-2009-3.php
- https://nvd.nist.gov/vuln/detail/CVE-2009-1151
