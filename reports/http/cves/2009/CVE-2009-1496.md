---
cve_id: CVE-2009-1496
template_path: nuclei-templates/http/cves/2009/CVE-2009-1496.yaml
affected_product: Joomla! Cmimarketplace
severity: medium
authentication: none
external_callback: false
affected_versions: 0.1
preconditions: com_cmimarketplace component installed
poc_classification: info-leak
---

## Vulnerability
Joomla! Cmimarketplace 0.1 (com_cmimarketplace component) is vulnerable to local file inclusion via path traversal. The component fails to sanitize the `viewit` parameter in `index.php`, allowing remote attackers to supply `../` sequences to list arbitrary directories or read files such as `/etc/passwd`.

CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N (5.0) | CWE-22.

Successful exploitation leads to unauthorized access to sensitive files and potential remote code execution.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by sending a single unauthenticated GET request to `{{BaseURL}}/index.php?option=com_cmimarketplace&Itemid=70&viewit=/../../../../../../etc/passwd&cid=1` and checking that the HTTP response status is 200 while the body matches the regex `root:.*:0:0:` (confirming the root user entry from `/etc/passwd` was successfully included).

## References
- https://www.exploit-db.com/exploits/8367
- https://nvd.nist.gov/vuln/detail/CVE-2009-1496
- https://github.com/ARPSyndicate/kenzer-templates
