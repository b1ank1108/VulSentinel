---
cve_id: CVE-2006-2842
template_path: nuclei-templates/http/cves/2006/CVE-2006-2842.yaml
affected_product: Squirrelmail
severity: high
authentication: none
external_callback: false
affected_versions: <=1.4.6
preconditions: register_globals enabled and magic_quotes_gpc disabled
poc_classification: info-leak
---

## Vulnerability
SquirrelMail <=1.4.6 suffers from a PHP local file inclusion vulnerability in `functions/plugin.php`. The issue is present when `register_globals` is enabled and `magic_quotes_gpc` is disabled, allowing remote unauthenticated attackers to inject a URL into the `plugins` array parameter and include arbitrary local files.

This enables reading of sensitive server files (such as `/etc/passwd`) and, in some configurations, execution of arbitrary PHP code.  
Impact: unauthorized file disclosure leading to information leakage or further compromise.  
Remediation: upgrade to a version higher than 1.4.6 or apply the vendor patches.  
CVSS v2: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P) | CWE-22.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/src/redirect.php?plugins[]=../../../../etc/passwd%00` and verifies success via an HTTP 200 response containing the regex pattern `root:[x*]:0:0` (signature from `/etc/passwd`). This directly confirms the LFI/path-traversal flaw by triggering unauthorized local file disclosure.

## References
- https://www.exploit-db.com/exploits/27948
- http://squirrelmail.cvs.sourceforge.net/squirrelmail/squirrelmail/functions/global.php?r1=1.27.2.16&r2=1.27.2.17&view=patch&pathrev=SM-1_4-STABLE
- http://www.squirrelmail.org/security/issue/2006-06-01
- https://nvd.nist.gov/vuln/detail/CVE-2006-2842
- ftp://patches.sgi.com/support/free/security/advisories/20060703-01-U.asc
