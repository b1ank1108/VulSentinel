---
cve_id: CVE-2007-4556
template_path: nuclei-templates/http/cves/2007/CVE-2007-4556.yaml
affected_product: OpenSymphony XWork/Apache Struts2
severity: medium
authentication: none
external_callback: false
affected_versions: OpenSymphony XWork before 1.2.3, and 2.x before 2.0.4 (as used in WebWork and Apache Struts)
preconditions: altSyntax enabled
poc_classification: rce
---

## Vulnerability
Apache Struts support in OpenSymphony XWork before 1.2.3 and 2.x before 2.0.4 (as used in WebWork and Apache Struts) recursively evaluates all input as an Object-Graph Navigation Language (OGNL) expression when altSyntax is enabled. This allows remote attackers to cause a denial of service (infinite loop) or execute arbitrary code via form input beginning with a "%{" sequence and ending with a "}" character.

CVSS v2: 6.8 (AV:N/AC:M/Au:N/C:P/I:P/A:P)  
Impact: Remote code execution  
Remediation: Update to the latest version of Apache Struts2

## PoC / Detection
Classification: rce

The template performs an active exploit check by sending a single POST request to `/login.action` with a URL-encoded form body where the `password` parameter contains a crafted OGNL expression. The payload instantiates `java.lang.ProcessBuilder` to execute `cat /etc/passwd`, redirects error stream, reads the output via `BufferedReader`, and writes it to the HTTP response using the servlet writer. Detection succeeds on HTTP 200 status combined with regex match `root:.*:0:0:` in the response body, confirming command execution and leakage of the root user entry.

## References
- https://www.guildhab.top/?p=2326
- https://nvd.nist.gov/vuln/detail/CVE-2007-4556
- https://cwiki.apache.org/confluence/display/WW/S2-001
- http://forums.opensymphony.com/ann.jspa?annID=54
- http://issues.apache.org/struts/browse/WW-2030
