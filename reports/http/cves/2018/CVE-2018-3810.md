---
cve_id: CVE-2018-3810
template_path: nuclei-templates/http/cves/2018/CVE-2018-3810.yaml
affected_product: Oturia WordPress Smart Google Code Inserter
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.5
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Oturia WordPress Smart Google Code Inserter plugin before 3.5 contains an authentication bypass (CWE-287) in `saveGoogleCode()` (`smartgooglecode.php`). The function performs no authorization check on the `sgcgoogleanalytic` parameter, allowing any unauthenticated attacker to overwrite the Google Analytics/HTML insertion setting. Injected JavaScript/HTML executes persistently on every page served by the WordPress site. CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Impact: full plugin configuration takeover and persistent client-side code execution for all visitors.

## PoC / Detection
Classification: auth-bypass

The template sends a POST to `{{BaseURL}}/wp-admin/options-general.php?page=smartcode` containing the body `sgcgoogleanalytic=<script>console.log("document.domain")</script>&sgcwebtools=&button=Save+Changes&action=savegooglecode` (no credentials, Content-Type application/x-www-form-urlencoded). It then issues a GET to `{{BaseURL}}` and verifies the exact test script tag appears in the response body (status 200 + text/html Content-Type).

## References
- https://www.exploit-db.com/exploits/43420
- https://nvd.nist.gov/vuln/detail/CVE-2018-3810
- https://wordpress.org/plugins/smart-google-code-inserter/#developers
- https://limbenjamin.com/articles/smart-google-code-inserter-auth-bypass.html
- https://wpvulndb.com/vulnerabilities/8987
