---
cve_id: CVE-2018-19276
template_path: nuclei-templates/http/cves/2018/CVE-2018-19276.yaml
affected_product: OpenMRS Platform
severity: critical
authentication: none
external_callback: true
affected_versions: < 2.24.0
preconditions: []
poc_classification: rce
---

## Vulnerability

OpenMRS Platform versions prior to 2.24.0 contain an insecure object deserialization vulnerability (CWE-502) that allows unauthenticated remote attackers to execute arbitrary system commands. The vulnerability exists in the REST API endpoint (`/ws/rest/v1/`) which accepts XML-formatted request bodies. When specially crafted XML data containing malicious serialized Java objects is submitted, the application deserializes the payload without proper validation, leading to remote code execution.

The vulnerability leverages Groovy's `Expando` class and `MethodClosure` to construct a deserialization gadget chain that invokes `ProcessBuilder` to execute arbitrary commands on the underlying operating system. This represents a complete compromise of the affected system, potentially exposing sensitive patient healthcare data and allowing full control over the OpenMRS installation.

The CVSS v3.1 score is 9.8 (Critical) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-based exploitation requiring no privileges or user interaction, with high impact to confidentiality, integrity, and availability. The EPSS score of 0.93328 (99.802nd percentile) indicates this vulnerability is actively exploited in the wild.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to the OpenMRS REST API endpoint (`/ws/rest/v1/xxxxxx`) with a malicious XML payload containing a serialized Java object deserialization gadget chain. The payload constructs a `ProcessBuilder` object configured to execute a `curl` command that makes an HTTP request to an Interactsh callback URL.

The template tests two common deployment paths: the root path and `/openmrs`. Detection is confirmed when:
1. A DNS or HTTP callback is received at the Interactsh server (indicating command execution)
2. The response has a `Content-Type` of `application/json`
3. The response body contains the string `"message":` (typical of OpenMRS error responses)

The template uses `stop-at-first-match: true` to halt testing once a vulnerable instance is identified. The successful callback demonstrates that arbitrary commands can be executed on the target system without authentication.

## References

- http://packetstormsecurity.com/files/155691/OpenMRS-Java-Deserialization-Remote-Code-Execution.html
- https://know.bishopfox.com/advisories/news/2019/02/openmrs-insecure-object-deserialization
- https://nvd.nist.gov/vuln/detail/CVE-2018-19276
