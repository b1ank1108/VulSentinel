---
cve_id: CVE-2018-18778
template_path: nuclei-templates/http/cves/2018/CVE-2018-18778.yaml
affected_product: ACME mini_httpd
severity: medium
authentication: none
external_callback: false
affected_versions: <1.30
preconditions: []
poc_classification: info-leak
---

## Vulnerability

ACME mini_httpd versions prior to 1.30 are vulnerable to local file inclusion (LFI). This vulnerability allows remote attackers to read arbitrary files on the server without authentication. The flaw is classified as CWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) with a CVSS v3.0 score of 6.5 (Medium severity). The vulnerability enables unauthorized access to sensitive files on the server's filesystem, potentially exposing configuration files, credentials, and other confidential data.

## PoC / Detection

Classification: info-leak

The template performs a two-stage detection process:

1. **Fingerprinting Stage**: Sends a GET request to the base URL and checks for the presence of "Server: mini_httpd" in the response headers to confirm the target is running mini_httpd.

2. **Exploitation Verification**: If mini_httpd is detected, the template sends a crafted GET request directly to `/etc/passwd` using an unsafe HTTP request. The template verifies successful exploitation by:
   - Checking for the regex pattern `root:.*:0:0:` in the response body (indicating the passwd file contents)
   - Confirming a 200 OK status code

The detection confirms the LFI vulnerability by successfully retrieving the contents of the `/etc/passwd` file, demonstrating unauthorized file system access.

## References

- https://www.acunetix.com/vulnerabilities/web/acme-mini_httpd-arbitrary-file-read/
- http://www.acme.com/software/mini_httpd/
- https://nvd.nist.gov/vuln/detail/CVE-2018-18778
- https://github.com/0xT11/CVE-POC
- https://github.com/ARPSyndicate/cvemon
