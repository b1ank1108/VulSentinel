---
cve_id: CVE-2018-5233
template_path: nuclei-templates/http/cves/2018/CVE-2018-5233.yaml
affected_product: Grav CMS
severity: medium
authentication: none
external_callback: false
affected_versions: <1.3.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-5233 is a reflected cross-site scripting (XSS) vulnerability in Grav CMS versions prior to 1.3.0. The vulnerability exists in the `system/src/Grav/Common/Twig/Twig.php` component and allows remote attackers to inject arbitrary web script or HTML via the PATH_INFO parameter to the `/admin/tools` endpoint. The flaw stems from improper input sanitization, enabling attackers to craft malicious URLs that execute JavaScript in victims' browsers when accessed. This can lead to session hijacking, credential theft, or unauthorized actions performed on behalf of authenticated users. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity), requiring user interaction but no authentication to exploit.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the `/admin/tools` endpoint with a crafted PATH_INFO parameter containing an XSS payload: `a--</script><script>alert(document.domain)</script>`. The template verifies the vulnerability by checking for multiple conditions:

1. The injected payload (`</script><script>alert(document.domain)</script>`) is reflected in the response body without proper sanitization
2. The response contains Grav CMS indicators (such as `/themes/grav`, `Grav Admin Login`, or `data-grav-` attributes)
3. The response has a `text/html` content type
4. The server returns a 200 OK status code

All conditions must be met for a positive detection. The template uses a harmless `alert(document.domain)` payload to verify the XSS condition without causing actual harm, demonstrating that arbitrary JavaScript can be executed in the context of the application.

## References

- https://sysdream.com/news/lab/2018-03-15-cve-2018-5233-grav-cms-admin-plugin-reflected-cross-site-scripting-xss-vulnerability/
- http://www.openwall.com/lists/oss-security/2018/03/15/1
- https://nvd.nist.gov/vuln/detail/CVE-2018-5233
- https://github.com/ARPSyndicate/kenzer-templates
