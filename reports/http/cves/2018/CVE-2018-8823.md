---
cve_id: CVE-2018-8823
template_path: nuclei-templates/http/cves/2018/CVE-2018-8823.yaml
affected_product: PrestaShop Responsive Mega Menu Module
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0.32
preconditions: [Responsive Mega Menu Pro module installed on PrestaShop]
poc_classification: rce
---

## Vulnerability
The PrestaShop Responsive Mega Menu Module (Responsive Mega Menu Pro 1.0.32) is affected by CVE-2018-8823, a remote code execution and SQL injection vulnerability in `modules/bamegamenu/ajax_phpcode.php`. The `code` parameter is passed directly to PHP evaluation, allowing remote attackers to execute arbitrary PHP code or SQL commands.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8).  
Impact: Unauthenticated attackers achieve full PrestaShop compromise and customer data access.  
Remediation: Remove the vulnerable Responsive Mega Menu Pro module or upgrade to a patched version.

## PoC / Detection
Classification: rce  
The template issues a GET request to `{{BaseURL}}/modules/bamegamenu/ajax_phpcode.php?code=print(md5(999999999))` and matches for the literal MD5 hash of 999999999 in the response body alongside HTTP 200 status. This harmless probe confirms the `code` parameter is evaluated as PHP on the server, verifying the RCE condition.

## References
- https://vulners.com/openvas/OPENVAS:1361412562310144185
- https://www.openservis.cz/prestashop-blog/nejcastejsi-utoky-v-roce-2023-seznam-deravych-modulu-nemate-nejaky-z-nich-na-e-shopu-i-vy/
- https://github.com/advisories/GHSA-q937-6mg8-6rgc
- https://nvd.nist.gov/vuln/detail/CVE-2018-8823
- https://github.com/zapalm/prestashop-security-vulnerability-checker
