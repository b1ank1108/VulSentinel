---
cve_id: CVE-2018-19458
template_path: nuclei-templates/http/cves/2018/CVE-2018-19458.yaml
affected_product: PHP Proxy
severity: high
authentication: none
external_callback: false
affected_versions: 3.0.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

PHP Proxy version 3.0.3 contains a local file inclusion (LFI) vulnerability that allows unauthenticated attackers to read arbitrary files from the server. The vulnerability exists in the `index.php` endpoint, which improperly handles the `q` parameter when processing `file://` protocol URIs. This flaw enables attackers to bypass access controls and read sensitive files from the server's filesystem, including system configuration files. The vulnerability is distinct from CVE-2018-19246 and is classified under CWE-287 (Improper Authentication), with a CVSS v3.0 score of 7.5 (High severity). The attack vector is network-based, requires low complexity, no privileges, and no user interaction.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to `/index.php?q=file:///etc/passwd`, attempting to exploit the LFI flaw to read the Unix password file. The detection mechanism verifies successful exploitation through two conditions:

1. The response body contains a regex pattern matching `root:.*:0:0:`, which is characteristic of the `/etc/passwd` file format showing the root user entry
2. The HTTP response status code is 200, indicating successful file retrieval

If both conditions are met, the vulnerability is confirmed, demonstrating that the application improperly processes file protocol URIs and allows unauthorized file system access.

## References

- https://www.exploit-db.com/exploits/45780
- https://pentest.com.tr/exploits/PHP-Proxy-3-0-3-Local-File-Inclusion.html
- https://nvd.nist.gov/vuln/detail/CVE-2018-19458
- https://www.exploit-db.com/exploits/45780/
- https://github.com/ARPSyndicate/kenzer-templates
