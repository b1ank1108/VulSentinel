---
cve_id: CVE-2018-5230
template_path: nuclei-templates/http/cves/2018/CVE-2018-5230.yaml
affected_product: Atlassian Jira Confluence
severity: medium
authentication: none
external_callback: false
affected_versions: <7.6.6, 7.7.0-7.7.3, 7.8.0-7.8.3, 7.9.0-7.9.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-5230 is a reflected cross-site scripting (XSS) vulnerability in Atlassian Jira Confluence. The vulnerability exists in the error message handling of custom fields when an invalid value is specified. Remote attackers can inject arbitrary HTML or JavaScript code through specially crafted requests to vulnerable endpoints. The flaw affects multiple version ranges: versions before 7.6.6, versions 7.7.0 through 7.7.3, versions 7.8.0 through 7.8.3, and versions 7.9.0 through 7.9.1.

Successful exploitation allows attackers to execute arbitrary script code in the context of a victim's browser session. This can lead to session hijacking, credential theft, data exfiltration, or other malicious activities performed with the victim's privileges. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity). The attack vector is network-based, requires low attack complexity, no privileges, but does require user interaction (UI:R) and has a changed scope (S:C).

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to a specific Confluence endpoint with an XSS payload embedded in the URL path: `/pages/includes/status-list-mo<iframe src="javascript:alert(document.domain)">.vm`. The payload attempts to inject an iframe element with JavaScript code.

The template verifies the vulnerability through three conditions:
1. The response body contains the reflected XSS payload `<iframe src="javascript:alert(document.domain)">` and the string "confluence"
2. The response Content-Type header is `text/html`
3. The HTTP status code is 200

If all conditions are met, the template confirms that the application is vulnerable to reflected XSS, indicating that user input is not properly sanitized before being rendered in error messages.

## References

- https://jira.atlassian.com/browse/JRASERVER-67289
- https://nvd.nist.gov/vuln/detail/CVE-2018-5230
- https://github.com/sushantdhopat/JIRA_testing
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/Faizee-Asad/JIRA-Vulnerabilities
