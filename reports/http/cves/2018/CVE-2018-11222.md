---
cve_id: CVE-2018-11222
template_path: nuclei-templates/http/cves/2018/CVE-2018-11222.yaml
affected_product: Pandora FMS
severity: high
authentication: none
external_callback: false
affected_versions: <=7.0NG.722
preconditions: []
poc_classification: rce
---

## Vulnerability
Pandora FMS <=7.0NG.722 is vulnerable to unauthenticated remote code execution. The issue arises from chaining an unrestricted file upload (associated with CVE-2018-11221) and local file inclusion (CVE-2018-11222). Attackers can upload a malicious PHP plugin and execute it via LFI for full server compromise.

Impact: Complete server takeover by unauthenticated attackers, including access to managed systems.

Remediation: Upgrade to version 7.0NG.723 or later.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5) | CWE-20

## PoC / Detection
Classification: rce

The template verifies exploitability through a two-request chain:
1. POST multipart upload of a ZIP (plugin.oum) containing `phpinfo.php` with a random base64 marker to `/pandora_console/ajax.php?page=include/ajax/update_manager.ajax&upload_file=true`. Matches for success status and extracts package path.
2. GET to the LFI path `/pandora_console/ajax.php?page=[extracted_path]/plugin/phpinfo` to execute the PHP and confirm marker presence in response.

This demonstrates arbitrary PHP execution without authentication or OOB interactions.

## References
- https://blog.hackercat.ninja/post/pandoras_box/
- https://github.com/pandorafms/pandorafms
- https://nvd.nist.gov/vuln/detail/CVE-2018-11222
