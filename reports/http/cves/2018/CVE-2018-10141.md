---
cve_id: CVE-2018-10141
template_path: nuclei-templates/http/cves/2018/CVE-2018-10141.yaml
affected_product: Palo Alto Networks PAN-OS GlobalProtect
severity: medium
authentication: none
external_callback: false
affected_versions: before 8.1.4
preconditions: GlobalProtect Portal enabled
poc_classification: info-leak
---

## Vulnerability

Palo Alto Networks PAN-OS GlobalProtect Portal Login page (before 8.1.4) allows unauthenticated reflected cross-site scripting via the `user` parameter on `/global-protect/login.esp`. Attacker can inject arbitrary JavaScript/HTML that executes in the victim's browser context (changed scope).

CVSS:3.0 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) • CWE-79 • EPSS 0.44152 (97.465th percentile).

Impact: session hijacking, credential theft, page defacement, or client-side actions.  
Remediation: upgrade to PAN-OS 8.1.4 or later.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET to `{{BaseURL}}/global-protect/login.esp?user=j%22;-alert(1)-%22x` and confirms the vulnerability if the response body reflects the unsanitized payload inside `var valueUser = "j";-alert(1)-"x";` (JS context breakout), returns status 200, and serves `text/html`.

## References
- https://security.paloaltonetworks.com/CVE-2018-10141
- https://nvd.nist.gov/vuln/detail/CVE-2018-10141
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Elsfa7-110/kenzer-templates
