---
cve_id: CVE-2018-16836
template_path: nuclei-templates/http/cves/2018/CVE-2018-16836.yaml
affected_product: Rubedo CMS
severity: critical
authentication: none
external_callback: false
affected_versions: <=3.4.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Rubedo CMS through 3.4.0 contains a directory traversal vulnerability (CWE-22) in the theme component. Unauthenticated attackers can read and execute arbitrary files outside the service root path, demonstrated by the URI `/theme/default/img/%2e%2e/..//etc/passwd`.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Impact: arbitrary file read on the server.  
Remediation: upgrade to Rubedo CMS >=3.4.1 or apply the security patch.

## PoC / Detection
Classification: info-leak  
The template sends a single GET request to `{{BaseURL}}/theme/default/img/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd` and matches on HTTP status 200 combined with the regex `root:.*:0:0:` to confirm successful path traversal to `/etc/passwd`.

## References
- https://www.exploit-db.com/exploits/45385
- https://nvd.nist.gov/vuln/detail/CVE-2018-16836
- https://github.com/maroueneboubakri/CVE/tree/master/rubedo-cms
- https://www.exploit-db.com/exploits/45385/
- https://github.com/ARPSyndicate/kenzer-templates
