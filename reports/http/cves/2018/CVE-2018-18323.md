---
cve_id: CVE-2018-18323
template_path: nuclei-templates/http/cves/2018/CVE-2018-18323.yaml
affected_product: Centos Web Panel
severity: high
authentication: none
external_callback: false
affected_versions: 0.9.8.480
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Centos Web Panel version 0.9.8.480 suffers from a local file inclusion (LFI) vulnerability via insufficient sanitization of the `file` parameter in the `admin/index.php?module=file_editor` endpoint. CVE-2018-18323 (CWE-22) allows unauthenticated remote attackers to traverse directories and read arbitrary sensitive files on the server filesystem. The same version is also affected by XSS and RCE.  

Impact: Successful exploitation allows an attacker to read sensitive files on the server.  
CVSS v3.0: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).  
Remediation: Upgrade to a patched version of Centos Web Panel.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/admin/index.php?module=file_editor&file=/../../../../../../../../../../../etc/passwd` and verifies success via an HTTP 200 response containing the regex pattern `root:[x*]:0:0` (confirming inclusion of `/etc/passwd`).

## References
- https://packetstormsecurity.com/files/149795/Centos-Web-Panel-0.9.8.480-XSS-LFI-Code-Execution.html
- http://centos-webpanel.com/
- https://seccops.com/centos-web-panel-0-9-8-480-multiple-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2018-18323
- https://github.com/ARPSyndicate/kenzer-templates
