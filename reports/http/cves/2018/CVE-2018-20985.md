---
cve_id: CVE-2018-20985
template_path: nuclei-templates/http/cves/2018/CVE-2018-20985.yaml
affected_product: WordPress Payeezy Pay plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.97
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-20985 is a local file inclusion (LFI) vulnerability in the WordPress Payeezy Pay plugin version 2.97 and earlier. The vulnerability exists because the plugin fails to sufficiently verify user-supplied input in the `donate.php` file. An unauthenticated attacker can exploit this flaw to include and read arbitrary local files from the server, potentially exposing sensitive information such as database credentials, configuration files, and other critical data. The CVSS score of 9.8 (Critical) reflects the severity of this vulnerability, which requires no authentication, has low attack complexity, and can lead to high impact on confidentiality, integrity, and availability.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a POST request to `/wp-content/plugins/wp-payeezy-pay/donate.php` with a body parameter `x_login=../../../wp-config`. This payload attempts to traverse the directory structure and include the WordPress configuration file (`wp-config.php`). The template verifies successful exploitation by checking for three specific strings in the response body that are characteristic of the WordPress configuration file: "The base configuration for WordPress", "define( 'DB_NAME',", and "define( 'DB_PASSWORD',". A successful match with HTTP status 200 confirms the presence of the vulnerability and the ability to read sensitive local files.

## References

- https://www.pluginvulnerabilities.com/2018/12/06/our-improved-proactive-monitoring-has-now-caught-a-local-file-inclusion-lfi-vulnerability-as-well/
- https://wordpress.org/plugins/wp-payeezy-pay/#developers
- https://nvd.nist.gov/vuln/detail/CVE-2018-20985
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
