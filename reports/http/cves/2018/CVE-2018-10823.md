---
cve_id: CVE-2018-10823
template_path: nuclei-templates/http/cves/2018/CVE-2018-10823.yaml
affected_product: D-Link Router Firmware (DWR-116, DWR-512, DWR-712, DWR-912, DWR-921, DWR-111)
severity: high
authentication: required
external_callback: false
affected_versions: DWR-116 ≤1.06, DWR-512 ≤2.02, DWR-712 ≤2.02, DWR-912 ≤2.02, DWR-921 ≤2.02, DWR-111 ≤1.01
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2018-10823 is a remote command injection vulnerability affecting multiple D-Link router models. The vulnerability exists in the `chkisg.htm` page where the `Sip` parameter is not properly sanitized, allowing an authenticated attacker to inject arbitrary shell commands. The flaw is classified as CWE-78 (OS Command Injection) and has a CVSS v3.1 score of 8.8 (High severity).

The vulnerability allows attackers to execute arbitrary operating system commands with the privileges of the web server process, leading to full control over the device internals. This can result in unauthorized access to sensitive data, modification of router configurations, installation of malicious firmware, and complete compromise of the affected device. The attack vector is network-based with low attack complexity, requiring only low-level authentication but no user interaction.

Affected models include D-Link DWR-116 (through firmware 1.06), DWR-512, DWR-712, DWR-912, DWR-921 (all through firmware 2.02), and DWR-111 (through firmware 1.01). The EPSS score of 0.9396 (99.88th percentile) indicates this vulnerability has an extremely high probability of exploitation in the wild.

## PoC / Detection

Classification: rce

The Nuclei template detects this vulnerability by sending a GET request to the vulnerable `chkisg.htm` endpoint with a malicious payload injected into the `Sip` parameter. The detection payload uses URL encoding to inject a command that attempts to read the `/etc/passwd` file:

`/chkisg.htm%3FSip%3D1.1.1.1%20%7C%20cat%20%2Fetc%2Fpasswd`

This translates to: `chkisg.htm?Sip=1.1.1.1 | cat /etc/passwd`

The pipe character (`|`) allows command chaining, executing `cat /etc/passwd` after the intended IP address parameter. The template confirms successful exploitation by:
1. Checking for a 200 HTTP status code
2. Matching the regex pattern `root:.*:0:0:` in the response body, which indicates the `/etc/passwd` file contents were successfully retrieved

This detection method verifies the presence of command injection by demonstrating arbitrary command execution capability, though it uses a read-only command for safe detection purposes.

## References

- https://www.exploit-db.com/exploits/45676
- https://nvd.nist.gov/vuln/detail/CVE-2018-10823
- https://seclists.org/fulldisclosure/2018/Oct/36
- http://sploit.tech/2018/10/12/D-Link.html
- https://github.com/ARPSyndicate/kenzer-templates
