---
cve_id: CVE-2018-8024
template_path: nuclei-templates/http/cves/2018/CVE-2018-8024.yaml
affected_product: Apache Spark
severity: medium
authentication: none
external_callback: false
affected_versions: < 2.3.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Apache Spark UI versions prior to 2.3.2 contain a reflected cross-site scripting (XSS) vulnerability in the `/jobs/` endpoint. The vulnerability exists due to insufficient sanitization of query string parameters, allowing attackers to inject arbitrary JavaScript code that executes in the context of a victim's browser session. This is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation). The CVSS v3.0 score is 6.1 (Medium), with the attack vector being network-based, requiring no privileges but user interaction, and having a changed scope with low confidentiality and integrity impact.

Successful exploitation enables attackers to execute malicious JavaScript in victims' browsers, potentially leading to session cookie theft, credential harvesting, or performing unauthorized actions on behalf of authenticated users.

## PoC / Detection

Classification: info-leak

The template detects this XSS vulnerability by sending a GET request to the `/jobs/` endpoint with a crafted query string parameter containing an XSS payload: `?"'><script>alert(document.domain)</script>`. The template tests both the standard BaseURL and port 4040 (common Spark UI port).

The detection logic verifies three conditions:
1. HTTP response status is 200
2. Content-Type header contains 'text/html'
3. Response body contains both the injected script payload (`><script>alert(document.domain)</script>`) and the string 'Spark Jobs' (confirming the Spark UI context)

If all conditions are met, the vulnerability is confirmed as the unsanitized payload is reflected in the HTML response, demonstrating that arbitrary JavaScript can be injected and executed.

## References

- https://github.com/RhinoSecurityLabs/CVEs/tree/master/CVE-2018-8024
- https://nvd.nist.gov/vuln/detail/CVE-2018-8024
