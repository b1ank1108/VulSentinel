---
cve_id: CVE-2018-5316
template_path: nuclei-templates/http/cves/2018/CVE-2018-5316.yaml
affected_product: SagePay Server Gateway for WooCommerce
severity: medium
authentication: none
external_callback: false
affected_versions: <1.0.9
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-5316 is a reflected cross-site scripting (XSS) vulnerability in the WordPress SagePay Server Gateway for WooCommerce plugin versions prior to 1.0.9. The vulnerability exists in the `includes/pages/redirect.php` file, which fails to properly sanitize the `page` parameter before reflecting it in the HTTP response. An attacker can craft a malicious URL containing JavaScript code in the `page` parameter, and when a victim visits this URL, the script executes in their browser within the context of the WordPress site.

Successful exploitation allows an attacker to execute arbitrary JavaScript code in the victim's browser, potentially leading to session hijacking, credential theft, defacement, or other malicious actions performed with the victim's privileges. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity), requiring user interaction but no authentication.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the vulnerable `redirect.php` endpoint with a crafted XSS payload in the `page` parameter: `</script>"><script>alert(document.domain)</script>`. 

The template verifies the vulnerability through three conditions:
1. The injected payload (`</script>"><script>alert(document.domain)</script>`) is reflected in the response body
2. The response contains the string "Authenticate your card", confirming the page is the expected redirect page
3. The response has a `text/html` content type and returns HTTP status 200

This detection method confirms that user-supplied input is reflected without proper sanitization, demonstrating the presence of the XSS vulnerability. While the template uses a harmless alert() payload for detection, the underlying vulnerability allows arbitrary JavaScript execution.

## References

- https://wordpress.org/support/topic/sagepay-server-gateway-for-woocommerce-1-0-7-cross-site-scripting/#post-9792337
- https://wordpress.org/plugins/sagepay-server-gateway-for-woocommerce/#developers
- https://packetstormsecurity.com/files/145459/WordPress-Sagepay-Server-Gateway-For-WooCommerce-1.0.7-XSS.html
- https://nvd.nist.gov/vuln/detail/CVE-2018-5316
- https://github.com/ARPSyndicate/kenzer-templates
