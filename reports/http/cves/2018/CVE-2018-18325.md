---
cve_id: CVE-2018-18325
template_path: nuclei-templates/http/cves/2018/CVE-2018-18325.yaml
affected_product: DotNetNuke
severity: high
authentication: none
external_callback: false
affected_versions: 9.2 through 9.2.2
preconditions: []
poc_classification: rce
---

## Vulnerability
DNN (DotNetNuke) versions 9.2 through 9.2.2 employ a weak encryption algorithm to protect input parameters due to an incomplete patch for CVE-2018-15811. This flaw permits the crafting of malicious DNNPersonalization cookies that trigger unsafe deserialization, resulting in remote code execution using .NET gadgets like ObjectDataProvider and FileSystemUtils.

- **Impact**: Full server compromise via arbitrary code execution.
- **CVSS Score**: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)
- **CWE**: CWE-326 (Inadequate Encryption Strength)
- **Remediation**: Upgrade to DotNetNuke 9.3.0 or newer.

## PoC / Detection
Classification: rce

The template issues a GET request to `/__` embedding a malicious `DNNPersonalization` cookie. The cookie payload uses an `ExpandedWrapper` with `ObjectDataProvider` to invoke `FileSystemUtils.WriteFile` on `C:\Windows\win.ini`. Detection succeeds if the response body contains win.ini signatures (`[extensions]` and `for 16-bit app support`) AND returns HTTP 404 status.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2018-18325
- https://nvd.nist.gov/vuln/detail/CVE-2018-15811
- https://github.com/dnnsoftware/Dnn.Platform/releases
- http://packetstormsecurity.com/files/157080/DotNetN
