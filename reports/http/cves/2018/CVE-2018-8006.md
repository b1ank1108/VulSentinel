---
cve_id: CVE-2018-8006
template_path: nuclei-templates/http/cves/2018/CVE-2018-8006.yaml
affected_product: Apache ActiveMQ
severity: medium
authentication: none
external_callback: false
affected_versions: 5.0.0 to 5.15.5
preconditions: []
poc_classification: detect-only
---

## Vulnerability

Apache ActiveMQ versions 5.0.0 through 5.15.5 contain a cross-site scripting (XSS) vulnerability in the web-based administration console. The vulnerability exists on the queue.jsp page due to improper data filtering of the QueueFilter parameter. An attacker can inject arbitrary JavaScript code through this parameter, which will be executed in the context of a victim's browser when they access the malicious URL. This can lead to session hijacking, defacement, or theft of sensitive information from users accessing the ActiveMQ admin console.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

## PoC / Detection

Classification: detect-only

The template detects this vulnerability by sending a GET request to the `/admin/queues.jsp` endpoint with a crafted QueueFilter parameter containing an XSS payload: `yu1ey"><script>alert("1")</script>qb68`. 

The detection verifies the vulnerability through three conditions:
1. The reflected XSS payload `"><script>alert("1")</script>` appears in the response body
2. The response Content-Type header contains "/html" (indicating HTML content)
3. The server returns a 200 OK status code

If all three conditions are met, the template confirms that the application is vulnerable to reflected XSS through improper filtering of the QueueFilter parameter.

## References

- http://activemq.apache.org/security-advisories.data/CVE-2018-8006-announcement.txt
- https://lists.apache.org/thread.html/2b5c0039197a4949f29e1e2c9441ab38d242946b966f61c110808bcc@%3Ccommits.activemq.apache.org%3E
- https://lists.apache.org/thread.html/fcbe6ad00f1de142148c20d813fae3765dc4274955e3e2f3ca19ff7b@%3Cdev.activemq.apache.org%3E
- https://lists.apache.org/thread.html/a859563f05fbe7c31916b3178c2697165bd9bbf5a65d1cf62aef27d2@%3Ccommits.activemq.apache.org%3E
- https://lists.apache.org/thread.html/03f91b1fb85686a848cee6b90112cf6059bd1b21b23bacaa11a962e1@%3Cdev.activemq.apache.org%3E
- https://lists.apache.org/thread.html/3f1e41bc9153936e065ca3094bd89ff8167ad2d39ac0b410f24382d2@%3Cgitbox.activemq.apache.org%3E
- https://lists.apache.org/thread.html/c0ec53b72b3240b187afb1cf67e4309a9e5f607282010aa196734814@%3Cgitbox.activemq.apache.org%3E
- https://lists.apache.org/thread.html/rb698ed085f79e56146ca24ab359c9ef95846618675ea1ef402e04a6d@%3Ccommits.activemq.apache.org%3E
- https://lists.apache.org/thread.html/r946488fb942fd35c6a6e0359f52504a558ed438574a8f14d36d7dcd7@%3Ccommits.activemq.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2018-8006
