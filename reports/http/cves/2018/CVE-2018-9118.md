---
cve_id: CVE-2018-9118
template_path: nuclei-templates/http/cves/2018/CVE-2018-9118.yaml
affected_product: WordPress 99 Robots WP Background Takeover Advertisements plugin
severity: high
authentication: none
external_callback: false
affected_versions: <=4.1.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-9118 is a local file inclusion (LFI) vulnerability affecting the WordPress 99 Robots WP Background Takeover Advertisements plugin version 4.1.4 and earlier. The vulnerability exists in the `exports/download.php` file, which fails to properly validate the `filename` parameter. This allows unauthenticated attackers to traverse the directory structure and read arbitrary files on the server using path traversal sequences (e.g., `../../../../`).

The vulnerability is classified under CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) and has a CVSS v3.0 score of 7.5 (High severity), with the vector string CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N. This indicates the vulnerability is exploitable remotely without authentication, has low attack complexity, and results in high confidentiality impact. The EPSS score of 0.71307 (98.688th percentile) suggests a high probability of active exploitation in the wild.

The vulnerability allows unauthorized access to sensitive files on the server, potentially exposing database credentials, configuration files, and other sensitive information that could enable further exploitation of the WordPress installation.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the vulnerable endpoint `/wp-content/plugins/wpsite-background-takeover/exports/download.php` with a malicious `filename` parameter containing path traversal sequences (`../../../../wp-config.php`). This attempts to read the WordPress configuration file located outside the intended directory.

The detection mechanism verifies successful exploitation by checking the response body for multiple strings that are characteristic of the `wp-config.php` file:
- "DB_NAME"
- "DB_PASSWORD"
- "DB_HOST"
- "The base configurations of the WordPress"

All four strings must be present in the response for the vulnerability to be confirmed, indicating that the wp-config.php file was successfully retrieved through the LFI vulnerability.

## References

- https://www.exploit-db.com/exploits/44417
- https://wpvulndb.com/vulnerabilities/9056
- https://99robots.com/docs/wp-background-takeover-advertisements/
- https://nvd.nist.gov/vuln/detail/CVE-2018-9118
- https://github.com/ARPSyndicate/cvemon
