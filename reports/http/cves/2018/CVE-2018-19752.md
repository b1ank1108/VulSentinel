---
cve_id: CVE-2018-19752
template_path: nuclei-templates/http/cves/2018/CVE-2018-19752.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: through 4.11.01
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DomainMOD through 4.11.01 contains a stored cross-site scripting (XSS) vulnerability via the `notes` field when adding a registrar at `/assets/add/registrar.php`. User-controlled input is saved unsanitized and reflected in `/assets/registrars.php` without escaping.

An authenticated attacker (high privileges required) can inject arbitrary JavaScript that executes in the victim's browser context upon viewing the registrars list page.

**CVSS 3.0**: 4.8 (AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N)  
**CWE**: CWE-79  
**Impact**: Session hijacking, page defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak

The template first performs a login POST to `/` with `new_username`/`new_password` template variables. It then issues a POST to `/assets/add/registrar.php` injecting the payload `<script>alert(document.domain)</script>` into the `new_notes` field (while supplying dummy values for other registrar fields). Finally, it performs a GET to `/assets/registrars.php` and checks for the exact unescaped string `"><script>alert(document.domain)</script></a>` in the response body, along with `text/html` content-type and HTTP 200 status.

## References
- https://github.com/domainmod/domainmod/issues/84
- https://www.exploit-db.com/exploits/45949/
- https://nvd.nist.gov/vuln/detail/CVE-2018-19752
- https://github.com/ARPSyndicate/kenzer-templates
