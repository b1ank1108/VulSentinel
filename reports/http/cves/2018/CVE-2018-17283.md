---
cve_id: CVE-2018-17283
template_path: nuclei-templates/http/cves/2018/CVE-2018-17283.yaml
affected_product: Zoho ManageEngine OpManager
severity: high
authentication: none
external_callback: false
affected_versions: before 12.3 Build 123196
preconditions: []
poc_classification: state-change
---

## Vulnerability
Unauthenticated SQL injection in Zoho ManageEngine OpManager before 12.3 Build 123196. Attackers can obtain an API key via unauthenticated `/oputilsServlet?action=getAPIKey` and inject payloads into the `name` parameter of `/api/json/device/setManaged`. This enables database access/modification, administrator user addition, and credential extraction.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5) | CWE-89

## PoC / Detection
Classification: state-change

The template performs two raw HTTP requests: (1) `GET /oputilsServlet?action=getAPIKey` extracts `API_KEY` via regex match on response body; (2) `POST /api/json/device/setManaged?apiKey=...` sends time-based blind SQL injection payload (`name=KcP7OGhC';select pg_sleep(6); --`) in form-urlencoded body. Detection matches on DSL conditions: response duration â‰¥6s, status_code==200, body contains "result", content-type contains "application/json".

## References
- https://github.com/x-f1v3/forcve/issues/4
- https://nvd.nist.gov/vuln/detail/CVE-2018-17283
