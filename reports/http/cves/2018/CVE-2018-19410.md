---
cve_id: CVE-2018-19410
template_path: nuclei-templates/http/cves/2018/CVE-2018-19410.yaml
affected_product: PRTG Network Monitor
severity: critical
authentication: none
external_callback: false
affected_versions: < 18.2.40.1683
preconditions: []
poc_classification: state-change
---

## Vulnerability
PRTG Network Monitor before 18.2.40.1683 allows remote unauthenticated attackers to create users with read-write privileges (including administrator) via Local File Inclusion. A remote unauthenticated user can override the `include` directive in `/public/login.htm` to include and execute `/api/addusers`, adding privileged accounts.

**Impact:** Unauthenticated attackers can create administrator users with full privileges via local file inclusion, leading to complete compromise of the monitoring system and access to network infrastructure.

**Remediation:** Upgrade to PRTG Network Monitor version 18.2.40.1683 or later and ensure the `/public` directory is properly secured.

**CVSS v3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: state-change

The template sends a crafted POST request to `/public/login.htm?file=/api/addusers.htm` containing `id=200&users={{rand_base(6)}}` and checks for 'Added 1 users' and 'prtg' in the 200 OK response body. This confirms the vulnerability by successfully creating a new user account.

## References
- https://global.ptsecurity.com/analytics/threatscape/pt-2018-24
- https://github.com/himash/CVE-2018-19410-POC
