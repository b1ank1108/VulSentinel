---
cve_id: CVE-2018-14933
template_path: nuclei-templates/http/cves/2018/CVE-2018-14933.yaml
affected_product: NUUO NVRmini
severity: critical
authentication: none
external_callback: false
affected_versions: 2016 firmware
preconditions: []
poc_classification: rce
---

## Vulnerability
NUUO NVRmini is vulnerable to unauthenticated remote command execution through the upgrade_handle.php file. The vulnerability allows an attacker to execute arbitrary commands by manipulating the uploaddir parameter.

Unauthenticated attackers can execute arbitrary commands on the NUUO NVRmini device by manipulating the uploaddir parameter in upgrade_handle.php, leading to complete device compromise and potential unauthorized access to video surveillance systems and recordings.

Update NUUO NVRmini to a patched version later than the 2016 firmware that properly validates the uploaddir parameter and restricts command execution.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8), CWE-78, CPE: cpe:2.3:o:nuuo:nvrmini_firmware:2016:*:*:*:*:*:*:*

## PoC / Detection
Classification: rce

The template issues a GET request to `{{BaseURL}}/upgrade_handle.php?cmd=writeuploaddir&uploaddir=%27;id;%27` (injecting the `id` command via the uploaddir parameter) and matches on HTTP status 200 together with the regex `uid=[0-9]+.*gid=[0-9]+.*` appearing in the response body.

## References
- https://www.exploit-db.com/exploits/45070
- https://www.cve.org/CVERecord?id=CVE-2018-14933
- https://nvd.nist.gov/vuln/detail/CVE-2018-14933
