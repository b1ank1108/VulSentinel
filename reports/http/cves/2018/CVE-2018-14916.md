---
cve_id: CVE-2018-14916
template_path: nuclei-templates/http/cves/2018/CVE-2018-14916.yaml
affected_product: Loytec LGATE-902
severity: critical
authentication: none
external_callback: false
affected_versions: < 6.4.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-14916 is a local file inclusion (LFI) vulnerability affecting Loytec LGATE-902 devices running firmware versions prior to 6.4.2. The vulnerability exists in the `/webui/file_guest` endpoint, which fails to properly validate user-supplied path parameters. An unauthenticated attacker can exploit this flaw by manipulating the `path` parameter with directory traversal sequences (e.g., `../`) to access arbitrary files on the device's filesystem outside the intended web root directory.

The vulnerability allows reading sensitive system files, including `/etc/passwd`, which can expose user account information and potentially facilitate further attacks. The CVSS v3.0 score of 9.1 (Critical) reflects the ease of exploitation (no authentication required, network accessible, low complexity) and the high impact on integrity and availability, though confidentiality impact is rated as none in the official scoring.

The flaw is classified as CWE-732 (Incorrect Permission Assignment for Critical Resource), indicating improper access controls on the file retrieval functionality.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending an HTTP GET request to the vulnerable `/webui/file_guest` endpoint with a crafted path parameter that uses directory traversal sequences to access `/etc/passwd`:

```
GET /webui/file_guest?path=/var/www/documentation/../../../../../etc/passwd&flags=1152
```

The detection logic verifies successful exploitation by checking for:
1. The presence of the root user entry pattern (`root:[x*]:0:0`) in the response body, which is characteristic of Unix/Linux `/etc/passwd` files
2. An HTTP 200 status code indicating successful file retrieval

The template uses a harmless read operation to confirm the LFI vulnerability exists without causing system damage.

## References

- https://packetstormsecurity.com/files/152453/Loytec-LGATE-902-XSS-Traversal-File-Deletion.html
- https://nvd.nist.gov/vuln/detail/CVE-2018-14916
- http://packetstormsecurity.com/files/152453/Loytec-LGATE-902-XSS-Traversal-File-Deletion.html
- https://seclists.org/fulldisclosure/2019/Apr/12
- https://github.com/ARPSyndicate/kenzer-templates
