---
cve_id: CVE-2018-11511
template_path: nuclei-templates/http/cves/2018/CVE-2018-11511.yaml
affected_product: ASUSTOR ADM
severity: critical
authentication: none
external_callback: false
affected_versions: 3.1.0.RFQ3
preconditions: []
poc_classification: state-change
---

## Vulnerability
ASUSTOR ADM 3.1.0.RFQ3 is vulnerable to unauthenticated SQL injection via the `album_id` parameter in the `/photo-gallery/api/album/tree_lists/` endpoint (and `scope` parameter in `/photo-gallery/api/photo/search/`). Attacker-controlled payloads reach the backend database unfiltered.

An attacker can execute arbitrary SQL commands, leading to information disclosure or further system compromise.

**CVSS Score:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-89  
**Impact:** Unauthenticated attackers can access, modify, or delete database contents, potentially compromising the entire ASUSTOR ADM system and stored data.  
**Remediation:** Upgrade to a patched version of ASUSTOR ADM or apply vendor-provided security updates.

## PoC / Detection
Classification: state-change

The template sends two raw POST requests (stop-at-first-match) injecting the time-based blind payload `+AND+SLEEP(9)` into the vulnerable parameters. It matches on `duration>=9`, HTTP 200 status, presence of `"success":` in the body, and album-related JSON strings (`"album_not_exist"` or `"album_items"`). This harmless probe confirms the SQL injection point exists without data exfiltration or modification.

## References
- https://www.exploit-db.com/exploits/44909
- https://nvd.nist.gov/vuln/detail/CVE-2018-11511
