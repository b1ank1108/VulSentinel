---
cve_id: CVE-2018-17246
template_path: nuclei-templates/http/cves/2018/CVE-2018-17246.yaml
affected_product: Kibana
severity: critical
authentication: none
external_callback: false
affected_versions: versions before 6.4.3 and 5.6.13
preconditions: access to the Kibana Console API
poc_classification: info-leak
---

## Vulnerability

Kibana is affected by a Local File Inclusion vulnerability in its Console plugin. Versions before 6.4.3 and 5.6.13 allow an attacker with access to the Console API to perform path traversal, including arbitrary local files. This can lead to reading sensitive files on the server (information disclosure) and potentially executing JavaScript which may result in arbitrary command execution under the Kibana process privileges.

## PoC / Detection
Classification: info-leak

The template sends a GET request to `{{BaseURL}}/api/console/api_server?sense_version=%40%40SENSE_VERSION&apis=../../../../../../../../../../../etc/passwd` with a path traversal payload targeting `/etc/passwd`. It verifies the LFI by matching for the string "An internal server error occurred" in the body and confirming Kibana-specific response headers (`kbn-name` or `kibana`, and `application/json` content-type).

## References
- https://github.com/vulhub/vulhub/blob/master/kibana/CVE-2018-17246/README.md
- https://www.elastic.co/community/security
- https://discuss.elastic.co/t/elastic-stack-6-4-3-and-5-6-13-security-update/155594
- https://nvd.nist.gov/vuln/detail/CVE-2018-17246
- https://access.redhat.com/errata/RHBA-2018:3743
