---
cve_id: CVE-2018-7600
template_path: nuclei-templates/http/cves/2018/CVE-2018-7600.yaml
affected_product: Drupal
severity: critical
authentication: none
external_callback: false
affected_versions: Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1
preconditions: default or common module configurations
poc_classification: rce
---

## Vulnerability
CVE-2018-7600 is a remote code execution vulnerability in Drupal core. It affects Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1. The vulnerability arises from an issue affecting multiple subsystems with default or common module configurations, allowing unauthenticated remote attackers to execute arbitrary code.

CVSS 3.0 Score: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: rce

The template performs an active exploit by sending a crafted multipart/form-data POST request to `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`. It sets `mail[#post_render][]` to `passthru`, `mail[#type]` to `markup`, and `mail[#markup]` to `cat /etc/passwd` to trigger command execution. Detection matches on `application/json` header, status 200, and regex for `root:.*:0:0:` in the response body indicating successful RCE.

## References
- https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2018-7600
- https://nvd.nist.gov/vuln/detail/CVE-2018-7600
- https://www.drupal.org/sa-core-2018-002
- https://groups.drupal.org/security/faq-2018-002
- http://www.securitytracker.com/id/1040598
