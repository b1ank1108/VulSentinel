---
cve_id: CVE-2018-7422
template_path: nuclei-templates/http/cves/2018/CVE-2018-7422.yaml
affected_product: Site Editor
severity: high
authentication: none
external_callback: false
affected_versions: <=1.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-7422 is a Local File Inclusion (LFI) vulnerability affecting the WordPress Site Editor plugin through version 1.1.1. The vulnerability exists in the `ajax_shortcode_pattern.php` file within the pagebuilder extension, where the `ajax_path` parameter is not properly sanitized. This allows remote attackers to traverse the directory structure and retrieve arbitrary files from the server without authentication. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS v3.0 score of 7.5 (High severity). The attack vector is network-based, requires low complexity, no privileges, and no user interaction. An attacker can exploit this flaw to access sensitive configuration files such as `wp-config.php` (containing database credentials) or system files like `/etc/passwd`, potentially leading to further system compromise.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending HTTP GET requests to the vulnerable `ajax_shortcode_pattern.php` endpoint with crafted `ajax_path` parameters. It attempts two different file inclusion payloads:

1. **WordPress Configuration File Access**: Requests `../../../../../../../wp-config.php` using directory traversal to access the WordPress configuration file containing database credentials.
2. **System File Access**: Requests `/etc/passwd` to access the Unix/Linux password file.

The template verifies successful exploitation through two matcher conditions (OR logic):
- Detecting the presence of both "DB_NAME" and "DB_PASSWORD" strings in the response body (indicating successful retrieval of wp-config.php)
- Detecting a regex pattern matching `root:.*:0:0:` in the response body (indicating successful retrieval of /etc/passwd)

Either successful match confirms the presence of the LFI vulnerability, demonstrating unauthorized file read access.

## References

- https://www.exploit-db.com/exploits/44340
- http://seclists.org/fulldisclosure/2018/Mar/40
- https://wpvulndb.com/vulnerabilities/9044
- https://nvd.nist.gov/vuln/detail/CVE-2018-7422
- https://github.com/El-Palomo/SYMFONOS
