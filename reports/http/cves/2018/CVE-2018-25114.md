---
cve_id: CVE-2018-25114
template_path: nuclei-templates/http/cves/2018/CVE-2018-25114.yaml
affected_product: osCommerce
severity: critical
authentication: none
external_callback: false
affected_versions: 2.3.4.1
preconditions: accessible /install/ directory after installation
poc_classification: rce
---

## Vulnerability

osCommerce Online Merchant 2.3.4.1 contains a remote code execution vulnerability caused by insecure default configuration and missing authentication in the installer workflow. Unauthenticated attackers can execute arbitrary PHP code via `install_4.php` when the `/install/` directory remains accessible after installation.

**Impact**: Unauthenticated attackers can execute arbitrary PHP code, leading to complete e-commerce platform compromise and access to customer data.  
**CVSS**: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N  
**CWE**: CWE-94

## PoC / Detection

Classification: rce

The template detects the RCE by sending a POST request to `/install/install.php?step=4` with a form-urlencoded payload that injects `passthru('cat /etc/passwd')` into the configuration generation (`DIR_FS_DOCUMENT_ROOT=.%2F&DB_DATABASE=%27%29%3Bpassthru%28%27cat+%2Fetc%2Fpasswd%27%29%3B%2F%2A`). It then issues a GET request to `/install/includes/configure.php` and matches for the regex `root:.*:0:0:` in the response body along with HTTP status 200.

## References

- https://www.exploit-db.com/exploits/50128
- https://github.com/nobodyatall648/osCommerce-2.3.4-Remote-Command-Execution
- https://www.exploit-db.com/exploits/44374
- https://www.vulncheck.com/advisories/oscommerce-installer-unauth-config-file-injection-php-code-execution
