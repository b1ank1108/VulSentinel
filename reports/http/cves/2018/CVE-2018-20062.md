---
cve_id: CVE-2018-20062
template_path: nuclei-templates/http/cves/2018/CVE-2018-20062.yaml
affected_product: ThinkPHP
severity: critical
authentication: none
external_callback: false
affected_versions: <=5.0.23
preconditions: []
poc_classification: rce
---

## Vulnerability
ThinkPHP 5.0.23 contains a critical remote code execution vulnerability in `thinkphp/library/think/App.php`. Remote attackers can execute arbitrary PHP code through specially crafted requests (e.g., filter parameter as in `s=index/\think\Request/input&filter=phpinfo&data=1` or invokefunction/call_user_func_array payloads). Discovered in the context of NoneCms V1.3.

**CVSS Score:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**Impact:** Unauthenticated attackers can execute arbitrary PHP code on the server, leading to complete system compromise, data theft, and potential lateral movement within the network.

**Remediation:** Upgrade to ThinkPHP version 5.0.24 or later, or apply vendor-provided security patches.

## PoC / Detection
Classification: rce

The template issues a single GET request with the payload `?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1` to trigger code execution. Detection succeeds if the response status is 200 and contains the words "PHP Extension", "PHP Version", and "ThinkPHP".

## References
- https://github.com/yilin1203/CVE-2018-20062/blob/main/CVE-2018-20062.py
- https://github.com/yilin1203/CVE-2018-20062
- https://github.com/vulhub/vulhub/tree/master/thinkphp/5-rce
