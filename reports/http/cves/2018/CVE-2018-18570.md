---
cve_id: CVE-2018-18570
template_path: nuclei-templates/http/cves/2018/CVE-2018-18570.yaml
affected_product: Planon
severity: medium
authentication: none
external_callback: false
affected_versions: before Live Build 41
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Planon before Live Build 41 is vulnerable to reflected cross-site scripting (XSS) via the unescaped `nodatamsg` query parameter in the Wicket resource path `/wicket/resource/nl.planon.pssm.dashboard.cre.engine.wicket.page.AbstractDashboardPage/html/nodata.html`.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').  
Successful exploitation allows arbitrary JavaScript execution in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak  
The template performs a single unauthenticated GET request to the vulnerable endpoint with the encoded payload `?nodatamsg=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`. It verifies the flaw by checking whether the response body exactly contains the unsanitized reflection `</script><script>alert(document.domain)</script>`, the `Content-Type` header contains `text/html`, and the status code is 200.

## References
- https://www2.deloitte.com/de/de/pages/risk/articles/planon-cross-site-scripting.html
- https://nvd.nist.gov/vuln/detail/CVE-2018-18570
- https://github.com/ARPSyndicate/kenzer-templates
