---
cve_id: CVE-2018-2392
template_path: nuclei-templates/http/cves/2018/CVE-2018-2392.yaml
affected_product: SAP Internet Graphics Server (IGS)
severity: high
authentication: none
external_callback: false
affected_versions: 7.20, 7.20EXT, 7.45, 7.49, 7.53
preconditions: []
poc_classification: info-leak
---

## Vulnerability

SAP Internet Graphics Server (IGS) versions 7.20, 7.20EXT, 7.45, 7.49, and 7.53 contain an XML External Entity (XXE) injection vulnerability (CWE-611) in the XMLCHART page. The vulnerability stems from insufficient validation of the Extension HTML tag when processing POST requests to generate charts. An unauthenticated attacker can exploit this flaw by submitting specially crafted XML documents containing external entity declarations. Successful exploitation enables unauthorized access to sensitive information through file system access (e.g., reading /etc/passwd) or potentially leads to complete system compromise. The CVSS v3.0 score is 7.5 (High), with an EPSS score of 0.86102 (99.38th percentile), indicating active exploitation in the wild.

## PoC / Detection

Classification: info-leak

The template detects CVE-2018-2392 by sending a multipart POST request to the `/XMLCHART` endpoint with two XML documents. The first document contains valid chart data with categories and series values. The second document includes a malicious DOCTYPE declaration with an external entity (`<!ENTITY xxe SYSTEM "/etc/passwd">`) that is referenced within the `<Extension>` tag of the chart customization XML. The template verifies the vulnerability by checking for multiple conditions: the response body must contain chart-related keywords ("Picture", "Info", "/output/") along with either "ImageMap" or "Errors"; the response headers must include both "text/html" and "SAP Internet Graphics Server"; and the HTTP status must be 200. This detection approach confirms the server processes the XXE payload and attempts to access the specified file path, demonstrating the information disclosure vulnerability.

## References

- https://launchpad.support.sap.com/#/notes/2525222
- https://blogs.sap.com/2018/02/13/sap-security-patch-day-february-2018/
- https://www.rapid7.com/db/modules/auxiliary/admin/sap/sap_igs_xmlchart_xxe/
- https://troopers.de/troopers18/agenda/3r38lr/
- https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/admin/sap/sap_igs_xmlchart_xxe.rb
- https://nvd.nist.gov/vuln/detail/CVE-2018-2392
