---
cve_id: CVE-2018-12031
template_path: nuclei-templates/http/cves/2018/CVE-2018-12031.yaml
affected_product: Eaton Intelligent Power Manager
severity: critical
authentication: none
external_callback: false
affected_versions: 1.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Eaton Intelligent Power Manager 1.6 contains a directory traversal vulnerability (CVE-2018-12031, CWE-22) in the `/server/node_upgrade_srv.js` endpoint when processing the `firmware` parameter in the `downloadFirmware` action. An unauthenticated remote attacker can traverse directories to read arbitrary files from the filesystem, potentially disclosing sensitive information (e.g. /etc/passwd), causing denial of service, or enabling code execution.

CVSS v3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: info-leak

The Nuclei template sends GET requests appending traversal sequences (`/../../../../../../../../../../etc/passwd` and equivalent for Windows `win.ini`) to the firmware download endpoint. Detection succeeds if the HTTP status is 200 and the response body matches regex patterns indicating successful file read: Linux passwd format (`root:.*:0:0:`) or Windows INI sections (`\[(font|extension|file)s\]`).

## References
- https://github.com/EmreOvunc/Eaton-Intelligent-Power-Manager-Local-File-Inclusion
- https://www.exploit-db.com/exploits/48614
- https://nvd.nist.gov/vuln/detail/CVE-2018-12031
- https://github.com/0xT11/CVE-POC
- https://github.com/ARPSyndicate/cvemon
