---
cve_id: CVE-2018-10822
template_path: nuclei-templates/http/cves/2018/CVE-2018-10822.yaml
affected_product: D-Link Routers
severity: high
authentication: none
external_callback: false
affected_versions: DWR-116 through 1.06, DIR-140L through 1.02, DIR-640L through 1.02, DWR-512 through 2.02, DWR-712 through 2.02, DWR-912 through 2.02, DWR-921 through 2.02, DWR-111 through 1.01, and probably others with the same type of firmware
preconditions: []
poc_classification: info-leak
---

## Vulnerability
D-Link routers (DWR-116 through 1.06, DIR-140L through 1.02, DIR-640L through 1.02, DWR-512 through 2.02, DWR-712 through 2.02, DWR-912 through 2.02, DWR-921 through 2.02, DWR-111 through 1.01 and equivalent firmware) contain a path-traversal Local File Inclusion flaw in the web interface. Remote unauthenticated attackers can read arbitrary files by appending /.. or // after "GET /uir" in an HTTP request.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5, CWE-22).  
Impact: read sensitive system files (e.g., /etc/passwd, configuration data).  
Remediation: apply the latest D-Link firmware update.

## PoC / Detection
Classification: info-leak

The template sends one unauthenticated GET request to `{{BaseURL}}/uir//etc/passwd` and confirms exploitation if the response returns HTTP 200 and matches the regex `root:.*:0:0:` (indicating successful inclusion of /etc/passwd).

## References
- https://www.exploit-db.com/exploits/45678
- http://sploit.tech/2018/10/12/D-Link.html
- https://nvd.nist.gov/vuln/detail/CVE-2018-10822
- https://seclists.org/fulldisclosure/2018/Oct/36
- https://github.com/ARPSyndicate/cvemon
