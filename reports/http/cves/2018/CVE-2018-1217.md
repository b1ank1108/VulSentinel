---
cve_id: CVE-2018-1217
template_path: nuclei-templates/http/cves/2018/CVE-2018-1217.yaml
affected_product: Dell EMC Avamar and Integrated Data Protection Appliance Installation Manager
severity: critical
authentication: none
external_callback: false
affected_versions: Dell EMC Avamar Server 7.3.1, 7.4.1, and 7.5.0 and Dell EMC Integrated Data Protection Appliance 2.0 and 2.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Avamar Installation Manager in Dell EMC Avamar Server 7.3.1, 7.4.1, and 7.5.0, and Dell EMC Integrated Data Protection Appliance 2.0 and 2.1, is affected by a missing access control check vulnerability (CWE-862). A remote unauthenticated attacker can read or change the Local Download Service (LDLS) emcsupportUsername and emcsupportPassword credentials used to connect to Dell EMC Online Support. This enables credential theft, impersonation of the AVI service on Dell EMC Online Support, or corruption of the configuration that prevents legitimate connections.

CVSS: 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated raw POST request to `/avi/avigui/avigwt` using GWT-RPC protocol, invoking the `getLDLSConfig` method with the target hostname as the sole parameter. It detects successful exposure by confirming HTTP status 200 and response body containing `//OK`, `emcsupportUsername`, and `emcsupportPassword`. The template additionally extracts the username and password values internally to confirm the information disclosure.

## References
- https://www.exploit-db.com/exploits/44441
- https://nvd.nist.gov/vuln/detail/CVE-2018-1217
