---
cve_id: CVE-2018-19127
template_path: nuclei-templates/http/cves/2018/CVE-2018-19127.yaml
affected_product: PHPCMS 2008
severity: critical
authentication: none
external_callback: false
affected_versions: 2008
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2018-19127 is an unauthenticated remote code execution vulnerability in PHPCMS 2008 caused by template injection in the `type.php` file. The vulnerability allows attackers to inject arbitrary PHP code through the `template` parameter, which is written into a PHP template cache file (`data/cache_template/rss.tpl.php`). Once the malicious content is cached, the server executes it as PHP code when the cache file is accessed, granting the attacker full remote code execution capabilities.

The vulnerability is classified as CWE-94 (Improper Control of Generation of Code - Code Injection) with a CVSS v3.0 score of 9.8 (Critical). The attack vector is network-based, requires low complexity, no privileges, and no user interaction. PHPCMS 2008 is no longer maintained and the vendor is unresponsive, leaving users with no official patch. The EPSS score of 0.84845 (99.318th percentile) indicates a very high probability of active exploitation in the wild.

## PoC / Detection

Classification: rce

The template performs a two-stage detection process to verify the remote code execution vulnerability:

**Stage 1 (Injection):** The template sends a GET request to `/type.php` with a crafted `template` parameter containing a payload that injects PHP code to calculate and echo the MD5 hash of a random number (999999999). The payload uses PHPCMS template syntax (`tag_(){};echo(md5({{num}}));{//../rss`) to break out of the template context and inject executable PHP code. The template verifies successful injection by checking for HTTP 200 status and the presence of the MD5 hash alongside PHPCMS-specific content markers ("value=\"picture", "phpcms").

**Stage 2 (Verification):** The template then accesses the cached template file at `/data/cache_template/rss.tpl.php` to confirm that the injected code was written to disk and is executable. It checks for the presence of the same MD5 hash in the response, proving that arbitrary PHP code execution has been achieved.

This two-step approach confirms both the injection vector and the actual code execution capability, demonstrating a complete RCE chain.

## References

- https://github.com/ab1gale/phpcms-2008-CVE-2018-19127
- https://github.com/advisories/GHSA-p498-q357-m3p7
- https://nvd.nist.gov/vuln/detail/CVE-2018-19127
