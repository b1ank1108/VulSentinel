---
cve_id: CVE-2018-20011
template_path: nuclei-templates/http/cves/2018/CVE-2018-20011.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: <=4.11.01
preconditions: []
poc_classification: state-change
---

## Vulnerability

DomainMOD through version 4.11.01 contains a stored cross-site scripting (XSS) vulnerability in the asset category management functionality. The vulnerability exists in the `/assets/add/category.php` endpoint, specifically in the `CatagoryName` and `StakeHolder` parameters. When malicious JavaScript code is submitted through these parameters, it is stored in the application and later executed in the context of users' browsers when they view the categories page at `/assets/categories.php`.

This is a stored XSS vulnerability (CWE-79) that requires authenticated access to exploit, as the attacker must have valid credentials to access the asset management functionality. The CVSS score of 4.8 (Medium severity) reflects that while the vulnerability requires high privileges (PR:H) and user interaction (UI:R), it has a changed scope (S:C) allowing the attacker to affect resources beyond the vulnerable component.

Successful exploitation could enable an attacker to execute arbitrary JavaScript in victims' browsers, potentially leading to session hijacking, credential theft, defacement, or other malicious actions within the application's security context.

## PoC / Detection

Classification: state-change

The template performs an authenticated exploitation test through three sequential HTTP requests:

1. **Authentication**: Sends a POST request to the root endpoint (`/`) with username and password credentials to establish an authenticated session.

2. **Payload Injection**: Submits a POST request to `/assets/add/category.php` with a malicious XSS payload (`<script>alert(document.domain)</script>`) in the `new_category` parameter, attempting to store the malicious script in the application database.

3. **Verification**: Sends a GET request to `/assets/categories.php` to retrieve the categories listing page and verify if the injected payload is reflected in the response.

The template confirms the vulnerability by checking that the final response returns HTTP 200, has a `text/html` content type, and contains the injected payload in its rendered form (`><script>alert(document.domain)</script></a>`), indicating the XSS payload was successfully stored and is being executed when the page is viewed.

## References

- https://www.exploit-db.com/exploits/46374/
- https://github.com/domainmod/domainmod/issues/88
- https://nvd.nist.gov/vuln/detail/CVE-2018-20011
- https://github.com/ARPSyndicate/kenzer-templates
