---
cve_id: CVE-2018-16979
template_path: nuclei-templates/http/cves/2018/CVE-2018-16979.yaml
affected_product: Monstra CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 3.0.4
preconditions: []
poc_classification: state-change
---

## Vulnerability

Monstra CMS version 3.0.4 contains an HTTP header injection vulnerability in the `plugins/captcha/crypt/cryptographp.php` file via the `cfg` parameter. The vulnerability is classified as CWE-113 (Improper Neutralization of CRLF Sequences in HTTP Headers). An attacker can inject arbitrary HTTP headers by supplying malicious input containing CRLF (Carriage Return Line Feed) sequences. This allows manipulation of HTTP responses, potentially enabling attacks such as:

- HTTP response splitting
- Cache poisoning
- Session hijacking through cookie injection
- Cross-site scripting (XSS) via injected headers
- Unauthorized redirects to attacker-controlled domains
- Improper access to virtual hosts

The vulnerability requires no authentication and can be exploited remotely over the network with low attack complexity, though it does require user interaction (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1). This issue is related to CVE-2012-2943.

## PoC / Detection

Classification: state-change

The template detects this vulnerability by sending a GET request to `/plugins/captcha/crypt/cryptographp.php` with a crafted `cfg` parameter containing CRLF sequences (`%0D%0A`) followed by a `Set-Cookie` header injection attempt. The payload is:

`cfg=1%0D%0ASet-Cookie:%20crlfinjection=1`

The template verifies the vulnerability by checking for:
1. HTTP 200 status code response
2. Presence of both strings "new line detected in" and "cryptographp.php" in the response body

These indicators suggest the application is processing the injected CRLF characters and detecting the malicious newline, confirming the vulnerability exists. While the template uses a detection-oriented probe, the underlying vulnerability allows arbitrary HTTP header injection, enabling state-changing attacks like cookie manipulation and response splitting.

## References

- https://github.com/howchen/howchen/issues/4
- https://nvd.nist.gov/vuln/detail/CVE-2018-16979
- https://github.com/ARPSyndicate/kenzer-templates
