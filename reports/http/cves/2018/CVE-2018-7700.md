---
cve_id: CVE-2018-7700
template_path: nuclei-templates/http/cves/2018/CVE-2018-7700.yaml
affected_product: DedeCMS
severity: high
authentication: none
external_callback: false
affected_versions: 5.7SP2
preconditions: []
poc_classification: rce
---

## Vulnerability
DedeCMS 5.7SP2 suffers from a CSRF flaw in `tag_test_action.php` where the `partcode` parameter accepts a `{dede:field name='source' runphp='yes'}` tag that directly executes supplied PHP code, enabling arbitrary code execution (classified as RCE). Impact includes unauthorized actions on behalf of the victim and full remote code execution. Remediation requires applying latest patches and updating beyond 5.7SP2. CVSS 3.0 score 8.8 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H), CWE-352.

## PoC / Detection
Classification: rce  
The template issues a single unauthenticated GET request to `{{BaseURL}}/tag_test_action.php?url=a&token=&partcode={dede:field name='source' runphp='yes'}echo md5("CVE-2018-7700");{/dede:field}` and verifies successful RCE by checking for the static string `4cc32a3a81d2bb37271934a48ce4468a` (MD5 of "CVE-2018-7700") in the 200 OK response body.

## References
- https://laworigin.github.io/2018/03/07/CVE-2018-7700-dedecms%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/
- https://nvd.nist.gov/vuln/detail/CVE-2018-7700
- https://github.com/0ps/pocassistdb
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
