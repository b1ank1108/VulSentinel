---
cve_id: CVE-2018-10738
template_path: nuclei-templates/http/cves/2018/CVE-2018-10738.yaml
affected_product: Nagios XI
severity: high
authentication: required
external_callback: false
affected_versions: <= 5.4.12
preconditions: authenticated administrator access
poc_classification: state-change
---

## Vulnerability
SQL injection via the `chbKey1` parameter in `nagiosql/admin/menuaccess.php` (Nagios XI <= 5.4.12). Authenticated administrators can execute arbitrary SQL, enabling read/modify/delete of database contents and full instance compromise.  
CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (7.2). CWE-89.

## PoC / Detection
Classification: state-change  
Sends a single POST to `{{BaseURL}}/nagiosql/admin/menuaccess.php` (Content-Type: application/x-www-form-urlencoded) containing `chbKey1=-1%' and (select 1 from(select count(*),concat((select md5({{rand_int}})) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)#`. Matches the reflected MD5 hash of the random integer in the response body to confirm the injection point.

## References
- https://qkl.seebug.org/vuldb/ssvid-97268
- https://vuldb.com/de/?id.117807
