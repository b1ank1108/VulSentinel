---
cve_id: CVE-2018-20526
template_path: nuclei-templates/http/cves/2018/CVE-2018-20526.yaml
affected_product: Roxy Fileman
severity: critical
authentication: none
external_callback: false
affected_versions: 1.4.5
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2018-20526 is an unrestricted file upload vulnerability in Roxy Fileman version 1.4.5. The vulnerability exists in the `upload.php` component, which fails to properly validate uploaded files. This allows an attacker to upload arbitrary files, including malicious PHP scripts, to the server without authentication. The flaw is classified as CWE-434 (Unrestricted Upload of File with Dangerous Type) and has a CVSS score of 9.8, indicating critical severity. Successful exploitation enables remote code execution, allowing attackers to execute arbitrary commands on the target system, obtain sensitive information, modify data, and potentially gain full control over the compromised system without requiring credentials.

## PoC / Detection

Classification: rce

The template performs a two-step verification process to detect this vulnerability:

1. **File Upload**: Sends a POST request to `/php/upload.php` with a multipart form containing a PHP file (with `.php7` extension) that contains code to output the MD5 hash of the string 'CVE-2018-20526'. The upload request specifies the target directory as `/Uploads` and uses the `upload` action with `ajax` method.

2. **Execution Verification**: Sends a GET request to `/Uploads/{{randstr}}.php7` to access the uploaded file and verify it executes on the server.

The template confirms the vulnerability by checking for:
- HTTP 200 status code on the execution request
- The presence of the specific MD5 hash value `f76d6a5f7491700cc3a678bdba2902d3` in the response body, proving the PHP code executed successfully

This demonstrates that arbitrary PHP code can be uploaded and executed, confirming remote code execution capability.

## References

- http://packetstormsecurity.com/files/151033/Roxy-Fileman-1.4.5-File-Upload-Directory-Traversal.html
- https://www.exploit-db.com/exploits/46085/
- https://nvd.nist.gov/vuln/detail/CVE-2018-20526
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
