---
cve_id: CVE-2018-7193
template_path: nuclei-templates/http/cves/2018/CVE-2018-7193.yaml
affected_product: osTicket
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.10.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected cross-site scripting (XSS) vulnerability (CWE-79) in Enhancesoft osTicket < 1.10.2 located in `/scp/directory.php`. The `order` GET parameter is reflected without sanitization, allowing remote attackers to inject arbitrary web script or HTML.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1/medium).  
Successful exploitation executes attacker-controlled JavaScript in the victim's browser context, enabling data theft or unauthorized actions.

## PoC / Detection
Classification: info-leak  
The template first issues a GET to `/scp/login.php` to confirm osTicket presence and extract the `__CSRFToken__` value. It then performs a POST login to `/scp/login.php` using the extracted token plus supplied `{{username}}`/`{{password}}` credentials. Finally it sends a GET to `/scp/directory.php?&&order="><script>alert(document.domain);</script>&sort=dept`. Detection succeeds when the exact unsanitized payload string appears in the 200 OK HTML response body.

## References
- https://blog.securityevaluators.com/vulnerabilities-found-in-popular-ticketing-system-dd273bda229c
- https://nvd.nist.gov/vuln/detail/CVE-2018-7193
