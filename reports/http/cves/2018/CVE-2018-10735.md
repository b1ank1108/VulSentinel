---
cve_id: CVE-2018-10735
template_path: nuclei-templates/http/cves/2018/CVE-2018-10735.yaml
affected_product: Nagios XI
severity: high
authentication: required
external_callback: false
affected_versions: <= 5.4.12
preconditions: [authenticated as administrator]
poc_classification: state-change
---

## Vulnerability
SQL injection via the `cname` parameter in `/nagiosql/admin/commandline.php` (Nagios XI <= 5.4.12). Authenticated administrators can execute arbitrary SQL, enabling full read/write/delete access to database contents and potential full instance compromise.  
CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2) • CWE-89 • CPE: cpe:2.3:a:nagios:nagios_xi:*:*:*:*:*:*:*:*  
Remediation: upgrade to 5.4.13 or later.

## PoC / Detection
Classification: state-change  
Template issues a single GET request to `{{BaseURL}}/nagiosql/admin/commandline.php?cname=' union select concat(md5({{num}}))#` (where `num` is a random 10-digit integer) and matches the resulting MD5 hash value in the response body to confirm union-based SQL injection. The probe is non-destructive and only verifies exploitability.

## References
- https://vulners.com/seebug/SSV:97266
- https://github.com/chaitin/xray/blob/master/pocs/nagio-cve-2018-10735.yml
