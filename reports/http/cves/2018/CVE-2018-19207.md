---
cve_id: CVE-2018-19207
template_path: nuclei-templates/http/cves/2018/CVE-2018-19207.yaml
affected_product: WP GDPR Compliance
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.4.3
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2018-19207 is a critical unauthenticated vulnerability in the WP GDPR Compliance WordPress plugin affecting versions prior to 1.4.3. The vulnerability exists in the `Includes/Ajax.php` file, which fails to properly validate user input before processing AJAX actions. This allows unauthenticated attackers to execute arbitrary actions and modify any database option without authentication.

The flaw stems from insufficient access controls on the `wpgdprc_process_action` AJAX endpoint. Attackers can leverage this to perform privileged operations including creating administrator accounts, modifying critical site configurations, and potentially achieving remote code execution by manipulating WordPress options that control executable code paths.

The vulnerability is classified as CWE-425 (Direct Request) with a CVSS score of 9.8, indicating maximum severity across confidentiality, integrity, and availability impacts. The EPSS score of 0.91939 (99.685th percentile) indicates this vulnerability is actively exploited in the wild.

## PoC / Detection

Classification: state-change

The template performs a multi-step detection process to verify the vulnerability:

1. **Nonce Extraction**: The template first sends a GET request to the base URL and extracts the AJAX security nonce from the page source using regex pattern matching on the `wpgdprcData` JavaScript object.

2. **Configuration Modification**: Using the extracted nonce, the template sends two POST requests to `/wp-admin/admin-ajax.php`:
   - First request enables user registration by setting the `users_can_register` option to "1"
   - Second request changes the default user role to "administrator"

3. **Verification**: The template confirms successful exploitation by checking for JSON responses containing empty `message` and `error` fields, indicating the database modifications were accepted without authentication.

The template demonstrates the vulnerability's state-change capability by modifying WordPress configuration options that would allow an attacker to create administrator accounts on the target site.

## References

- https://wpvulndb.com/vulnerabilities/9157
- https://github.com/aeroot/WP-GDPR-Compliance-Plugin-Exploit
