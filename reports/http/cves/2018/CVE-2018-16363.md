---
cve_id: CVE-2018-16363
template_path: nuclei-templates/http/cves/2018/CVE-2018-16363.yaml
affected_product: WordPress File Manager plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 3.0
preconditions: []
poc_classification: detect-only
---

## Vulnerability

WordPress File Manager plugin versions prior to 3.0 contain an authenticated reflected cross-site scripting (XSS) vulnerability in the admin dashboard. The vulnerability exists in the `lang` parameter of the plugin's admin interface (`admin.php?page=wp_file_manager`). The parameter value is directly echoed into a JavaScript context without proper sanitization or encoding, allowing an attacker to inject arbitrary JavaScript code. An authenticated user with access to the WordPress admin dashboard can exploit this vulnerability by crafting a malicious URL containing JavaScript payloads in the `lang` parameter.

## PoC / Detection

Classification: detect-only

The template performs a two-step detection process:

1. **Authentication Step**: Sends a POST request to `/wp-login.php` with username and password credentials to establish an authenticated WordPress session. Validates successful login by checking for HTTP 302 redirect and the presence of the `wordpress_logged_in` cookie in the response headers.

2. **XSS Detection Step**: Once authenticated, sends a GET request to `/wp-admin/admin.php?page=wp_file_manager` with a crafted `lang` parameter containing the XSS payload: `</script><script>alert(document.domain)</script>`. The template verifies the vulnerability by checking that:
   - The injected payload appears unescaped in the response body
   - The response contains expected File Manager plugin indicators (`var fmlang`, `wp-file-manager`)
   - The response is HTML content with HTTP 200 status

The template uses a benign `alert(document.domain)` payload to confirm the XSS vulnerability without causing harm.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2018-16363
- https://wpscan.com/vulnerability/65e4849b-6517-400d-884f-65234f58ab0c/
- https://plugins.trac.wordpress.org/changeset/1936043
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16363
