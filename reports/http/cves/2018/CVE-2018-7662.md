---
cve_id: CVE-2018-7662
template_path: nuclei-templates/http/cves/2018/CVE-2018-7662.yaml
affected_product: CouchCMS
severity: medium
authentication: none
external_callback: false
affected_versions: <= 2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
CouchCMS <= 2.0 allows unauthenticated remote attackers to discover the full server filesystem path via direct requests to `/includes/mysql2i/mysql2i.func.php` or `/addons/phpmailer/phpmailer.php`. These endpoints trigger PHP fatal errors that leak the absolute installation directory (CWE-200).  
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (5.3).  
Impact: reveals directory structure to aid further attacks (path traversal, targeted RCE).  
Remediation: upgrade to 2.1 or higher.

## PoC / Detection
Classification: info-leak  
The template issues two GET requests (`{{BaseURL}}/includes/mysql2i/mysql2i.func.php` and `{{BaseURL}}/addons/phpmailer/phpmailer.php`, stop-at-first-match) and matches response-body error strings:  
- `mysql2i.func.php on line 10` AND `Fatal error: Cannot redeclare mysql_affected_rows() in`  
- OR `phpmailer.php on line 10` AND `Fatal error: Call to a menber function add_event_listener() on a non-object in`  
These strings confirm the path-disclosure condition.

## References
- https://github.com/CouchCMS/CouchCMS/issues/46
- https://nvd.nist.gov/vuln/detail/CVE-2018-7662
- https://github.com/20142995/Goby
- https://github.com/5ecurity/CVE-List
- https://github.com/ARPSyndicate/cvemon
