---
cve_id: CVE-2018-1000533
template_path: nuclei-templates/http/cves/2018/CVE-2018-1000533.yaml
affected_product: GitList
severity: critical
authentication: none
external_callback: false
affected_versions: < 0.6.0
preconditions: []
poc_classification: rce
---

## Vulnerability
GitList < 0.6.0 contains improperly sanitized input passed via the `searchTree` function, resulting in remote code execution.  
Impact: Successful exploitation allows an attacker to execute arbitrary code on the target system.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-20.

## PoC / Detection
Classification: rce

The template detects/verify the vulnerability by:  
- Sending GET / and extracting the repository path via regex `<span class="name">(.*?)</span>` from the HTML body (internal extractor).  
- Sending POST /{{path}}/tree/a/search with form-encoded `query=--open-files-in-pager=cat%20/etc/passwd`.  
- Matching the word `root:/root:/bin/bash` in the response body to confirm command execution via git pager injection.

## References
- https://github.com/vulhub/vulhub/tree/master/gitlist/CVE-2018-1000533
- https://nvd.nist.gov/vuln/detail/CVE-2018-1000533
- https://security.szurek.pl/exploit-bypass-php-escapeshellarg-escapeshellcmd.html
- https://github.com/klaussilveira/gitlist/commit/87b8c26b023c3fc37f0796b14bb13710f397b322
- https://github.com/superlink996/chunqiuyunjingbachang
