---
cve_id: CVE-2018-1000130
template_path: nuclei-templates/http/cves/2018/CVE-2018-1000130.yaml
affected_product: Jolokia Agent
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: Jolokia agent in proxy mode
poc_classification: rce
---

## Vulnerability
Jolokia agent is vulnerable to a JNDI injection vulnerability that allows a remote attacker to run arbitrary Java code on the server when the agent is in proxy mode. Successful exploitation leads to remote code execution and full system compromise. CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (score 8.1). CWE-74.

## PoC / Detection
Classification: rce

The template issues one POST request to `/jolokia/read/getDiagnosticOptions` containing a JSON payload with a read operation on `java.lang:type=Memory` and a `target` object embedding the JNDI URL `service:jmx:rmi:///jndi/ldap://127.0.0.1:1389/o=tomcat`. Detection succeeds on HTTP 200 combined with the exact body string "Failed to retrieve RMIServer stub: javax.naming.CommunicationException: 127.0.0.1:1389", confirming the proxy-mode JNDI processing flaw via a harmless localhost probe.

## References
- https://jolokia.org/#Security_fixes_with_1.5.0
- https://access.redhat.com/errata/RHSA-2018:2669
- https://nvd.nist.gov/vuln/detail/CVE-2018-1000130
- https://github.com/ARPSyndicate/cvemon
- https://github.com/SexyBeast233/SecBooks
