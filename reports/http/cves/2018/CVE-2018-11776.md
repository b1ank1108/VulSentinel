---
cve_id: CVE-2018-11776
template_path: nuclei-templates/http/cves/2018/CVE-2018-11776.yaml
affected_product: Apache Struts2 S2-057
severity: high
authentication: none
external_callback: false
affected_versions: 2.3 to 2.3.34 and 2.5 to 2.5.16
preconditions: alwaysSelectFullNamespace=true (by user or Convention Plugin); results used with no namespace + upper package has no/wildcard namespace; or url tag without value/action + upper package has no/wildcard namespace
poc_classification: rce
---

## Vulnerability
Apache Struts2 S2-057 (CVE-2018-11776) enables remote code execution via OGNL expression injection.  
Apache Struts versions 2.3 to 2.3.34 and 2.5 to 2.5.16 suffer from possible remote code execution when alwaysSelectFullNamespace is true (either by user or a plugin like Convention Plugin) and then: results are used with no namespace and in same time, its upper package have no or wildcard namespace and similar to results, same possibility when using url tag which doesn't have value and action set and in same time, its upper package have no or wildcard namespace.  
Impact: Remote code execution.  
Remediation: Apply the latest security patches or upgrade to a non-vulnerable version of Apache Struts2.

## PoC / Detection
Classification: rce  
The template performs unauthenticated GET requests to three variant OGNL payloads appended to common .action endpoints (/help.action and /actionChain1.action). Each payload bypasses member-access restrictions, executes `cat /etc/passwd` via Runtime.exec or ProcessBuilder, and forces the response output stream to return the command result. Detection stops at the first match: HTTP 200 status combined with regex `root:.*:0:0:` confirming successful command execution.

## References
- https://github.com/jas502n/St2-057
- https://cwiki.apache.org/confluence/display/WW/S2-057
- https://security.netapp.com/advisory/ntap-20180822-0001/
- https://nvd.nist.gov/vuln/detail/CVE-2018-11776
- http://packetstormsecurity.com/files/172830/Apache-Struts-Remote-Code-Execution.html
