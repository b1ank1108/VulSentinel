---
cve_id: CVE-2018-13380
template_path: nuclei-templates/http/cves/2018/CVE-2018-13380.yaml
affected_product: Fortinet FortiOS
severity: medium
authentication: none
external_callback: false
affected_versions: 6.0.0 to 6.0.4, 5.6.0 to 5.6.7, 5.4.0 to 5.4.12, 5.2 and below
preconditions: SSL VPN web portal accessible
poc_classification: info-leak
---

## Vulnerability
Fortinet FortiOS SSL VPN web portal is vulnerable to reflected cross-site scripting via unsanitized `title`/`msg` (in `/message`) and `errmsg` (in `/remote/error`) parameters. Affected versions: 6.0.0-6.0.4, 5.6.0-5.6.7, 5.4.0-5.4.12, and 5.2 and below. An attacker can inject and execute arbitrary script code in a victim's browser by supplying a malicious URL.  
CVSS 3.1 score: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).  
Impact: session hijacking, page defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak  
The template sends two unauthenticated GET requests:  
- `{{BaseURL}}/message?title=x&msg=%26%23%3Csvg/onload=alert(1337)%3E%3B`  
- `{{BaseURL}}/remote/error?errmsg=ABABAB--%3E%3Cscript%3Ealert(1337)%3C/script%3E`  
Matchers confirm vulnerability if the raw payload (`<svg/onload=alert(1337)>` or `<script>alert(1337)</script>`) appears unsanitized in the response body (OR condition), status is 200, and Content-Type is not `application/json`.

## References
- https://blog.orange.tw/2019/08/attacking-ssl-vpn-part-2-breaking-the-fortigate-ssl-vpn.html
- https://fortiguard.com/advisory/FG-IR-18-383
- https://fortiguard.com/advisory/FG-IR-20-230
- https://nvd.nist.gov/vuln/detail/CVE-2018-13380
- https://github.com/merlinepedra25/nuclei-templates
