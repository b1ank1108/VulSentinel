---
cve_id: CVE-2018-7192
template_path: nuclei-templates/http/cves/2018/CVE-2018-7192.yaml
affected_product: osTicket
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.10.2
preconditions: requires staff login with valid credentials
poc_classification: info-leak
---

## Vulnerability
osTicket before 1.10.2 contains a reflected cross-site scripting vulnerability in `/ajax.php/form/help-topic`. Remote attackers can inject arbitrary web script or HTML via the `message` parameter.

**CVE ID**: CVE-2018-7192  
**CWE**: CWE-79  
**CVSS v3.0**: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**Description**: Cross-site scripting (XSS) vulnerability in /ajax.php/form/help-topic in Enhancesoft osTicket before 1.10.2 allows remote attackers to inject arbitrary web script or HTML via the "message" parameter.  
**Impact**: Attacker-supplied JavaScript executes in the victim's browser context, enabling data theft (session tokens, cookies, form data) or unauthorized actions.  
**Remediation**: Upgrade to 1.10.2 or later.  
**Metadata**: Vendor: osticket, Product: osticket, Shodan: title:"osTicket".

## PoC / Detection
Classification: info-leak

The template first issues a GET to `/scp/login.php` to confirm the osTicket instance and extract the `__CSRFToken__` value via regex. It then performs a POST to `/scp/login.php` with the extracted token plus supplied `{{username}}` and `{{password}}` to establish an authenticated session. Finally, it sends a GET request to `/ajax.php/form/help-topic/1` embedding a reflected XSS payload in the `message` parameter (`dgh7r onmouseover=alert(document.domain) style=position:absolute;width:100%;height:100%;top:0;left:0; qavj5`).  

Detection succeeds if the response body contains the unsanitized payload string, returns HTTP 200, and has `text/html` content-type, proving the parameter is reflected without sanitization.

## References
- https://blog.securityevaluators.com/vulnerabilities-found-in-popular-ticketing-system-dd273bda229c
- https://nvd.nist.gov/vuln/detail/CVE-2018-7192
