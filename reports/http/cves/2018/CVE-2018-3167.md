---
cve_id: CVE-2018-3167
template_path: nuclei-templates/http/cves/2018/CVE-2018-3167.yaml
affected_product: Oracle E-Business Suite Application Management Pack
severity: medium
authentication: none
external_callback: true
affected_versions: 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-3167 is a blind server-side request forgery (SSRF) vulnerability in Oracle E-Business Suite's Application Management Pack component, specifically within the User Monitoring subcomponent. The vulnerability allows an unauthenticated attacker with network access via HTTP to exploit XML External Entity (XXE) processing in the `lcmServiceController.jsp` endpoint. 

By injecting a malicious DTD (Document Type Definition) declaration, an attacker can force the server to make outbound requests to arbitrary URLs. This enables the attacker to:
- Gain read access to a subset of internal data
- Connect to internal services such as HTTP-enabled databases
- Perform POST requests towards internal services not intended to be exposed
- Bypass network restrictions and access internal resources

The vulnerability has a CVSS v3.0 score of 5.3 (Medium severity) with the vector CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N, indicating network-based exploitation requiring no privileges or user interaction, with low confidentiality impact.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a POST request to `/OA_HTML/lcmServiceController.jsp` with a malicious XML payload containing a DOCTYPE declaration that references an external entity pointing to `http://interact.sh`. The payload structure is:

```xml
<!DOCTYPE root PUBLIC "-//B/A/EN" "http://interact.sh">
```

The template verifies the vulnerability through two conditions:
1. The response body contains the error message "Unexpected text in DTD", indicating the server attempted to process the external DTD reference
2. The HTTP response status is 200

This detection method confirms that the XML parser processes external entities and attempts to make outbound connections, demonstrating the blind SSRF condition. The use of `interact.sh` (an out-of-band interaction service) allows verification of the server making external requests, though the template itself only checks for the error message rather than confirming the actual callback.

## References

- http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html
- http://web.archive.org/web/20211206102649/https://securitytracker.com/id/1041897
- https://medium.com/@x41x41x41/unauthenticated-ssrf-in-oracle-ebs-765bd789a145
- https://nvd.nist.gov/vuln/detail/CVE-2018-3167
- http://www.securitytracker.com/id/1041897
