---
cve_id: CVE-2018-2791
template_path: nuclei-templates/http/cves/2018/CVE-2018-2791.yaml
affected_product: Oracle Fusion Middleware WebCenter Sites
severity: high
authentication: none
external_callback: false
affected_versions: 11.1.1.8.0, 12.2.1.2.0, 12.2.1.3.0
preconditions: human interaction from a person other than the attacker
poc_classification: info-leak
---

## Vulnerability
Oracle Fusion Middleware WebCenter Sites component of Oracle Fusion Middleware is susceptible to multiple instances of cross-site scripting. Unauthenticated attackers with network access via HTTP can compromise Oracle WebCenter Sites. Impacted versions that are affected are 11.1.1.8.0, 12.2.1.2.0 and 12.2.1.3.0. Successful attacks require human interaction from a person other than the attacker and while the vulnerability is in Oracle WebCenter Sites, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized access to critical data or complete access to all Oracle WebCenter Sites accessible data as well as unauthorized update, insert or delete access to some Oracle WebCenter Sites accessible data. Successful exploitation could allow an attacker to execute arbitrary script code in the context of the targeted user's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak

The template sends two raw GET requests to `/cs/Satellite` embedding reflected XSS payloads in query parameters (`cs_imagedir=qqq%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E` and `destpage="<h1xxx"><script>alert(document.domain)</script>`). It verifies the vulnerability with word matchers on the response body looking for unsanitized reflection of the `<script>alert(...)` payloads (first matcher single word; second matcher requires both alert string and "Missing translation key" under AND condition). Uses `stop-at-first-match: true` and `matchers-condition: or`.

## References
- http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
- http://web.archive.org/web/20211206165005/https://securitytracker.com/id/1040695
- https://www.exploit-db.com/exploits/44752/
- https://outpost24.com/blog/Vulnerabilities-discovered-in-Oracle-WebCenter-Sites
- https://nvd.nist.gov/vuln/detail/CVE-2018-2791
