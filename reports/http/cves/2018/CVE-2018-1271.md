---
cve_id: CVE-2018-1271
template_path: nuclei-templates/http/cves/2018/CVE-2018-1271.yaml
affected_product: Spring MVC Framework
severity: medium
authentication: none
external_callback: false
affected_versions: 5.0 prior to 5.0.5 and 4.3 prior to 4.3.15 and older unsupported
preconditions: Spring MVC configured to serve static resources (e.g. CSS, JS, images)
poc_classification: info-leak
---

## Vulnerability
Spring MVC Framework versions 5.0 prior to 5.0.5 and versions 4.3 prior to 4.3.15 (and older unsupported) are vulnerable to local file inclusion via directory traversal. The flaw exists because applications can configure Spring MVC to serve static resources (e.g. CSS, JS, images); specially crafted URLs with encoded traversal sequences allow attackers to read arbitrary files from the server filesystem.

Impact: Successful exploitation allows reading sensitive server files, leading to unauthorized access or information disclosure.  
Remediation: Apply latest security patches and updates from the vendor.  
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N (score 5.9). CWE-22.

## PoC / Detection
Classification: info-leak

The template sends two unauthenticated GET requests using double URL-encoded backslash sequences (%255c%255c..%255c) for path traversal. Targets are common static-resource endpoints: `{{BaseURL}}/static/.../windows/win.ini` and `{{BaseURL}}/spring-mvc-showcase/resources/.../windows/win.ini`. Detection succeeds on HTTP 200 status combined with the matcher word "for 16-bit app support" (characteristic string from win.ini).

## References
- https://medium.com/@knownsec404team/analysis-of-spring-mvc-directory-traversal-vulnerability-cve-2018-1271-b291bdb6be0d
- https://pivotal.io/security/cve-2018-1271
- https://access.redhat.com/errata/RHSA-2018:1320
- https://nvd.nist.gov/vuln/detail/CVE-2018-1271
- http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html
