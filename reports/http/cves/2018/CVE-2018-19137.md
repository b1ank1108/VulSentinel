---
cve_id: CVE-2018-19137
template_path: nuclei-templates/http/cves/2018/CVE-2018-19137.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: 4.11.01
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DomainMOD 4.11.01 suffers from a reflected cross-site scripting (XSS) vulnerability (CWE-79) in the IP-address editing endpoint `/assets/edit/ip-address.php`. The `ipid` query parameter is reflected unsanitized into the HTML response body when `del=1` is supplied.  

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
Successful exploitation allows arbitrary JavaScript execution in the victimâ€™s browser context, enabling session hijacking, page defacement, or theft of sensitive information (cookies, tokens, form data).  

Remediation: upgrade to a patched release or apply the vendor fix.

## PoC / Detection
Classification: info-leak  

The template first performs a POST login to `/` using form-encoded credentials (`new_username={{username}}&new_password={{password}}`). It then sends a GET request to `/assets/edit/ip-address.php?ipid=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E&del=1`. Detection triggers on an AND match of:  
- response body contains the unsanitized string `<script>alert(document.domain)</script>&really_del`  
- `Content-Type` header contains `text/html`  
- HTTP status 200  

This confirms lack of output encoding on the `ipid` value, verifying the reflected XSS condition.

## References
- https://github.com/domainmod/domainmod/issues/79
- https://nvd.nist.gov/vuln/detail/CVE-2018-19137
- https://github.com/ARPSyndicate/kenzer-templates
