---
cve_id: CVE-2018-16283
template_path: nuclei-templates/http/cves/2018/CVE-2018-16283.yaml
affected_product: WordPress Wechat Broadcast plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-16283 is a Local File Inclusion (LFI) vulnerability in the WordPress Wechat Broadcast plugin version 1.2.0 and earlier. The vulnerability exists in the `Image.php` file, which fails to properly sanitize the `url` parameter, allowing unauthenticated attackers to perform directory traversal attacks. By manipulating the `url` parameter with path traversal sequences (e.g., `../../`), attackers can read arbitrary files on the WordPress server's filesystem.

The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) and has a CVSS v3.0 score of 9.8 (Critical), with an attack vector that requires no privileges, no user interaction, and has low attack complexity. The EPSS score of 0.77894 (98.977th percentile) indicates a high probability of exploitation in the wild.

Successful exploitation allows attackers to access sensitive files such as `/etc/passwd`, `wp-config.php` (containing database credentials), private keys, and other configuration files, leading to complete compromise of confidentiality, integrity, and availability of the WordPress installation.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending an HTTP GET request to the vulnerable `Image.php` endpoint with a directory traversal payload in the `url` parameter:

```
/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=../../../../../../../../../../etc/passwd
```

The template attempts to traverse up the directory structure to access the `/etc/passwd` file on Unix-based systems. Detection is confirmed by matching a regex pattern in the response body that identifies the root user entry (`root:.*:0:0:`), which is characteristic of the `/etc/passwd` file format. A successful match indicates the plugin is vulnerable to LFI and allows arbitrary file read access without authentication.

## References

- https://www.exploit-db.com/exploits/45438
- https://nvd.nist.gov/vuln/detail/CVE-2018-16283
- https://github.com/springjk/wordpress-wechat-broadcast/issues/14
- http://seclists.org/fulldisclosure/2018/Sep/32
- https://exchange.xforce.ibmcloud.com/vulnerabilities/150202
