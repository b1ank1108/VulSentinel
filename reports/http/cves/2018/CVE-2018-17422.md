---
cve_id: CVE-2018-17422
template_path: nuclei-templates/http/cves/2018/CVE-2018-17422.yaml
affected_product: DotCMS
severity: medium
authentication: none
external_callback: false
affected_versions: < 5.0.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DotCMS before 5.0.2 is vulnerable to open redirect issues via the `FORWARD_URL` parameter in `html/common/forward_js.jsp` and the `hostname` parameter in `html/portlet/ext/common/page_preview_popup.jsp`. An attacker can supply an arbitrary URL, causing the application to generate JavaScript that redirects the victim browser to a malicious site. This enables phishing, potential sensitive information disclosure, data modification, or unauthorized operations (CVSS 6.1, CWE-601).

## PoC / Detection
Classification: info-leak

The template performs two GET requests (stopping at first match):  
`{{BaseURL}}/html/common/forward_js.jsp?FORWARD_URL=http://oast.me`  
`{{BaseURL}}/html/portlet/ext/common/page_preview_popup.jsp?hostname=oast.me`  
It then applies word matchers on the response body looking for exact strings `"self.location = 'http://oast.me'"` or `"location.href = 'http\x3a\x2f\x2fwww\x2eoast\x2eme'"` to confirm the injected value is reflected unsanitized in client-side redirection code.

## References
- https://github.com/dotCMS/core/issues/15286
- https://nvd.nist.gov/vuln/detail/CVE-2018-17422
- https://github.com/ARPSyndicate/kenzer-templates
