---
cve_id: CVE-2018-7765
template_path: nuclei-templates/http/cves/2018/CVE-2018-7765.yaml
affected_product: Schneider Electric U.motion Builder
severity: high
authentication: none
external_callback: false
affected_versions: < v1.3.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-7765 is a SQL injection vulnerability in Schneider Electric U.motion Builder software versions prior to v1.3.4. The vulnerability exists in the `track_import_export.php` file within the reporting module, where the underlying SQLite database query fails to properly sanitize the `object_id` input parameter. This allows attackers to inject arbitrary SQL commands into the database query, potentially leading to unauthorized data access, modification, or deletion. The vulnerability has a CVSS v3.0 score of 8.8 (High), classified under CWE-89 (SQL Injection). The attack vector is network-based with low attack complexity, requires no privileges, but does require user interaction.

## PoC / Detection

Classification: info-leak

The template performs a blind SQL injection detection using an ORDER BY clause enumeration technique. It sends two sequential POST requests to `/umotion/modules/reporting/track_import_export.php`:

1. **First request**: Injects `object_id=1' order by 1-- -` to test if ordering by the first column succeeds. The template expects a successful response containing 'Object' and 'Period' strings without the error message 'Invalid argument supplied for foreach', with content-type 'application/octet-stream' and HTTP 200 status.

2. **Second request**: Injects `object_id=1' order by 2-- -` to test if ordering by a second column triggers an error. The template expects the response to contain 'Object', 'Period', AND the error message 'Invalid argument supplied for foreach', confirming the SQL injection by demonstrating control over the query structure.

This two-step approach confirms SQL injection by showing that valid SQL syntax is processed differently than invalid syntax, proving the application is vulnerable to SQL injection attacks that could be leveraged for data exfiltration.

## References

- http://seclists.org/fulldisclosure/2019/May/26
- https://www.schneider-electric.com/en/download/document/SEVD-2018-095-01/
