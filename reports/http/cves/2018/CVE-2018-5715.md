---
cve_id: CVE-2018-5715
template_path: nuclei-templates/http/cves/2018/CVE-2018-5715.yaml
affected_product: SugarCRM
severity: medium
authentication: none
external_callback: false
affected_versions: 3.5.1
preconditions: []
poc_classification: detect-only
---

## Vulnerability

CVE-2018-5715 is a reflected cross-site scripting (XSS) vulnerability in SugarCRM version 3.5.1. The vulnerability exists in the phprint.php file where parameter names in the query string (specifically the $key variable) are not properly sanitized before being reflected in the HTML response. An attacker can inject arbitrary JavaScript code through crafted URL parameters, which will execute in the context of a victim's browser when they visit the malicious link. This can lead to session hijacking, credential theft, website defacement, or other client-side attacks. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1, requiring user interaction but no authentication.

## PoC / Detection

Classification: detect-only

The template detects this XSS vulnerability by sending a GET request to the SugarCRM login page with a crafted query string containing an XSS payload. The request targets `/index.php?action=Login&module=Users&print=a` with an injected parameter `&"/><script>alert(1)</script>`. The template verifies the vulnerability by checking for three conditions: (1) the reflected XSS payload appears in the response body as `&"/><script>alert(1)</script>=&"><< Back</a><br><br>`, (2) the response Content-Type header is `text/html`, and (3) the HTTP status code is 200. This confirms that the malicious script is reflected unescaped in the HTML output, making the application vulnerable to XSS attacks.

## References

- https://www.exploit-db.com/exploits/43683
- https://m4k4br0.github.io/sugarcrm-xss/
- https://www.exploit-db.com/exploits/43683/
- https://nvd.nist.gov/vuln/detail/CVE-2018-5715
- https://github.com/ARPSyndicate/kenzer-templates
