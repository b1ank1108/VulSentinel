---
cve_id: CVE-2018-17431
template_path: nuclei-templates/http/cves/2018/CVE-2018-17431.yaml
affected_product: Comodo Unified Threat Management Web Console
severity: critical
authentication: none
external_callback: false
affected_versions: All releases before 2.7.0 & 1.5.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Comodo Unified Threat Management Web Console (part of Comodo Firewall & Central Manager / UTM) contains a web-shell-based remote code execution flaw due to improper authentication (CWE-287).  

Unauthenticated remote attackers can reach the `/manage/webshell/u` endpoint and execute arbitrary system commands, resulting in full compromise (CVSS 3.1 score 9.8: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  

**Impact**  
Arbitrary code execution on the target system.  

**Remediation**  
Apply the latest security patches or updates provided by Comodo.

## PoC / Detection
Classification: rce

The template sends two raw GET requests to `/manage/webshell/u` on the target host.  
1. First request embeds the encoded command sequence `service\nssh\ndisable\n` inside the `k` query parameter (along with fixed `s=5&w=218&h=15&l=62`).  
2. Second request triggers execution with a minimal `k=%0a` payload.  
Detection succeeds on HTTP 200 and the literal string "Configuration has been altered" in the response body, confirming the webshell accepted and processed the command (state change proving RCE capability).

## References
- https://www.exploit-db.com/exploits/48825
- https://secure.comodo.com/home/purchase.php?pid=106&license=try&track=9276&af=9276
- https://nvd.nist.gov/vuln/detail/CVE-2018-17431
- https://github.com/Fadavvi/CVE-2018-17431-PoC#confirmation-than-bug-exist-2018-09-25-ticket-id-xwr-503-79437
- https://drive.google.com/file/d/0BzFJhNQNHcoTbndsUmNjVWNGYWNJaWxYcWNyS2ZDajluTDFz/view
