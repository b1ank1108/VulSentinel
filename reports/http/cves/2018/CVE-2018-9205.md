---
cve_id: CVE-2018-9205
template_path: nuclei-templates/http/cves/2018/CVE-2018-9205.yaml
affected_product: Drupal avatar_uploader
severity: high
authentication: none
external_callback: false
affected_versions: 7.x-1.0-beta8
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-9205 is a Local File Inclusion (LFI) vulnerability in the Drupal avatar_uploader module version 7.x-1.0-beta8. The vulnerability exists in the `view.php` program within the module, which fails to properly restrict or validate file paths provided through user input. This path traversal flaw (CWE-22) allows unauthenticated remote attackers to read arbitrary files from the server's filesystem by manipulating the `file` parameter with directory traversal sequences (e.g., `../`).

The vulnerability has a CVSS v3.0 score of 7.5 (High severity) with the vector CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, indicating network-based exploitation with low complexity, no privileges required, no user interaction needed, and high impact on confidentiality. The EPSS score of 0.81446 (99.15th percentile) suggests a very high probability of active exploitation in the wild.

Successful exploitation enables attackers to access sensitive files such as `/etc/passwd`, configuration files containing database credentials, application secrets, and other confidential data stored on the server filesystem.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending an HTTP GET request to the vulnerable endpoint at `/sites/all/modules/avatar_uploader/lib/demo/view.php` with a malicious `file` parameter containing directory traversal sequences (`../../../../../../../../../../../etc/passwd`). 

The template attempts to read the Unix/Linux password file (`/etc/passwd`) to verify the LFI vulnerability. Detection is confirmed when:
1. The HTTP response status code is 200 (OK)
2. The response body contains a regex pattern matching typical `/etc/passwd` entries (`root:.*:0:0:`), indicating successful file disclosure

This non-invasive detection method verifies the presence of the path traversal vulnerability without modifying any system state.

## References

- https://www.exploit-db.com/exploits/44501
- https://nvd.nist.gov/vuln/detail/CVE-2018-9205
- https://www.drupal.org/project/avatar_uploader/issues/2957966
- https://www.drupal.org/project/avatar_uploader
- https://github.com/ARPSyndicate/cvemon
