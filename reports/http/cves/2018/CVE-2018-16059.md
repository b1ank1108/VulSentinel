---
cve_id: CVE-2018-16059
template_path: nuclei-templates/http/cves/2018/CVE-2018-16059.yaml
affected_product: WirelessHART Fieldgate SWG70
severity: medium
authentication: none
external_callback: false
affected_versions: 3.0 (specifically 3.00.07)
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2018-16059 is a local file inclusion (LFI) vulnerability affecting the WirelessHART Fieldgate SWG70 version 3.0 (firmware 3.00.07). The vulnerability exists in the `/fcgi-bin/wgsetcgi` endpoint, specifically in the `filename` parameter handling. An attacker can exploit this flaw to traverse the filesystem using path traversal sequences (`../../`) and read arbitrary files on the system without authentication.

The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS v3.0 score of 5.3 (Medium severity). The CVSS vector (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) indicates this is a network-exploitable vulnerability requiring no privileges or user interaction, with impact limited to confidentiality (information disclosure). The EPSS score of 0.37052 (97th percentile) suggests a relatively high probability of exploitation in the wild.

Successful exploitation allows unauthorized reading of sensitive system files, potentially exposing configuration data, credentials, or other information that could facilitate further attacks against the industrial IoT device.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a POST request to `/fcgi-bin/wgsetcgi` with a crafted payload that attempts to read the `/etc/passwd` file through path traversal. The request body includes:
- `action=ajax`
- `command=4`
- `filename=../../../../../../../../../../etc/passwd` (path traversal sequence)
- `origin=cw.Communication.File.Read`
- `transaction=fileCommand`

The template confirms the vulnerability by checking for two conditions:
1. The response body contains a regex pattern matching typical `/etc/passwd` entries (`root:.*:0:0:`)
2. The HTTP response status is 200

This detection method validates that the LFI vulnerability is exploitable and that the system returns the contents of sensitive files without proper access controls.

## References

- https://www.exploit-db.com/exploits/45342
- https://ics-cert.us-cert.gov/advisories/ICSA-19-073-03
- https://nvd.nist.gov/vuln/detail/CVE-2018-16059
- https://www.exploit-db.com/exploits/45342/
- https://cert.vde.com/en-us/advisories/vde-2019-002
