---
cve_id: CVE-2018-20010
template_path: nuclei-templates/http/cves/2018/CVE-2018-20010.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: through 4.11.01
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DomainMOD through version 4.11.01 is vulnerable to stored cross-site scripting (XSS) via the Username field on `/assets/add/ssl-provider-account.php`. An authenticated high-privilege user can inject a malicious payload that is persisted and later rendered unsanitized when any user views `/assets/ssl-accounts.php`.  
Impact: arbitrary JavaScript execution in the victimâ€™s browser context, enabling session hijacking, page defacement, or theft of sensitive information.  
Classification: CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8), CWE-79.

## PoC / Detection
Classification: info-leak

The template first authenticates by POSTing `new_username={{username}}&new_password={{password}}` to `/`. It then POSTs the XSS payload `%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E` in the `new_username` parameter (along with dummy values for other fields) to `/assets/add/ssl-provider-account.php`. Finally, it issues a GET to `/assets/ssl-accounts.php` and uses DSL matchers to confirm HTTP 200, text/html Content-Type, and the literal unescaped `<script>alert(document.domain)</script>` string inside the response body.

## References
- https://www.exploit-db.com/exploits/46373/
- https://github.com/domainmod/domainmod/issues/88
- https://nvd.nist.gov/vuln/detail/CVE-2018-20010
- https://github.com/ARPSyndicate/kenzer-templates
