---
cve_id: CVE-2018-15917
template_path: nuclei-templates/http/cves/2018/CVE-2018-15917.yaml
affected_product: Jorani Leave Management System
severity: medium
authentication: none
external_callback: false
affected_versions: 0.6.5
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2018-15917 is a persistent cross-site scripting (XSS) vulnerability in Jorani Leave Management System version 0.6.5. The vulnerability exists in the language parameter of the `/session/language` endpoint, which fails to properly sanitize user input before storing and rendering it. Attackers can inject arbitrary JavaScript or HTML code through this parameter, which then executes persistently in the browsers of other users who access the application, including administrators. This can lead to session hijacking, credential theft, or unauthorized actions performed in the context of victim users. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 5.4 (Medium severity).

## PoC / Detection

Classification: state-change

The template detects this vulnerability by sending a crafted GET request to the `/session/language` endpoint with a malicious JavaScript payload embedded in the `language` parameter: `en"><script>alert(document.domain)</script>`. The template then makes a second request to `/session/login` to verify that the injected script persists and is rendered in the application's HTML response. The detection confirms the vulnerability by checking for:

1. The presence of the injected script tag `<script>alert(document.domain)</script>` in the response body
2. The presence of the string `_jorani` to confirm the target application
3. A `text/html` content-type header
4. A 200 HTTP status code

The successful detection indicates that the XSS payload was stored and is being reflected back to users, demonstrating the persistent nature of the vulnerability.

## References

- https://www.exploit-db.com/exploits/45338
- https://nvd.nist.gov/vuln/detail/CVE-2018-15917
- https://github.com/bbalet/jorani/issues/254
- https://github.com/JavierOlmedo/JavierOlmedo
