---
cve_id: CVE-2018-11784
template_path: nuclei-templates/http/cves/2018/CVE-2018-11784.yaml
affected_product: Apache Tomcat
severity: medium
authentication: none
external_callback: true
affected_versions: versions prior to 9.0.12, 8.5.34, and 7.0.91
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Apache Tomcat versions prior to 9.0.12, 8.5.34, and 7.0.91 are prone to an open-redirection vulnerability because it fails to properly sanitize user-supplied input. An unauthenticated remote attacker can craft a URL containing `//` followed by an external domain to trigger an unintended redirect.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N (score 4.3), CWE-601.  
Impact: An attacker can redirect users to malicious websites, leading to phishing attacks or the download of malware.  
Remediation: Upgrade to Apache Tomcat version 9.0.12 or later, or apply the relevant patch provided by the Apache Software Foundation.

## PoC / Detection
Classification: detect-only

The template issues a single GET request to `{{BaseURL}}//interact.sh` and matches on the response if the Location header contains a redirect to `interact.sh` (case-insensitive regex on the header part) while the status code is not 404. This behaviorally confirms the open-redirect condition via a harmless probe.

## References
- https://lists.apache.org/thread.html/23134c9b5a23892a205dc140cdd8c9c0add233600f76b313dda6bd75@%3Cannounce.tomcat.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2018-11784
- http://lists.opensuse.org/opensuse-security-announce/2019-06/msg00030.html
- http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00056.html
- http://packetstormsecurity.com/files/163456/Apache-Tomcat-9.0.0M1-Open-Redirect.html
