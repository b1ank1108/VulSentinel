---
cve_id: CVE-2018-1000856
template_path: nuclei-templates/http/cves/2018/CVE-2018-1000856.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: 4.11.01
preconditions: []
poc_classification: info-leak
---

## Vulnerability
DomainMOD 4.11.01 contains a stored cross-site scripting vulnerability in the Segment Name field processed by `/segments/add.php`.  
An authenticated attacker can inject arbitrary JavaScript that is persisted and later rendered unescaped when any user views the segments listing page.  
**Description:** DomainMOD 4.11.01 is vulnerable to cross-site scripting via the segments/add.php Segment Name field.  
**Impact:** Successful exploitation allows execution of arbitrary JavaScript in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information such as cookies and credentials.  
**CVSS v3.0:** 4.8 (AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**Remediation:** Upgrade to a patched release or apply the vendor patch.

## PoC / Detection
Classification: info-leak  
The template first POSTs login credentials (`new_username`/`new_password`) to `/` to establish an authenticated session, then POSTs a payload containing `<script>alert(1)</script>` in the `new_name` field to `/segments/add.php` (with dummy domain/description/notes), and finally issues a GET to `/segments/`. Detection succeeds when the response body contains the literal unescaped string `<script>alert(1)</script></a>` together with HTTP 200 and `text/html` content-type, confirming the stored XSS.

## References
- https://github.com/domainmod/domainmod/issues/80
- https://nvd.nist.gov/vuln/detail/CVE-2018-1000856
- https://github.com/ARPSyndicate/kenzer-templates
