---
cve_id: CVE-2018-9995
template_path: nuclei-templates/http/cves/2018/CVE-2018-9995.yaml
affected_product: TBK DVR4104/DVR4216 Devices
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2018-9995 is a critical authentication bypass vulnerability affecting TBK DVR4104 and DVR4216 devices, as well as multiple re-branded versions including Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login. The vulnerability allows remote attackers to bypass authentication by sending a simple "Cookie: uid=admin" header in HTTP requests. This enables unauthorized access to sensitive device functionality, including the ability to retrieve user credentials via a device.rsp endpoint that returns JSON data containing usernames, passwords, and permission levels.

The flaw represents a complete failure of authentication controls, as the device trusts client-supplied cookie values without proper validation. An attacker can gain full administrative access to the DVR system without knowing any legitimate credentials, potentially leading to unauthorized configuration changes, surveillance of video feeds, data exfiltration, and complete compromise of the device.

## PoC / Detection

Classification: auth-bypass

The template detects this authentication bypass vulnerability by sending a GET request to the `/device.rsp?opt=user&cmd=list` endpoint without any authentication credentials. The request does not include the "Cookie: uid=admin" header mentioned in the vulnerability description, suggesting the endpoint may be accessible without authentication or the template is testing for the presence of the vulnerable endpoint.

The template verifies the vulnerability by checking for:
1. HTTP 200 status code response
2. Presence of JSON fields indicating user account data: "uid" (user ID), "pwd" (password), "view" (view permissions), and "playback" (playback permissions)

If all matchers are satisfied, the device is confirmed vulnerable, as it exposes sensitive user credential information through an improperly secured endpoint that should require authentication.

## References

- https://www.exploit-db.com/exploits/44577/
- http://misteralfa-hack.blogspot.cl/2018/04/tbk-vision-dvr-login-bypass.html
- http://misteralfa-hack.blogspot.cl/2018/04/update-dvr-login-bypass-cve-2018-9995.html
- https://www.bleepingcomputer.com/news/security/new-hacking-tool-lets-users-access-a-bunch-of-dvrs-and-their-video-feeds/
- https://nvd.nist.gov/vuln/detail/CVE-2018-9995
