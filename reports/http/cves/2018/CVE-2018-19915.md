---
cve_id: CVE-2018-19915
template_path: nuclei-templates/http/cves/2018/CVE-2018-19915.yaml
affected_product: DomainMOD
severity: medium
authentication: required
external_callback: false
affected_versions: <=4.11.01
preconditions: [user with permissions to add/edit web hosts]
poc_classification: info-leak
---

## Vulnerability
DomainMOD through version 4.11.01 contains a stored cross-site scripting (XSS) vulnerability (CWE-79) in the Web Host Name or Web Host URL fields when adding or editing hosts via assets/add/host.php (or assets/edit/host.php). Injected payloads persist and execute without sanitization when any user (typically an administrator) views the hosts list at /assets/hosting.php.

CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (4.8). Successful exploitation allows arbitrary JavaScript execution in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information.

Remediation: Upgrade to DomainMOD >=4.11.02.

## PoC / Detection
Classification: info-leak

The template verifies the vulnerability via an authenticated multi-step workflow that injects a proof-of-concept payload and confirms unsanitized output:
- POST to / with username/password to establish session.
- POST to /assets/add/host.php with new_host and new_url set to `<script>alert(document.domain)</script>`.
- GET /assets/hosting.php followed by DSL matcher confirming the exact payload string appears unescaped inside the HTML response body.

This confirms stored XSS without triggering external callbacks or destructive actions.

## References
- https://github.com/domainmod/domainmod/issues/87
- https://www.exploit-db.com/exploits/46376/
- https://nvd.nist.gov/vuln/detail/CVE-2018-19915
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
