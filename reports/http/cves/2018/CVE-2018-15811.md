---
cve_id: CVE-2018-15811
template_path: nuclei-templates/http/cves/2018/CVE-2018-15811.yaml
affected_product: DotNetNuke
severity: high
authentication: none
external_callback: false
affected_versions: 9.2 - 9.2.1
preconditions: []
poc_classification: rce
---

## Vulnerability

DotNetNuke versions 9.2 through 9.2.1 contain a critical security flaw involving weak encryption algorithms used to protect input parameters. This cryptographic weakness allows attackers to decrypt or tamper with input parameters and craft malicious DNNPersonalization cookies. When these specially crafted cookies are processed by the application, they trigger insecure deserialization, leading to remote code execution. The vulnerability is classified as CWE-326 (Inadequate Encryption Strength) and has a CVSS score of 7.5. The weakness in the encryption scheme enables attackers to bypass cryptographic protections and inject serialized objects that execute arbitrary code when deserialized by the server.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a crafted HTTP GET request to a non-existent path (`/__`) with a malicious DNNPersonalization cookie. The cookie contains a specially crafted XML serialization payload that exploits the weak encryption and deserialization vulnerability. The payload attempts to invoke `System.Data.Services.Internal.ExpandedWrapper` with `System.Windows.Data.ObjectDataProvider` to call the `FileSystemUtils.WriteFile` method with the parameter `C:\Windows\win.ini`. 

The template verifies successful exploitation by checking for a 404 status code (indicating the requested path doesn't exist, but the cookie was processed) and the presence of specific strings from the Windows win.ini file (`[extensions]` and `for 16-bit app support`) in the response body. The appearance of these strings confirms that the deserialization occurred and the file read operation was executed, demonstrating the remote code execution capability.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2018-15811
- https://github.com/dnnsoftware/Dnn.Platform/releases
- http://packetstormsecurity.com/files/157080/DotNetNuke-Cookie-Deserialization-Remote-Code-Execution.html
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/dnn_cookie_deserialization_rce.rb
