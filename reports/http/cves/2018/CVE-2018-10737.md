---
cve_id: CVE-2018-10737
template_path: nuclei-templates/http/cves/2018/CVE-2018-10737.yaml
affected_product: Nagios XI
severity: high
authentication: required
external_callback: false
affected_versions: <= 5.4.12
preconditions: [administrator authentication]
poc_classification: state-change
---

## Vulnerability
SQL injection in the `txtSearch` parameter of `admin/logbook.php`.  
A SQL injection issue was discovered in Nagios XI before 5.4.13 via the admin/logbook.php txtSearch parameter.  
Authenticated administrators can execute arbitrary SQL commands to access, modify, or delete database contents, potentially compromising the entire Nagios XI instance.  
CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2)  
CWE-89  
Remediation: Upgrade to Nagios XI version 5.4.13 or later.

## PoC / Detection
Classification: state-change  
The template issues a single POST request to `/nagiosql/admin/logbook.php` with a crafted `txtSearch` payload containing a subquery `(select count(*),concat((select (select (select md5({{rand_int}}))) from information_schema.tables limit 0,1),floor(rand(0)*2))x ... group by x)` that triggers a duplicate-key error leaking the computed MD5 value. Detection succeeds if the exact MD5 hash of the random integer appears in the response body.

## References
- https://vulners.com/seebug/SSV:97267
- https://nvd.nist.gov/vuln/detail/CVE-2018-10737
