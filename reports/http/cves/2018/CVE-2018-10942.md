---
cve_id: CVE-2018-10942
template_path: nuclei-templates/http/cves/2018/CVE-2018-10942.yaml
affected_product: PrestaShop AttributeWizardPro Module
severity: critical
authentication: none
external_callback: false
affected_versions: 1.6.9
preconditions: [AttributeWizardPro module installed]
poc_classification: rce
---

## Vulnerability
PrestaShop AttributeWizardPro Module (Attribute Wizard addon version 1.6.9) allows unauthenticated remote attackers to execute arbitrary code by uploading a PHP file (CWE-434, CVE-2018-10942).

Unauthenticated attackers can upload and execute arbitrary PHP files via the `file_upload.php` endpoint, leading to complete server compromise, data theft, and potential lateral movement.

CVSS 3.0: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: rce

The template actively tests the vulnerability by attempting to upload a randomly-named `.php` file containing a unique random string using a multipart/form-data POST request to `/modules/[variant]/file_upload.php` (trying paths: attributewizardpro, 1attributewizardpro, attributewizardpro.OLD, attributewizardpro_x). It then issues a GET to the uploaded file from the `file_uploads` subdirectory and verifies the presence of both the filename (in first response body) and the random string (in second response body) to confirm the upload succeeded.

## References
- https://webcache.googleusercontent.com/search?q=cache:y0TbS2LsRfoJ:www.vfocus.net/art/20160629/12773.html&hl=en&gl=en
- https://www.openservis.cz/prestashop-blog/nejcastejsi-utoky-v-roce-2023-seznam-deravych-modulu-nemate-nejaky-z-nich-na-e-shopu-i-vy/
- https://nvd.nist.gov/vuln/detail/CVE-2018-10942
