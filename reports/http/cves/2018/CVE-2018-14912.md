---
cve_id: CVE-2018-14912
template_path: nuclei-templates/http/cves/2018/CVE-2018-14912.yaml
affected_product: cgit
severity: high
authentication: none
external_callback: false
affected_versions: < 1.2.1
preconditions: HTTP clone functionality enabled (enable-http-clone=1)
poc_classification: info-leak
---

## Vulnerability
cgit < 1.2.1 contains a directory traversal flaw in `cgit_clone_objects` when `enable-http-clone=1` (HTTP cloning enabled). Unauthenticated attackers can read arbitrary server files by supplying `../` sequences in the `path` query parameter of `/cgit/cgit.cgi/git/objects/?path=`.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5) | CWE-22

Impact: Exposure of sensitive repository data, source code, configuration files, and credentials.

Remediation: Upgrade to cgit 1.2.1 or later.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/cgit/cgit.cgi/git/objects/?path=../../../../../../../etc/passwd` and confirms successful traversal by matching HTTP 200 status plus the regex `root:[x*]:0:0` in the response body (leak of /etc/passwd).

## References
- https://cxsecurity.com/issue/WLB-2018080034
- https://nvd.nist.gov/vuln/detail/CVE-2018-14912
- https://lists.zx2c4.com/pipermail/cgit/2018-August/004176.html
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1627
- https://lists.debian.org/debian-lts-announce/2018/08/msg00005.html
