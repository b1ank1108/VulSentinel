---
cve_id: CVE-2018-6605
template_path: nuclei-templates/http/cves/2018/CVE-2018-6605.yaml
affected_product: Joomla! Component Zh BaiduMap
severity: critical
authentication: none
external_callback: false
affected_versions: 3.0.0.1
preconditions: [Zh BaiduMap component installed on Joomla!]
poc_classification: state-change
---

## Vulnerability
SQL injection in the Zh BaiduMap 3.0.0.1 component for Joomla! via the `id` parameter in `getPlacemarkDetails`, `getPlacemarkHoverText`, `getPathHoverText`, or `getPathDetails` requests (POST to `option=com_zhbaidumap`).  

Unauthenticated remote attackers can execute arbitrary SQL, enabling read/write/delete of any database contents and full Joomla! compromise.  

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8) â€¢ CWE-89.

## PoC / Detection
Classification: state-change

The template sends one POST request to `{{BaseURL}}/index.php?option=com_zhbaidumap&no_html=1&format=raw&task=getPlacemarkDetails` with form body `id=-1 UNION ALL SELECT ... md5({{rand_int(2000000000,2100000000)}}) ... --+`. It verifies the vulnerability if the 200 OK response body contains both the computed MD5 value and the literal string "dataexists".

## References
- https://github.com/ARPSyndicate/cvemon
- https://github.com/C0reL0ader/EaST/blob/master/exploits/efa_joomla_zh_baidumap_sqli.py
- https://www.exploit-db.com/exploits/43974
