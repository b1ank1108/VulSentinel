---
cve_id: CVE-2018-6882
template_path: nuclei-templates/http/cves/2018/CVE-2018-6882.yaml
affected_product: Zimbra Collaboration Suite
severity: medium
authentication: required
external_callback: true
affected_versions: ZCS before 8.7 Patch 1 and 8.8.x before 8.8.7
preconditions: SMTP port 25 accessible to send crafted email; victim must view email in Zimbra web client while logged in
poc_classification: info-leak
---

## Vulnerability
Zimbra Collaboration Suite (ZCS) contains a cross-site scripting (XSS) vulnerability in the `ZmMailMsgView.getAttachmentLinkHtml` function. Insufficient sanitization of the `Content-Location` header in email attachments allows remote attackers to inject arbitrary web script or HTML.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.8).  
Impact: arbitrary JavaScript execution in the victim's browser context upon opening the malicious attachment, enabling session-cookie theft, credential capture, or access to sensitive email data.  
Remediation: upgrade to ZCS 8.7 Patch 1 or 8.8.7 or later.

## PoC / Detection
Classification: info-leak

The template first fingerprints the target by requesting `/js/zimbraMail/share/model/ZmSettings.js` and matching vulnerable `CLIENT_VERSION` patterns (8.7.0/5/11 or 8.8.0/6) plus the Zimbra Collaboration Suite banner. It then performs a full login POST (`/`) with supplied `{{user}}`/`{{pass}}` to extract CSRF token and session ID. A crafted multipart email is delivered unauthenticated via TCP to port 25 containing an attachment whose `Content-Location` header embeds the XSS payload `http://foo.bar'></a><img src=a onerror=alert(document.domain)>`. Finally, an authenticated SOAP `SearchConvRequest` queries the inbox and checks whether the unsanitized `onerror=alert(document.domain)` string appears in the response body (text/javascript content-type). This confirms the attachment-link HTML generation reflects the payload exactly as it would to a logged-in victim.

## References
- https://www.securify.nl/advisory/SFY20180101/cross-site-scripting-vulnerability-in-zimbra-collaboration-suite-due-to-the-way-it-handles-attachment-links.html
- https://nvd.nist.gov/vuln/detail/CVE-2018-6882
