---
cve_id: CVE-2018-11473
template_path: nuclei-templates/http/cves/2018/CVE-2018-11473.yaml
affected_product: Monstra CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 3.0.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Monstra CMS 3.0.4 contains a reflected cross-site scripting (XSS) vulnerability in the user registration form. The vulnerability exists in the login parameter of the registration endpoint (`/users/registration`). The application fails to properly sanitize user input before reflecting it in the HTTP response, allowing an attacker to inject arbitrary JavaScript code. When a victim accesses a crafted URL or submits a malicious registration form, the injected script executes in the context of the victim's browser session. This can enable attackers to steal session cookies, perform actions on behalf of the victim, deface the application interface, or redirect users to malicious sites. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.0 score of 6.1 (Medium severity).

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Initial GET request**: Retrieves the registration page at `/users/registration` and extracts the CSRF token from the response using a regex pattern matching `id="csrf" name="csrf" value="(.*)"`.

2. **Exploitation POST request**: Submits a registration form with the following parameters:
   - `csrf`: The extracted CSRF token
   - `login`: "test"
   - `password`: `"><script>alert(document.domain)</script>` (XSS payload)
   - `email`: "teest@gmail.com"
   - `answer`: "test"
   - `register`: "Register"

The template confirms the vulnerability by checking for:
- The reflected XSS payload (`"><script>alert(document.domain)</script>"`) in the response body
- The presence of "Monstra" text indicating the CMS
- A `text/html` content-type header
- HTTP status code 200

All conditions must be met for positive detection.

## References

- https://github.com/monstra-cms/monstra/issues/446
- https://github.com/nikhil1232/Monstra-CMS-3.0.4-XSS-ON-Registration-Page
- https://nvd.nist.gov/vuln/detail/CVE-2018-11473
- https://github.com/ARPSyndicate/kenzer-templates
