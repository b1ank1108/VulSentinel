---
cve_id: CVE-2021-24436
template_path: nuclei-templates/http/cves/2021/CVE-2021-24436.yaml
affected_product: WordPress W3 Total Cache
severity: medium
authentication: required
external_callback: false
affected_versions: <2.1.4
preconditions: [W3 Total Cache plugin installed and activated on WordPress]
poc_classification: info-leak
---

## Vulnerability
WordPress W3 Total Cache plugin before 2.1.4 is vulnerable to reflected cross-site scripting (XSS) in the `extension` parameter on the Extensions dashboard (`/wp-admin/admin.php?page=w3tc_extensions`). The parameter value is output directly into an HTML attribute without escaping, allowing injection of arbitrary JavaScript. Exploitation requires an authenticated administrator to visit an attacker-crafted link, enabling script execution in the admin context with potential for data theft, session hijacking, or site defacement. Fixed in 2.1.4. CVSS 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), CWE-79.

## PoC / Detection
Classification: info-leak

The template first POSTs credentials to `/wp-login.php` to authenticate as a WordPress administrator, then issues a GET request to the Extensions dashboard injecting the encoded payload `"><script>alert(document.domain)</script>` into the `extension` parameter. Detection succeeds if the response returns HTTP 200, `text/html` content-type, and the unescaped payload string appears in the body (specifically `><script>alert(document.domain)</script>&action=view`), confirming the reflection that would execute JavaScript in an admin browser.

## References
- https://wpscan.com/vulnerability/3e855e09-056f-45b5-89a9-d644b7d8c9d0
- https://wordpress.org/plugins/w3-total-cache/
- https://wpscan.com/vulnerability/05988ebb-7378-4a3a-9d2d-30f8f58fe9ef
- https://nvd.nist.gov/vuln/detail/CVE-2021-24436
- https://github.com/ARPSyndicate/cvemon
