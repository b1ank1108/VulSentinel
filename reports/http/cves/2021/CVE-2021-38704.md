---
cve_id: CVE-2021-38704
template_path: nuclei-templates/http/cves/2021/CVE-2021-38704.yaml
affected_product: ClinicCases
severity: medium
authentication: none
external_callback: false
affected_versions: 7.3.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
ClinicCases 7.3.3 contains multiple reflected cross-site scripting (XSS) flaws (CVE-2021-38704, CWE-79, CVSS 3.1: 6.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Unauthenticated attackers can craft malicious URLs that inject unsanitized JavaScript payloads into the `type` parameter of `/cliniccases/lib/php/data/messages_load.php`. When a victim visits the URL, the payload executes in the victim's browser context, enabling session-token theft, account takeover, data exfiltration, or page defacement.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/cliniccases/lib/php/data/messages_load.php?type=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`. It confirms the reflected XSS by matching the exact unsanitized string `</script><script>alert(document.domain)</script>` in the response body, verifying `text/html` Content-Type header, and requiring HTTP 200 status. This probe validates the lack of output encoding that allows arbitrary JavaScript execution for a victim visiting the crafted URL.

## References
- https://github.com/sudonoodle/CVE-2021-38704
- https://nvd.nist.gov/vuln/detail/CVE-2021-38704
- https://github.com/judsonmitchell/ClinicCases/releases
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
