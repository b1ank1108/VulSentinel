---
cve_id: CVE-2021-41174
template_path: nuclei-templates/http/cves/2021/CVE-2021-41174.yaml
affected_product: Grafana
severity: medium
authentication: none
external_callback: false
affected_versions: 8.0.0 <= 8.2.2
preconditions: [unauthenticated victim visits crafted URL for page with login button in menu bar]
poc_classification: info-leak
---

## Vulnerability
Grafana is an open-source monitoring and observability platform. Versions 8.0.0 to 8.2.2 are affected by an AngularJS rendering XSS (CVE-2021-41174, CWE-79). If an attacker convinces an unauthenticated victim to visit a specially crafted URL for a page containing the login button, arbitrary JavaScript executes in the victim's browser context (CVSS 3.1: 6.1 Medium, AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).

Impact includes potential data theft, session hijacking, or application defacement. Remediation requires upgrading to 8.2.3 or later.

## PoC / Detection
Classification: info-leak

The template sends a single GET request to `{{BaseURL}}/dashboard/snapshot/%7B%7Bconstructor.constructor(%27alert(document.domain)%27)()%7D%7D?orgId=1` embedding an AngularJS expression payload designed to trigger XSS. Detection relies on matching HTTP 200 status, presence of Grafana branding strings ("Grafana" and "frontend_boot_js_done_time_seconds"), and a regex confirming the vulnerable version range in the page subtitle. The crafted URL serves as the PoC for social engineering delivery.

## References
- https://github.com/grafana/grafana/security/advisories/GHSA-3j9m-hcv9-rpj8
- https://nvd.nist.gov/vuln/detail/CVE-2021-41174
- https://github.com/grafana/grafana/commit/3cb5214fa45eb5a571fd70d6c6edf0d729983f82
- https://github.com/grafana/grafana/commit/31b78d51c693d828720a5b285107a50e6024c912
- https://github.com/grafana/grafana/commit/fb85ed691290d211a5baa44d9a641ab137f0de88
