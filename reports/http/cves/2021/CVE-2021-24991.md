---
cve_id: CVE-2021-24991
template_path: nuclei-templates/http/cves/2021/CVE-2021-24991.yaml
affected_product: WooCommerce PDF Invoices & Packing Slips WordPress Plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 2.10.5
preconditions: ["WooCommerce PDF Invoices & Packing Slips plugin installed and activated"]
poc_classification: state-change
---

## Vulnerability
WooCommerce PDF Invoices & Packing Slips WordPress Plugin < 2.10.5 suffers from reflected cross-site scripting (XSS) in the admin dashboard. The plugin fails to escape the `tab` and `section` query parameters before outputting them inside an HTML attribute on `/wp-admin/admin.php?page=wpo_wcpdf_options_page`, allowing an attacker to inject arbitrary JavaScript that executes in the context of an authenticated administrator.

**Impact**  
Malicious scripts can steal session cookies, exfiltrate sensitive data, or perform unauthorized actions (configuration changes, data modification) in the admin's browser.

**CVSS v3.1**  
4.8 (Medium) â€” AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N  
**CWE**  
CWE-79  
**Remediation**  
Update to version 2.10.5 or later.

## PoC / Detection
Classification: state-change

The template first POSTs credentials to `/wp-login.php` to authenticate as a WordPress administrator, then issues a GET to the plugin options page with `section=` containing the payload `" style=animation-name:rotation onanimationstart=alert(document.domain) x`. Detection succeeds if the response (status 200) contains both the exact unescaped payload string and the plugin signature "WooCommerce PDF Invoices", confirming the parameters are reflected without sanitization and the vulnerable plugin is present. This verifies the condition that enables JavaScript execution leading to unauthorized administrative actions.

## References
- https://wpscan.com/vulnerability/88e706df-ae03-4665-94a3-db226e1f31a9
- https://nvd.nist.gov/vuln/detail/CVE-2021-24991
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
