---
cve_id: CVE-2021-3378
template_path: nuclei-templates/http/cves/2021/CVE-2021-3378.yaml
affected_product: FortiLogger
severity: critical
authentication: none
external_callback: false
affected_versions: 4.4.2.2
preconditions: []
poc_classification: rce
---

## Vulnerability
FortiLogger 4.4.2.2 is affected by an arbitrary file upload vulnerability (CWE-434) in the hotspot logo upload functionality. An unauthenticated remote attacker can POST a file to `/Config/SaveUploadedHotspotLogoFile` while spoofing the `Content-Type: image/png` header; the server stores the file under `/Assets/temp/hotspot/img/logohotspot.asp`. Successful exploitation results in unauthorized access, remote code execution, and full system compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8).

## PoC / Detection
Classification: rce

The template verifies the flaw with a two-step HTTP interaction that does not require authentication or external interaction: (1) a multipart/form-data POST to `/Config/SaveUploadedHotspotLogoFile` uploads a file named `poc.txt` containing a random string under the spoofed `image/png` Content-Type; (2) a follow-up GET to `/Assets/temp/hotspot/img/logohotspot.txt` retrieves the file. Detection succeeds when the random string appears in the second response body, the `Content-Type` header contains both `text/plain` and `ASP.NET`, and the status code is 200.

## References
- https://erberkan.github.io/2021/cve-2021-3378/
- https://github.com/erberkan/fortilogger_arbitrary_fileupload
- http://packetstormsecurity.com/files/161601/FortiLogger-4.4.2.2-Arbitrary-File-Upload.html
- http://packetstormsecurity.com/files/161974/FortiLogger-Arbitrary-File-Upload.html
- https://github.com/SYRTI/POC_to_review
