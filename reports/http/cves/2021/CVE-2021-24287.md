---
cve_id: CVE-2021-24287
template_path: nuclei-templates/http/cves/2021/CVE-2021-24287.yaml
affected_product: WordPress Select All Categories and Taxonomies plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <1.3.2
preconditions: [plugin installed and activated on WordPress site]
poc_classification: info-leak
---

## Vulnerability
WordPress Select All Categories and Taxonomies plugin before 1.3.2 contains a reflected cross-site scripting vulnerability. The settings page does not properly sanitize the `tab` parameter before outputting it. An attacker can inject arbitrary script that executes in the context of an unsuspecting authenticated user's browser, enabling cookie-based credential theft, session hijacking, and site defacement.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79. Fixed in version 1.3.2.

## PoC / Detection
Classification: info-leak

The template first performs a POST login to `/wp-login.php` using supplied `{{username}}`/`{{password}}` credentials. It then sends a GET request to `/wp-admin/options-general.php?page=moove-taxonomy-settings&tab="+style=animation-name:rotation+onanimationstart="alert(document.domain);`. Detection matches if the second response returns status 200, the response body contains the unsanitized `alert(document.domain)` payload, and contains the plugin page marker "Set up the taxonomies". This confirms lack of output sanitization on the `tab` parameter.

## References
- https://www.exploit-db.com/exploits/50349
- https://wpscan.com/vulnerability/56e1bb56-bfc5-40dd-b2d0-edef43d89bdf
- https://wordpress.org/plugins/select-all-categories-and-taxonomies-change-checkbox-to-radio-buttons/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24287
- https://github.com/ARPSyndicate/cvemon
