---
cve_id: CVE-2021-24495
template_path: nuclei-templates/http/cves/2021/CVE-2021-24495.yaml
affected_product: WordPress Marmoset Viewer plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <1.9.3
preconditions: Marmoset Viewer plugin installed on WordPress site
poc_classification: info-leak
---

## Vulnerability
WordPress Marmoset Viewer plugin before 1.9.3 contains a reflected cross-site scripting vulnerability. The `id` parameter to `mviewer.php` is not properly sanitized, validated, or escaped before being output back in the page.

Successful exploitation allows an attacker to inject malicious scripts into web pages viewed by other users, leading to data theft, session hijacking, or defacement. CVSS 3.1 score 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).

## PoC / Detection
Classification: info-leak

The template issues two GET requests to `{{BaseURL}}/wp-content/plugins/marmoset-viewer/mviewer.php` with `id` values containing reflected XSS payloads that include the `{{randstr}}` placeholder. Detection succeeds if either payload appears unsanitized in the response body (or-condition), the body contains the string "Marmoset Viewer", the Content-Type header is `text/html`, and the status code is 200.

## References
- https://johnjhacking.com/blog/cve-2021-24495-improper-neutralization-of-input-during-web-page-generation-on-id-parameter-in-wordpress-marmoset-viewer-plugin-versions-1.9.3-leads-to-reflected-cross-site-scripting/
- https://wordpress.org/plugins/marmoset-viewer/#developers
- https://wpscan.com/vulnerability/d11b79a3-f762-49ab-b7c8-3174624d7638
- https://nvd.nist.gov/vuln/detail/CVE-2021-24495
- https://github.com/ARPSyndicate/kenzer-templates
