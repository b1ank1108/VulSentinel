---
cve_id: CVE-2021-4436
template_path: nuclei-templates/http/cves/2021/CVE-2021-4436.yaml
affected_product: 3DPrint Lite
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.9.1.5
preconditions: []
poc_classification: rce
---

## Vulnerability
3DPrint Lite WordPress plugin < 1.9.1.5 contains an arbitrary file upload flaw (CWE-434) in the `p3dlite_handle_upload` AJAX action. The handler performs zero authorization checks or file validation, enabling any unauthenticated remote attacker to upload arbitrary files—including PHP webshells—directly to the web server root. A `.htaccess` file is present that blocks direct execution/access on Apache, yet the impact section explicitly states RCE remains possible. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Fixed in 1.9.1.5.

## PoC / Detection
Classification: rce

The template issues a single unauthenticated POST to `/wp-admin/admin-ajax.php` using a multipart/form-data payload (boundary-generated, action=`p3dlite_handle_upload`, file field named with random 5-char lowercase alpha + `.php`, Content-Type `text/php`). The file body is `<?php echo "{{randstr}}";unlink(__FILE__);?>` (self-deleting probe). Success is confirmed by `and` matchers on HTTP 200 status plus response body containing `"jsonrpc":"2.0"`, `"filename":` and the exact uploaded filename.

## References
- https://wpscan.com/vulnerability/c46ecd0d-a132-4ad6-b936-8acde3a09282/
- https://nvd.nist.gov/vuln/detail/CVE-2021-4436
- https://github.com/fkie-cad/nvd-json-data-feeds
