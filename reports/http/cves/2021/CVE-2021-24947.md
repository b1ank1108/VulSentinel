---
cve_id: CVE-2021-24947
template_path: nuclei-templates/http/cves/2021/CVE-2021-24947.yaml
affected_product: WordPress Responsive Vector Maps
severity: medium
authentication: required
external_callback: false
affected_versions: < 6.4.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Responsive Vector Maps < 6.4.2 contains an arbitrary file read vulnerability because the plugin does not have proper authorization and validation of the `rvm_upload_regions_file_path` parameter in the `rvm_import_regions` AJAX action, allowing any authenticated user to read arbitrary files on the web server.

**CVSS v3.1:** 6.5 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)  
**CWE:** CWE-352, CWE-863  
**Impact:** An attacker can read sensitive files on the server, potentially leading to unauthorized access or exposure of sensitive information.  
**Remediation:** Update to version 6.4.2 or later.

## PoC / Detection
Classification: info-leak

The template first executes a POST login to `/wp-login.php` using the supplied `{{username}}` and `{{password}}` credentials (with `wordpress_test_cookie`). It then issues a GET request to `/wp-admin/admin-ajax.php?action=rvm_import_regions&nonce=5&rvm_mbe_post_id=1&rvm_upload_regions_file_path=/etc/passwd`. Detection succeeds on HTTP 200 combined with regex match for the root user entry pattern `root:[x*]:0:0`.

## References
- https://wpscan.com/vulnerability/c6bb12b1-6961-40bd-9110-edfa9ee41a18
- https://nvd.nist.gov/vuln/detail/CVE-2021-24947
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/kazet/wpgarlic
