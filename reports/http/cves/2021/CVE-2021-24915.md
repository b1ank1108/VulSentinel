---
cve_id: CVE-2021-24915
template_path: nuclei-templates/http/cves/2021/CVE-2021-24915.yaml
affected_product: Contest Gallery
severity: critical
authentication: none
external_callback: false
affected_versions: < 13.1.0.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Contest Gallery WordPress plugin before 13.1.0.6 lacks capability checks and does not sanitize/escape the `cg-search-user-name-original` parameter before using it in a SQL statement during gallery user export. Unauthenticated attackers can inject arbitrary SQL to extract database contents and enumerate all registered blog users (including usernames and email addresses), enabling targeted phishing.

CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
Impact: full user enumeration and potential database dump  
Remediation: fixed in 13.1.0.6

## PoC / Detection
Classification: info-leak

The template issues a raw POST to `/wp-admin/admin.php?page=contest-gallery/index.php&users_management=true&option_id=1` with `cg-search-user-name-original` set to a UNION ALL SELECT payload that injects `VERSION()` and enables `cg_create_user_data_csv_new_export` + `cg_create_user_data_csv`. It verifies success by matching HTTP 200, `text/csv` + `filename=` header, and body containing the exact user-export column headers `WpUserId`, `Username`, `Usermail`.

## References
- https://wpscan.com/vulnerability/45ee86a7-1497-4c81-98b8-9a8e5b3d4fac
- https://gist.github.com/tpmiller87/6c05596fe27dd6f69f1aaba4cbb9c917
- https://wordpress.org/plugins/contest-gallery/
