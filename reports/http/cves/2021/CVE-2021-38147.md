---
cve_id: CVE-2021-38147
template_path: nuclei-templates/http/cves/2021/CVE-2021-38147.yaml
affected_product: Wipro Holmes Orchestrator
severity: high
authentication: none
external_callback: false
affected_versions: 20.4.1 (fixed in v21.4.0)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Wipro Holmes Orchestrator 20.4.1 (20.4.1_02_11_2020) allows remote attackers to download arbitrary files, such as reports containing sensitive information, because authentication is not required for API access to processexecution/DownloadExcelFile/Domain_Credential_Report_Excel, processexecution/DownloadExcelFile/User_Report_Excel, processexecution/DownloadExcelFile/Process_Report_Excel, processexecution/DownloadExcelFile/Infrastructure_Report_Excel, or processexecution/DownloadExcelFile/Resolver_Report_Excel.

**Impact**: Unauthenticated attackers can download sensitive reports containing Domain Credentials, User Information, Process Details, Infrastructure Data, and Resolver Information.

**CVSS**: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

**CWE**: CWE-306

**Fixed**: v21.4.0

## PoC / Detection
Classification: info-leak

The template performs unauthenticated GET requests to four report-download endpoints (`{{BaseURL}}/processexecution/DownloadExcelFile/Domain_Credential_Report_Excel`, `Process_Report_Excel`, `Infrastructure_Report_Excel`, `Resolver_Report_Excel`) with `stop-at-first-match: true`. It verifies exploitation success via DSL matcher requiring all of: HTTP 200 status, header containing `application/vnd.openxml` and `attachment; filename=`, and response body containing `<?xml version=`.

## References
- https://packetstormsecurity.com/files/165039/Wipro-Holmes-Orchestrator-20.4.1-Report-Disclosure.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-38147
- https://www.wipro.com/holmes/
