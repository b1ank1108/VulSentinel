---
cve_id: CVE-2021-25032
template_path: nuclei-templates/http/cves/2021/CVE-2021-25032.yaml
affected_product: PublishPress Capabilities
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.3.1
preconditions: []
poc_classification: state-change
---

## Vulnerability
The PublishPress Capabilities plugin for WordPress before 2.3.1 does not have proper authorization and CSRF checks when updating settings via the init hook, allowing unauthenticated attackers to update arbitrary blog options, such as setting the default role to administrator.  
Impact: complete site compromise through privilege escalation.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: state-change

The template sends an unauthenticated POST request to `/wp-admin/admin.php` with parameters `page=pp-capabilities-settings&all_options=default_role&default_role=administrator`. It then performs a login POST to `/wp-login.php` using `{{username}}`/`{{password}}` and issues a GET to `/wp-admin/admin.php?page=pp-capabilities`, matching the response body for `"selected'> Administrator"` (status 200) to confirm the option was successfully modified.

## References
- https://wpscan.com/vulnerability/2f0f1a32-0c7a-48e6-8617-e0b2dcf62727/
- https://plugins.trac.wordpress.org/changeset/2640161
- https://nvd.nist.gov/vuln/detail/CVE-2021-25032
- https://github.com/RandomRobbieBF/CVE-2021-25032
