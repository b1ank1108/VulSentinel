---
cve_id: CVE-2021-32478
template_path: nuclei-templates/http/cves/2021/CVE-2021-32478.yaml
affected_product: Moodle
severity: medium
authentication: none
external_callback: false
affected_versions: 3.8 to 3.8.8, 3.9 to 3.9.6, 3.10 to 3.10.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Moodle versions 3.8 to 3.8.8, 3.9 to 3.9.6, and 3.10 to 3.10.3 contain a reflected XSS and open redirect in the LTI authorization endpoint (`/mod/lti/auth.php`) due to insufficient sanitization of the `redirect_uri` parameter. Attackers can supply a `javascript:` URI or arbitrary redirect target in a crafted URL, resulting in client-side script execution or malicious redirection when a victim visits the link (UI:R required).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79. No additional configuration or feature flags required beyond the affected version; the endpoint is present in standard installations.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET to `{{BaseURL}}/mod/lti/auth.php?redirect_uri=javascript:alert('{{randstr}}')` and confirms the flaw if the 200 OK response (text/html Content-Type) contains both the random string and the literal substring `<form action="javascript:alert` in the body. This verifies unsanitized reflection into an HTML attribute, proving the condition for reflected XSS (and open redirect with alternate payloads).

## References
- https://twitter.com/JacksonHHax/status/1391367064154042377
- https://nvd.nist.gov/vuln/detail/CVE-2021-32478
- https://moodle.org/mod/forum/discuss.php?d=422314
