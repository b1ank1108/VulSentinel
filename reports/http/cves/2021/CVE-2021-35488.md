---
cve_id: CVE-2021-35488
template_path: nuclei-templates/http/cves/2021/CVE-2021-35488.yaml
affected_product: Thruk
severity: medium
authentication: none
external_callback: false
affected_versions: 2.40-2
preconditions: authenticated user must visit crafted malicious URL
poc_classification: info-leak
---

## Vulnerability
Thruk 2.40-2 contains a reflected cross-site scripting (XSS) vulnerability via the `title` parameter in `/thruk/#cgi-bin/status.cgi?style=combined`. An attacker can inject arbitrary JavaScript into status.cgi that executes in the victim's browser context when the page is accessed by an authenticated user, enabling session hijacking, defacement, or theft of sensitive information. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1, CWE-79).

## PoC / Detection
Classification: info-leak

The template sends a single GET request to `{{BaseURL}}/thruk/cgi-bin/login.cgi?thruk/cgi-bin/status.cgi%3fstyle=combined&title=%27%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`, embedding the XSS payload in the encoded `title` parameter. It verifies exploitation by matching the unsanitized payload string `'></script><script>alert(document.domain)</script>` and `Thruk Monitoring` in the response body under HTTP 401 status, confirming lack of sanitization in status.cgi processing.

## References
- https://www.gruppotim.it/redteam
- https://www.thruk.org/changelog.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-35488
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
