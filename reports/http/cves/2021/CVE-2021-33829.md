---
cve_id: CVE-2021-33829
template_path: nuclei-templates/http/cves/2021/CVE-2021-33829.yaml
affected_product: Drupal 7 CKEditor
severity: medium
authentication: required
external_callback: false
affected_versions: CKEditor 4.14.0 through 4.16.x before 4.16.1
preconditions: Authenticated user with content creation permissions on Drupal 7
poc_classification: info-leak
---

## Vulnerability

Drupal 7 with CKEditor contains a cross-site scripting vulnerability (CVE-2021-33829) in CKEditor versions 4.14.0 through 4.16.x before 4.16.1. Caused by mishandling in content processing (comments/body), it allows remote attackers to inject executable JavaScript code. Exploitation requires the victim to view the malicious content, such as a crafted page node.

**Impact:** Arbitrary JavaScript execution in the victim's browser context, enabling session hijacking, data theft, or other malicious client-side actions.

**CVSS v3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**CWE:** CWE-79

**Remediation:** Update to CKEditor 4.16.1 or later.

## PoC / Detection
Classification: info-leak

The template simulates exploitation by performing a 4-step authenticated workflow:
1. Logs in to Drupal using supplied credentials and captures session cookies.
2. Accesses the page creation form (/node/add/page) to extract form_build_id and form_token.
3. Submits a new page node with title and body containing the XSS payload (`<!--{cke_protected}--><img src=x onerror=alert(document.domain)>` using full_html format).
4. Follows the redirect to the new node URL and verifies the raw payload (including the alert call) appears unsanitized in the response body.

This confirms the XSS as the JavaScript would execute upon viewing by any user.

## References
- https://checkmarx.com/blog/cve-2021-33829-stored-xss-vulnerability-discovered-in-ckeditor4-affects-widely-used-cms/
- https://www.drupal.org/sa-core-2021-003
- https://lists.debian.org/debian-lts-announce/2021/11/msg00007.html
- https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NYA354LJP47KCVJMTUO77ZCX3ZK42G3T/
