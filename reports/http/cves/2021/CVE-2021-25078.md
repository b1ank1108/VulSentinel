---
cve_id: CVE-2021-25078
template_path: nuclei-templates/http/cves/2021/CVE-2021-25078.yaml
affected_product: WordPress Affiliates Manager plugin
severity: medium
authentication: none
external_callback: false
affected_versions: < 2.9.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The WordPress Affiliates Manager plugin prior to 2.9.0 does not validate, sanitise or escape the IP address of requests logged by the click tracking feature. This allows unauthenticated attackers to inject XSS payloads (via the X-Forwarded-For header) that are stored and later executed in the context of any authenticated administrator viewing the tracked requests page.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.  
Impact: session hijacking, defacement or theft of sensitive information in the admin browser context.  
Remediation: Fixed in version 2.9.0.

## PoC / Detection
Classification: info-leak

The template first posts credentials to /wp-login.php, then issues a GET to /?wpam_id=1 carrying the payload `<img src onerror=alert(document.domain)>` in the X-Forwarded-For header, and finally GETs /wp-admin/admin.php?page=wpam-clicktracking. It asserts that both login and final page return 200, the final response is HTML, the unsanitized payload appears verbatim in the body, and the page contains the string "Affiliates Manager Click Tracking".

## References
- https://wpscan.com/vulnerability/d4edb5f2-aa1b-4e2d-abb4-76c46def6c6e
- https://nvd.nist.gov/vuln/detail/CVE-2021-25078
- https://plugins.trac.wordpress.org/changeset/2648196
- https://github.com/ARPSyndicate/cvemon
