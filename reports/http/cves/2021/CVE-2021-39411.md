---
cve_id: CVE-2021-39411
template_path: nuclei-templates/http/cves/2021/CVE-2021-39411.yaml
affected_product: Hospital Management System
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Hospital Management System 1.0 contains a reflected cross-site scripting (XSS) vulnerability (CWE-79, CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N score 7.2) via the `searchdata` parameter in `/hms/doctor/search.php` and `/hms/admin/patient-search.php`. Authenticated attackers can inject arbitrary JavaScript (e.g. `<script>alert(document.domain)</script>`), which is echoed unsanitized into search-result messages. Exploitation enables session-cookie theft, browser-based attacks, or unauthorized administrative actions in the victim's browser context.

## PoC / Detection
Classification: info-leak

The template first authenticates as doctor (`POST /hms/doctor/`) and as admin (`POST /hms/admin/`) using supplied username/password credentials, then submits the reflected-XSS payload in the `searchdata` form field to the respective search endpoints. Detection succeeds on HTTP 200 responses containing HTML and the literal string `Result against "<script>alert(document.domain)</script>" keyword` in the response body, confirming unsanitized reflection of attacker-controlled JavaScript.

## References
- https://vulmon.com/vulnerabilitydetails?qid=CVE-2021-39411&scoretype=cvssv3
- https://nvd.nist.gov/vuln/detail/CVE-2021-39411
