---
cve_id: CVE-2021-40539
template_path: nuclei-templates/http/cves/2021/CVE-2021-40539.yaml
affected_product: Zoho ManageEngine ADSelfService Plus
severity: critical
authentication: none
external_callback: false
affected_versions: version 6113 and prior
preconditions: []
poc_classification: rce
---

## Vulnerability
Zoho ManageEngine ADSelfService Plus versions 6113 and prior are vulnerable to a REST API authentication bypass (CWE-706) in the LogonCustomization endpoint. This flaw permits unauthenticated remote attackers to upload arbitrary JSP and Java class files, leading to remote code execution with the privileges of the application process. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation allows remote attackers to execute arbitrary commands with the privileges of the affected application. Remediation: Upgrade to ADSelfService Plus build 6114.

## PoC / Detection
Classification: rce

The template executes a multi-step active exploit to confirm RCE:
- POST to `/./RestAPI/LogonCustomization` (twice) to upload a ws.jsp file containing code that outputs the MD5 hash of "CVE-2021-40539" and a malicious Si.class for command execution and file copy.
- POST to `/./RestAPI/Connection` with openSSLTool parameters to load the class and trigger relocation of the JSP to `/help/admin-guide/test.jsp`.
- GET `/help/admin-guide/test.jsp` and matches for the string "114f7ce498a54a1be1de1f1e5731d0ea" (MD5 output) with 200 status to verify successful execution.

## References
- https://attackerkb.com/topics/DMSNq5zgcW/cve-2021-40539/rapid7-analysis
- https://www.synacktiv.com/publications/how-to-exploit-cve-2021-40539-on-manageengine-adselfservice-plus.html
- https://github.com/synacktiv/CVE-2021-40539
- https://nvd.nist.gov/vuln/detail/CVE-2021-40539
- https://www.manageengine.com
