---
cve_id: CVE-2021-41419
template_path: nuclei-templates/http/cves/2021/CVE-2021-41419.yaml
affected_product: QVIS NVR/DVR
severity: critical
authentication: none
external_callback: true
affected_versions: before 2021-12-13
preconditions: []
poc_classification: rce
---

## Vulnerability
QVIS NVR/DVR before 2021-12-13 is vulnerable to unauthenticated remote code execution via unsafe Java deserialization of the `javax.faces.ViewState` parameter in its JSF-based web interface. The flaw (CWE-502) allows deserialization of untrusted data using a commons-collections3.1 gadget, enabling arbitrary command execution.

Impact: attackers can execute arbitrary code remotely, potentially leading to full system compromise.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8).  
Remediation: update to the latest version or apply security patches provided by the vendor.

## PoC / Detection
Classification: rce

The template first issues a GET request to `/qvisdvr/` to extract the `JSESSIONID` token from the `Set-Cookie` header. It then sends a POST request to `/qvisdvr/index.faces;jsessionid={{token}}` with a `javax.faces.ViewState` parameter containing a Base64-encoded commons-collections3.1 deserialization gadget that executes `wget http://{{interactsh-url}}`. Detection succeeds on an out-of-band HTTP interaction with the interactsh server combined with a 500 status code response.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-41419
- https://gist.github.com/Meeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee/712ac36c8a08e2698e875169442a23a4
