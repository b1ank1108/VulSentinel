---
cve_id: CVE-2021-21351
template_path: nuclei-templates/http/cves/2021/CVE-2021-21351.yaml
affected_product: XStream
severity: critical
authentication: none
external_callback: true
affected_versions: <1.4.16
preconditions: Application deserializes untrusted XML using XStream
poc_classification: rce
---

## Vulnerability
XStream before 1.4.16 is susceptible to remote code execution. An attacker can load and execute arbitrary code from a remote host via manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations.

Successful exploitation could allow an attacker to execute arbitrary code on the target system. CVSS v3.1: 9.1 (AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H).

Remediation: Install at least 1.4.16 if relying on XStream's default Security Framework blacklist.

## PoC / Detection
Classification: rce

The template performs a single POST request to `/` (Content-Type: application/xml) containing a crafted XML payload that constructs a deserialization gadget chain (`javax.naming.ldap.Rdn$RdnEntry` → `XRTreeFrag` → `SAX2DTM` → `JdbcRowSetImpl` with `dataSource=rmi://{{interactsh-url}}/test`). 

Detection verifies the flaw via:
- Out-of-band DNS interaction (interactsh_protocol matcher)
- Response body containing "timestamp" or "com.thoughtworks.xstream" (OR)
- "application/json" header or HTTP 500 status

## References
- https://github.com/vulhub/vulhub/tree/master/xstream/CVE-2021-21351
- https://x-stream.github.io/CVE-2021-21351.html
- https://paper.seebug.org/1543/
- http://x-stream.github.io/changes.html#1.4.16
- https://nvd.nist.gov/vuln/detail/CVE-2021-21351
