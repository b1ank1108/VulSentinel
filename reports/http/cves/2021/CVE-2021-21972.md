---
cve_id: CVE-2021-21972
template_path: nuclei-templates/http/cves/2021/CVE-2021-21972.yaml
affected_product: VMware vSphere Client (HTML5)
severity: critical
authentication: none
external_callback: false
affected_versions: VMware vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l and 6.5 before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2)
preconditions: []
poc_classification: rce
---

## Vulnerability
VMware vCenter vSphere Client (HTML5) contains a remote code execution vulnerability in a vCenter Server plugin. A malicious actor with network access to port 443 may exploit this issue to execute commands with unrestricted privileges on the underlying operating system that hosts vCenter Server. This affects VMware vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l and 6.5 before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2).

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-22 (path traversal).

## PoC / Detection
Classification: rce

The template performs a GET request to `{{BaseURL}}/ui/vropspluginui/rest/services/getstatus` and requires all of: `VSPHERE-UI-JSESSIONID` present in response headers, body regex match for `(Install|Config) Final Progress`, and HTTP status 200. This fingerprints the exposed vulnerable plugin endpoint (actual exploit uses arbitrary file upload, not performed here).

## References
- https://swarm.ptsecurity.com/unauth-rce-vmware/
- https://nvd.nist.gov/vuln/detail/CVE-2021-21972
- https://www.vmware.com/security/advisories/VMSA-2021-0002.html
- http://packetstormsecurity.com/files/161590/VMware-vCenter-Server-7.0-Arbitrary-File-Upload.html
- https://github.com/NS-Sp4ce/CVE-2021-21972
