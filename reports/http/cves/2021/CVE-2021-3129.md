---
cve_id: CVE-2021-3129
template_path: nuclei-templates/http/cves/2021/CVE-2021-3129.yaml
affected_product: Laravel with Ignition
severity: critical
authentication: none
external_callback: false
affected_versions: Laravel version 8.4.2 and before with Ignition before 2.5.2
preconditions: debug mode enabled
poc_classification: rce
---

## Vulnerability
Unauthenticated remote code execution in Laravel applications (version 8.4.2 and before) using Ignition (before 2.5.2) in debug mode. The root cause is insecure `file_get_contents()` and `file_put_contents()` usage inside `Facade\Ignition\Solutions\MakeViewVariableOptionalSolution` exposed at the `/_ignition/execute-solution` endpoint, enabling log poisoning via PHP stream filters and subsequent PHAR deserialization.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

Impact: Successful exploitation of this vulnerability can lead to remote code execution, potentially allowing an attacker to take control of the affected system.

Remediation: Upgrade Laravel to version 8.4.3 or higher to mitigate this vulnerability.

## PoC / Detection
Classification: rce

The template executes a 5-step raw POST chain directly against `/_ignition/execute-solution` (no authentication, no external interaction). It repeatedly invokes `MakeViewVariableOptionalSolution` with crafted `viewFile` parameters using PHP filter chains (iconv.utf-8.utf-16be|quoted-printable-encode|base64-decode) to write a malicious payload into `../storage/logs/laravel.log`, then triggers execution via the `phar://` wrapper on the same log. Success is confirmed by an HTTP 500 response body containing the words `uid=`, `gid=`, `groups=` and `Illuminate` (plus regex extraction of UID/GID output).

## References
- https://www.ambionics.io/blog/laravel-debug-rce
- https://github.com/vulhub/vulhub/tree/master/laravel/CVE-2021-3129
- https://nvd.nist.gov/vuln/detail/CVE-2021-3129
- https://github.com/facade/ignition/pull/334
- https://github.com/d4n-sec/d4n-sec.github.io
