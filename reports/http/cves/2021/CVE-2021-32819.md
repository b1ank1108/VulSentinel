---
cve_id: CVE-2021-32819
template_path: nuclei-templates/http/cves/2021/CVE-2021-32819.yaml
affected_product: Nodejs Squirrelly
severity: high
authentication: none
external_callback: true
affected_versions: <= 8.0.8
preconditions: [ExpressJS render API mixing template data with engine configuration options]
poc_classification: rce
---

## Vulnerability
Nodejs Squirrelly (a template engine for JavaScript that works out-of-the-box with ExpressJS) is susceptible to remote code execution. The library mixes pure template data with engine configuration options through the Express render API; overwriting internal options (e.g. `defaultFilter`) allows arbitrary code execution in downstream applications. No patch existed at disclosure; 8.0.8 was the latest version. Impact: arbitrary code execution on the affected system. CVSS 3.1: 8.8 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: rce

The template sends a single GET request to `{{BaseURL}}/?Express=aaaa&autoEscape=&defaultFilter=...` embedding JavaScript that redefines `require` to load `child_process` and executes `wget http://{{interactsh-url}}`. Detection succeeds when the OAST interaction is received, confirmed by matching the HTTP callback protocol and the `User-Agent: Wget` header in the inbound request.

## References
- https://securitylab.github.com/advisories/GHSL-2021-023-squirrelly/
- https://www.linuxlz.com/aqld/2331.html
- https://blog.diefunction.io/vulnerabilities/ghsl-2021-023
- https://nvd.nist.gov/vuln/detail/CVE-2021-32819
- https://github.com/squirrellyjs/squirrelly/commit/c12418a026f73df645ba927fd29358efe02fed1e
