---
cve_id: CVE-2021-25161
template_path: nuclei-templates/http/cves/2021/CVE-2021-25161.yaml
affected_product: Aruba Instant Access Point (IAP)
severity: medium
authentication: none
external_callback: false
affected_versions: Aruba Instant 6.4.x: 6.4.4.8-4.2.4.17 and below; Aruba Instant 6.5.x: 6.5.4.18 and below; Aruba Instant 8.3.x: 8.3.0.14 and below; Aruba Instant 8.5.x: 8.5.0.11 and below; Aruba Instant 8.6.x: 8.6.0.7 and below; Aruba Instant 8.7.x: 8.7.1.1 and below
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A reflected cross-site scripting vulnerability (CVE-2021-25161, CWE-79) affects Aruba Instant Access Point (IAP) web interface in the `decoded_texts` parameter of `/swarm.cgi?opcode=cp_preview`. CVSS 3.1 score 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). 

**Affected versions:** Aruba Instant 6.4.x: 6.4.4.8-4.2.4.17 and below; Aruba Instant 6.5.x: 6.5.4.18 and below; Aruba Instant 8.3.x: 8.3.0.14 and below; Aruba Instant 8.5.x: 8.5.0.11 and below; Aruba Instant 8.6.x: 8.6.0.7 and below; Aruba Instant 8.7.x: 8.7.1.1 and below.

**Impact:** Reflected XSS allows injection of malicious JavaScript, which can be used to steal administrator credentials or manipulate access point configurations when an authenticated user visits a crafted URL.

**Remediation:** Upgrade to latest patched Swarm version. Apply input validation and output encoding.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `/swarm.cgi` embedding a reflected XSS payload (`decoded_texts="%27;%0Aalert(document.domain);//%0a%27`) that injects an `alert(document.domain)` call. Detection succeeds if the server reflects the payload unescaped into the response body within a JavaScript string context (matching `var decode_string = "` and the alert code), returns HTTP 200, and sets text/html content-type. This confirms lack of proper sanitization/encoding.

## References
- https://alephsecurity.com/2021/07/15/aruba-instant/?utm_source=feedly
- https://nvd.nist.gov/vuln/detail/CVE-2021-25161
