---
cve_id: CVE-2021-45092
template_path: nuclei-templates/http/cves/2021/CVE-2021-45092.yaml
affected_product: Thinfinity VirtualUI
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: /lab.html reachable by default
poc_classification: rce
---

## Vulnerability
Thinfinity VirtualUI exposes an iframe injection flaw in the `/lab.html` endpoint via the unsanitized `vpath` query parameter (reachable by default). An attacker can supply an arbitrary value (e.g., a malicious iframe source) that is reflected into the page response.

**Impact**  
Successful exploitation enables unauthorized access, data leakage, and potential remote code execution.

**CVSS v3.1**  
9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE**  
CWE-74 (Injection)  
**CPE**  
cpe:2.3:a:cybelesoft:thinfinity_virtualui:*:*:*:*:*:*:*:*

**Remediation**  
Apply the latest vendor security patches or updates.

## PoC / Detection
Classification: rce

The template performs a single unauthenticated GET request to `{{BaseURL}}/lab.html?vpath=//interact.sh` and applies two regex matchers with an AND condition: the response body must contain `.*vpath.*` (confirming parameter reflection) and `thinfinity` (confirming the target application). This verifies the `vpath` value reaches an injectable iframe context without sanitization.

## References
- https://github.com/cybelesoft/virtualui/issues/2
- https://nvd.nist.gov/vuln/detail/CVE-2021-44848
- https://www.tenable.com/cve/CVE-2021-45092
- http://packetstormsecurity.com/files/166068/Thinfinity-VirtualUI-2.5.41.0-IFRAME-Injection.html
- https://github.com/danielmofer/nuclei_templates
