---
cve_id: CVE-2021-46069
template_path: nuclei-templates/http/cves/2021/CVE-2021-46069.yaml
affected_product: Vehicle Service Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: authenticated user with permissions to save mechanics
poc_classification: info-leak
---

## Vulnerability
Vehicle Service Management System 1.0 is vulnerable to stored cross-site scripting (XSS) in the Mechanic List section. Authenticated users can inject malicious scripts through the mechanic name field during save operations. The payload persists in the database and executes when the mechanics list (`/admin/?page=mechanics`) is viewed by other users.

CVE: CVE-2021-46069  
CWE: CWE-79  
CVSS: 4.8 (CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N)  
Impact: JavaScript execution in victim browser context, enabling theft of sensitive information.

## PoC / Detection
Classification: info-leak

The template verifies the stored XSS by:  
- Logging in via POST to `/classes/Login.php?f=login` using provided credentials.  
- Injecting the payload `"><script>alert(document.domain)</script>` via POST to `/classes/Master.php?f=save_mechanic`.  
- Fetching the mechanics page and confirming the payload appears unescaped in the HTML response body (matcher checks for `<td>\"><script>alert(document.domain)</script></td>`).  

This confirms the lack of output sanitization on stored mechanic data.

## References
- https://github.com/plsanu/Vehicle-Service-Management-System-Mechanic-List-Stored-Cross-Site-Scripting-XSS
- https://www.plsanu.com/vehicle-service-management-system-mechanic-list-stored-cross-site-scripting-xss
- https://www.sourcecodester.com/php/14972/vehicle-service-management-system-php-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-46069
- https://github.com/plsanu/CVE-2021-46069
