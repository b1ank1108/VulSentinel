---
cve_id: CVE-2021-28918
template_path: nuclei-templates/http/cves/2021/CVE-2021-28918.yaml
affected_product: Netmask NPM Package
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.0.0
preconditions: target application relies on netmask for IP filtering and exposes endpoints accepting url/host/file query parameters
poc_classification: info-leak
---

## Vulnerability
Netmask NPM Package is susceptible to server-side request forgery because of improper input validation of octal strings. This allows unauthenticated remote attackers to perform indeterminate SSRF, remote file inclusion, and local file inclusion attacks on many of the dependent packages. A remote unauthenticated attacker can bypass packages relying on netmask to filter IPs and reach critical VPN or LAN hosts.

An attacker can exploit this vulnerability to make requests to internal resources, potentially leading to unauthorized access or information disclosure.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N (score 9.1). CWE-704.

Remediation: Upgrade to Netmask version 2.0.0 or later.

## PoC / Detection
Classification: info-leak

The template issues three GET requests (stopping at first match) appending octal-encoded localhost IPs (0177.0.0.1) via ?url=, ?host=, or ?file= parameters, then matches on Apache Server Status strings in the body or the regex pattern for root user entries from /etc/passwd to confirm successful internal resource retrieval.

## References
- https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md
- https://github.com/advisories/GHSA-pch5-whg9-qr2r
- https://nvd.nist.gov/vuln/detail/CVE-2021-28918
- https://github.com/rs/node-netmask
- https://rootdaemon.com/2021/03/29/vulnerability-in-netmask-npm-package-affects-280000-projects/
