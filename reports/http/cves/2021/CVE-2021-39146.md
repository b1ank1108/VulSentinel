---
cve_id: CVE-2021-39146
template_path: nuclei-templates/http/cves/2021/CVE-2021-39146.yaml
affected_product: XStream
severity: high
authentication: none
external_callback: true
affected_versions: 1.4.18
preconditions: no allow-list configured (per XStream security recommendations)
poc_classification: rce
---

## Vulnerability
XStream 1.4.18 is susceptible to remote code execution. An attacker can execute commands of the host by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site. Setups which followed XStream's security recommendations with an allow-list are not impacted.

Successful exploitation could allow an attacker to execute arbitrary code on the affected system. CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H (score 8.5). CWE-434.

## PoC / Detection
Classification: rce

The template sends a single POST request to `/` containing a malicious XML payload that exploits a deserialization gadget chain (`javax.naming.ldap.Rdn_-RdnEntry` → `javax.swing.MultiUIDefaults` → `javax.naming.InitialContext#doLookup`) forcing an LDAP callback to `ldap://{{interactsh-url}}/#evil`. Matchers confirm success via DNS interactsh interaction, XStream-related strings ("timestamp", "com.thoughtworks.xstream") in the body (OR), `application/json` header, or HTTP 500 status.

## References
- https://x-stream.github.io/CVE-2021-39146.html
- https://github.com/x-stream/xstream/security/advisories/GHSA-p8pq-r894-fm8f
- https://security.netapp.com/advisory/ntap-20210923-0003/
- https://nvd.nist.gov/vuln/detail/CVE-2021-39146
- https://lists.debian.org/debian-lts-announce/2021/09/msg00017.html
