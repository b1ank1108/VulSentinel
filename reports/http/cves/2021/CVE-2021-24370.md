---
cve_id: CVE-2021-24370
template_path: nuclei-templates/http/cves/2021/CVE-2021-24370.yaml
affected_product: WordPress Fancy Product Designer plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <4.6.9
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Fancy Product Designer plugin before 4.6.9 is susceptible to an unauthenticated arbitrary file upload via `inc/custom-image-handler.php` (CWE-434). An attacker can upload malicious files and execute code on the server, modify data, and/or gain full control over a compromised system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8).

## PoC / Detection
Classification: rce
The template sends a single unauthenticated GET request to `{{BaseURL}}/wp-content/plugins/fancy-product-designer/inc/custom-image-handler.php` and matches the response body for the string `{"error":"You need to define a directory`, the `text/html` Content-Type header, and HTTP status 200 to fingerprint the vulnerable plugin endpoint.

## References
- https://www.wordfence.com/blog/2021/06/critical-0-day-in-fancy-product-designer-under-active-attack/
- https://wpscan.com/vulnerability/82c52461-1fdc-41e4-9f51-f9dd84962b38
- https://seclists.org/fulldisclosure/2020/Nov/30
- https://nvd.nist.gov/vuln/detail/CVE-2021-24370
- https://www.secpod.com/blog/critical-zero-day-flaw-actively-exploited-in-wordpress-fancy-product-designer-plugin/
