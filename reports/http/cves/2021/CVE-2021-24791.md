---
cve_id: CVE-2021-24791
template_path: nuclei-templates/http/cves/2021/CVE-2021-24791.yaml
affected_product: Header Footer Code Manager
severity: high
authentication: required
external_callback: false
affected_versions: < 1.1.14
preconditions: [authenticated as WordPress administrator]
poc_classification: info-leak
---

## Vulnerability
The Header Footer Code Manager WordPress plugin before 1.1.14 is vulnerable to time-based blind SQL injection via the unescaped "orderby" and "order" parameters when viewing the Snippets admin dashboard (CWE-89). Authenticated administrators can exploit this to extract sensitive database contents including user credentials. CVSS 7.2 (AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H). Fixed in 1.1.14.

## PoC / Detection
Classification: info-leak

The template first authenticates to WordPress by POSTing admin credentials to /wp-login.php, then issues a GET to /wp-admin/admin.php?page=hfcm-list with `orderby=(SELECT 5619 FROM (SELECT(SLEEP(6)))uWCv)` and `order=DESC`. Detection matches on response duration >=6s, status_code==200, text/html content-type, and body containing "Add New Snippet".

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-24791
- https://wpscan.com/vulnerability/d55caa9b-d50f-4c13-bc69-dc475641735f
- https://wordpress.org/plugins/header-footer-code-manager/
