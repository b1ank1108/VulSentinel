---
cve_id: CVE-2021-24364
template_path: nuclei-templates/http/cves/2021/CVE-2021-24364.yaml
affected_product: WordPress Jannah Theme
severity: medium
authentication: none
external_callback: false
affected_versions: <5.4.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Jannah Theme before 5.4.4 is affected by a reflected cross-site scripting (XSS) vulnerability (CVE-2021-24364, CWE-79). The `tie_get_user_weather` AJAX action fails to sanitize the `options` JSON parameter before reflecting it in the page output.

**CVSS v3.1**: 6.1 (Medium) â€” AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N  
**EPSS**: 0.02314 (84.529th percentile)  
**Vendor/Product**: tielabs / jannah (WordPress theme)  

**Description**: WordPress Jannah theme before 5.4.4 contains a reflected cross-site scripting vulnerability. It does not properly sanitize the options JSON parameter in its tie_get_user_weather AJAX action before outputting it back in the page.  

**Impact**: Successful exploitation allows an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.  

**Remediation**: Update the WordPress Jannah Theme to version 5.4.4 or later.

## PoC / Detection
Classification: info-leak

The template first issues a GET request to `/` and internally matches Jannah theme assets (`/wp-content/themes/jannah/assets/` or `attachment-jannah-image-`).  

It then sends a GET request to `{{BaseURL}}/wp-admin/admin-ajax.php?action=tie_get_user_weather&options=%7B%27location%27%3A%27Cairo%27%2C%27units%27%3A%27C%27%2C%27forecast_days%27%3A%275%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3Ecustom_name%27%3A%27Cairo%27%2C%27animated%27%3A%27true%27%7D`.  

Detection confirms exploitation if the response body contains the unsanitized payload `</script><script>alert(document.domain)</script>`, the `Content-Type` header is `text/html`, and the status code is 200.

## References
- https://wpscan.com/vulnerability/1d53fbe5-a879-42ca-a9d3-768a80018382
- https://nvd.nist.gov/vuln/detail/CVE-2021-24364
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
- https://github.com/crpytoscooby/resourses_web
