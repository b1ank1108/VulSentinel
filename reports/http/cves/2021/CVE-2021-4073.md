---
cve_id: CVE-2021-4073
template_path: nuclei-templates/http/cves/2021/CVE-2021-4073.yaml
affected_product: RegistrationMagic
severity: critical
authentication: none
external_callback: false
affected_versions: <= 5.0.1.7
preconditions: [Attacker must know a valid username on the target site]
poc_classification: auth-bypass
---

## Vulnerability

CVE-2021-4073 is a critical authentication bypass vulnerability in the RegistrationMagic WordPress plugin versions 5.0.1.7 and earlier. The vulnerability stems from missing identity validation in the `social_login_using_email()` function. This flaw allows unauthenticated attackers to log in as any site user without providing valid credentials, provided they know a valid username on the target WordPress installation.

The vulnerability is classified as CWE-287 (Improper Authentication) with a CVSS v3.1 score of 9.8 (Critical). The attack vector is network-based, requires low complexity, no privileges, and no user interaction. Successful exploitation can lead to complete compromise of confidentiality, integrity, and availability of the affected system. Attackers can gain administrative access, potentially leading to full site takeover, data theft, malicious content injection, and further lateral movement within the infrastructure.

## PoC / Detection

Classification: auth-bypass

The template performs a multi-step authentication bypass verification:

1. **Nonce Extraction (Step 1 & 2)**: The template first attempts to extract a security nonce from the target site by checking for social login functionality indicators (Facebook login handlers) or by parsing the site's main page for security tokens.

2. **Social Login Exploitation (Step 3)**: Using the extracted nonce, the template sends a POST request to `/wp-admin/admin-ajax.php` with the action `rm_login_social_user`, providing a randomly generated email address. This exploits the vulnerable `social_login_using_email()` function that fails to properly validate user identity.

3. **Authentication Verification (Step 4)**: The template confirms successful authentication bypass by accessing `/wp-admin/` and checking for authenticated WordPress admin panel indicators (Profile menu, admin bar elements) and the presence of `wordpress_logged_in_` cookies in the response headers.

The template successfully demonstrates that an unauthenticated attacker can obtain valid WordPress session cookies and access the administrative interface without legitimate credentials.

## References

- https://www.wordfence.com/blog/2021/12/authentication-bypass-vulnerability-patched-in-user-registration-plugin/
- https://nvd.nist.gov/vuln/detail/CVE-2021-4073
- https://www.wordfence.com/vulnerability-advisories/#CVE-2021-4073
