---
cve_id: CVE-2021-38647
template_path: nuclei-templates/http/cves/2021/CVE-2021-38647.yaml
affected_product: Microsoft Open Management Infrastructure
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
CVE-2021-38647 is an unauthenticated remote code execution (OMIGOD) in Microsoft Open Management Infrastructure. The flaw allows arbitrary command execution via the exposed WS-Management SOAP endpoint. Successful exploitation grants SYSTEM/root privileges. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Remediation: updates released August 11, 2021.

## PoC / Detection
Classification: rce  
The template issues a single unauthenticated POST /wsman containing a SOAP envelope with ResourceURI set to SCX_OperatingSystem, Action ExecuteScript, and <p:Script>aWQ=</p:Script> (base64 "id"). It detects exploitation by matching both '<p:StdOut>' and 'uid=0(root) gid=0(root) groups=0' in the response body.

## References
- https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-38647
- https://attackerkb.com/topics/08O94gYdF1/cve-2021-38647
- https://censys.io/blog/understanding-the-impact-of-omigod-cve-2021-38647/
- https://github.com/microsoft/omi
