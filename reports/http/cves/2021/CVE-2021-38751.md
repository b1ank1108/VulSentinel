---
cve_id: CVE-2021-38751
template_path: nuclei-templates/http/cves/2021/CVE-2021-38751.yaml
affected_product: ExponentCMS
severity: medium
authentication: none
external_callback: false
affected_versions: <= 2.6
preconditions: []
poc_classification: state-change
---

## Vulnerability
An HTTP Host header injection vulnerability exists in ExponentCMS 2.6 and below within `/exponent_constants.php`. Supplying a tampered Host header causes the application to reflect the attacker-controlled value into generated page links and constants (EXPONENT.URL, EXPONENT.PATH). This produces arbitrary link modification on responses, enabling phishing, session hijacking, cache poisoning, and MITM attacks.

**CVSS:** 4.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)  
**CWE:** CWE-116  
**Impact:** Attacker can force victim browsers or caches to load attacker-chosen URLs from the legitimate domain.  
**Remediation:** Upgrade to a version higher than 2.6 or apply the patch referenced in the GitHub issue.

## PoC / Detection
Classification: state-change

The template performs a single GET request to `{{BaseURL}}` while injecting `Host: {{randstr}}.tld`. It matches on HTTP 200 and confirms the response body simultaneously contains the injected random subdomain plus the strings `EXPONENT.PATH` and `EXPONENT.URL`. This directly verifies that the application trusts and embeds the unsanitized Host header into its rendered output, proving the ability to modify page links at will.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-38751
- https://github.com/exponentcms/exponent-cms/issues/1544
- https://github.com/exponentcms/exponent-cms/blob/a9fa9358c5e8dc2ce7ad61d7d5bea38505b8515c/exponent_constants.php#L56-L64
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
