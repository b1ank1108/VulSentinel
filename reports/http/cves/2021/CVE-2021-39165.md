---
cve_id: CVE-2021-39165
template_path: nuclei-templates/http/cves/2021/CVE-2021-39165.yaml
affected_product: Cachet
severity: medium
authentication: none
external_callback: false
affected_versions: <=2.3.18
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Cachet is an open source status page system. Versions <=2.3.18 (including the 2.4 development branch) contain an unauthenticated SQL injection in `SearchableTrait#scopeSearch()` via the `/api/v1/components` endpoint. Attackers can exfiltrate sensitive database contents such as administrator passwords and session tokens. The original Cachet repository is no longer active. CVSS 3.1 vector: AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (score 6.5). Successful exploitation enables arbitrary SQL queries leading to data leakage or manipulation.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `/api/v1/components` with a time-based blind SQL injection payload (`name=1&1[0]=&1[1]=a&1[2]=&1[3]=or+'a'='a') and (select sleep(6))--`). It confirms exploitation when the response duration is >=6 seconds, the HTTP status is 200, Content-Type contains `application/json`, and the body includes both `pagination` and `data` keys.

## References
- https://www.leavesongs.com/PENETRATION/cachet-from-laravel-sqli-to-bug-bounty.html
- https://github.com/fiveai/Cachet/commit/27bca8280419966ba80c6fa283d985ddffa84bb6
- https://github.com/W0rty/CVE-2021-39165/blob/main/exploit.py
- https://nvd.nist.gov/vuln/detail/CVE-2021-39165
- https://github.com/fiveai/Cachet/security/advisories/GHSA-79mg-4w23-4fqc
