---
cve_id: CVE-2021-24155
template_path: nuclei-templates/http/cves/2021/CVE-2021-24155.yaml
affected_product: WordPress BackupGuard plugin
severity: high
authentication: required
external_callback: false
affected_versions: <1.6.0
preconditions: [high-privilege (administrator) user]
poc_classification: rce
---

## Vulnerability
WordPress BackupGuard plugin before 1.6.0 is susceptible to authenticated arbitrary file upload. The plugin does not ensure imported files are in SGBP format and extension, allowing high-privilege users to upload arbitrary files including PHP, possibly leading to remote code execution (CWE-434).  
Impact: remote code execution.  
CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (7.2).  
Remediation: fixed in version 1.6.0.

## PoC / Detection
Classification: rce

The template logs in to `/wp-login.php` with supplied username/password, visits `/wp-admin/admin.php?page=backup_guard_backups` to extract the nonce via regex from `BG_BACKUP_STRINGS`, uploads a test `{{randstr}}.php` (containing `echo "CVE-2021-24155";`) via multipart POST to `/wp-admin/admin-ajax.php?action=backup_guard_importBackup`, then GETs `/wp-content/uploads/backup-guard/{{randstr}}.php` and verifies 200 status, text/html content-type, successful import JSON, and payload execution string.

## References
- https://wpscan.com/vulnerability/d442acac-4394-45e4-b6bb-adf4a40960fb
- https://wordpress.org/plugins/backup/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24155
- http://packetstormsecurity.com/files/163382/WordPress-Backup-Guard-1.5.8-Shell-Upload.html
- https://github.com/0dayNinja/CVE-2021-24155.rb
