---
cve_id: CVE-2021-30118
template_path: nuclei-templates/http/cves/2021/CVE-2021-30118.yaml
affected_product: Kaseya VSA
severity: critical
authentication: none
external_callback: false
affected_versions: < 9.5.7
preconditions: []
poc_classification: rce
---

## Vulnerability
Kaseya VSA Unified Remote Monitoring & Management (RMM) < 9.5.7 is vulnerable to unauthenticated arbitrary file upload via `/SystemTab/uploader.aspx`. The endpoint requires a `sessionId` cookie but does not validate it (any numeric value is accepted), allowing full authentication bypass. Attackers control filename (`Filename`/`qqfile`) and destination path (`PathData`), enabling upload of ASPX files with web-server privileges directly into the webroot (`C:\Kaseya\WebPages\`). Uploaded files are immediately executable by requesting their URL, resulting in remote code execution in the web-server process context.

**Impact**: Full system compromise, data breach, credential theft, or persistence via webshell.  
**Remediation**: Update to version 9.5.7 or later.  
**CVSS**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE**: CWE-434

## PoC / Detection
Classification: rce

The template verifies the RCE chain with a two-request flow using only harmless, self-deleting payloads:  
1. POST `/SystemTab/uploader.aspx?Filename={{rand}}.aspx&PathData=C%3A%5CKaseya%5CWebPages%5C&qqfile={{rand}}.aspx` (with fake numeric `sessionId` cookie) uploads an ASPX file containing C# code that computes MD5("999999999"), prints the lowercase hex hash, then immediately deletes itself via `File.Delete`. Matcher confirms HTTP 200 and "success"/"true" in body.  
2. GET `/{{rand}}.aspx` (same fake cookie) retrieves the file and matches the exact MD5 hash in the response body (status 200), proving upload succeeded and server-side execution occurred.  
Random 8-character filename and 8-digit `sessionId` are generated per run; the uploaded file never persists.

## References
- https://csirt.divd.nl/2021/07/07/Kaseya-Limited-Disclosure/
- https://csirt.divd.nl/CVE-2021-30118
- https://csirt.divd.nl/DIVD-2021-00011
- https://helpdesk.kaseya.com/hc/en-gb/articles/360019054377-9-5-5-Feature-Release-10-April-2021
- https://nvd.nist.gov/vuln/detail/CVE-2021-30118
