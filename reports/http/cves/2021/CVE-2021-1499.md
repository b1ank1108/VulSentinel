---
cve_id: CVE-2021-1499
template_path: nuclei-templates/http/cves/2021/CVE-2021-1499.yaml
affected_product: Cisco HyperFlex HX Data Platform
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Cisco HyperFlex HX Data Platform contains an arbitrary file upload vulnerability in the web-based management interface. An unauthenticated attacker can send a specific HTTP request to an affected device, enabling upload of arbitrary files with the permissions of the tomcat8 user. This allows upload and execution of arbitrary files on the target system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N (score 5.3)  
CWE-306: Missing Authentication for Critical Function

## PoC / Detection
Classification: rce

The template performs a single unauthenticated POST request to `/upload` using a multipart/form-data payload. It supplies a file named with path-traversal (`../../../../../tmp/passwd9`) containing benign JSON-like content and verifies exploitation success by matching the response body for the strings `{"result":`, `"filename:`, and `/tmp/passwd9`, the `application/json` Content-Type header, and HTTP 200 status.

## References
- https://swarm.ptsecurity.com/cisco-hyperflex-how-we-got-rce-through-login-form-and-other-findings/
- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-hyperflex-upload-KtCK8Ugz
- http://packetstormsecurity.com/files/163203/Cisco-HyperFlex-HX-Data-Platform-File-Upload-Remote-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-1499
- https://github.com/Z0fhack/Goby_POC
