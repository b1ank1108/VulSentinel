---
cve_id: CVE-2021-43798
template_path: nuclei-templates/http/cves/2021/CVE-2021-43798.yaml
affected_product: Grafana
severity: high
authentication: none
external_callback: false
affected_versions: 8.0.0-beta1 through 8.3.0
preconditions: Presence of at least one installed plugin (e.g., alertlist)
poc_classification: info-leak
---

<think>
[Agent 3][AgentThink] I have analyzed the YAML for CVE-2021-43798.
[Agent 1][AgentThink] Extracted signals for CVE-2021-43798 Grafana template:
- affected_product: Grafana (from name: Grafana v8.x - Arbitrary File Read)
- severity: high
- authentication: none (public /public/plugins/ paths, no auth headers/cookies/login)
- external_callback: false (no interactsh, direct file read probes)
- affected_versions: 8.0.0-beta1 through 8.3.0 (from description)
- preconditions: Presence of at least one installed plugin (template uses alertlist, description specifies any installed plugin ID)

Vuln type: LFI / path traversal -> info-leak classification.
Template detects by trying ../ traversal to /etc/passwd, win.ini, defaults.ini and matching content.

Ready to draft full Markdown? Or any adjustments?
[Agent 3][AgentThink] Key extracts:
- Name: Grafana v8.x - Arbitrary File Read → affected_product: Grafana
- Severity: high
- Auth: none (direct GET to public path, no creds)
- Callback: false (no interactsh, direct file checks)
- Versions: 8.0.0-beta1 through 8.3.0 (from description)
- Preconditions: [] (no extra config/features mentioned beyond version; plugin endpoint is standard)
- It's LFI / path traversal for file read → info-leak classification
- Template: GET to /public/plugins/alertlist/ with many ../ to fetch /etc/passwd, win.ini, defaults.ini; matches content-type, status 200, regex on body
[Agent 2][AgentThink] I have analyzed the YAML for CVE-2021-43798.
[Agent 2][AgentThink] Signals draft:
- affected_product: Grafana
- severity: high
- authentication: none (public GET requests, no auth headers/cookies/login)
- external_callback: false (no interactsh or OOB)
- affected_versions: 8.0.0-beta1 through 8.3.0 (from description)
- preconditions: [] (no special configs/features beyond vulnerable version; uses default alertlist plugin path)

Classification: info-leak (LFI/path traversal allowing unauthorized file read)

Template does: GET to /public/plugins/alertlist/ with many ../ to /etc/passwd, win.ini, defaults.ini; matches 200 + text/plain header + regex for file content patterns.

References: the 5 URLs listed.

Ready to compile full MD if no issues.
[Agent 1][AgentThink] Proposed full output:



## Vulnerability

Grafana versions 8.0.0-beta1 through 8.3.0 contain a local directory traversal vulnerability in the static asset serving for plugins at `/public/plugins/<plugin_id>/`. This permits unauthenticated attackers to read arbitrary local files on the server by supplying excessive `../` sequences after a valid plugin name.

The flaw is a path traversal (CWE-22) leading to local file inclusion (LFI). Impact includes exposure of sensitive system files (/etc/passwd), configuration files, and potential credential leakage.

CVSS: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). 

Remediation: Upgrade to patched versions 8.0.7, 8.1.8, 8.2.7, or 8.3.1.

## PoC / Detection

Classification: info-leak

The template detects exploitation by sending GET requests that exploit the traversal using the built-in 'alertlist' plugin:
- `{{BaseURL}}/public/plugins/alertlist/../../../../.../etc/passwd`
- Equivalent path to `windows/win.ini`
- Path to Grafana's `conf/defaults.ini`

Matchers require HTTP 200 status, `text/plain` Content-Type, and regex matches for expected file contents (e.g., `root:.*:0:` for passwd, INI sections like `[fonts]`, or Grafana-specific paths). Uses stop-at-first-match.

## References
- https://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p
- https://nosec.org/home/detail/4914.html
- https://github.com/jas502n/Grafana-VulnTips
- https://nvd.nist.gov/vuln/detail/CVE-2021-43798
- http://packetstormsecurity.com/files/165198/Grafana-Arbitrary-File-Reading.html

This matches all rules: info-leak classification correct for LFI, no fabrication, direct from YAML.
[Agent 1][AgentThink] No feedback received. Submitting this as final based on YAML analysis. Confidence high as all data directly extracted.
[Agent 3][AgentThink] Suggested full output:



## Vulnerability

Grafana versions 8.0.0-beta1 through 8.3.0 suffer from a local directory traversal vulnerability in the public plugins endpoint. Attackers can access arbitrary local files by traversing directories using paths such as `/public/plugins/alertlist/../../../../etc/passwd` for any installed plugin ID.

This allows unauthenticated remote file disclosure, with high impact on confidentiality.

## PoC / Detection
Classification: info-leak

The nuclei template verifies the vulnerability by issuing GET requests to traversal paths targeting system files (/etc/passwd, windows/win.ini) and Grafana's defaults.ini configuration using the 'alertlist' plugin. It matches on HTTP 200 status, text/plain Content-Type header, and regex patterns confirming file contents (e.g., root UID, INI sections).

## References
- https://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p
- https://nosec.org/home/detail/4914.html
- https://github.com/jas502n/Grafana-VulnTips
- https://nvd.nist.gov/vuln/detail/CVE-2021-43798
- http://packetstormsecurity.com/files/165198/Grafana-Arbitrary-File-Reading.html
[Agent 2][AgentThink] Full report draft:



## Vulnerability

Grafana versions 8.0.0-beta1 through 8.3.0 are vulnerable to arbitrary file read via local directory traversal in the `/public/plugins/NAME/` endpoint (NAME = any installed plugin ID, e.g. alertlist). Unauthenticated attackers can access local files on the server.

## PoC / Detection
Classification: info-leak

The template sends GET requests with deep `../` traversal via the alertlist plugin path to read /etc/passwd, windows/win.ini, and conf/defaults.ini. It matches on 200 status, text/plain Content-Type header, and regex patterns matching expected file contents (root user, grafana.sock, INI sections).

## References
- https://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p
- https://nosec.org/home/detail/4914.html
- https://github.com/jas502n/Grafana-VulnTips
- https://nvd.nist.gov/vuln/detail/CVE-2021-43798
- http://packetstormsecurity.com/files/165198/Grafana-Arbitrary-File-Reading.html
[Agent 2][AgentThink] I suggest using this as final output. Confidence high as all data directly from YAML. No uncertainties requiring 'unknown'.

</think>


## Vulnerability
Grafana versions 8.0.0-beta1 through 8.3.0 are vulnerable to local directory traversal in the public plugins endpoint `/public/plugins/NAME/` (NAME = any installed plugin ID). This permits unauthenticated remote arbitrary file read of local server files.  
Impact: exposure of sensitive files (e.g. /etc/passwd, configuration files), leading to data leakage or further compromise.  
Remediation: upgrade to 8.0.7, 8.1.8, 8.2.7 or 8.3.1.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5), CWE-22.

## PoC / Detection
Classification: info-leak

The template detects the flaw by issuing three GET requests that trigger directory traversal using the built-in `alertlist` plugin:  
- `{{BaseURL}}/public/plugins/alertlist/../../../../../../../../../../../../../../../../../../../etc/passwd`  
- equivalent path to `windows/win.ini`  
- path to `conf/defaults.ini`  

`stop-at-first-match: true`. Matchers require HTTP 200, `text/plain` Content-Type header, and regex match (OR) on body content patterns confirming leaked file data (`root:.*:0:`, `/tmp/grafana\.sock`, INI sections `[fonts|extensions|Mail|files]`).

## References
- https://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p
- https://nosec.org/home/detail/4914.html
- https://github.com/jas502n/Grafana-VulnTips
- https://nvd.nist.gov/vuln/detail/CVE-2021-43798
- http://packetstormsecurity.com/files/165198/Grafana-Arbitrary-File-Reading.html
