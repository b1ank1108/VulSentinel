---
cve_id: CVE-2021-30497
template_path: nuclei-templates/http/cves/2021/CVE-2021-30497.yaml
affected_product: Ivanti Avalanche
severity: high
authentication: none
external_callback: false
affected_versions: 6.3.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Ivanti Avalanche 6.3.2 suffers from a local file inclusion (directory traversal) flaw (CVE-2021-30497, CWE-22) that lets remote unauthenticated attackers read arbitrary files outside the intended 'image' folder by manipulating the `imageFilePath` query parameter on the `/AvalancheWeb/image` endpoint.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).  
Successful exploitation yields unauthorized access to sensitive files and can enable remote code execution plus full system compromise.  
Remediation requires applying the latest Ivanti security patches or updates.

## PoC / Detection
Classification: info-leak  
The template issues a single unauthenticated GET request to `{{BaseURL}}/AvalancheWeb/image?imageFilePath=C:/windows/win.ini` and confirms the flaw when the response returns HTTP 200 with the exact string "for 16-bit app support" present in the body (a static marker contained in every Windows win.ini file).

## References
- https://ssd-disclosure.com/ssd-advisory-ivanti-avalanche-directory-traversal/
- https://forums.ivanti.com/s/article/Security-Alert-CVE-2021-30497-Directory-Traversal-Vulnerability?language=en_US
- https://help.ivanti.com/wl/help/en_us/aod/5.4/Avalanche/Console/Launching_the_Avalanche.htm
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30497
- https://github.com/StarCrossPortal/scalpel
