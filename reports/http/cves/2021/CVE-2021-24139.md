---
cve_id: CVE-2021-24139
template_path: nuclei-templates/http/cves/2021/CVE-2021-24139.yaml
affected_product: 10Web Photo Gallery
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.5.55
preconditions: [WordPress with 10Web Photo Gallery plugin installed and active]
poc_classification: state-change
---

## Vulnerability
Unauthenticated time-based blind SQL injection in the 10Web Photo Gallery WordPress plugin (prior to 1.5.55) via the `bwg_search_x` parameter in `frontend/models/model.php`. Allows attackers to execute arbitrary SQL commands, leading to data theft, tampering, or full database compromise (CVSS 9.8).

## PoC / Detection
Classification: state-change

Template first performs a GET to `/index.php?rest_route=/wp/v2/pages` and extracts a public page `slug` whose rendered content contains the `bwg` marker (indicating an embedded gallery). It then sends a GET to `/{{slug}}/?bwg_search_0=` with a time-based blind SQLi payload forcing `SLEEP(5)`. Vulnerability is confirmed if the response status is 200 and duration is >=5 seconds.

## References
- https://wpscan.com/vulnerability/2e33088e-7b93-44af-aa6a-e5d924f86e28
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/photo-gallery/photo-gallery-by-10web-1554-sql-injection-via-bwg-search-x-parameter
- https://nvd.nist.gov/vuln/detail/CVE-2021-24139
