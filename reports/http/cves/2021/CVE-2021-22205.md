---
cve_id: CVE-2021-22205
template_path: nuclei-templates/http/cves/2021/CVE-2021-22205.yaml
affected_product: GitLab CE/EE
severity: critical
authentication: none
external_callback: false
affected_versions: starting from 11.9 (fixed in 13.10.3 or 13.11.1)
preconditions: []
poc_classification: rce
---

## Vulnerability
GitLab CE/EE starting from version 11.9 is affected by a critical remote code execution vulnerability. The application does not properly validate image files passed to a file parser.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (score 10.0)  
CWE-94: Improper Control of Generation of Code ('Code Injection')

**Impact**: Successful exploitation allows arbitrary code execution on the affected GitLab instance.  
**Remediation**: Upgrade to GitLab CE/EE 13.10.3, 13.11.1 or later.

## PoC / Detection
Classification: rce  
The template performs an unauthenticated GET request to `/users/sign_in` (following up to 3 redirects) and checks the response body for any of 60+ specific SHA256 hashes of `application-*.css` assets known to ship in vulnerable versions. A regex extractor also pulls the hash value. This is passive version fingerprinting only; positive matches do not guarantee exploitability.

## References
- https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/red-team-research/cve-2021-22205-hash-generator
- https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/red-team-operations/-/issues/196
- https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22205.json
- https://censys.io/blog/cve-2021-22205-it-was-a-gitlab-smash/
- https://security.humanativaspa.it/gitlab-ce-cve-2021-22205-in-the-wild/
- https://hackerone.com/reports/1154542
- https://nvd.nist.gov/vuln/detail/CVE-2021-22205
