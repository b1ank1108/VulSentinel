---
cve_id: CVE-2021-39144
template_path: nuclei-templates/http/cves/2021/CVE-2021-39144.yaml
affected_product: XStream
severity: high
authentication: none
external_callback: true
affected_versions: 1.4.18
preconditions: XStream without allow-list security configuration
poc_classification: rce
---

## Vulnerability
XStream 1.4.18 is susceptible to remote code execution. An attacker can execute commands of the host by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site. Setups which followed XStream's security recommendations with an allow-list are not impacted.

**Impact:** Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system.

**Remediation:** Upgrade XStream to a version that is not affected by CVE-2021-39144.

**CVSS:** CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H (score 8.5)

**CWE:** CWE-306, CWE-502

## PoC / Detection
Classification: rce

The template sends a single POST request to `/` containing a crafted XML payload (`<java.util.PriorityQueue>` with `dynamic-proxy`, `sun.tracing.NullProvider`, and `DTraceProbe` gadget) that forces XStream deserialization to invoke `java.lang.Runtime.exec("curl http://{{interactsh-url}}")`. It verifies success by matching the resulting out-of-band HTTP callback (interactsh_protocol == http and User-Agent containing "curl").

## References
- https://x-stream.github.io/CVE-2021-39144.html
- https://github.com/x-stream/xstream/security/advisories/GHSA-j9h8-phrw-h4fh
- https://security.netapp.com/advisory/ntap-20210923-0003/
- https://nvd.nist.gov/vuln/detail/cve-2021-39144
- https://lists.debian.org/debian-lts-announce/2021/09/msg00017.html
