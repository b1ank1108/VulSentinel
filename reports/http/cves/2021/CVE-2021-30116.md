---
cve_id: CVE-2021-30116
template_path: nuclei-templates/http/cves/2021/CVE-2021-30116.yaml
affected_product: Kaseya VSA
severity: critical
authentication: none
external_callback: false
affected_versions: < 9.5.7
preconditions: on-premise deployment
poc_classification: info-leak
---

## Vulnerability
Kaseya VSA before 9.5.7 exposes an unauthenticated download page at `/dl.asp` (default on-premise feature) that serves Windows agent installers. Installation creates `C:\Program Files (x86)\Kaseya\XXXXXXXXXX\KaseyaD.ini` containing `Agent_Guid` and `AgentPassword`. These values enable GET authentication to `/dl.asp?un=GUID&pw=PASSWORD`, returning a `sessionId` cookie usable for semi-authenticated access to server services and clients not intended for agents. Unauthenticated attackers thereby obtain sufficient information to penetrate the installation. CVE-2021-30116 (CWE-522, CVSS 10.0) exploited in the wild July 2021.

## PoC / Detection
Classification: info-leak

The template issues GET `{{BaseURL}}/dl.asp`, matches body for `<title>Download Agent</title>` and `mkDefault.asp?id=`, extracts the numeric ID via regex (internal). It then issues GET `{{BaseURL}}/mkDefault.asp?id={{id}}` and verifies 302 status with `Location` header containing `/install/VSA-default-([0-9-]+)/KcsSetup.exe`. This confirms the vulnerable unauthenticated download endpoint that enables credential leakage via agent installer.

## References
- https://csirt.divd.nl/2021/07/04/Kaseya-Case-Update-2/
- https://csirt.divd.nl/2021/07/07/Kaseya-Limited-Disclosure/
- https://helpdesk.kaseya.com/hc/en-gb/articles/4403440684689-Important-Notice-July-2nd-2021
- https://www.secpod.com/blog/kaseya-vsa-zero-day-by-revil/
- https://nvd.nist.gov/vuln/detail/CVE-2021-30116
