---
cve_id: CVE-2021-35064
template_path: nuclei-templates/http/cves/2021/CVE-2021-35064.yaml
affected_product: Kramer VIAware
severity: critical
authentication: none
external_callback: false
affected_versions: all tested versions
preconditions: [web interface accessible]
poc_classification: rce
---

## Vulnerability

Kramer VIAware (all tested versions) is affected by unauthenticated privilege escalation and remote code execution (CVE-2021-35064, CWE-269) due to misconfigured sudo permissions and insecure handling of privileged operations in `ajaxPages/writeBrowseFilePathAjax.php`. Unauthenticated attackers with access to the web interface can upload arbitrary PHP code, leading to full system compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H score 9.8).

## PoC / Detection

Classification: rce

The template exploits the flaw by issuing a POST request to `/ajaxPages/writeBrowseFilePathAjax.php` that writes the payload `<?php echo md5("CVE-2021-35064"); ?>` as a file named `{{randstr}}.php` in the web root (`/var/www/html/`). It then performs a GET request to the uploaded file and matches the expected MD5 hash `44f63b292601ec4ab0d8c3244c9f5ebe` in the response body to confirm arbitrary file write and PHP code execution.

## References

- http://packetstormsecurity.com/files/166623/Kramer-VIAware-Remote-Code-Execution.html
- https://www.kramerav.com/us/product/viaware
- https://www.exploit-db.com/exploits/50856
- https://write-up.github.io/kramerav/
- https://nvd.nist.gov/vuln/detail/CVE-2021-35064
