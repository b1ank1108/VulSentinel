---
cve_id: CVE-2021-46072
template_path: nuclei-templates/http/cves/2021/CVE-2021-46072.yaml
affected_product: Vehicle Service Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Vehicle Service Management System 1.0 contains a stored cross-site scripting (XSS) vulnerability (CWE-79) in the Service List section of the admin panel. An authenticated attacker with high privileges can inject arbitrary JavaScript payloads through the service name or description fields when creating or updating a service. The payload is persisted unsanitized and executes in the browser of any user (including other admins) who later views the services list page.

**CVSS 3.1:** 4.8 (Medium)  
**Vector:** AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N  
**Impact:** Malicious scripts execute in the context of the viewing user, enabling session theft, credential harvesting, defacement, or further client-side attacks.  
**Remediation:** Upgrade to the latest version.

## PoC / Detection
Classification: state-change

The template verifies the stored XSS by:  
1. Authenticating via POST `/classes/Login.php?f=login` using supplied credentials.  
2. Submitting a crafted service record containing the unsanitized payload `<script>alert(document.domain)</script>` via POST `/classes/Master.php?f=save_service`.  
3. Retrieving the services maintenance page via GET `/admin/?page=maintenance/services`.  
4. Confirming the raw `<td>\"><script>alert(document.domain)</script></td>` appears in the HTML body (no escaping occurred).  

This confirms the application stores and reflects attacker-controlled HTML/JavaScript.

## References
- https://github.com/plsanu/Vehicle-Service-Management-System-Service-List-Stored-Cross-Site-Scripting-XSS
- https://www.plsanu.com/vehicle-service-management-system-service-list-stored-cross-site-scripting-xss
- https://www.sourcecodester.com/php/14972/vehicle-service-management-system-php-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-46072
- https://github.com/soosmile/POC
