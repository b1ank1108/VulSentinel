---
cve_id: CVE-2021-21978
template_path: nuclei-templates/http/cves/2021/CVE-2021-21978.yaml
affected_product: VMware View Planner
severity: critical
authentication: none
external_callback: false
affected_versions: 4.x prior to 4.6 Security Patch 1
preconditions: []
poc_classification: rce
---

## Vulnerability
VMware View Planner 4.x prior to 4.6 Security Patch 1 contains a remote code execution vulnerability (CVE-2021-21978, CVSS 9.8) in the logupload web application due to improper input validation of the `logMetaData` parameter and missing authorization checks. An unauthenticated attacker with network access to the View Planner Harness can perform path traversal and upload arbitrary files, leading to code execution inside the logupload container.  
Impact: full system compromise (C:H/I:H/A:H).  
Remediation: upgrade to 4.6 SP1 or later.

## PoC / Detection
Classification: rce  
The template sends one raw POST request to `/logupload` with `logMetaData` JSON containing path traversal (`"itrLogPath": "../../../../../etc/httpd/html/wsgi_log_upload"`, `"logFileType": "log_upload_wsgi.py"`) and a multipart/form-data payload uploading a file named `logfile` (filename empty) containing the string `POC_TEST`. It matches on HTTP 200, exact body length 28, and the literal string `File uploaded successfully.` to confirm the arbitrary-file-upload primitive that enables RCE.

## References
- https://twitter.com/osama_hroot/status/1367258907601698816
- https://nvd.nist.gov/vuln/detail/CVE-2021-21978
- https://www.vmware.com/security/advisories/VMSA-2021-0003.html
- http://packetstormsecurity.com/files/161879/VMware-View-Planner-4.6-Remote-Code-Execution.html
- https://github.com/HimmelAward/Goby_POC
