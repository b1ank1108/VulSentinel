---
cve_id: CVE-2021-35464
template_path: nuclei-templates/http/cves/2021/CVE-2021-35464.yaml
affected_product: ForgeRock OpenAM
severity: critical
authentication: none
external_callback: false
affected_versions: < 7.0
preconditions: []
poc_classification: rce
---

## Vulnerability
ForgeRock OpenAM (also referred to as AM server) before version 7.0 is affected by a pre-authentication Java deserialization vulnerability in the `jato.pageSession` parameter on multiple pages. The flaw arises from unsafe handling in the Sun ONE Application Framework (JATO) shipped with Java 8 or earlier. A single crafted request to `/ccversion/*` endpoints triggers remote code execution.

- **CVSS Score**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
- **CWE**: CWE-502 (Deserialization of Untrusted Data)
- **Impact**: Successful exploitation allows arbitrary code execution on the affected system.
- **Remediation**: Upgrade to ForgeRock OpenAM 7.0 or later.

## PoC / Detection
Classification: rce

The template performs a single unauthenticated GET request to `{{BaseURL}}/openam/oauth2/..;/ccversion/Version` and applies an AND matcher-condition on the response: presence of `Set-Cookie: JSESSIONID=` in headers, body containing either "Version Information -" or "openam/ccversion/Masthead.jsp", and HTTP status 200. This fingerprints instances exposing the vulnerable JATO endpoint (actual RCE payload injection via `jato.pageSession` is outside the template's detection logic).

## References
- https://portswigger.net/research/pre-auth-rce-in-forgerock-openam-cve-2021-35464
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-35464
- http://packetstormsecurity.com/files/163486/ForgeRock-OpenAM-Jato-Java-Deserialization.html
- http://packetstormsecurity.com/files/163525/ForgeRock-Access-Manager-OpenAM-14.6.3-Remote-Code-Execution.html
- https://bugster.forgerock.org
