---
cve_id: CVE-2021-39152
template_path: nuclei-templates/http/cves/2021/CVE-2021-39152.yaml
affected_product: XStream
severity: high
authentication: none
external_callback: true
affected_versions: <1.4.18
preconditions: Application deserializes untrusted XML input using XStream on Java runtime 8-14
poc_classification: info-leak
---

## Vulnerability
XStream before 1.4.18 is susceptible to server-side request forgery. An attacker can request data from internal resources that are not publicly available by manipulating the processed input stream with a Java runtime version 14 to 8. This makes it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.

Successful exploitation of this vulnerability could result in unauthorized access to sensitive internal resources or services.

## PoC / Detection
Classification: info-leak

The template sends a single raw POST request to `/` with Content-Type `application/xml` containing a crafted `<map>` payload that uses duplicated `jdk.nashorn.internal.runtime.Source_-URLData` objects to trigger an SSRF callback to `http://{{interactsh-url}}/internal/`. Detection occurs via matchers that verify the OOB interaction: `interactsh_protocol` contains "http" and the received request includes `User-Agent: Java`.

## References
- https://x-stream.github.io/CVE-2021-39152.html
- https://github.com/x-stream/xstream/security/advisories/GHSA-xw4p-crpj-vjx2
- https://security.netapp.com/advisory/ntap-20210923-0003/
- https://nvd.nist.gov/vuln/detail/cve-2021-39152
- https://lists.debian.org/debian-lts-announce/2021/09/msg00017.html
