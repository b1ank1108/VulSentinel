---
cve_id: CVE-2021-4380
template_path: nuclei-templates/http/cves/2021/CVE-2021-4380.yaml
affected_product: Pinterest Automatic
severity: critical
authentication: none
external_callback: false
affected_versions: < 4.14.4
preconditions: []
poc_classification: state-change
---

## Vulnerability

The Pinterest Automatic plugin for WordPress (up to and including the versions addressed in the template) contains an authorization bypass due to missing capability checks on the `wp_pinterest_automatic_parse_request` function and the `process_form.php` script. Unauthenticated attackers can therefore update arbitrary WordPress options. This can be abused to create new administrative user accounts or redirect unsuspecting site visitors to malicious content.

## PoC / Detection
Classification: state-change

The template performs a three-request flow that actively exploits and verifies the flaw:  
1. A GET request to `/` extracts the current `blogdescription` value via regex from the `<div class="site-description">` element.  
2. A POST request to `/?wp_pinterest_automatic=settings` submits the modified `blogdescription` (original value appended with `!`).  
3. A final GET request to `/` confirms the option update succeeded by checking for the altered description string in the response body.  

This demonstrates unauthenticated arbitrary modification of WordPress site options.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-4380
- https://wpscan.com/vulnerability/ffd344fd-de2c-4f27-8932-41aa0a3c3d05
- https://www.acunetix.com/vulnerabilities/web/wordpress-plugin-pinterest-automatic-pin-security-bypass-4-14-3/
- https://www.wordfence.com/threat-intel/vulnerabilities/id/e4fdc902-4cfe-4116-a294-9a0fcb2de346?source=cve
- https://github.com/20142995/nuclei-templates
