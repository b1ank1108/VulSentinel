---
cve_id: CVE-2021-29156
template_path: nuclei-templates/http/cves/2021/CVE-2021-29156.yaml
affected_product: OpenAM
severity: high
authentication: none
external_callback: false
affected_versions: < 13.5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OpenAM contains an LDAP injection vulnerability. When a user tries to reset their password, the backend validates the username existence through an LDAP query. This allows attackers to inject arbitrary LDAP queries, enabling user enumeration which can lead to full password retrieval and unauthorized access to sensitive information.

**Impact**  
Allows an attacker to execute arbitrary LDAP queries and potentially gain unauthorized access to sensitive information or perform unauthorized actions.

**Remediation**  
Upgrade to OpenAM commercial version 13.5.1 or later.

**CVSS**  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5)

## PoC / Detection
Classification: info-leak

The template performs unauthenticated GET requests to common PWResetUserValidation paths (`/openam/ui/PWResetUserValidation`, `/OpenAM-11.0.0/ui/PWResetUserValidation`, `/ui/PWResetUserValidation`) and verifies the response contains "jato.pageSession" with status code 200, fingerprinting the exposed vulnerable password reset validation endpoint.

## References
- https://github.com/sullo/advisory-archives/blob/master/Forgerock_OpenAM_LDAP_injection.md
- https://hackerone.com/reports/1278050
- https://www.guidepointsecurity.com/blog/ldap-injection-in-forgerock-openam-exploiting-cve-2021-29156/
- https://portswigger.net/research/hidden-oauth-attack-vectors
- https://bugster.forgerock.org/jira/browse/OPENAM-10135
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
