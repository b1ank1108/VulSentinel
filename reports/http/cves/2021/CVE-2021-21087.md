---
cve_id: CVE-2021-21087
template_path: nuclei-templates/http/cves/2021/CVE-2021-21087.yaml
affected_product: Adobe ColdFusion
severity: medium
authentication: none
external_callback: false
affected_versions: 2016 (update 16 and earlier), 2018 (update 10 and earlier) and 2021.0.0.323925
preconditions: [user interaction required]
poc_classification: detect-only
---

## Vulnerability
Adobe ColdFusion suffers from an Improper Neutralization of Input During Web Page Generation (CWE-79) vulnerability. Affected releases are 2016 (update 16 and earlier), 2018 (update 10 and earlier) and 2021.0.0.323925. An attacker can inject arbitrary JavaScript that executes in the context of the current user. Exploitation requires user interaction. Successful attack may result in session hijacking, page defacement or theft of sensitive information.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (5.4)

## PoC / Detection
Classification: detect-only

The template issues GET requests to seven candidate paths for the cfajax.js AJAX library (`/cf_scripts/scripts/ajax/package/cfajax.js`, `/cf-scripts/...`, `/CFIDE/scripts/...`, `/cfide/scripts/...`, `/CF_SFSD/...`, `/cfide-scripts/...`, `/cfmx/CFIDE/...`), stops at the first match, and confirms a 200 response containing the exact vulnerable pattern `eval\(\"(\"\+json\+\"\)\"\)`.

## References
- https://helpx.adobe.com/security/products/coldfusion/apsb21-16.html
- https://twitter.com/Daviey/status/1374070630283415558
- https://nvd.nist.gov/vuln/detail/CVE-2021-21087
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
