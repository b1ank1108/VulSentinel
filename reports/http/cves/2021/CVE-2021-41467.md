---
cve_id: CVE-2021-41467
template_path: nuclei-templates/http/cves/2021/CVE-2021-41467.yaml
affected_product: JustWriting
severity: medium
authentication: none
external_callback: false
affected_versions: 1.0.0 and below
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A cross-site scripting vulnerability in `application/controllers/dropbox.php` in JustWriting 1.0.0 and below allows remote attackers to inject arbitrary web script or HTML via the `challenge` parameter to the `/sync/dropbox/download` endpoint.

CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
CWE-79  
Impact: Successful exploitation allows injection of malicious scripts into web pages viewed by users, leading to session hijacking, defacement, or theft of sensitive information.  
Remediation: Upgrade to the latest version.

## PoC / Detection
Classification: info-leak

The template first sends `GET /` and internally matches `status_code == 200` && `contains(body, "justwriting")` to fingerprint a JustWriting instance. It then sends `GET /sync/dropbox/download?challenge=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E` and matches `status_code == 200` && `contains(content_type, "text/html")` && `contains(body, "</script><script>alert(document.domain)</script>")` to confirm the payload is reflected unsanitized.

## References
- https://github.com/hjue/JustWriting/issues/106
- https://nvd.nist.gov/vuln/detail/CVE-2021-41467
- https://github.com/hjue/JustWriting/
