---
cve_id: CVE-2021-24165
template_path: nuclei-templates/http/cves/2021/CVE-2021-24165.yaml
affected_product: WordPress Ninja Forms
severity: medium
authentication: required
external_callback: false
affected_versions: <3.4.34
preconditions: []
poc_classification: detect-only
---

## Vulnerability
WordPress Ninja Forms plugin before 3.4.34 is affected by an open redirect in the `nf_oauth_connect` AJAX handler (`wp-admin/admin-ajax.php?action=nf_oauth_connect`). The `redirect` parameter is user-controlled and reflected directly into a 302 Location header with no validation or allow-listing.  

An attacker with a valid WordPress login can craft a malicious link that forces any authenticated victim to an arbitrary external site, enabling phishing, credential theft, or malware delivery.  

CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) â€¢ CWE-601.

## PoC / Detection
Classification: detect-only  

The template first POSTs credentials to `/wp-login.php` to establish an authenticated session, then issues `GET /wp-admin/admin-ajax.php?client_id=1&redirect=https://interact.sh&action=nf_oauth_connect`. It confirms the flaw if both requests return HTTP 302 and the second response Location header contains the supplied redirect target.

## References
- https://wpscan.com/vulnerability/6147acf5-e43f-47e6-ab56-c9c8be584818
- https://www.wordfence.com/blog/2021/02/one-million-sites-affected-four-severe-vulnerabilities-patched-in-ninja-forms/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24165
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
