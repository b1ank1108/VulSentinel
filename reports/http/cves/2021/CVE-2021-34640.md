---
cve_id: CVE-2021-34640
template_path: nuclei-templates/http/cves/2021/CVE-2021-34640.yaml
affected_product: WordPress Securimage-WP-Fixed plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <=3.5.4
preconditions: [Securimage-WP-Fixed plugin installed and activated]
poc_classification: info-leak
---

## Vulnerability
WordPress Securimage-WP-Fixed plugin <=3.5.4 suffers from reflected cross-site scripting (XSS) due to unsanitized `$_SERVER['PHP_SELF']` in `securimage-wp.php`. The flaw occurs on the plugin options page (`page=securimage-wp-options`) when the URL path is reflected without escaping.  

CVSS 3.1: 6.1 (Medium) â€“ AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (CWE-79).  
Impact includes session hijacking, page defacement, or theft of sensitive information when an authenticated administrator visits the crafted link.

## PoC / Detection
Classification: info-leak

The template performs a two-request sequence: (1) POST to `/wp-login.php` with supplied `{{username}}`/`{{password}}` to establish an authenticated session, (2) GET to `//wp-admin/options-general.php/"></script><script>alert(document.domain)</script>/script%3E?page=securimage-wp-options%2F` embedding a reflected XSS payload in the path. Detection matches if the response body contains the literal unescaped string `</script><script>alert(document.domain)</script>`, status is 200, and `Content-Type` contains `text/html`.

## References
- https://wpscan.com/vulnerability/22017067-8675-4884-b976-d7f5a71279d2
- https://www.wordfence.com/vulnerability-advisories/#CVE-2021-34640
- https://plugins.trac.wordpress.org/browser/securimage-wp-fixed/trunk/securimage-wp.php#L628
- https://nvd.nist.gov/vuln/detail/CVE-2021-34640
- https://github.com/ARPSyndicate/cvemon
