---
cve_id: CVE-2021-46104
template_path: nuclei-templates/http/cves/2021/CVE-2021-46104.yaml
affected_product: webp_server_go
severity: high
authentication: none
external_callback: false
affected_versions: 0.4.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
CVE-2021-46104 is a path traversal vulnerability (CWE-22) in webp_server_go 0.4.0 caused by insufficient sanitization of file paths in the request handler. Unauthenticated remote attackers can read arbitrary files from the server filesystem (including /etc/passwd) by supplying a double URL-encoded traversal sequence. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Remediation requires upgrading to version 0.4.1 or later.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc/passwd` and matches on HTTP 200 status plus the regex `root:.*:0:0` in the response body to confirm the path-traversal file-read condition.

## References
- https://github.com/webp-sh/webp_server_go/issues/92
