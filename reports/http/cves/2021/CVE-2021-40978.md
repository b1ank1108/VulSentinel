---
cve_id: CVE-2021-40978
template_path: nuclei-templates/http/cves/2021/CVE-2021-40978.yaml
affected_product: MKdocs
severity: high
authentication: none
external_callback: false
affected_versions: 1.2.2
preconditions: dev-server must be used in an unsafe way (namely public)
poc_classification: info-leak
---

## Vulnerability
MKdocs 1.2.2 built-in dev-server allows directory traversal using port 8000, enabling remote exploitation to obtain sensitive information. Vendor has disputed the vulnerability because the dev-server must be used in an unsafe way (namely public). Impact: An attacker can read or modify sensitive files on the server, potentially leading to unauthorized access, data leakage, or system compromise. Remediation: Upgrade MKdocs to version 1.2.3 or later. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5 High). CWE-22.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` (URL-encoded `../` traversal payload) and verifies success by matching HTTP status 200 together with the regex `root:[x*]:0:0:` appearing in the response body.

## References
- https://github.com/mkdocs/mkdocs/pull/2604
- https://github.com/nisdn/CVE-2021-40978
- https://nvd.nist.gov/vuln/detail/CVE-2021-40978
- https://github.com/mkdocs/mkdocs
- https://github.com/mkdocs/mkdocs/issues/2601
