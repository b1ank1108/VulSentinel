---
cve_id: CVE-2021-22214
template_path: nuclei-templates/http/cves/2021/CVE-2021-22214.yaml
affected_product: GitLab CE/EE
severity: high
authentication: none
external_callback: false
affected_versions: starting from 10.5 (fixed in 10.6 or higher)
preconditions: [requests to the internal network for webhooks enabled]
poc_classification: info-leak
---

## Vulnerability
GitLab CE/EE versions starting from 10.5 are susceptible to a server-side request forgery vulnerability in the CI lint API when requests to the internal network for webhooks are enabled, even on instances where registration is limited. The issue spans multiple related CVEs due to similar reports fixed across separate patches: CVE-2021-39935, CVE-2021-22214, CVE-2021-22175.  

**Impact:** Unauthorized access to internal resources, potential data leakage, and further attacks on the system.  
**CVSS:** 8.6 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)  
**CWE:** 918 (Server-Side Request Forgery)  

**Remediation:** Upgrade GitLab CE/EE to a version that is not affected (10.6 or higher).

## PoC / Detection
Classification: info-leak

The template issues a POST request to `/api/v4/ci/lint?include_merged_yaml=true` with a JSON body containing `{"content":"include:\n  remote: http://127.0.0.1/test.yml"}` (or the port-9100 variant). It verifies exploitation conditions by matching HTTP 200 status, `application/json` content-type, and the exact string `does not have valid YAML syntax!` in the response body (stop-at-first-match), confirming the server processed the remote include directive and triggered the SSRF to an internal address.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-22214
- https://nvd.nist.gov/vuln/detail/CVE-2021-39935
- https://nvd.nist.gov/vuln/detail/CVE-2021-22175
- https://vin01.github.io/piptagole/gitlab/ssrf/security/2021/06/15/gitlab-ssrf.html
- https://docs.gitlab.com/ee/api/lint.html
