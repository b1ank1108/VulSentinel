---
cve_id: CVE-2021-31856
template_path: nuclei-templates/http/cves/2021/CVE-2021-31856.yaml
affected_product: Layer5 Meshery
severity: critical
authentication: none
external_callback: false
affected_versions: 0.5.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Layer5 Meshery 0.5.2 contains a SQL injection vulnerability (CVE-2021-31856, CWE-89) in the REST API. The flaw is in the `order` parameter of the `/experimental/patternfiles` endpoint (handled by `GetMesheryPatterns` in `models/meshery_pattern_persister.go`). Unauthenticated remote attackers can execute arbitrary SQL commands. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (base score 9.8). Successful exploitation can lead to unauthorized access, data leakage, or data manipulation. Remediation requires upgrading to a patched version or applying security patches.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/api/experimental/patternfile?order=id%3Bselect(md5({{num}}))&page=0&page_size=0` (where `num=999999999`). It matches on HTTP 200 status and presence of the literal MD5 hash string of `999999999` in the response body. This confirms the injected SELECT executes server-side and its output is reflected, proving the SQL injection allows reading arbitrary data.

## References
- https://github.com/ssst0n3/CVE-2021-31856
- https://nvd.nist.gov/vuln/detail/CVE-2021-31856
- https://meshery.io
- https://github.com/layer5io/meshery/pull/2745
- https://github.com/ssst0n3/my_vulnerabilities
