---
cve_id: CVE-2021-24644
template_path: nuclei-templates/http/cves/2021/CVE-2021-24644.yaml
affected_product: Images to WebP
severity: high
authentication: required
external_callback: false
affected_versions: < 1.9
preconditions: [plugin installed and activated on WordPress]
poc_classification: info-leak
---

## Vulnerability
Images to WebP WordPress plugin before version 1.9 does not validate or sanitize the `tab` parameter before using it in the PHP `include()` function. This leads to an authenticated local file inclusion (LFI) via path traversal.

Authenticated attackers can read arbitrary local files from the server via path traversal, potentially exposing sensitive configuration files, credentials, and system information.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Fixed in 1.9.

## PoC / Detection
Classification: info-leak

The template first performs a POST login to `/wp-login.php` with supplied `{{username}}`/`{{password}}` credentials and verifies success via 302 redirect + `wordpress_logged_in` cookie. It then sends a GET request to `/wp-admin/upload.php?page=images-to-webp.php&tab=..%2F..%2F..%2F..%2Fwp-links-opml` (path-traversal payload). Detection triggers on status 200 + body containing `wp-links-opml`, `Images to WebP`, and a date regex match (`[A-Za-z]{3}, [0-9]{2} [A-Za-z]{3} 20[0-9]{2}`).

## References
- https://wpscan.com/vulnerability/5a363eeb-9510-4535-97e2-9dfd3b10d511/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24644
