---
cve_id: CVE-2021-29484
template_path: nuclei-templates/http/cves/2021/CVE-2021-29484.yaml
affected_product: Ghost CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 4.0.0 to 4.3.2
preconditions: Requires tricking a logged-in user into clicking a malicious link
poc_classification: info-leak
---

## Vulnerability
Ghost CMS 4.0.0 to 4.3.2 contains a DOM-based cross-site scripting (XSS) vulnerability (CWE-79) in an unused `/ghost/preview` endpoint introduced during 4.0.0 development. Attackers craft a malicious link that, when visited by any logged-in user, executes arbitrary JavaScript in the victim's browser context (CVSS 3.1 score 6.8: AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N). Impact includes data theft, session hijacking, and site defacement. Fixed in 4.3.3.

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/ghost/preview` and matches on HTTP 200 status, `text/html` Content-Type header, and the simultaneous presence of the exact vulnerable JavaScript fragments `XMLHttpRequest.prototype.open = XMLHttpRequest.prototype.send` and `top.postMessage(` in the response body. This fingerprints the presence of the DOM XSS flaw in `core/server/web/admin/views/preview.html`.

## References
- https://github.com/TryGhost/Ghost/security/advisories/GHSA-9fgx-q25h-jxrg
- https://www.npmjs.com/package/ghost
- https://forum.ghost.org/t/critical-security-update-available-for-ghost-4-x/22290
- https://nvd.nist.gov/vuln/detail/CVE-2021-29484
- https://github.com/ARPSyndicate/cvemon
- https://github.com/TryGhost/Ghost/blob/95651b33a66f3240535a61999b292a725f1b3317/core/server/web/admin/views/preview.html
- https://www.sonarsource.com/blog/ghost-admin-takeover/
