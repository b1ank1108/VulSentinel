---
cve_id: CVE-2021-28151
template_path: nuclei-templates/http/cves/2021/CVE-2021-28151.yaml
affected_product: Hongdian H8922
severity: high
authentication: required
external_callback: false
affected_versions: 3.0.5
preconditions: [default guest:guest credentials]
poc_classification: rce
---

## Vulnerability
Hongdian H8922 3.0.5 firmware is vulnerable to remote command injection (CWE-78) in the `tools.cgi` ping endpoint. Shell metacharacters can be injected into the `destination` (IP-address) field when `op_type=ping`. The interface is exposed using default credentials `guest:guest` (template also tests `admin:admin`). Successful exploitation allows arbitrary command execution, enabling malware deployment, sensitive data exfiltration, data modification, or full device control.

CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: rce

The template sends two raw POST requests to `/tools.cgi`:
- First with `Authorization: Basic Z3Vlc3Q6Z3Vlc3Q=` (guest:guest) and body `op_type=ping&destination=%3Bid` (injects `;id`).
- Second with `Authorization: Basic YWRtaW46YWRtaW4=` (admin:admin) and identical payload.

Matchers confirm exploitation if response is HTTP 200, Content-Type contains `text/html` or `application/x-www-form-urlencoded`, and body matches regex `uid=\d+\(([^)]+)\) gid=\d+\(([^)]+)\)` (id command output).

## References
- https://ssd-disclosure.com/ssd-advisory-hongdian-h8922-multiple-vulnerabilities/
- http://en.hongdian.com/Products/Details/H8922
- https://nvd.nist.gov/vuln/detail/CVE-2021-28151
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ArrestX/--POC
