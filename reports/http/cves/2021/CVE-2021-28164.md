---
cve_id: CVE-2021-28164
template_path: nuclei-templates/http/cves/2021/CVE-2021-28164.yaml
affected_product: Eclipse Jetty
severity: medium
authentication: none
external_callback: false
affected_versions: 9.4.37.v20210219 to 9.4.38.v20210224
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Eclipse Jetty 9.4.37.v20210219 to 9.4.38.v20210224 is susceptible to improper authorization. The default compliance mode allows requests with URIs that contain %2e or %2e%2e segments to access protected resources within the WEB-INF directory. An attacker can access sensitive information regarding the implementation of a web application.

Impact: An attacker can exploit this vulnerability to access sensitive information, potentially leading to further attacks or unauthorized access.  
Remediation: Apply the latest security patches or updates provided by the Eclipse Jetty project.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (5.3)

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by performing two sequential GET requests (flow: http(1) && http(2)):

- Baseline check: GET `{{BaseURL}}/WEB-INF/web.xml` with an internal negated matcher confirming the response does **not** contain `</web-app>` + `java.sun.com`, is not `application/xml`, and status code is neither 200 nor 404.
- Bypass check: GET `{{BaseURL}}/%2e/WEB-INF/web.xml` matching for status 200, `application/xml` Content-Type header, and body containing both `</web-app>` and `java.sun.com`.

Successful bypass confirms the encoded-path authorization flaw allowing unauthorized read of protected configuration files.

## References
- https://github.com/eclipse/jetty.project/security/advisories/GHSA-v7ff-8wcx-gmc5
- https://github.com/vulhub/vulhub/tree/1239bca12c75630bb2033b728140ed5224dcc6d8/jetty
- https://lists.apache.org/thread.html/r780c3c210a05c5bf7b4671303f46afc3fe56758e92864e1a5f0590d0@%3Cjira.kafka.apache.org%3E
- http://packetstormsecurity.com/files/164590/Jetty-9.4.37.v20210219-Information-Disclosure.html
- https://nvd.nist.gov/vuln/detail/cve-2021-28164
