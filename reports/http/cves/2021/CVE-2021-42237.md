---
cve_id: CVE-2021-42237
template_path: nuclei-templates/http/cves/2021/CVE-2021-42237.yaml
affected_product: Sitecore Experience Platform
severity: critical
authentication: none
external_callback: true
affected_versions: Sitecore XP 7.5 to Sitecore XP 8.2 Update 7
preconditions: []
poc_classification: rce
---

## Vulnerability
Sitecore XP 7.5 to Sitecore XP 8.2 Update 7 is vulnerable to an insecure deserialization attack where remote commands can be executed by an attacker with no authentication or special configuration required.  
**CWE-502** â€¢ **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)**  
Successful exploitation allows arbitrary code execution on the affected system.

## PoC / Detection
Classification: rce  
The template issues a single raw POST to `/sitecore/shell/ClientBin/Reporting/Report.ashx` containing a crafted XML payload with a malicious `SortedSet` comparer gadget that deserializes to `System.Diagnostics.Process.Start("cmd", "/c nslookup {{interactsh-url}}")`. Detection succeeds when the interactsh DNS callback is observed (`interactsh_protocol: dns`) **and** the response body contains `System.ArgumentNullException`.

## References
- https://blog.assetnote.io/2021/11/02/sitecore-rce/
- https://support.sitecore.com/kb?id=kb_article_view&sysparm_article=KB1000776
- https://nvd.nist.gov/vuln/detail/CVE-2021-42237
- http://sitecore.com
- http://packetstormsecurity.com/files/164988/Sitecore-Experience-Platform-XP-Remote-Code-Execution.html
