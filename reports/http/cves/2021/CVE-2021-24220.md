---
cve_id: CVE-2021-24220
template_path: nuclei-templates/http/cves/2021/CVE-2021-24220.yaml
affected_product: Multiple Thrive Themes
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.0.0
preconditions: WordPress site with one of the following themes installed and active: Rise, Luxe, Minus, Ignition, FocusBlog, Squared, Voice, Performag, Pressive, Storied
poc_classification: rce
---

## Vulnerability

Multiple Thrive Themes WordPress themes (including Rise, Luxe, Minus, Ignition, FocusBlog, Squared, Voice, Performag, Pressive and Storied) before version 2.0.0 suffer from an arbitrary file upload vulnerability. The themes register a REST API endpoint for image compression via the Kraken optimization engine. A crafted request, potentially combined with an Option Update vulnerability, allows attackers to retrieve malicious code from a remote URL and overwrite existing files or create new ones on the server, including executable PHP files.

Impact: Arbitrary PHP code execution leading to full site compromise.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H (9.1)  
CWE-434: Unrestricted Upload of File with Dangerous Type

## PoC / Detection

Classification: rce

The Nuclei template detects affected installations without exploiting the upload. It uses a batteringram attack to issue GET requests to `{{BaseURL}}/wp-content/themes/{{theme}}/style.css` for each possible theme name in the list. It extracts the version via regex, verifies status_code == 200, version < 2.0.0 using compare_versions, presence of "Theme Name", and theme-specific strings in the body.

## References
- https://www.wordfence.com/blog/2021/03/recently-patched-vulnerability-in-thrive-themes-actively-exploited-in-the-wild
- https://wpscan.com/vulnerability/a2424354-2639-4f53-a24f-afc11f6c4cac
