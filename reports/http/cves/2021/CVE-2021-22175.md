---
cve_id: CVE-2021-22175
template_path: nuclei-templates/http/cves/2021/CVE-2021-22175.yaml
affected_product: GitLab
severity: high
authentication: none
external_callback: true
affected_versions: GitLab 10.5 and later
preconditions: []
poc_classification: info-leak
---

## Vulnerability
GitLab 10.5 and later contains a Server-Side Request Forgery (SSRF, CVE-2021-22175, CWE-918) in the CI Lint API caused by insecure handling of webhook requests and remote YAML includes. Unauthenticated attackers can force the server to issue arbitrary HTTP requests to internal or external resources by submitting crafted `include.remote` payloads.

**CVSS:** 8.6 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)  
**Impact:** Internal network reconnaissance, port scanning, information disclosure, or further compromise of backend services.  
**Remediation:** Update to the latest GitLab version.

## PoC / Detection
Classification: info-leak

The template issues a single POST request to `/api/v4/ci/lint` with JSON body `{"include_merged_yaml":true,"content":"include:\n  remote: 'http://{{interactsh-url}}/gitlab.yml'"}`. It confirms the SSRF by verifying a 200 JSON response containing both "Included file" and "errors" strings, plus an out-of-band HTTP callback to the interactsh server.

## References
- https://gitlab.com/gitlab-org/gitlab/-/issues/294178
- https://nvd.nist.gov/vuln/detail/CVE-2021-22175
