---
cve_id: CVE-2021-24786
template_path: nuclei-templates/http/cves/2021/CVE-2021-24786.yaml
affected_product: Download Monitor
severity: high
authentication: required
external_callback: false
affected_versions: < 4.4.5
preconditions: administrator-level permissions required
poc_classification: info-leak
---

## Vulnerability
Download Monitor for WordPress (< 4.4.5) contains an SQL injection in the `orderby` parameter on the admin download logs page (`/wp-admin/edit.php?post_type=dlm_download&page=download-monitor-logs`). Insufficient escaping of user input and lack of prepared statements allow authenticated administrator attackers to append arbitrary SQL queries. Primary impact is extraction of sensitive database information (CWE-89); full arbitrary SQL execution possible (data theft, modification, deletion). CVSS 3.1: 7.2 (High) â€” AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H.

## PoC / Detection
Classification: info-leak

The template first authenticates by POSTing administrator credentials to `/wp-login.php`. It then sends a GET request to the logs page with a time-based blind SQLi payload injected into `orderby` (`download_date`+and+(select+sleep(8))+and+`user_id=user_id`). Confirmation occurs if the second response has status 200, contains the string "dlm_product" in the body, and duration >= 8 seconds.

## References
- https://wpscan.com/vulnerability/a6571f16-66d2-449e-af83-1c6ddd56edfa
- https://plugins.trac.wordpress.org/changeset/2610899/download-monitor
- https://nvd.nist.gov/vuln/detail/CVE-2021-24786
