---
cve_id: CVE-2021-41097
template_path: nuclei-templates/http/cves/2021/CVE-2021-41097.yaml
affected_product: Aurelia-Path
severity: high
authentication: none
external_callback: false
affected_versions: < 1.1.7
preconditions: application parses user-controlled URLs with aurelia-path parseQueryString
poc_classification: state-change
---

## Vulnerability
Aurelia-Path before version 1.1.7 suffers from prototype pollution (CWE-1321) in the `parseQueryString` function. Malicious URL parameters containing `__proto__` keys allow modification of `Object.prototype`. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H (score 7.5). Remediation is to update to 1.1.7 or later. Exploitation requires the application to parse user-controlled URLs using this library.

## PoC / Detection
Classification: state-change

The template issues a single GET request to `{{BaseURL}}/blog/?__proto__[polluted]=polluted` and verifies success if status is 200 and the response body simultaneously contains the strings `aurelia-path`, `parseQueryString`, and any of the vulnerable version indicators `1.1.0` through `1.1.6`.

## References
- https://github.com/aurelia/path/issues/44
- https://security.snyk.io/vuln/SNYK-JS-AURELIAPATH-1579475
- https://nvd.nist.gov/vuln/detail/CVE-2021-41097
