---
cve_id: CVE-2021-31602
template_path: nuclei-templates/http/cves/2021/CVE-2021-31602.yaml
affected_product: Hitachi Vantara Pentaho/Business Intelligence Server
severity: high
authentication: none
external_callback: false
affected_versions: Hitachi Vantara Pentaho through 9.1 and Pentaho Business Intelligence Server through 7.x
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Hitachi Vantara Pentaho through 9.1 and Pentaho Business Intelligence Server through 7.x contain an authentication bypass (CWE-287). The platform Security Model uses multiple Access Control layers; the applicationContext-spring-security.xml default configuration permits unauthenticated users (with no prior knowledge of platform settings) to extract information without valid credentials. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Successful exploitation allows unauthorized server access.

## PoC / Detection
Classification: auth-bypass

The template performs two unauthenticated GET requests (stop-at-first-match) to `/pentaho/api/userrolelist/systemRoles?require-cfg.js` or `/api/userrolelist/systemRoles?require-cfg.js`. It verifies exploitation by matching HTTP 200 status and the presence of both `<roleList>` and `<roles>Anonymous</roles>` strings in the response body.

## References
- https://seclists.org/fulldisclosure/2021/Nov/13
- https://portswigger.net/daily-swig/remote-code-execution-sql-injection-bugs-uncovered-in-pentaho-business-analytics-software
- https://hawsec.com/publications/pentaho/HVPENT210401-Pentaho-BA-Security-Assessment-Report-v1_1.pdf
- https://www.hitachi.com/hirt/security/index.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31602
