---
cve_id: CVE-2021-34805
template_path: nuclei-templates/http/cves/2021/CVE-2021-34805.yaml
affected_product: FAUST iServer
severity: high
authentication: none
external_callback: false
affected_versions: before 9.0.019.019.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability
FAUST iServer before 9.0.019.019.7 suffers from local file inclusion (LFI) / path traversal (CWE-22). For every URL request the server maps the path directly to a corresponding .fau file on the OS filesystem without sanitizing directory-traversal sequences (%2e%2e%5c).  
CVSS 3.1: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).  
Successful exploitation allows unauthenticated remote reading of arbitrary sensitive files (configuration files, system files, source code).

## PoC / Detection
Classification: info-leak  
The template issues one unauthenticated GET request to `{{BaseURL}}/%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5cwindows%5cwin.ini` and matches on HTTP 200 plus the exact strings `bit app support`, `fonts`, and `extensions` appearing together in the response body (standard markers inside `C:\Windows\win.ini`).

## References
- https://cxsecurity.com/issue/WLB-2022010120
- http://packetstormsecurity.com/files/165701/FAUST-iServer-9.0.018.018.4-Local-File-Inclusion.html
- http://www.land-software.de/lfs.fau?prj=iweb&dn=faust+iserver
- https://nvd.nist.gov/vuln/detail/CVE-2021-34805
- https://github.com/20142995/Goby
