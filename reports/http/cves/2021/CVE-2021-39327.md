---
cve_id: CVE-2021-39327
template_path: nuclei-templates/http/cves/2021/CVE-2021-39327.yaml
affected_product: WordPress BulletProof Security
severity: medium
authentication: none
external_callback: false
affected_versions: versions up to, and including, 5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress BulletProof Security plugin is vulnerable to sensitive information disclosure due to a file path disclosure in the publicly accessible `~/db_backup_log.txt` file. This grants attackers the full path of the site in addition to the path of database backup files.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (score 5.3)  
CWE-459, CWE-200  
Impact: An attacker can gain sensitive information from the target system.  
Remediation: Update to the latest version of WordPress BulletProof Security.  
CPE: cpe:2.3:a:ait-pro:bulletproof_security:*:*:*:*:*:wordpress:*:*

## PoC / Detection
Classification: info-leak  
The template issues GET requests to two candidate paths (`{{BaseURL}}/wp-content/bps-backup/logs/db_backup_log.txt` and `{{BaseURL}}/wp-content/plugins/bulletproof-security/admin/htaccess/db_backup_log.txt`). It verifies the response contains both marker strings `BPS DB BACKUP LOG` and `==================` (AND condition), is not an empty log file (negative regex), returns `text/plain` Content-Type, and HTTP status 200.

## References
- https://packetstormsecurity.com/files/164420/wpbulletproofsecurity51-disclose.txt
- https://www.wordfence.com/vulnerability-advisories/#CVE-2021-39327
- https://nvd.nist.gov/vuln/detail/CVE-2021-39327
- http://packetstormsecurity.com/files/164420/WordPress-BulletProof-Security-5.1-Information-Disclosure.html
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2591118%40bulletproof-security&new=2591118%40bulletproof-security&sfp_email=&sfph_mail=
