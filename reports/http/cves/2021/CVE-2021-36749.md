---
cve_id: CVE-2021-36749
template_path: nuclei-templates/http/cves/2021/CVE-2021-36749.yaml
affected_product: Apache Druid
severity: medium
authentication: required
external_callback: false
affected_versions: 0.21.0 and 0.21.1
preconditions: [authenticated access to ingestion sampler endpoint; application allows HTTP InputSource but restricts Local InputSource]
poc_classification: info-leak
---

## Vulnerability
Apache Druid ingestion system vulnerable to local file inclusion via HTTP InputSource. Authenticated users can read arbitrary local files (server-process privileges) by supplying `file://` URIs in HTTP firehose configuration. Bypasses application-level restrictions that permit HTTP but forbid Local InputSource. Issue persisted in 0.21.0/0.21.1 despite prior CVE-2021-26920 fix claim. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (6.5).

## PoC / Detection
Classification: info-leak

Template sends POST `/druid/indexer/v1/sampler?for=connect` with JSON index task using HTTP firehose `uris: ["file:///etc/passwd"]` and string parser. Verifies via regex match on response body for `/etc/passwd` entries (`root:.*:0:0:` or `druid:*:1000:1000:`).

## References
- https://github.com/BrucessKING/CVE-2021-36749
- https://lists.apache.org/thread.html/rc9400a70d0ec5cdb8a3486fc5ddb0b5282961c0b63e764abfbcb9f5d%40%3Cdev.druid.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2021-36749
- https://lists.apache.org/thread.html/r304dfe56a5dfe1b2d9166b24d2c74ad1c6730338b20aef77a00ed2be@%3Cannounce.apache.org%3E
- https://lists.apache.org/thread.html/r304dfe56a5dfe1b2d9166b24d2c74ad1c6730338b20aef77a00ed2be%40%3Cannounce.apache.org%3E
