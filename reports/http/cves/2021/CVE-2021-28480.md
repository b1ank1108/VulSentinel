---
cve_id: CVE-2021-28480
template_path: nuclei-templates/http/cves/2021/CVE-2021-28480.yaml
affected_product: Microsoft Exchange Server
severity: critical
authentication: none
external_callback: false
affected_versions: 2013 Cumulative Update 23, 2016 Cumulative Update 19 and 20, 2019 Cumulative Update 8 and 9
preconditions: []
poc_classification: rce
---

## Vulnerability
Microsoft Exchange Server is vulnerable to a pre-authentication Server-Side Request Forgery (SSRF) combined with ACL bypass (ProxyNotFound) caused by improper input validation in the OWA component. This allows remote attackers with network access to execute arbitrary code.

**CVSS 3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Impact:** Attackers can execute arbitrary code remotely, potentially leading to full system compromise or data breach.  
**Remediation:** Apply the latest security patches and updates provided by Microsoft for Exchange Server.  
**Tags:** cve, cve2021, ssrf, rce, exchange, microsoft

## PoC / Detection
Classification: rce

The template detects the vulnerability via a two-step unauthenticated interaction:  
1. Issues `GET /owa/` and extracts the internal frontend server name from the `X-FEServer` response header (after confirming 302 redirect).  
2. Computes an XOR-encoded (0xFF) `X-BackEndCookie` payload containing the server name, random email, Unix epoch, and timestamp; then sends `GET /owa/calendar/{{randstr}}` with the crafted cookie and `X-AnchorMailbox` header.  
Success is confirmed on 302 status with response body containing both `NT+AUTHORITY` and `Microsoft.Exchange.Clients.Owa2.Server.Core.OwaADUserNotFoundException`.

## References
- https://sec.vnpt.vn/2021/04/microsoft-exchange-from-deserialization-to-post-auth-rce-cve-2021-28482
- https://hitcon.org/2021/agenda/279d7810-e619-4dc3-9113-b11bad5277ec/The%20Proxy%20Era%20of%20Microsoft%20Exchange%20Server.pdf
- https://www.youtube.com/watch?v=vn4niT9XEIM
- https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2021-28480
- https://nvd.nist.gov/vuln/detail/cve-2021-28480
