---
cve_id: CVE-2021-25864
template_path: nuclei-templates/http/cves/2021/CVE-2021-25864.yaml
affected_product: Hue Magic
severity: high
authentication: none
external_callback: false
affected_versions: 3.0.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Hue Magic 3.0.0 is susceptible to local file inclusion via the res.sendFile API. The vulnerability allows path traversal attacks leading to unauthorized access to sensitive files on the server filesystem.

The LFI vulnerability can lead to unauthorized access to sensitive files, potentially exposing sensitive information or allowing for further exploitation.

CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
CWE: CWE-22  
Framework: Node.js

## PoC / Detection
Classification: info-leak

The template sends a GET request to `/hue/assets/..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2fpasswd` and verifies successful exploitation by checking for HTTP status code 200 combined with a regex match for `root:.*:0:0:` in the response body (confirming that `/etc/passwd` was successfully read).

## References
- https://github.com/Foddy/node-red-contrib-huemagic/issues/217
- https://nvd.nist.gov/vuln/detail/CVE-2021-25864
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
