---
cve_id: CVE-2021-31249
template_path: nuclei-templates/http/cves/2021/CVE-2021-31249.yaml
affected_product: CHIYU TCP/IP Converter
severity: medium
authentication: none
external_callback: false
affected_versions: BF-430, BF-431, BF-450
preconditions: []
poc_classification: state-change
---

## Vulnerability
CHIYU TCP/IP Converter BF-430, BF-431, and BF-450 devices are vulnerable to CRLF injection via the unsanitized `redirect=` parameter present in multiple CGI endpoints (e.g. `man.cgi`). Attacker-controlled input containing `%0d%0a` sequences is reflected into HTTP response headers and body without neutralization.

Successful exploitation enables obtaining sensitive information, modifying data, executing unauthorized administrative operations, and can escalate to remote code execution or full unauthorized access within the device context.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N (score 6.5, Medium). CWE-74.

## PoC / Detection
Classification: state-change

The template sends a single unauthenticated GET request to `{{BaseURL}}/man.cgi?redirect=setting.htm%0d%0a%0d%0a<script>alert(document.domain)</script>&failure=fail.htm&type=dev_name_apply&http_block=0&TF_ip0=192&TF_ip1=168&TF_ip2=200&TF_ip3=200&TF_port=&TF_port=&B_mac_apply=APPLY`. It matches on a 302 status together with both the string `Location: setting.htm` and the injected `<script>alert(document.domain)</script>` appearing in the response headers, confirming CRLF injection and response-header/body manipulation.

## References
- https://gitbook.seguranca-informatica.pt/cve-and-exploits/cves/chiyu-iot-devices#cve-2021-31249
- https://www.chiyu-tech.com/msg/message-Firmware-update-87.html
- https://seguranca-informatica.pt/dancing-in-the-iot-chiyu-devices-vulnerable-to-remote-attacks/
- https://nvd.nist.gov/vuln/detail/CVE-2021-31249
