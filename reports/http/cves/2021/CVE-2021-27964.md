---
cve_id: CVE-2021-27964
template_path: nuclei-templates/http/cves/2021/CVE-2021-27964.yaml
affected_product: SonLogger
severity: critical
authentication: none
external_callback: false
affected_versions: before 6.4.1
preconditions: []
poc_classification: rce
---

## Vulnerability
SonLogger before 6.4.1 is vulnerable to unauthenticated arbitrary file upload. An attacker can POST to `/Config/SaveUploadedHotspotLogoFile` with no authentication, session header, or credentials. The endpoint performs no file-extension or content-type validation. Uploaded files are stored and served from `/Assets/temp/hotspot/img/`.  
Impact: unauthenticated attackers achieve remote code execution and complete server compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8, CWE-434).

## PoC / Detection
Classification: rce  
The template performs a two-step detection:  
1. Multipart POST to `/Config/SaveUploadedHotspotLogoFile` with a random `.txt` filename (Content-Type: image/png) containing random alphanumeric data; matcher verifies HTTP 200 + JSON content-type + "Message" in body.  
2. GET to `/Assets/temp/hotspot/img/{{random}}.txt` to confirm the exact random payload is returned, proving arbitrary file storage and retrieval that enables webshell/RCE.

## References
- https://erberkan.github.io/2021/SonLogger-vulns/
- https://github.com/erberkan/SonLogger-vulns
