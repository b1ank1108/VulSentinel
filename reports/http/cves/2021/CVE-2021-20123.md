---
cve_id: CVE-2021-20123
template_path: nuclei-templates/http/cves/2021/CVE-2021-20123.yaml
affected_product: Draytek VigorConnect
severity: high
authentication: none
external_callback: false
affected_versions: 1.6.0-B3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion in the file download functionality of the DownloadFileServlet endpoint. An unauthenticated attacker can leverage this vulnerability to download arbitrary files from the underlying operating system with root privileges. CVSS 3.1 score is 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). CWE-22 path traversal.

## PoC / Detection
Classification: info-leak

The template issues two unauthenticated GET requests (stopping at first match) to `{{BaseURL}}/ACSServer/DownloadFileServlet` using path-traversal payloads `../../../../../../etc/passwd` and `../../../../../../windows/win.ini` (with fixed `type=uploadfile&path=anything` parameters). It verifies exploitation by matching HTTP status 200, `Content-Type: application/octet-stream` header, and regex patterns in the response body for either Linux root user entry (`root:.*:0:0:`) or Windows `win.ini` signature (`for 16-bit app support`).

## References
- https://www.tenable.com/security/research/tra-2021-42
- https://nvd.nist.gov/vuln/detail/CVE-2021-20123
- https://github.com/ARPSyndicate/kenzer-templates
