---
cve_id: CVE-2021-26084
template_path: nuclei-templates/http/cves/2021/CVE-2021-26084.yaml
affected_product: Confluence Server
severity: critical
authentication: optional
external_callback: false
affected_versions: before version 6.13.23, from version 6.14.0 before 7.4.11, from version 7.5.0 before 7.11.6, and from version 7.12.0 before 7.12.5
preconditions: ["Allow people to sign up to create their account is enabled"]
poc_classification: rce
---

## Vulnerability
Confluence Server and Data Center contain an OGNL injection vulnerability (CWE-917) that could allow an authenticated user, and in some instances an unauthenticated user, to execute arbitrary code. The vulnerable endpoints can be accessed by a non-administrator user or unauthenticated user if 'Allow people to sign up to create their account' is enabled. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation allows arbitrary code execution on the server.

## PoC / Detection
Classification: rce

The template issues a POST request to one of 13 candidate endpoints (e.g. `/pages/createpage-entervariables.action?SpaceKey=x`, `/confluence/pages/createpage-entervariables.action`, `/users/user-dark-features`) with the queryString payload `aaaa\u0027%2b#{16*8787}%2b\u0027bbb`. It stops at the first match and verifies the OGNL expression was evaluated by checking for the string `value="aaaa{140592=null}` in the HTTP 200 response body.

## References
- https://jira.atlassian.com/browse/CONFSERVER-67940
- https://github.com/httpvoid/CVE-Reverse/tree/master/CVE-2021-26084
- https://nvd.nist.gov/vuln/detail/CVE-2021-26084
- https://github.com/Udyz/CVE-2021-26084
- https://github.com/0xsyr0/OSCP
