---
cve_id: CVE-2021-24849
template_path: nuclei-templates/http/cves/2021/CVE-2021-24849.yaml
affected_product: WCFM WooCommerce Multivendor Marketplace
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.4.12
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WCFM WooCommerce Multivendor Marketplace WordPress plugin before 3.4.12 is vulnerable to SQL injection in the `wcfm_ajax_controller` AJAX action. The endpoint is available to unauthenticated and authenticated users; multiple parameters are not properly sanitized before being used in SQL statements. Unauthenticated attackers can execute SQL injection through multiple unsanitized parameters, potentially gaining access to all WooCommerce marketplace data including customer and vendor information. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-89. Fixed in 3.4.12.

## PoC / Detection
Classification: info-leak

The template first issues an internal GET request to `/wp-content/plugins/wc-multivendor-marketplace/readme.txt` and matches the response status 200 plus the exact plugin name string to fingerprint the component. It then sends a POST to `/wp-admin/admin-ajax.php` (Content-Type application/x-www-form-urlencoded) using the `action=wcfm_ajax_controller&controller=wcfm-refund-requests` endpoint with two time-based blind SQLi payloads: `transaction_id=1+union+select+1+and+sleep(5)--` or `orderby=ID`%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP(5)))b)--%20``. The request is confirmed vulnerable if duration >=5s, status_code == 200, header contains application/json, and body contains "success".

## References
- https://wpscan.com/vulnerability/763c08a0-4b2b-4487-b91c-be6cc2b9322e/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24849
- https://wordpress.org/plugins/wc-multivendor-marketplace/
