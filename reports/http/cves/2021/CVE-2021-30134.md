---
cve_id: CVE-2021-30134
template_path: nuclei-templates/http/cves/2021/CVE-2021-30134.yaml
affected_product: Php-mod/curl Library
severity: medium
authentication: none
external_callback: false
affected_versions: <2.3.2
preconditions: test files (post_file_path_upload.php) exposed in web root
poc_classification: info-leak
---

## Vulnerability
Php-mod/curl Library before 2.3.2 contains a reflected cross-site scripting (XSS) vulnerability (CVE-2021-30134, CWE-79) via the `key` parameter of `post_file_path_upload.php` and POST data to `post_multidimensional.php`. An attacker can inject arbitrary scripts, enabling theft of cookie-based authentication credentials, session hijacking, or page defacement.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1)

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/vendor/curl/curl/tests/server/php-curl-test/post_file_path_upload.php?key=<img%20src%20onerror%3dalert(document.domain)>` and verifies successful exploitation by checking for literal reflection of the unsanitized payload in the response body, combined with `text/html` Content-Type and HTTP 200 status.

## References
- https://wpscan.com/vulnerability/0b547728-27d2-402e-ae17-90d539344ec7
- https://nvd.nist.gov/vuln/detail/CVE-2021-30134
- https://github.com/ARPSyndicate/kenzer-templates
