---
cve_id: CVE-2021-24214
template_path: nuclei-templates/http/cves/2021/CVE-2021-24214.yaml
affected_product: WordPress OpenID Connect Generic Client
severity: medium
authentication: none
external_callback: false
affected_versions: 3.8.0-3.8.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress OpenID Connect Generic Client plugin (by daggerhartlab) versions 3.8.0-3.8.1 contains a reflected cross-site scripting (XSS) flaw. The `login-error` GET parameter is reflected unsanitized inside the login form error message on `wp-login.php`. No authentication is required; the issue is exploitable in the default plugin configuration on any WordPress site with the plugin active. Successful exploitation allows arbitrary JavaScript execution in the victim's browser context (session hijacking, credential theft, defacement).  
CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) • CWE-79 • Remediation: upgrade to 3.8.2+.

## PoC / Detection
Classification: info-leak

The template first issues an internal GET request to `/wp-content/plugins/daggerhart-openid-connect-generic/readme.txt` and matches the string "OpenID Connect Generic Client" to confirm the plugin is installed. It then sends `GET {{BaseURL}}/wp-login.php?login-error=<script>alert(document.domain)</script>` and verifies the payload is reflected verbatim in the response body (matcher: "ERROR (<script>alert(document.domain)</script>):" AND "Login with OpenID Connect"), along with `Content-Type: text/html` and HTTP 200. This confirms the lack of output sanitization on the login-error parameter.

## References
- https://wpscan.com/vulnerability/31cf0dfb-4025-4898-a5f4-fc7115565a10
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24214
- https://nvd.nist.gov/vuln/detail/CVE-2021-24214
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
