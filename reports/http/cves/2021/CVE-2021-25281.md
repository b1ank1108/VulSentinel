---
cve_id: CVE-2021-25281
template_path: nuclei-templates/http/cves/2021/CVE-2021-25281.yaml
affected_product: SaltStack Salt
severity: critical
authentication: none
external_callback: false
affected_versions: < 3002.5
preconditions: []
poc_classification: rce
---

## Vulnerability
SaltStack Salt before 3002.5 does not honor eauth credentials for the wheel_async client. This authentication bypass (CWE-287) allows unauthenticated attackers to remotely execute arbitrary wheel modules on the Salt master, resulting in complete infrastructure compromise and control over all managed systems.

## PoC / Detection
Classification: rce
The template sends a single POST request to `/run` using `client: wheel_async`, `fun: pillar_roots.write` (harmless file-write probe to `../../../../../../../tmp/testing`) with dummy credentials (`username: "1"`, `password: "1"`, `eauth: "pam"`). Detection succeeds on HTTP 200 and JSON body containing all of: "return", "tag", "jid", "salt", "wheel".

## References
- http://hackdig.com/02/hack-283902.htm
- https://dozer.nz/posts/saltapi-vulns
- https://nvd.nist.gov/vuln/detail/CVE-2021-25281
- https://github.com/saltstack/salt/releases
- https://www.saltstack.com/blog/active-saltstack-cve-announced-2021-jan-21/
