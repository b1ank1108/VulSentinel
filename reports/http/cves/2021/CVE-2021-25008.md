---
cve_id: CVE-2021-25008
template_path: nuclei-templates/http/cves/2021/CVE-2021-25008.yaml
affected_product: Code Snippets
severity: medium
authentication: required
external_callback: false
affected_versions: < 2.14.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2021-25008 is a reflected Cross-Site Scripting (XSS) vulnerability in the Code Snippets WordPress plugin affecting versions prior to 2.14.3. The vulnerability exists due to improper sanitization of the `snippets-safe-mode` parameter before it is reflected in HTML attributes within the plugin's admin interface. An attacker can craft a malicious URL containing JavaScript code in this parameter, which will execute in the context of an authenticated administrator's browser session when the URL is accessed. This is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), indicating network-exploitable with low complexity but requiring user interaction.

## PoC / Detection

Classification: info-leak

The template performs authenticated detection of the XSS vulnerability through a two-step process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials (`username` and `password` parameters) to establish an authenticated session.

2. **XSS Probe**: Sends a GET request to `/wp-admin/admin.php?page=snippets` with a crafted `snippets-safe-mode[0]` parameter containing an XSS payload: `" style=animation-name:rotation onanimationstart=alert(document.domain) x=`. This payload uses CSS animation events to trigger JavaScript execution.

The template confirms the vulnerability by checking for:
- The reflected XSS payload in the response body (specifically the unescaped attribute injection)
- The presence of "Snippets" text indicating the plugin page loaded
- HTTP 200 status code

The detection verifies that the malicious input is reflected without proper encoding, confirming the XSS vulnerability is exploitable.

## References

- https://wpscan.com/vulnerability/cb232354-f74d-48bb-b437-7bdddd1df42a
- https://nvd.nist.gov/vuln/detail/CVE-2021-25008
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
