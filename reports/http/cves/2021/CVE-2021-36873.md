---
cve_id: CVE-2021-36873
template_path: nuclei-templates/http/cves/2021/CVE-2021-36873.yaml
affected_product: WordPress iQ Block Country plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <=1.2.11
preconditions: iQ Block Country plugin installed and activated
poc_classification: info-leak
---

## Vulnerability
WordPress iQ Block Country plugin versions <=1.2.11 contains a stored cross-site scripting (XSS) vulnerability (CWE-79) in the block message field of the admin settings page. Authenticated attackers can inject arbitrary JavaScript via the `blockcountry_blockmessage` option; the payload executes in the context of any administrator viewing the page, enabling session-cookie theft or further client-side attacks (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N, score 5.4).

## PoC / Detection
Classification: info-leak

The template performs a 4-request flow: (1) POST /wp-login.php with provided admin credentials, (2) GET the plugin settings page to extract the `_wpnonce` via regex, (3) POST /wp-admin/options.php to update `blockcountry_blockmessage` with the payload `test</textarea><script>alert(document.domain)</script>`, (4) GET the settings page again and matches on `status_code_4 == 200`, HTML content-type, presence of the exact unsanitized payload in `body_4`, and the expected `<h3>Block type</h3>` heading.

## References
- https://wpscan.com/vulnerability/ba93f085-2153-439b-9cda-7c5b09d3ed58
- https://wordpress.org/plugins/iq-block-country/
- https://patchstack.com/database/vulnerability/iq-block-country-/wordpress-iq-block-country-plugin-1-2-11-authenticated-persistent-cross-site-scripting-xss-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2021-36873
- https://wordpress.org/plugins/iq-block-country/#developers
