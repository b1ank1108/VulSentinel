---
cve_id: CVE-2021-27850
template_path: nuclei-templates/http/cves/2021/CVE-2021-27850.yaml
affected_product: Apache Tapestry
severity: critical
authentication: none
external_callback: false
affected_versions: 5.4.5, 5.5.0, 5.6.2 and 5.7.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache Tapestry contains a critical unauthenticated remote code execution vulnerability (CVE-2021-27850). This is a bypass of the fix for CVE-2019-0195, which previously blocked downloading arbitrary class files from the classpath via crafted asset file URLs. Successful exploitation could allow an attacker to execute arbitrary code on the affected system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8)  
CWE-IDs: CWE-502, CWE-200

## PoC / Detection
Classification: rce

The template detects the vulnerability with a two-request sequence. The first raw GET to `/assets/app/something/services/AppModule.class/` extracts a dynamic ID from the response header using an internal regex extractor (`\/assets\/app\/([a-z0-9]+)\/services\/AppMod`). The second raw GET to `/assets/app/{{id}}/services/AppModule.class/` then verifies success by matching HTTP status 200, `application/java` Content-Type header, and the simultaneous presence of the strings `configuration` and `webtools` in the body (confirming retrieval of an internal Java class file from the classpath).

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-27850
- https://lists.apache.org/thread.html/r237ff7f286bda31682c254550c1ebf92b0ec61329b32fbeb2d1c8751%40%3Cusers.tapestry.apache.org%3E
- http://www.openwall.com/lists/oss-security/2021/04/15/1
- https://security.netapp.com/advisory/ntap-20210528-0002/
- https://github.com/ARPSyndicate/cvemon
