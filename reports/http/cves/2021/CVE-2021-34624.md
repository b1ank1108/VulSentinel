---
cve_id: CVE-2021-34624
template_path: nuclei-templates/http/cves/2021/CVE-2021-34624.yaml
affected_product: WordPress ProfilePress
severity: critical
authentication: none
external_callback: false
affected_versions: 3.0.0 - 3.1.3
preconditions: []
poc_classification: rce
---

## Vulnerability
A critical arbitrary file upload vulnerability in the file uploader component (`~/src/Classes/FileUploader.php`) of the ProfilePress WordPress plugin allows unauthenticated attackers to upload arbitrary files (including PHP) during user registration or profile updates. This affects versions 3.0.0 - 3.1.3 and can lead to remote code execution and server compromise.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

## PoC / Detection
Classification: rce

The template performs detection by issuing a raw POST request to `/wp-admin/admin-ajax.php` using the `pp_ajax_signup` action. It submits registration form data (random username, email, password, names) along with a crafted PHP file upload (`{{rand}}.php` containing `<?php echo "CVE-2021-34624"; ?>`) and sets administrator capabilities. It then GETs the uploaded file from `/wp-content/uploads/pp-files/{{filename}}.php` and matches on the test string appearing in the body with status 200.

## References
- https://wpscan.com/vulnerability/e12448ec-84a0-46aa-b280-5d9a80ee1e41/
