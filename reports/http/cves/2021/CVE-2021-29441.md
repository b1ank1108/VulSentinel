---
cve_id: CVE-2021-29441
template_path: nuclei-templates/http/cves/2021/CVE-2021-29441.yaml
affected_product: Nacos
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.4.1
preconditions: Nacos configured with authentication enabled (-Dnacos.core.auth.enabled=true)
poc_classification: auth-bypass
---

## Vulnerability

Nacos versions before 1.4.1, when configured with authentication enabled (-Dnacos.core.auth.enabled=true), contain a backdoor in the AuthFilter servlet filter that skips authentication checks. The bypass is triggered by setting the User-Agent header to "Nacos-Server", allowing any unauthenticated attacker to perform administrative tasks including configuration modification.

## PoC / Detection

Classification: auth-bypass

The template sends two identical POST requests to `/nacos/v1/cs/configs?dataId=nacos.cfg.dataIdfoo&group=foo&content=helloWorld`:

- First request (default User-Agent) expects HTTP 403 with body containing "Forbidden".
- Second request (User-Agent: Nacos-Server) expects HTTP 200 with body exactly "true".

Detection succeeds only when both status/body conditions are met, confirming the authentication bypass.

## References

- https://securitylab.github.com/advisories/GHSL-2020-325_326-nacos/
- https://github.com/alibaba/nacos/issues/4701
- https://github.com/advisories/GHSA-36hp-jr8h-556f
- https://github.com/alibaba/nacos/pull/4703
- https://github.com/bakery312/Vulhub-Reproduce
