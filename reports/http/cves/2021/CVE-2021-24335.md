---
cve_id: CVE-2021-24335
template_path: nuclei-templates/http/cves/2021/CVE-2021-24335.yaml
affected_product: WordPress Car Repair Services & Auto Mechanic Theme
severity: medium
authentication: none
external_callback: false
affected_versions: <4.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected cross-site scripting (XSS) in the WordPress Car Repair Services & Auto Mechanic Theme before version 4.0. The flaw stems from missing sanitization/encoding of the `serviceestimatekey` GET parameter on the `/car1/estimateresult/result` endpoint, which is echoed directly into the HTML output.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1) • CWE-79 • CPE `cpe:2.3:a:smartdatasoft:car_repair_services_\&_auto_mechanic:*:*:*:*:*:wordpress:*:*`  

Impact: attacker-controlled JavaScript executes in the victim's browser context, enabling data theft (cookies, localStorage), session hijacking, or page defacement.  

Remediation: upgrade to version 4.0 or later.

## PoC / Detection
Classification: info-leak  

The template first issues a GET to `{{BaseURL}}` and internally matches theme-specific assets (`/wp-content/themes/car-repair-services/css`, `/js`, and `id="car-repair-services-"`) to confirm the vulnerable theme is active. It then sends a second GET to `{{BaseURL}}/car1/estimateresult/result?s=&serviceestimatekey=</script><script>alert(document.domain)</script>`, verifying that the exact unsanitized payload appears verbatim in the response body while status=200 and Content-Type contains `text/html`. This confirms the parameter is reflected without escaping, proving the XSS condition.

## References
- https://themeforest.net/item/car-repair-services-auto-mechanic-wordpress-theme/19823557
- https://m0ze.ru/vulnerability/[2021-02-12]-[WordPress]-[CWE-79]-Car-Repair-Services-WordPress-Theme-v3.9.txt
- https://wpscan.com/vulnerability/39258aba-2449-4214-a490-b8e46945117d
- https://nvd.nist.gov/vuln/detail/CVE-2021-24335
- https://m0ze.ru/vulnerability/%5B2021-02-12%5D-%5BWordPress%5D-%5BCWE-79%5D-Car-Repair-Services-WordPress-Theme-v3.9.txt
