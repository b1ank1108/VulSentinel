---
cve_id: CVE-2021-20150
template_path: nuclei-templates/http/cves/2021/CVE-2021-20150.yaml
affected_product: Trendnet AC2600 TEW-827DRU
severity: medium
authentication: none
external_callback: false
affected_versions: 2.08B01
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Trendnet AC2600 TEW-827DRU firmware version 2.08B01 improperly discloses information via redirection from the setup wizard. A user (or unauthenticated attacker) may view information as Admin by manually browsing to the setup wizard and forcing it to redirect to the desired page (e.g., ftpserver.asp). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (score 5.3). CWE-306: Missing Authentication for Critical Function.

**Impact:** An attacker can obtain sensitive credentials (ftp_username, ftp_password, ftp_permission, admin_passwd), leading to unauthorized access to the router.

**Remediation:** Update the router firmware to the latest version to fix the vulnerability.

## PoC / Detection
Classification: info-leak

The template issues a single raw POST request to `/apply_sec.cgi` with the parameters `action=setup_wizard_cancel&html_response_page=ftpserver.asp&html_response_return_page=ftpserver.asp`. It verifies the leak by matching the words `ftp_username`, `ftp_password`, `ftp_permission`, and `TEW-827DRU` (all required) in the response body, confirming `text/html` content-type and HTTP 200 status. A regex extractor then pulls the plaintext value of the `admin_passwd` input field.

## References
- https://www.tenable.com/security/research/tra-2021-54
- https://nvd.nist.gov/vuln/detail/CVE-2021-20150
