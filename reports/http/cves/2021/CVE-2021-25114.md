---
cve_id: CVE-2021-25114
template_path: nuclei-templates/http/cves/2021/CVE-2021-25114.yaml
affected_product: WordPress Paid Memberships Pro
severity: critical
authentication: none
external_callback: false
affected_versions: <2.6.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Paid Memberships Pro plugin for WordPress before 2.6.7 is vulnerable to blind SQL injection (CWE-89) via the `discount_code` parameter in the unauthenticated REST route `/?rest_route=/pmpro/v1/checkout_level`. The parameter is not escaped before use in a SQL statement. An attacker can obtain sensitive database information, modify data, and/or perform unauthorized administrative operations. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). Impact limited to extraction of sensitive database information per template impact field.

## PoC / Detection
Classification: info-leak

The template performs a time-based blind SQLi probe plus plugin fingerprint:
- Sends GET request with payload `discount_code='  union select sleep(6) -- g` (level_id=3) and measures response duration.
- Follows with GET to `/wp-content/plugins/paid-memberships-pro/js/pmpro-checkout.js`.
Matchers (AND): `duration_1 >= 6`, first response contains `application/json` header + HTTP 200, second response body contains `other_discount_code_`.

## References
- https://wpscan.com/vulnerability/6c25a5f0-a137-4ea5-9422-8ae393d7b76b
- https://wordpress.org/plugins/paid-memberships-pro/
- https://nvd.nist.gov/vuln/detail/CVE-2021-25114
- https://www.paidmembershipspro.com/pmpro-update-2-6-7-security-release/
- https://github.com/ARPSyndicate/kenzer-templates
