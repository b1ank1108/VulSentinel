---
cve_id: CVE-2021-26295
template_path: nuclei-templates/http/cves/2021/CVE-2021-26295.yaml
affected_product: Apache OFBiz
severity: critical
authentication: none
external_callback: true
affected_versions: <17.12.06
preconditions: []
poc_classification: rce
---

## Vulnerability
Apache OFBiz prior to 17.12.06 contains an unsafe Java object deserialization vulnerability in its SOAP web service. An unauthenticated remote attacker can send malicious serialized objects leading to arbitrary code execution and full system compromise (CWE-502, CVSS 9.8).

## PoC / Detection
Classification: rce

The template sends a POST request with a crafted SOAP envelope to `/webtools/control/SOAPService`, embedding a hex-encoded ysoserial URLDNS gadget in the `cus-obj` parameter of `clearAllEntityCaches`. Detection relies on confirming a DNS callback to interactsh, "errorMessage" string in response body, and "OFBiz.Visitor=" in headers.

## References
- https://github.com/yumusb/CVE-2021-26295-POC
- https://packetstormsecurity.com/files/162104/Apache-OFBiz-SOAP-Java-Deserialization.html
- https://github.com/zhzyker/exphub/tree/master/ofbiz
- https://lists.apache.org/thread.html/r3c1802eaf34aa78a61b4e8e044c214bc94accbd28a11f3a276586a31%40%3Cuser.ofbiz.apache.org%3E
- https://lists.apache.org/thread.html/r6e4579c4ebf7efeb462962e359501c6ca4045687f12212551df2d607@%3Cnotifications.ofbiz.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2021-26295
