---
cve_id: CVE-2021-42192
template_path: nuclei-templates/http/cves/2021/CVE-2021-42192.yaml
affected_product: Konga
severity: high
authentication: required
external_callback: false
affected_versions: 0.14.9
preconditions: [authenticated non-admin user account]
poc_classification: auth-bypass
---

## Vulnerability
Konga 0.14.9 is affected by a privilege escalation vulnerability (CVE-2021-42192, CWE-863). Authenticated users can escalate to full administrator privileges by crafting a request that sets the `admin` flag to `true` on the `/api/user/{ID}` endpoint. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8). Successful exploitation allows unauthorized access to sensitive information and actions.

## PoC / Detection
Classification: auth-bypass

The template performs a multi-step detection simulating the exploit:  
- POST /login with `{{username}}`/`{{password}}` to obtain session `{{token}}` and extract user `{{id}}` via regex.  
- POST /api/user/{{id}} (with token) to retrieve current user object and confirm `"admin":false` in body_2.  
- PUT /api/user/{{id}} with payload setting `"admin":"true"`, `passports`, and token to update the record.  
- Matcher verifies body_3 contains `"admin":true` and all responses are 200 with JSON content-type.  

This confirms the endpoint lacks proper authorization checks on the admin flag update.

## References
- http://n0hat.blogspot.com/2021/11/konga-0149-privilege-escalation-exploit.html
- https://www.exploit-db.com/exploits/50521
- hhttps://nvd.nist.gov/vuln/detail/CVE-2021-42192
- https://docs.google.com/document/d/1-YU9zWiDVUps3Mb6zos3996yvZ48vW_vfOvaJLLHc4I/edit?usp=sharing
- https://github.com/pantsel/konga/
