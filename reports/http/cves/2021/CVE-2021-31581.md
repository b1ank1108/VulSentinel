---
cve_id: CVE-2021-31581
template_path: nuclei-templates/http/cves/2021/CVE-2021-31581.yaml
affected_product: Akkadian Provisioning Manager
severity: medium
authentication: none
external_callback: false
affected_versions: Akkadian OVA appliance < 3.0, Akkadian Provisioning Manager < 5.0.2, Akkadian Appliance Manager < 3.3.0.314-4a349e0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Akkadian Provisioning Manager is susceptible to information disclosure. The restricted shell provided can be escaped by abusing the Edit MySQL Configuration command. This command launches a standard VI editor interface which can then be escaped.

An attacker can exploit this vulnerability to access sensitive information, such as user credentials or system configuration details.

This issue was resolved in Akkadian OVA appliance version 3.0 and later, Akkadian Provisioning Manager 5.0.2 and later, and Akkadian Appliance Manager 3.3.0.314-4a349e0 and later.

CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N (4.4). CWE-269, CWE-312. CPE: cpe:2.3:a:akkadianlabs:ova_appliance:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: info-leak

The template sends a single GET request to `{{BaseURL}}/pme/database/pme/phinx.yml` and matches on HTTP status 200 combined with the presence of the strings "host:", "name:", and "pass:" (while excluding any response containing HTML). This directly verifies that the Phinx YAML database configuration file exposing MySQL connection credentials is publicly readable.

## References
- https://threatpost.com/unpatched-bugs-provisioning-cisco-uc/166882/
- https://www.rapid7.com/blog/post/2021/06/08/akkadian-provisioning-manager-multiple-vulnerabilities-disclosure/
- https://nvd.nist.gov/vuln/detail/CVE-2021-31581
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
