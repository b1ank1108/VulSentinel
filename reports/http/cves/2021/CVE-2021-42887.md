---
cve_id: CVE-2021-42887
template_path: nuclei-templates/http/cves/2021/CVE-2021-42887.yaml
affected_product: TOTOLINK EX1200T
severity: critical
authentication: none
external_callback: false
affected_versions: 4.1.2cu.5215
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
TOTOLINK EX1200T firmware 4.1.2cu.5215 contains an authentication bypass (CWE-287) in `/formLoginAuth.htm`. An unauthenticated remote attacker can send a crafted GET request with `authCode=1&userName=admin&action=login` to obtain a valid `SESSION_ID` cookie and 302 redirect, achieving full administrative access. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Impact includes sensitive data exposure, configuration modification, and network compromise.

## PoC / Detection
Classification: auth-bypass

The template performs a two-request HTTP flow to verify the bypass:
1. `GET /login.htm` – confirms device fingerprint via body containing "TOTOLINK".
2. `GET /formLoginAuth.htm?authCode=1&userName=admin&goURL=&action=login` – triggers the bypass; matcher requires `Set-Cookie: SESSION_ID=` header and HTTP 302 status in the second response.

No payloads, no version comparison, no OOB interaction; purely passive detection of the auth-bypass condition.

## References
- https://github.com/p1Kk/vuln/blob/main/totolink_ex1200t_login_bypass.md
- https://nvd.nist.gov/vuln/detail/cve-2021-42887
- https://github.com/ARPSyndicate/kenzer-templates
