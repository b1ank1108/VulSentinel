---
cve_id: CVE-2021-24931
template_path: nuclei-templates/http/cves/2021/CVE-2021-24931.yaml
affected_product: WordPress Secure Copy Content Protection and Content Locking plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <2.8.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Secure Copy Content Protection and Content Locking plugin before 2.8.2 contains an unauthenticated SQL injection in the `sccp_id` parameter of the `ays_sccp_results_export_file` AJAX action. The parameter is not escaped before use in a SQL statement, enabling attackers (authenticated or unauthenticated) to obtain sensitive information, modify data, execute unauthorized administrative operations, and gain full unauthorized access to the WordPress database.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-89.

## PoC / Detection
Classification: info-leak

The template issues a single raw GET request to `/wp-admin/admin-ajax.php?action=ays_sccp_results_export_file&sccp_id[]=3)%20AND%20(SELECT%205921%20FROM%20(SELECT(SLEEP(6)))LxjM)%20AND%20(7754=775&type=json` (20 s timeout) and matches on response duration â‰¥6 s, status_code == 200, content_type containing "text/html", and body containing `{"status":true` to confirm time-based blind SQL injection.

## References
- https://wpscan.com/vulnerability/1cd52d61-af75-43ed-9b99-b46c471c4231
- https://wordpress.org/plugins/secure-copy-content-protection/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24931
- http://packetstormsecurity.com/files/165946/WordPress-Secure-Copy-Content-Protection-And-Content-Locking-2.8.1-SQL-Injection.html
