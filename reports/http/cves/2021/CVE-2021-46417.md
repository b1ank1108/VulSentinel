---
cve_id: CVE-2021-46417
template_path: nuclei-templates/http/cves/2021/CVE-2021-46417.yaml
affected_product: Franklin Fueling Systems Colibri Controller Module
severity: high
authentication: none
external_callback: false
affected_versions: 1.8.19.8580
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A local file inclusion vulnerability (CWE-22) exists in Franklin Fueling Systems Colibri Controller Module 1.8.19.8580. Insecure handling of the download function in `/cgi-bin/tsaupload.cgi` permits path traversal using `../` sequences, allowing an unauthenticated remote attacker to read arbitrary files with root privileges.  

**CVSSv3.1:** 7.5 (High)  
**Vector:** AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N  
**Impact:** Unauthorized disclosure of configuration files, credentials, and other sensitive internal data.  
**Remediation:** Apply the vendor-supplied security patch or update.

## PoC / Detection
Classification: info-leak  

The template issues a single unauthenticated GET request to `{{BaseURL}}/cgi-bin/tsaupload.cgi?file_name=../../../../../..//etc/passwd&password=` and checks whether the response body matches the regex `root:.*:0:0:`. A positive match confirms the path-traversal LFI is present and readable.

## References
- https://packetstormsecurity.com/files/166671/Franklin-Fueling-Systems-Colibri-Controller-Module-1.8.19.8580-Local-File-Inclusion.html
- https://drive.google.com/drive/folders/1Yu4aVDdrgvs-F9jP3R8Cw7qo_TC7VB-R
- http://packetstormsecurity.com/files/166610/FFS-Colibri-Controller-Module-1.8.19.8580-Directory-Traversal.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-46417
- https://github.com/KayCHENvip/vulnerability-poc
