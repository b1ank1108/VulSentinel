---
cve_id: CVE-2021-20837
template_path: nuclei-templates/http/cves/2021/CVE-2021-20837.yaml
affected_product: MovableType
severity: critical
authentication: none
external_callback: true
affected_versions: MovableType 5002 and earlier (Movable Type Advanced 7 Series), Movable Type Advanced 6.8.2 and earlier (Movable Type Advanced 6 Series), Movable Type Premium 1.46 and earlier, and Movable Type Premium Advanced 1.46 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
MovableType is affected by a remote command injection vulnerability (CVE-2021-20837, CWE-78) allowing unauthenticated remote attackers to execute arbitrary OS commands via the XML-RPC API endpoint `/cgi-bin/mt/mt-xmlrpc.cgi` using the `mt.handler_to_coderef` method.

**CVSS 3.1**: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**Description**: MovableType 5002 and earlier (Movable Type Advanced 7 Series), Movable Type Advanced 6.8.2 and earlier (Movable Type Advanced 6 Series), Movable Type Premium 1.46 and earlier, and Movable Type Premium Advanced 1.46 and earlier allow remote attackers to execute arbitrary OS commands via unspecified vectors.

**Impact**: Successful exploitation leads to unauthorized access, data leakage, and potential compromise of the target system.

**Remediation**: Apply the latest security patches or updates provided by the vendor.

## PoC / Detection
Classification: rce

The template sends a POST request to `/cgi-bin/mt/mt-xmlrpc.cgi` containing an XML-RPC `<methodCall>` to `mt.handler_to_coderef` with a `<base64>`-encoded payload of `` `wget http://{{interactsh-url}}` ``. It verifies exploitation success by matching an out-of-band HTTP callback on interactsh, the presence of the string "failed loading package" in the response body, and HTTP status code 200.

## References
- https://nemesis.sh/posts/movable-type-0day/
- https://github.com/ghost-nemesis/cve-2021-20837-poc
- https://twitter.com/cyber_advising/status/1454051725904580608
- https://nvd.nist.gov/vuln/detail/CVE-2021-20837
- http://packetstormsecurity.com/files/164818/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
