---
cve_id: CVE-2021-21311
template_path: nuclei-templates/http/cves/2021/CVE-2021-21311.yaml
affected_product: Adminer
severity: high
authentication: none
external_callback: false
affected_versions: <4.7.9
preconditions: [bundling all drivers (e.g. adminer.php)]
poc_classification: info-leak
---

## Vulnerability
Adminer before 4.7.9 is susceptible to server-side request forgery (SSRF, CWE-918) due to exposure of sensitive information in error messages. Only versions bundling all drivers (e.g. the all-in-one `adminer.php`) are affected. An attacker can obtain internal information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.  
CVSS 3.1: 7.2 (AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N).  
Impact: unauthorized access to internal resources and potential data leakage.  
Remediation: upgrade to 4.7.9 or later.

## PoC / Detection
Classification: info-leak  
The template issues a POST request to common Adminer entry points (`/adminer.php`, `/index.php`, `/_adminer.php` and variants) with form-encoded authentication parameters that set `auth[server]=example.org` plus random driver/db/username/password values. It then matches on the presence of `<title>400 - Bad Request</title>` (plain or HTML-encoded) in the response body together with HTTP 403 status. This harmless probe triggers the SSRF error-path behavior that leaks connection details or confirms the forged outbound request succeeded, verifying the vulnerability without requiring authentication or out-of-band interaction.

## References
- https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6
- https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf
- https://packagist.org/packages/vrana/adminer
- https://nvd.nist.gov/vuln/detail/CVE-2021-21311
- https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351
