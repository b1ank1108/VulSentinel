---
cve_id: CVE-2021-24347
template_path: nuclei-templates/http/cves/2021/CVE-2021-24347.yaml
affected_product: WordPress SP Project & Document Manager plugin
severity: high
authentication: required
external_callback: false
affected_versions: <4.22
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress SP Project & Document Manager plugin before 4.22 allows authenticated shell upload. The plugin blocks executable files via extension check but is bypassed by case variation (e.g., `.pHP` instead of `.php`). 

Impact: unauthorized remote code execution on the affected WordPress site.  
CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
CWE-178: Improper Handling of Case Sensitivity  
Remediation: Fixed in version 4.22.

## PoC / Detection
Classification: rce

The template logs in to `/wp-login.php` with supplied credentials, fetches the document manager fileview page to extract the `cdm_upload_file_field` nonce, performs a multipart POST to upload a test PHP payload disguised as `{{randstr}}.pHP` (Content-Type: image/svg+xml containing `<?php echo "CVE-2021-24347"; ?>`), then issues a GET to `/wp-content/uploads/sp-client-document-manager/1/{{to_lower(randstr)}}.php` and matches the echo string in the 200 response body.

## References
- https://wpscan.com/vulnerability/8f6e82d5-c0e9-468e-acb8-7cd549f6a45a
- https://wordpress.org/plugins/sp-client-document-manager/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24347
- http://packetstormsecurity.com/files/163434/WordPress-SP-Project-And-Document-Manager-4.21-Shell-Upload.html
- https://github.com/Hacker5preme/Exploits
