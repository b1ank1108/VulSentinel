---
cve_id: CVE-2021-21234
template_path: nuclei-templates/http/cves/2021/CVE-2021-21234.yaml
affected_product: spring-boot-actuator-logview
severity: high
authentication: none
external_callback: false
affected_versions: < 0.2.13
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Spring Boot Actuator Logview (maven package "eu.hinsch:spring-boot-actuator-logview") versions prior to 0.2.13 contain a directory traversal vulnerability (CWE-22). The vulnerability exists in a library that adds a simple logfile viewer as a Spring Boot actuator endpoint. An attacker can exploit this flaw to traverse the filesystem and access arbitrary files on the server, leading to unauthorized access to sensitive information. The CVSS v3.1 score is 7.7 (AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N), indicating high confidentiality impact with low attack complexity. The EPSS score of 0.93852 (99.861th percentile) suggests this vulnerability is highly likely to be exploited in the wild.

## PoC / Detection

Classification: info-leak

The template detects this directory traversal vulnerability by attempting to read sensitive system files through the vulnerable logview endpoint. It sends GET requests to four different path variations:
- `/manage/log/view` and `/log/view` endpoints with parameters targeting Windows system files (`/windows/win.ini`)
- `/manage/log/view` and `/log/view` endpoints with parameters targeting Unix/Linux system files (`/etc/passwd`)

Both requests use the `filename` parameter to specify the target file and the `base` parameter with directory traversal sequences (`../../../../../../../../../../`) to escape the intended log directory. The template stops at the first successful match.

Detection is confirmed through two matcher sets:
1. For Unix/Linux systems: Validates the response contains `text/plain` content-type header, matches the regex pattern `root:.*:0:0:` (indicating `/etc/passwd` content), and returns HTTP 200 status
2. For Windows systems: Validates the response contains `text/plain` content-type header, contains strings characteristic of `win.ini` files ('bit app support', 'fonts', 'extensions'), and returns HTTP 200 status

## References

- https://blogg.pwc.no/styringogkontroll/unauthenticated-directory-traversal-vulnerability-in-a-java-spring-boot-actuator-library-cve-2021-21234
- https://github.com/cristianeph/vulnerability-actuator-log-viewer
- https://nvd.nist.gov/vuln/detail/CVE-2021-21234
- https://github.com/lukashinsch/spring-boot-actuator-logview/commit/760acbb939a8d1f7d1a7dfcd51ca848eea04e772
- https://github.com/lukashinsch/spring-boot-actuator-logview/commit/1c76e1ec3588c9f39e1a94bf27b5ff56eb8b17d6
- https://blog.csdn.net/qq_39583774/article/details/123023770#t5
