---
cve_id: CVE-2021-24295
template_path: nuclei-templates/http/cves/2021/CVE-2021-24295.yaml
affected_product: Spam protection, AntiSpam, FireWall by CleanTalk
severity: high
authentication: none
external_callback: false
affected_versions: < 5.153.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Unauthenticated time-based blind SQL injection in `lib/Cleantalk/ApbctWP/Firewall/SFW.php` (update_log function) of the Spam protection, AntiSpam, FireWall by CleanTalk WordPress plugin. Exploitable by sending requests with a manipulated User-Agent header after obtaining/setting ct_sfw_pass_key and ct_sfw_passed cookies.

Unauthenticated attackers can extract full database contents via time-based blind SQLi, exposing all WordPress user data and other sensitive information.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5)  
CWE-89  
Fixed in 5.153.4.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to the publicly accessible `/wp-content/plugins/cleantalk-spam-protect/readme.txt`, extracts the plugin version via regex on "Stable tag: ([0-9.]+)", and matches if the version compares as < 5.153.4, the body contains "Spam protection", and the status code is 200. This is a passive fingerprinting check only.

## References
- https://wpscan.com/vulnerability/152171fc-888c-4275-a118-5a1e664ef28b
- https://github.com/20142995/nuclei-templates
