---
cve_id: CVE-2021-29505
template_path: nuclei-templates/http/cves/2021/CVE-2021-29505.yaml
affected_product: XStream
severity: high
authentication: none
external_callback: true
affected_versions: <1.4.17
preconditions: []
poc_classification: rce
---

## Vulnerability
XStream before 1.4.17 is susceptible to remote code execution. An attacker can execute commands of the host by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site. Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system. Remediation: Patched in 1.4.17.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). CWE-502.

## PoC / Detection
Classification: rce  
The template sends a single POST request to `/` (Content-Type: application/xml) containing a crafted XML payload that exploits unsafe XStream deserialization via a `java.util.PriorityQueue` gadget chain. The payload embeds `javax.naming.ldap.Rdn_-RdnEntry` objects that ultimately trigger a JNDI/RMI lookup to `{{interactsh-url}}` (port 1099) inside a `sun.rmi.registry.RegistryImpl_Stub`. Detection verifies success by matching a DNS interaction via interactsh, the strings "timestamp" or "com.thoughtworks.xstream" in the response body (OR condition), an `application/json` header, or HTTP 500 status.

## References
- https://paper.seebug.org/1543/
- https://github.com/vulhub/vulhub/blob/master/xstream/CVE-2021-29505/README.zh-cn.md
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29505
- https://github.com/x-stream/xstream/security/advisories/GHSA-7chv-rrw6-w6fc
- https://nvd.nist.gov/vuln/detail/cve-2021-29505
