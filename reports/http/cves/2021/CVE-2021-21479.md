---
cve_id: CVE-2021-21479
template_path: nuclei-templates/http/cves/2021/CVE-2021-21479.yaml
affected_product: SCIMono
severity: critical
authentication: none
external_callback: false
affected_versions: < 0.0.19
preconditions: []
poc_classification: rce
---

## Vulnerability
SCIMono before 0.0.19 is vulnerable to remote code execution because it is possible for an attacker to inject and execute Java expressions and compromise the availability and integrity of the system. Successful exploitation allows arbitrary code execution on the target. CVSS 3.1 score 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H). CWE-74. Vendor: SAP. Product: scimono.

## PoC / Detection
Classification: rce  
The template issues a single unauthenticated GET request to `{{BaseURL}}/Schemas/$%7B''.class.forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('js').eval('java.lang.Runtime.getRuntime().exec(\"id\")')%7D` embedding a Server-Side Template Injection payload that forces the JavaScript ScriptEngine to run `Runtime.getRuntime().exec("id")`. Detection relies on matching all of the following strings in the response body: "The attribute value", "java.lang.UNIXProcess@", "has invalid value!", and '"status" : "400"' (indicating the injected command executed and produced a visible process object in the error output).

## References
- https://securitylab.github.com/advisories/GHSL-2020-227-scimono-ssti/
- https://nvd.nist.gov/vuln/detail/CVE-2021-21479
- https://github.com/SAP/scimono/security/advisories/GHSA-29q4-gxjq-rx5c
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
