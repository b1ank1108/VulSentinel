---
cve_id: CVE-2021-20086
template_path: nuclei-templates/http/cves/2021/CVE-2021-20086.yaml
affected_product: Odoo Apps
severity: high
authentication: none
external_callback: false
affected_versions: 1.2.1
preconditions: malicious user interaction required
poc_classification: state-change
---

## Vulnerability
Odoo Apps is vulnerable to Cross-Site Scripting via Prototype Pollution in the jquery-bbq 1.2.1 library (CVE-2021-20086, CWE-1321). The flaw stems from improperly controlled modification of object prototype attributes in jquery-bbq, enabling injection of arbitrary properties into Object.prototype via crafted query parameters. This leads to property overwrites and manipulation of application behavior, with potential JavaScript execution in the victim's browser context.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). Exploitation requires malicious user interaction.

## PoC / Detection
Classification: state-change

The template sends two GET requests to `{{BaseURL}}/` appending prototype-pollution payloads (`?__proto__[context]=<img src=x onerror=alert(document.domain)>&__proto__[jquery]=x` and the `constructor[prototype]` variant). It stops at the first match and verifies exploitation conditions with a DSL matcher requiring status_code 200, absence of "debug:" in body, and presence of both the injected `alert(document.domain)` string and the Odoo identifier `var odoo =` to confirm the pollution succeeded and affected page rendering.

## References
- https://www.tenable.com/security/research/tra-2022-10
- https://nvd.nist.gov/vuln/detail/CVE-2021-20086
