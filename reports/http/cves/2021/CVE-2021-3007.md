---
cve_id: CVE-2021-3007
template_path: nuclei-templates/http/cves/2021/CVE-2021-3007.yaml
affected_product: Laminas Project laminas-http
severity: critical
authentication: none
external_callback: false
affected_versions: laminas-http < 2.14.2 and Zend Framework 3.0.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Laminas Project laminas-http < 2.14.2 and Zend Framework 3.0.0 contain a deserialization vulnerability (CWE-502) in the `__destruct` method of `Zend\Http\Response\Stream` (Laminas equivalent). Supplying attacker-controlled serialized PHP objects allows remote code execution via gadget chain that reconfigures the view renderer escape helper to `system`.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Impact: arbitrary command execution on the server.

## PoC / Detection
Classification: rce  
The template issues two unauthenticated POST requests to `/` (Content-Type: application/x-www-form-urlencoded) with `param=<base64_serialized_gadget>`. The gadget (Laminas or Zend variant) sets the PHP renderer helper to `system` and injects `echo {{rand_base(5)}}` so the command runs during object destruction. Matcher verifies HTTP 200 and that response body contains the framework string ("laminas" or "zend") plus the random token. Flow uses logical OR of the two requests.

## References
- https://github.com/Ling-Yizhou/zendframework3-/blob/main/zend%20framework3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20rce.md
- https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/
