---
cve_id: CVE-2021-45232
template_path: nuclei-templates/http/cves/2021/CVE-2021-45232.yaml
affected_product: Apache APISIX Dashboard
severity: critical
authentication: none
external_callback: false
affected_versions: <2.10.1
preconditions: []
---

## Vulnerability

Apache APISIX Dashboard versions prior to 2.10.1 contain an authentication bypass vulnerability (CWE-306) in the Manager API. The vulnerability stems from the application's use of two frameworks: `gin` and `droplet`. While all APIs and authentication middleware are developed based on the `droplet` framework, some APIs directly use the `gin` framework interface, thereby bypassing authentication controls entirely.

This architectural flaw allows unauthenticated attackers to access protected API endpoints without providing any credentials. The vulnerability has a CVSS score of 9.8 (Critical) with an EPSS score of 0.93877 (99.865th percentile), indicating both high severity and active exploitation in the wild.

The impact includes unauthorized access to sensitive API functionality, potentially leading to data breaches, unauthorized configuration changes, and complete compromise of the APISIX Dashboard management interface.

## PoC / Detection

Classification: **auth-bypass**

The template detects this vulnerability by attempting to access the `/apisix/admin/migrate/export` endpoint without authentication. This endpoint should require authentication but is accessible due to the framework bypass issue.

The detection method:
1. Sends an unauthenticated GET request to `/apisix/admin/migrate/export`
2. Checks for a successful HTTP 200 response
3. Verifies the response contains `"Consumers":` in the body, indicating successful data export

A positive match confirms that the endpoint is accessible without authentication, demonstrating the authentication bypass vulnerability. The presence of consumer data in the response proves unauthorized access to sensitive configuration information.

## References

- https://apisix.apache.org/zh/blog/2021/12/28/dashboard-cve-2021-45232/
- https://github.com/pingpongcult/CVE-2021-45232
- https://github.com/advisories/GHSA-wcxq-f256-53xp
- https://twitter.com/403Timeout/status/1475715079173976066
- https://github.com/wuppp/cve-2021-45232-exp
