---
cve_id: CVE-2021-24227
template_path: nuclei-templates/http/cves/2021/CVE-2021-24227.yaml
affected_product: Patreon WordPress plugin
severity: high
authentication: none
external_callback: false
affected_versions: <1.7.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Patreon WordPress before version 1.7.0 is vulnerable to unauthenticated local file inclusion that could be abused by anyone visiting the site. Exploitation by an attacker could leak important internal files like wp-config.php, which contains database credentials and cryptographic keys. An attacker can exploit this vulnerability to read sensitive files on the server, potentially leading to further compromise of the system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). CWE-200.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/?patron_only_image=../../../../../../../../../../etc/passwd&patreon_action=serve_patron_only_image` and verifies exploitation success with HTTP status 200 plus regex match for `root:[x*]:0:0` in the response body (probing a harmless path-traversal payload to confirm the underlying LFI flaw).

## References
- https://wpscan.com/vulnerability/f62df02d-7678-440f-84a1-ddbf09364016
- https://wordpress.org/plugins/patreon-connect/
- https://jetpack.com/2021/03/26/vulnerabilities-found-in-patreon-wordpress-plugin/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24227
- https://github.com/ARPSyndicate/cvemon
