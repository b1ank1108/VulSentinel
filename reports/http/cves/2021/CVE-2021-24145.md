---
cve_id: CVE-2021-24145
template_path: nuclei-templates/http/cves/2021/CVE-2021-24145.yaml
affected_product: WordPress Modern Events Calendar Lite
severity: high
authentication: required
external_callback: false
affected_versions: before 5.16.5
preconditions: [administrator or high-privilege user access]
poc_classification: rce
---

## Vulnerability
WordPress Modern Events Calendar Lite plugin before 5.16.5 is vulnerable to authenticated arbitrary file upload. The plugin does not properly validate files imported via the MEC import feature, allowing PHP scripts to be uploaded (disguised with text/csv content-type) by administrators or high-privilege users, potentially leading to remote code execution (CWE-434). CVSS 3.1 score 7.2 (AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H). Fixed in 5.16.5.

## PoC / Detection
Classification: rce
The template authenticates via POST to /wp-login.php using username/password credentials, then uploads a malicious .php file (payload: `<?php echo md5("CVE-2021-24145"); unlink(__FILE__); ?>` named with random string) via multipart/form-data POST to `/wp-admin/admin.php?page=MEC-ix&tab=MEC-import` using Content-Type: text/csv and `mec-ix-action=import-start-bookings`, followed by a GET to `/wp-content/uploads/{{randstr}}.php` that verifies successful execution by matching the MD5 hash in the response body (payload self-deletes after run). Uses 3 HTTP requests.

## References
- https://wpscan.com/vulnerability/f42cc26b-9aab-4824-8168-b5b8571d1610
- https://downloads.wordpress.org/plugin/modern-events-calendar-lite.5.15.5.zip
- https://github.com/dnr6419/CVE-2021-24145
- https://nvd.nist.gov/vuln/detail/CVE-2021-24145
- https://github.com/k0mi-tg/CVE-POC
