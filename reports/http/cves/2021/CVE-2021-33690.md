---
cve_id: CVE-2021-33690
template_path: nuclei-templates/http/cves/2021/CVE-2021-33690.yaml
affected_product: SAP NetWeaver Development Infrastructure
severity: critical
authentication: required
external_callback: true
affected_versions: 7.11, 7.20, 7.30, 7.31, 7.40, 7.50
preconditions: authenticated access to Component Build Service
poc_classification: info-leak
---

## Vulnerability

Server-Side Request Forgery (SSRF) vulnerability in the SAP NetWeaver Development Infrastructure Component Build Service versions 7.11, 7.20, 7.30, 7.31, 7.40, 7.50. A threat actor with server access can send crafted queries to perform proxy attacks, potentially compromising sensitive internal data and impacting availability. Impact depends on whether NWDI runs on the intranet or internet (CVSS reflects worst-case internet scenario).

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H (9.9). CWE-918.

Remediation: Apply the latest firmware update provided by the vendor.

## PoC / Detection
Classification: info-leak

Template issues a POST request to `/tc.CBS.Appl/tcspseudo` containing `CBS=http://{{interactsh-url}}&USER=1&PWD=1&REQ_CONFIRM_DELAY=2000&ACTION=CONFIGURE`. Detection succeeds if a DNS callback is received on the interactsh domain and the response body contains "Could not connect to the CBS".

## References
- https://redrays.io/cve-2021-33690-server-side-request-forgery-vulnerability/
- https://nvd.nist.gov/vuln/detail/CVE-2021-33690
- https://launchpad.support.sap.com/#/notes/3072955
- https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=582222806
- https://github.com/redrays-io/CVE-2021-33690
