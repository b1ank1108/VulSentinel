---
cve_id: CVE-2021-33807
template_path: nuclei-templates/http/cves/2021/CVE-2021-33807.yaml
affected_product: Cartadis Gespage
severity: high
authentication: none
external_callback: false
affected_versions: through 8.2.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Cartadis Gespage through 8.2.1 is affected by a path traversal vulnerability (CWE-22) in the endpoints `gespage/doDownloadData` and `gespage/webapp/doDownloadData`. Unauthenticated remote attackers can traverse the filesystem using `../` sequences in the `file_name` parameter to read arbitrary files.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).  
Impact includes unauthorized access to sensitive files, data leakage, and potential further system compromise.  
No additional configuration, authentication, or feature enablement is required beyond the vulnerable software version.

## PoC / Detection
Classification: info-leak  

The template performs a single unauthenticated GET request to `{{BaseURL}}/gespage/doDownloadData?file_name=../../../../../Windows/debug/NetSetup.log`. It confirms exploitation by matching the string "NetpDoDomainJoin:" in the response body, the header `application/octet-stream`, and HTTP status code 200. This probe verifies the directory-traversal flaw by retrieving a predictable Windows system file.

## References
- https://www.on-x.com/sites/default/files/on-x_-_security_advisory_-_gespage_-_cve-2021-33807.pdf
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33807
- https://www.gespage.com/cartadis-db/
- https://www.cartadis.com/gespage-website/
- https://support.gespage.com/fr/support/solutions/articles/14000130201-security-advisory-gespage-directory-traversal
