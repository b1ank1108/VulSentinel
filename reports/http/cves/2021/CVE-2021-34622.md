---
cve_id: CVE-2021-34622
template_path: nuclei-templates/http/cves/2021/CVE-2021-34622.yaml
affected_product: WordPress ProfilePress plugin
severity: critical
authentication: required
external_callback: false
affected_versions: <= 3.1.3
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
WordPress ProfilePress plugin <= 3.1.3 (before 3.1.4) is vulnerable to privilege escalation (CVE-2021-34622). Due to insufficient validation in the profile update functionality, authenticated users can supply arbitrary usermeta fields (including `wp_capabilities`) during updates. This enables escalation to administrator and complete WordPress site takeover. CVSS 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H); CWE-269.

## PoC / Detection
Classification: auth-bypass

The template verifies the vulnerability by fully exploiting it: registers a random low-privilege user via multipart `pp_ajax_signup`, authenticates via `pp_ajax_login`, extracts `_wpnonce` and `nonce` from GET `/account/edit-profile/`, then submits multipart `pp_ajax_editprofile` injecting `wp_capabilities[administrator]=1`, and confirms success via 200 status plus body containing `"success":true` or "Account was updated successfully".

## References
- https://www.wordfence.com/blog/2021/06/easily-exploitable-critical-vulnerabilities-patched-in-profilepress-plugin/
- https://nvd.nist.gov/vuln/detail/CVE-2021-34622
