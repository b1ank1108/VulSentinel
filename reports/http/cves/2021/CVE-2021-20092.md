---
cve_id: CVE-2021-20092
template_path: nuclei-templates/http/cves/2021/CVE-2021-20092.yaml
affected_product: Buffalo WSR-2533DHPL2
severity: high
authentication: none
external_callback: false
affected_versions: firmware version <= 1.02 (WSR-2533DHPL2) and <= 1.24 (WSR-2533DHP3)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The web interfaces of Buffalo WSR-2533DHPL2 firmware version <= 1.02 and WSR-2533DHP3 firmware version <= 1.24 do not properly restrict access to sensitive information from an unauthorized actor.

An attacker can exploit this vulnerability to gain unauthorized access to the router's configuration settings and potentially compromise the entire network.

CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N) | CWE-287

Remediation: Apply the latest firmware update provided by Buffalo to fix the access control issue.

## PoC / Detection
Classification: info-leak

The template performs two chained raw HTTP GET requests exploiting path traversal: first to `/images/..%2finfo.html` (with Referer), extracting a token internally, then to `/images/..%2fcgi/cgi_i_filter.js` using the token, hardcoded cookies (`lang=8; url=ping.html; mobile=false;`), and Referer. Success is confirmed by a 200 OK status, `application/x-javascript` Content-Type header, and presence of both `/*DEMO*/` and `addCfg(` strings in the body.

## References
- https://www.tenable.com/security/research/tra-2021-13
- https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2
- https://nvd.nist.gov/vuln/detail/CVE-2021-20091
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
