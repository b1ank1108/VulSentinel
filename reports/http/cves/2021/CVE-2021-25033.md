---
cve_id: CVE-2021-25033
template_path: nuclei-templates/http/cves/2021/CVE-2021-25033.yaml
affected_product: Noptin
severity: medium
authentication: none
external_callback: false
affected_versions: < 1.6.5
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Noptin WordPress plugin fails to sanitize the `to` query parameter on the `noptin_ns=email_click` endpoint. Any value supplied is used directly in a `Location` header, enabling open redirection to attacker-controlled domains.  

**CVSS v3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** 601  
**Impact:** Phishing via crafted links that silently redirect authenticated or unauthenticated users.  
**Remediation:** Upgrade to version 1.6.5 or later.

## PoC / Detection
Classification: detect-only  

The template performs a single GET request to `{{BaseURL}}/?noptin_ns=email_click&to=https://interact.sh` and matches the response `Location` header with a regex confirming an unvalidated redirect to the supplied test domain. No payload execution, data modification, or out-of-band interaction occurs; the probe is purely behavioral and harmless.

## References
- https://wpscan.com/vulnerability/c2d2384c-41b9-4aaf-b918-c1cfda58af5c
- https://plugins.trac.wordpress.org/changeset/2639592
- https://nvd.nist.gov/vuln/detail/CVE-2021-25033
- https://github.com/ARPSyndicate/kenzer-templates
