---
cve_id: CVE-2021-40661
template_path: nuclei-templates/http/cves/2021/CVE-2021-40661.yaml
affected_product: IND780
severity: high
authentication: none
external_callback: false
affected_versions: 7.2.10 (June 18, 2012) and 8.0.07 (March 19, 2018)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
IND780 Advanced Weighing Terminals firmware is vulnerable to unauthenticated local file inclusion (LFI, CWE-22) via directory traversal. A remote attacker can supply a relative path to the `webpage` parameter when requesting `AutoCE.ini` through `excalweb.dll`, allowing arbitrary file reads on the host filesystem (e.g., configuration files or credentials).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).  
Impact: access to sensitive information leading to further system compromise.  
Remediation: apply latest vendor firmware update and restrict device access from untrusted networks.

## PoC / Detection
Classification: info-leak  
The template detects the vulnerability by sending a single unauthenticated GET request to `{{BaseURL}}/IND780/excalweb.dll?webpage=../../AutoCE.ini` and matching on HTTP 200 status together with both `ExePath=\Windows` and `WorkDir=\Windows` strings present in the response body, confirming successful inclusion and leakage of the AutoCE.ini configuration file.

## References
- https://sidsecure.au/blog/cve-2021-40661/?_sm_pdc=1&_sm_rid=MRRqb4KBDnjBMJk24b40LMS3SKqPMqb4KVn32Kr
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40661
- https://www.mt.com/au/en/home/products/Industrial_Weighing_Solutions/Terminals-and-Controllers/terminals-bench-floor-scales/advanced-bench-floor-applications/IND780/IND780_.html#overviewpm
- https://nvd.nist.gov/vuln/detail/CVE-2021-40661
- https://github.com/Live-Hack-CVE/CVE-2021-40661
