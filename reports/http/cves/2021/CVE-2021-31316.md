---
cve_id: CVE-2021-31316
template_path: nuclei-templates/http/cves/2021/CVE-2021-31316.yaml
affected_product: CentOS Web Panel
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
CentOS Web Panel's unprivileged user portal is affected by SQL injection via the `idsession` HTTP POST parameter to `/login/index.php?acc=newpass`. Unauthenticated attackers can extract database contents or execute arbitrary commands with root privileges.

CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | CWE-89

## PoC / Detection
Classification: rce

The template fingerprints the target with a GET / request checking for "cwpsrv" in response headers, then sends a POST request embedding a time-based blind SQLi payload (`a'%20UNION%20SELECT...sleep 7...`) in the `idsession` form field. Exploitation is confirmed if response duration >=7s, status_code==200, and body contains "Control WebPanel".

## References
- https://www.shielder.com/advisories/centos-web-panel-idsession-root-rce/
- https://nvd.nist.gov/vuln/detail/CVE-2021-31316
