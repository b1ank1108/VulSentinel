---
cve_id: CVE-2021-22005
template_path: nuclei-templates/http/cves/2021/CVE-2021-22005.yaml
affected_product: VMware vCenter Server
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
VMware vCenter Server contains an arbitrary file upload vulnerability in the Analytics service. A malicious actor with network access to port 443 on vCenter Server may exploit this issue to execute code on vCenter Server by uploading a specially crafted file.

CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) • CWE-22 • Impact: full remote code execution via file upload/execution on target system.

## PoC / Detection
Classification: rce

The template performs a two-request fingerprint of the vulnerable Analytics telemetry endpoint:  
- `GET /` (expects status 200 and "VMware vSphere" in body)  
- `POST /analytics/telemetry/ph/api/hyper/send?_c&_i=test` (Content-Type: application/json, body: `test_data`; expects status 201 and content-length 0).  

This harmless probe confirms the presence of the endpoint that permits arbitrary file upload leading to RCE; the actual exploit uses a crafted file upload to the same service.

## References
- https://kb.vmware.com/s/article/85717
- https://www.vmware.com/security/advisories/VMSA-2021-0020.html
- https://core.vmware.com/vmsa-2021-0020-questions-answers-faq
- https://nvd.nist.gov/vuln/detail/CVE-2021-22005
- https://github.com/ARPSyndicate/kenzer-templates
