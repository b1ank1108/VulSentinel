---
cve_id: CVE-2021-24940
template_path: nuclei-templates/http/cves/2021/CVE-2021-24940.yaml
affected_product: WordPress Persian Woocommerce plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <=5.8.0
preconditions: Persian WooCommerce plugin installed and activated; authenticated WordPress administrator must visit crafted URL
poc_classification: info-leak
---

## Vulnerability
WordPress Persian Woocommerce plugin through version 5.8.0 fails to escape the `s` search parameter before outputting it in an HTML attribute on the `persian-wc` admin dashboard page (`/wp-admin/admin.php?page=persian-wc`). This reflected cross-site scripting (XSS) flaw allows an attacker to craft a malicious URL that injects arbitrary JavaScript executed in the victim's browser context when visited by a logged-in administrator. Impact includes cookie-based credential theft, session hijacking, or site defacement. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Fixed in 5.9.8.

## PoC / Detection
Classification: info-leak

The template first authenticates to WordPress by POSTing `log={{username}}&pwd={{password}}` to `/wp-login.php`. It then issues a GET to `/wp-admin/admin.php?page=persian-wc?s=xxxxx%22+accesskey%3DX+onclick%3Dalert%281%29+test%3D%22` embedding the XSS payload. Detection succeeds if `status_code_2 == 200`, `contains(header_2, "text/html")`, the unescaped payload appears in `body_2`, and `body_2` contains `woocommerce_persian_translate` (confirming the plugin admin interface).

## References
- https://wpscan.com/vulnerability/1980c5ca-447d-4875-b542-9212cc7ff77f
- https://nvd.nist.gov/vuln/detail/CVE-2021-24940
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
