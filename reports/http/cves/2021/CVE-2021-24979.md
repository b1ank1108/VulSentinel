---
cve_id: CVE-2021-24979
template_path: nuclei-templates/http/cves/2021/CVE-2021-24979.yaml
affected_product: Paid Memberships Pro
severity: medium
authentication: required
external_callback: false
affected_versions: < 2.6.6
preconditions: [authenticated as WordPress administrator]
poc_classification: info-leak
---

## Vulnerability
The Paid Memberships Pro WordPress plugin before 2.6.6 is vulnerable to reflected cross-site scripting (XSS). The `s` parameter on the discount codes admin page (`/wp-admin/admin.php?page=pmpro-discountcodes`) is not escaped when output in an HTML attribute.

CVSS 3.1 score: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). An attacker can inject malicious JavaScript that executes in the context of an authenticated administrator, potentially stealing session cookies or exposing membership data. Fixed in 2.6.6.

## PoC / Detection
Classification: info-leak

The template first authenticates to WordPress using provided admin credentials via POST to `/wp-login.php`. It then sends a GET request to the vulnerable admin endpoint with an XSS payload in the `s` parameter (`s=s"+style=animation-name:rotation+onanimationstart=alert(document.domain)//`). Detection confirms if the unsanitized payload appears in the response body along with the plugin signature and correct HTML content-type.

## References
- https://wpscan.com/vulnerability/fc011990-4ec1-4553-901d-4ff1f482cb79
- https://nvd.nist.gov/vuln/detail/CVE-2021-24979
- https://plugins.trac.wordpress.org/changeset/2632369/paid-memberships-pro/tags/2.6.6/adminpages/discountcodes.php
