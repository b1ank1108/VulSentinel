---
cve_id: CVE-2021-4191
template_path: nuclei-templates/http/cves/2021/CVE-2021-4191.yaml
affected_product: GitLab
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
GitLab GraphQL API is vulnerable to unauthenticated user enumeration. An unauthenticated remote attacker can query the GraphQL endpoint to collect registered usernames, names, and email addresses. This enables reconnaissance for password brute-forcing or targeted phishing campaigns.  
CVSS: 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) | CWE-287

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated POST request to `/api/graphql` containing a GraphQL query for `users { nodes { id name username } }`. It detects the vulnerability on HTTP 200 responses whose body contains all of `"data"`, `"users"`, `"nodes"`, `"id"`, and `"gid://"` (JSON structure confirming public user listing), then extracts usernames via JSON extractor.

## References
- https://www.rapid7.com/blog/post/2022/03/03/cve-2021-4191-gitlab-graphql-api-user-enumeration-fixed/
- https://thehackernews.com/2022/03/new-security-vulnerability-affects.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-4191
- https://gitlab.com/gitlab-org/gitlab/-/issues/343898
- https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-4191.json
