---
cve_id: CVE-2021-23394
template_path: nuclei-templates/http/cves/2021/CVE-2021-23394.yaml
affected_product: elFinder
severity: high
authentication: none
external_callback: false
affected_versions: < 2.1.58
preconditions: [server parses .phar files as PHP]
poc_classification: rce
---

## Vulnerability
elFinder (studio-42/elfinder) before 2.1.58 contains a remote code execution vulnerability caused by execution of PHP code inside an uploaded .phar file. Attackers can upload a malicious .phar via the PHP connector; if the server parses .phar files as PHP, arbitrary PHP code executes, leading to full server compromise.  
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (8.1) • CWE-434 • CPE: cpe:2.3:a:std42:elfinder:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: rce

The template performs a three-step non-destructive verification using the elFinder PHP connector (/elFinder/php/connector.minimal.php):  
1. GET mkfile request creates a random `{randstr}.phar` file in the root and extracts its hash from the JSON response.  
2. GET put request writes a benign PHP payload (`<?=''; echo md5('{{randstr}}'); ?>`) into the .phar file.  
3. GET /elFinder/files/{{filename}}.phar triggers execution; the response body is matched for the computed MD5 hash to confirm the .phar was parsed and executed as PHP.

## References
- https://github.com/Studio-42/elFinder/issues/3295
- https://blog.sonarsource.com/elfinder-the-story-of-a-file-manager-and-a-bunch-of-vulnerabilities
- https://snyk.io/vuln/SNYK-PHP-STUDIO42ELFINDER-1290554
- https://nvd.nist.gov/vuln/detail/CVE-2021-23394
