---
cve_id: CVE-2021-46107
template_path: nuclei-templates/http/cves/2021/CVE-2021-46107.yaml
affected_product: Ligeo Archives Ligeo Basics
severity: high
authentication: none
external_callback: true
affected_versions: 02_01-2022
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Ligeo Archives Ligeo Basics (as of version 02_01-2022) is affected by a Server-Side Request Forgery (SSRF, CWE-918) vulnerability. The flaw exists in the `/archive/download` endpoint's `file` parameter, enabling unauthenticated attackers to read arbitrary local files (such as `/etc/passwd`) or force HTTP requests to internal or attacker-controlled external services.

**CVSS 3.1:** 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
**Impact:** Significant, resulting in unauthorized access to sensitive data or systems.

## PoC / Detection
Classification: info-leak

The template fingerprints the target by requesting `/` and confirming "Ligeo Archives" in the body. It then tests file-read SSRF with `/archive/download?file=file:///etc/passwd` (matching `root:.*:0:0:`) and blind SSRF via `/archive/download?file=http://{{interactsh-url}}/ ` (checking for interactsh HTTP callback). Up to 3 requests total.

## References
- https://raw.githubusercontent.com/Orange-Cyberdefense/CVE-repository/master/PoCs/POC_CVE-2021-46107.py
- https://nvd.nist.gov/vuln/detail/CVE-2021-46107
- https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/
- https://github.com/Transmetal/CVE-repository-master
- https://github.com/ARPSyndicate/cvemon
