---
cve_id: CVE-2021-24876
template_path: nuclei-templates/http/cves/2021/CVE-2021-24876.yaml
affected_product: Registrations for The Events Calendar
severity: medium
authentication: required
external_callback: false
affected_versions: < 2.7.5
preconditions: WordPress with Registrations for The Events Calendar plugin installed and activated
poc_classification: info-leak
---

## Vulnerability
The Registrations for The Events Calendar WordPress plugin before 2.7.5 fails to escape the `v` parameter when outputting it in an HTML attribute on the admin page `/wp-admin/admin.php?page=registrations-for-the-events-calendar&tab=registrations`. This results in an authenticated reflected cross-site scripting vulnerability (CWE-79).

CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Successful exploitation allows injection of malicious JavaScript that can steal administrator session cookies or perform administrative actions in the context of any authenticated user who visits the crafted link. Fixed in 2.7.5.

## PoC / Detection
Classification: info-leak

The template first performs authentication by sending a POST to `/wp-login.php` with supplied `{{username}}` and `{{password}}` credentials and confirms success via 302 redirect containing the `wordpress_logged_in` cookie. It then sends a GET request to the vulnerable admin endpoint with `v="+style=animation-name:rotation+onanimationstart=alert(document.domain)//` and verifies reflection by checking that the response body contains the exact unsanitized payload string, the hidden `<input type="hidden" name="v">` field, the plugin identifier string, HTML content type, and HTTP 200 status.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-24876
- https://wpscan.com/vulnerability/e77c2493-993d-418d-9629-a1f07b5a2b6f/
