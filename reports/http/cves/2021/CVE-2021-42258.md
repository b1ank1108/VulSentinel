---
cve_id: CVE-2021-42258
template_path: nuclei-templates/http/cves/2021/CVE-2021-42258.yaml
affected_product: BillQuick Web Suite
severity: critical
authentication: none
external_callback: false
affected_versions: 2018 through 2021 before 22.0.9.1
preconditions: []
poc_classification: rce
---

## Vulnerability
CVE-2021-42258 is a critical SQL injection (CWE-89) in BQE BillQuick Web Suite 2018 through 2021 before 22.0.9.1. The flaw permits unauthenticated remote code execution, including arbitrary command execution as the MSSQLSERVER$ account via xp_cmdshell. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). EPSS 0.93812 (99.855th percentile). Impact includes full system compromise, unauthorized data access, and leakage. Remediation requires applying vendor patches.

## PoC / Detection
Classification: rce

The template first issues a GET request to `/` and extracts ASP.NET ViewState (`__VIEWSTATE`), ViewStateGenerator (`__VIEWSTATEGENERATOR`), and EventValidation (`__EVENTVALIDATION`) tokens via XPath on the login form. It then sends a POST to `/` with a form-encoded payload injecting a single-quote SQLi into the username field (`txtID=uname%27`) while supplying dummy password and the extracted tokens. Detection matches the response body for the exact strings "System.Data.SqlClient.SqlException", "Incorrect syntax near", and "_ACCOUNTLOCKED" (AND condition). The probe is harmless error-based confirmation; the underlying flaw enables full unauthenticated RCE.

## References
- https://www.huntress.com/blog/threat-advisory-hackers-are-exploiting-a-vulnerability-in-popular-billing-software-to-deploy-ransomware
- https://nvd.nist.gov/vuln/detail/CVE-2021-42258
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Ostorlab/KEV
- https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors
