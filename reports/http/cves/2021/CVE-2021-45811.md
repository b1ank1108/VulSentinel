---
cve_id: CVE-2021-45811
template_path: nuclei-templates/http/cves/2021/CVE-2021-45811.yaml
affected_product: osTicket
severity: medium
authentication: required
external_callback: false
affected_versions: 1.15.x
preconditions: []
poc_classification: info-leak
---

## Vulnerability
osTicket 1.15.x contains a SQL injection vulnerability in the search functionality of the tickets.php page. Authenticated attackers can execute arbitrary SQL commands via the `keywords` and `topic_id` URL parameters combination. Impact includes extraction of sensitive database contents such as user credentials and ticket information. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (6.5). Remediation: upgrade to a later version.

## PoC / Detection
Classification: info-leak

The template first issues a GET to `/scp/login.php` to extract the `__CSRFToken__` value, then performs a POST login to `/scp/login.php` using the extracted token plus supplied `{{username}}` and `{{password}}` credentials, followed by a GET to `/tickets.php?a=search&keywords=text'+:1&topic_id=topic_id_val`. It matches on the second response body containing the injected SQL fragments "FROM (SELECT", "topic_id_val'' IN NATURAL", and "ORDER BY relevance" to confirm the vulnerability.

## References
- https://members.backbox.org/osticket-sql-injection/
- https://nvd.nist.gov/vuln/detail/CVE-2021-45811
