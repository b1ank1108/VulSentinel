---
cve_id: CVE-2021-24452
template_path: nuclei-templates/http/cves/2021/CVE-2021-24452.yaml
affected_product: WordPress W3 Total Cache plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <2.1.5
preconditions: ['Anonymously track usage to improve product quality setting enabled']
poc_classification: info-leak
---

## Vulnerability
WordPress W3 Total Cache plugin before 2.1.5 is vulnerable to reflected cross-site scripting via the `extension` parameter on the Extensions dashboard (`/wp-admin/admin.php?page=w3tc_extensions`). When the setting "Anonymously track usage to improve product quality" is enabled, the parameter is reflected in a JavaScript context without escaping. An attacker can craft a malicious link that, when clicked by an authenticated administrator, executes arbitrary JavaScript in the admin browser context (scope change). This leads to session hijacking, data theft, or full site compromise. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79. Fixed in 2.1.5.

## PoC / Detection
Classification: info-leak

The template first POSTs credentials to `/wp-login.php` to authenticate as administrator, then issues GET `/wp-admin/admin.php?page=w3tc_extensions&extension='-alert(document.domain)-'`. It matches on status_code 200, presence of the unsanitized payload string `'extensions/'-alert(document.domain)-''` and `w3-total-cache` in the body, plus `text/html` content-type header. This confirms the parameter is reflected without sanitization in the admin dashboard.

## References
- https://wpscan.com/vulnerability/3e855e09-056f-45b5-89a9-d644b7d8c9d0
- https://wordpress.org/plugins/w3-total-cache/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24452
