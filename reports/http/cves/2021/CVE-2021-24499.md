---
cve_id: CVE-2021-24499
template_path: nuclei-templates/http/cves/2021/CVE-2021-24499.yaml
affected_product: WordPress Workreap theme
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Workreap theme is susceptible to remote code execution (CVE-2021-24499, CWE-434). The AJAX actions `workreap_award_temp_file_uploader` and `workreap_temp_file_uploader` perform no nonce checks and perform no validation that the request originates from a valid user. Endpoints allow unauthenticated file uploads to the `wp-content/uploads/workreap-temp` directory; uploaded files receive no sanitization or validation, enabling arbitrary PHP scripts.

Impact: Successful exploitation allows an attacker to execute arbitrary code on the affected WordPress site.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: Update to the latest version of the Workreap plugin.

## PoC / Detection
Classification: rce

The template performs a direct non-destructive exploitation:  
- POSTs a multipart form to `/wp-admin/admin-ajax.php` (action=`workreap_award_temp_file_uploader`) uploading a temporary PHP file containing `<?php echo md5("CVE-2021-24499");unlink(__FILE__);?>`.  
- Issues a follow-up GET to `/wp-content/uploads/workreap-temp/<random>.php` and asserts both HTTP 200 and the expected MD5 hash in the response body.

## References
- https://github.com/RyouYoo/CVE-2021-24499
- https://nvd.nist.gov/vuln/detail/CVE-2021-24499
- https://wpscan.com/vulnerability/74611d5f-afba-42ae-bc19-777cdf2808cb
- https://jetpack.com/2021/07/07/multiple-vulnerabilities-in-workreap-theme/
- http://packetstormsecurity.com/files/172876/WordPress-Workreap-2.2.2-Shell-Upload.html
