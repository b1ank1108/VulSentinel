---
cve_id: CVE-2021-24731
template_path: nuclei-templates/http/cves/2021/CVE-2021-24731.yaml
affected_product: Pie Register WordPress plugin
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.7.1.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

The Pie Register WordPress plugin before 3.7.1.6 fails to properly escape user data in the `wp-json/pie/v1/login` REST API endpoint's `user_login` parameter, resulting in SQL injection.

Unauthenticated attackers can execute arbitrary SQL queries, enabling data leakage, manipulation, or unauthorized access (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H - 9.8).

Fixed in version 3.7.1.6.

## PoC / Detection

Classification: info-leak

The template issues a POST request to `/wp-json/pie/v1/login` with a time-based blind SQL injection payload in `user_login` (`'+AND+(SELECT+8149+FROM+(SELECT(SLEEP(3)))NuqO)+AND+'YvuB'='YvuB`). Vulnerability is verified if the response takes >=6 seconds, returns status 200, JSON content-type, and contains "User credentials are invalid." message.

## References

- https://wpscan.com/vulnerability/6bed00e4-b363-43b8-a392-d068d342151a
- https://wordpress.org/plugins/pie-register/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24731
