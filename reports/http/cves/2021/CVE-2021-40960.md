---
cve_id: CVE-2021-40960
template_path: nuclei-templates/http/cves/2021/CVE-2021-40960.yaml
affected_product: Galera WebTemplate
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Galera WebTemplate 1.0 is affected by a directory traversal vulnerability (CWE-22) that allows unauthenticated remote attackers to read arbitrary files on the server, including sensitive system files such as /etc/passwd and /etc/shadow. The flaw stems from insufficient path sanitization in the GallerySite/filesrc endpoint. Impact includes potential data leakage, unauthorized access, and full system compromise via read/modify/delete of arbitrary files. CVSS 3.1 score is 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Remediation requires applying vendor security patches.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing a single unauthenticated GET request to `{{BaseURL}}/GallerySite/filesrc/fotoilan/388/middle//.%252e/.%252e/.%252e/.%252e/.%252e/.%252e/.%252e/etc/passwd` (double URL-encoded traversal sequence) and confirms exploitation success when the HTTP response status is 200 and the body matches the regex `root:.*:0:0:` (indicating successful retrieval of /etc/passwd contents).

## References
- http://www.omrylmz.com/galera-webtemplate-1-0-directory-traversal-vulnerability-cve-2021-40960/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40960
- http://www.galera.com.tr/
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
