---
cve_id: CVE-2021-24762
template_path: nuclei-templates/http/cves/2021/CVE-2021-24762.yaml
affected_product: WordPress Perfect Survey plugin
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.5.2
preconditions: Perfect Survey plugin installed and active on a WordPress site
poc_classification: info-leak
---

## Vulnerability

Unauthenticated time-based blind SQL injection in the Perfect Survey WordPress plugin before version 1.5.2. The `question_id` GET parameter passed to the `get_question` AJAX action in `/wp-admin/admin-ajax.php` is not validated or escaped before use in a SQL query. This allows arbitrary SQL injection, resulting in unauthorized access to the WordPress database (CVSS 9.8, high impact on confidentiality, integrity, and availability).

## PoC / Detection
Classification: info-leak

The template issues a single GET request embedding a time-delay SQL payload `(SELECT(SLEEP(7)))` in the `question_id` parameter. Detection relies on matching a response duration of at least 7 seconds (confirming blind injection), the presence of the "wp-ps-session" header, and HTTP 404 status code.

## References
- https://www.exploit-db.com/exploits/50766
- https://github.com/cckuailong/reapoc/tree/main/2021/CVE-2021-24762/vultarget
- https://wpscan.com/vulnerability/c1620905-7c31-4e62-80f5-1d9635be11ad
- https://nvd.nist.gov/vuln/detail/CVE-2021-24762
