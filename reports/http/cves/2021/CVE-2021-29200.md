---
cve_id: CVE-2021-29200
template_path: nuclei-templates/http/cves/2021/CVE-2021-29200.yaml
affected_product: Apache OFBiz
severity: critical
authentication: none
external_callback: true
affected_versions: < 17.12.07
preconditions: []
poc_classification: rce
---

## Vulnerability

Apache OFBiz versions prior to 17.12.07 suffer from unsafe Java object deserialization (CWE-502) in the SOAPService handler. Unauthenticated remote attackers can achieve arbitrary code execution by submitting malicious serialized objects via SOAP XML, resulting in full server compromise (CVSS 9.8, AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection

Classification: rce

The template sends a single POST request to `/webtools/control/SOAPService` embedding a `generate_java_gadget` payload configured for DNS exfiltration to `{{interactsh-url}}` (hex-encoded). Detection relies on observing the DNS callback (`interactsh_protocol` matcher) and the string `value="responseMessage"` in the HTTP body response.

## References
- http://www.openwall.com/lists/oss-security/2021/04/27/4
- https://nvd.nist.gov/vuln/detail/CVE-2021-29200
- https://github.com/freeide/CVE-2021-29200
- https://lists.apache.org/thread.html/r108a964764b8bd21ebd32ccd4f51c183ee80a251c105b849154a8e9d%40%3Ccommits.ofbiz.apache.org%3E
- https://lists.apache.org/thread.html/r708351f1a8af7adb887cc3d8a92bed8fcbff4a9e495e69a9ee546fda%40%3Cnotifications.ofbiz.apache.org%3E
