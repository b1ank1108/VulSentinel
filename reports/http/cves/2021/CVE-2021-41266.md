---
cve_id: CVE-2021-41266
template_path: nuclei-templates/http/cves/2021/CVE-2021-41266.yaml
affected_product: MinIO Operator Console
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 0.12.3
preconditions: [external IDP enabled]
poc_classification: auth-bypass
---

## Vulnerability
MinIO Operator Console (graphical UI for the MinIO Operator multi-cloud object storage project) contains an authentication bypass when an external Identity Provider (IDP) is enabled. Affected versions allow an unauthenticated remote attacker to bypass login and gain full unauthorized access to the console.  
**Impact:** Attacker obtains sessionId and token, enabling complete console takeover (C:H/I:H/A:H).  
**CVSS 3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
**CWE:** CWE-306 (Missing Authentication for Critical Function).  
**Remediation:** Upgrade to v0.12.3 or higher; or set `automountServiceAccountToken: false` on the operator-console Kubernetes deployment and unset `CONSOLE_IDP_*` environment variables to disable external IDP.

## PoC / Detection
Classification: auth-bypass

The template issues a single unauthenticated POST request to `/api/v1/login/oauth2/auth` carrying the JSON payload `{"code":"test","state":"test"}`. Detection succeeds if the response contains the word "sessionId" in the body, "token" in headers, and returns HTTP 200 or 201.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-41266
- https://github.com/minio/console/security/advisories/GHSA-4999-659w-mq36
- https://github.com/minio/console/pull/1217
- https://github.com/HimmelAward/Goby_POC
- https://github.com/StarCrossPortal/scalpel
