---
cve_id: CVE-2021-40323
template_path: nuclei-templates/http/cves/2021/CVE-2021-40323.yaml
affected_product: Cobbler
severity: critical
authentication: none
external_callback: false
affected_versions: <3.3.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Cobbler before 3.3.0 allows log poisoning and resultant remote code execution via an XMLRPC method on the `/cobbler_api` endpoint. An unauthenticated attacker can trigger the flaw through crafted calls (e.g., `generate_script`), leading to arbitrary code execution and full system compromise.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-94.

**Impact:** Successful exploitation results in unauthorized remote code execution and complete system compromise.

**Remediation:** Upgrade to version 3.3.0 or later.

## PoC / Detection
Classification: rce

The template sends two chained raw POST requests to `{{BaseURL}}/cobbler_api`:
- First: XML-RPC `find_profile` call with `name=*` to extract a valid profile name (internal regex extractor: `<value><string>(.*?)</string></value>`).
- Second: XML-RPC `generate_script` call passing the extracted profile, an empty string, and `/etc/passwd` as parameters.

Matchers (AND condition) check for:
- `Content-Type: text/xml` header
- 200 status code
- regex OR match for `/etc/passwd` content patterns (`root:.*:0`, `bin:.*:1`, `nobody:.*:99`)

This verifies the exploitable condition of the underlying log-poisoning RCE flaw.

## References
- https://github.com/cobbler/cobbler/releases/tag/v3.3.0
- https://github.com/cobbler/cobbler/issues/2795
- https://tnpitsecurity.com/blog/cobbler-multiple-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2021-40323
- https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a
