---
cve_id: CVE-2021-21973
template_path: nuclei-templates/http/cves/2021/CVE-2021-21973.yaml
affected_product: VMware vSphere
severity: medium
authentication: none
external_callback: true
affected_versions: VMware vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l, and 6.5 before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
VMware vSphere (HTML5) is susceptible to server-side request forgery (SSRF, CWE-918) due to improper validation of URLs in a vCenter Server plugin. An unauthenticated remote attacker with network access to port 443 can send a crafted request to the plugin endpoint, forcing the server to issue arbitrary outbound requests.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (score 5.3).  
Successful exploitation enables unauthorized internal network access, data leakage, or chained attacks from the vulnerable server.

## PoC / Detection
Classification: info-leak

The template issues one unauthenticated GET request to `/ui/vropspluginui/rest/services/getvcdetails` with the `Vcip` header set to an interactsh-url (plus random filler values for `Vcpassword`, `Vcusername`, and `Reqresource`). It matches on HTTP 500 status together with the exact body string "The server sent HTTP status code 200", confirming the SSRF trigger via out-of-band callback.

## References
- https://twitter.com/osama_hroot/status/1365586206982082560
- https://twitter.com/bytehx343/status/1486582542807420928
- https://www.vmware.com/security/advisories/VMSA-2021-0002.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-21973
- https://github.com/soosmile/POC
