---
cve_id: CVE-2021-46068
template_path: nuclei-templates/http/cves/2021/CVE-2021-46068.yaml
affected_product: Vehicle Service Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Stored Cross-Site Scripting (XSS) (CVE-2021-46068, CWE-79) in Vehicle Service Management System 1.0 via the My Account section of the login/admin panel. Authenticated users (PR:H) can inject unsanitized JavaScript into the `firstname` field of user profiles (targeting ID 1), which is stored persistently and rendered without escaping when the admin user list is viewed. CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8). Impact: malicious script execution in victim's browser context, enabling session/cookie theft or further client-side attacks. Remediation: upgrade to latest version.

## PoC / Detection
Classification: state-change  
The template first performs authentication by POSTing supplied `{{username}}`/`{{password}}` to `/classes/Login.php?f=login`. It then injects the payload `Administrator"><script>alert(document.domain)</script>` (URL-encoded) into the `firstname` of user ID 1 via POST to `/classes/Users.php?f=save`. Finally, it issues GET `/admin/?page=user` and verifies the exact unsanitized string appears in the HTML response body (along with 200 status and text/html content-type).

## References
- https://github.com/plsanu/Vehicle-Service-Management-System-MyAccount-Stored-Cross-Site-Scripting-XSS
- https://www.plsanu.com/vehicle-service-management-system-myaccount-stored-cross-site-scripting-xss
- https://www.sourcecodester.com/php/14972/vehicle-service-management-system-php-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-46068
- https://github.com/zecool/cve
