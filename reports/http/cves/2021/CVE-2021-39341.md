---
cve_id: CVE-2021-39341
template_path: nuclei-templates/http/cves/2021/CVE-2021-39341.yaml
affected_product: OptinMonster Plugin
severity: high
authentication: none
external_callback: false
affected_versions: <= 2.6.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The OptinMonster Plugin is vulnerable to sensitive information disclosure and unauthorized setting updates due to insufficient authorization validation via the logged_in_or_has_api_key function in ~/OMAPI/RestApi.php. Unauthenticated attackers can access sensitive system information including PHP version, server configuration, and plugin details via unprotected REST API endpoints; this can also be used to inject malicious web scripts. Affects versions up to and including 2.6.4. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N (8.2).

## PoC / Detection
Classification: info-leak
The template sends an OPTIONS request to `/wp-json/omapp/v1/support` with `X-HTTP-Method-Override: GET` and Referer `https://wp.app.optinmonster.test`. It confirms exposure if the response body contains all of "PHP Version", "OptinMonster", '"functions.php"', and "Server Info".

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-39341
- https://plugins.trac.wordpress.org/browser/optinmonster/trunk/OMAPI/RestApi.php?rev=2606519#L1460
- https://wordfence.com/vulnerability-advisories/#CVE-2021-39341
