---
cve_id: CVE-2021-36260
template_path: nuclei-templates/http/cves/2021/CVE-2021-36260.yaml
affected_product: Hikvision IP camera/NVR
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Hikvision IP camera/NVR products contain a command injection vulnerability (CWE-78) in the web server due to insufficient input validation on the `/SDK/webLanguage` endpoint. An unauthenticated remote attacker can send specially crafted XML payloads to inject and execute arbitrary operating-system commands.  

Impact: arbitrary command execution leading to full device compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8).  
Remediation: apply the latest firmware update from Hikvision.

## PoC / Detection
Classification: rce

The template verifies exploitability with two raw HTTP requests:  
1. PUT `/SDK/webLanguage` containing the XML payload `<?xml version="1.0" encoding="UTF-8"?><language>$(echo {{rand_base(12)}}>webLib/x)</language>` to trigger command injection and write a random string to a web-accessible file.  
2. GET `/x` followed by a word matcher on the response body to confirm the random string is present, proving successful command execution.

## References
- https://watchfulip.github.io/2021/09/18/Hikvision-IP-Camera-Unauthenticated-RCE.html
- https://www.hikvision.com/en/support/cybersecurity/security-advisory/security-notification-command-injection-vulnerability-in-some-hikvision-products/
- https://nvd.nist.gov/vuln/detail/CVE-2021-36260
- https://github.com/Aiminsun/CVE-2021-36260
- https://therecord.media/experts-warn-of-widespread-exploitation-involving-hikvision-cameras/
