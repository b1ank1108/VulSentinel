---
cve_id: CVE-2021-45467
template_path: nuclei-templates/http/cves/2021/CVE-2021-45467.yaml
affected_product: Control Web Panel (CWP)
severity: critical
authentication: none
external_callback: false
affected_versions: < 0.9.8.1107
preconditions: []
poc_classification: rce
---

## Vulnerability
Control Web Panel (CWP, previously CentOS Web Panel) before version 0.9.8.1107 suffers from a critical unauthenticated file inclusion flaw via null-byte (%00) injection in the `scripts` parameter of `/user/loader.php` or `/user/login.php`. Crafted directory-traversal payloads using multiple `%00` sequences allow arbitrary file reads (e.g. `/etc/passwd`), arbitrary API-key registration, privilege escalation, and remote code execution, enabling full web-panel and host-system compromise.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-862.

## PoC / Detection
Classification: rce

The template first fingerprints CWP by requesting favicon paths (`/login/cwp_theme/original/img/ico/favicon.ico`, `/login/design/img/ico/favicon.ico`, or root) and matching either mmh3 hash `-356182173` of base64-encoded body or case-insensitive strings "control webpanel"/"cwp | user". It then sends GET requests to `/user/index.php?api=1&scripts=.%00%00%00./.../etc/passwd` and `/user/login.php?api=1&scripts=.%00%00%00./.../etc/passwd` (up to 12 null-byte traversals), confirming the flaw on status 200 with regex match `root:.*:0:0:`.

## References
- https://octagon.net/blog/2022/01/22/cve-2021-45467-cwp-centos-web-panel-preauth-rce/
- https://nvd.nist.gov/vuln/detail/CVE-2021-45467
