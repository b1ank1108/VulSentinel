---
cve_id: CVE-2021-24970
template_path: nuclei-templates/http/cves/2021/CVE-2021-24970.yaml
affected_product: WordPress All-In-One Video Gallery
severity: high
authentication: required
external_callback: false
affected_versions: <2.5.0
preconditions: administrative access to WordPress admin dashboard (plugin settings page)
poc_classification: info-leak
---

## Vulnerability
WordPress All-In-One Video Gallery plugin before 2.5.0 suffers from local file inclusion. The `tab` parameter is neither sanitized nor validated before being passed directly to a `require` statement inside the admin dashboard (`/wp-admin/admin.php?page=all-in-one-video-gallery`). 

This path-traversal flaw (CWE-22) enables an authenticated attacker to read arbitrary local files on the server. The plugin description notes that exploitation can additionally allow data modification or unauthorized administrative operations. 

Impact: sensitive file disclosure, potential unauthorized access or information leakage.  
CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2).  
Remediation: fixed in version 2.5.4.

## PoC / Detection
Classification: info-leak

The template first authenticates by POSTing `log={{username}}&pwd={{password}}` to `/wp-login.php`. It then issues a GET request to `/wp-admin/admin.php?page=all-in-one-video-gallery&tab=..%2F..%2F..%2F..%2F..%2Findex` (five-level path traversal targeting the WordPress root index file). Detection succeeds if the response meets all of: HTTP 200, `text/html` Content-Type, and body containing both the plugin title “All-in-One Video Gallery” and WordPress strings “Hello world!” + “Welcome to WordPress”.

## References
- https://wpscan.com/vulnerability/9b15d47e-43b6-49a8-b2c3-b99c92101e10
- https://wordpress.org/plugins/all-in-one-video-gallery
- https://nvd.nist.gov/vuln/detail/CVE-2021-24970
- https://github.com/ARPSyndicate/cvemon
