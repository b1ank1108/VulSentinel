---
cve_id: CVE-2021-20031
template_path: nuclei-templates/http/cves/2021/CVE-2021-20031.yaml
affected_product: SonicWall SonicOS 7.0
severity: medium
authentication: none
external_callback: false
affected_versions: 7.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
SonicWall SonicOS 7.0 contains an open redirect vulnerability. The application implicitly trusts Host header values, allowing an attacker to spoof the Host header. This enables rendering of arbitrary links, obtaining sensitive information, modifying data, executing unauthorized operations, and/or redirecting users to malicious sites.

CVSS v3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) | CWE-601.

## PoC / Detection
Classification: state-change

The template sends a single GET request to `{{BaseURL}}/`, injecting `Host: {{randstr}}.tld`. It verifies exploitation by matching HTTP 200 status and the response body containing both the reflected redirect URL `https://{{randstr}}.tld/auth.html` (proving Host header controls redirect target construction) and the string `Please be patient as you are being re-directed`.

## References
- https://www.exploit-db.com/exploits/50414
- https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0019
- http://packetstormsecurity.com/files/164502/Sonicwall-SonicOS-7.0-Host-Header-Injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-20031
- https://github.com/ARPSyndicate/cvemon
