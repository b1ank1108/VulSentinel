---
cve_id: CVE-2021-32789
template_path: nuclei-templates/http/cves/2021/CVE-2021-32789.yaml
affected_product: WooCommerce Blocks
severity: high
authentication: none
external_callback: false
affected_versions: 2.5 to 5.5
preconditions: WooCommerce Blocks feature plugin installed
poc_classification: info-leak
---

## Vulnerability
Unauthenticated SQL injection in the `wc/store/products/collection-data` endpoint of the WooCommerce Blocks WordPress plugin (via `calculate_attribute_counts[0][taxonomy]` parameter). Allows execution of read-only SQL queries through a crafted URL, enabling database data extraction (e.g., from `wp_users` table). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact includes data leakage and potential further compromise. Fixed by updating to version 5.6+.

## PoC / Detection
Classification: info-leak

The template performs a single GET request to `{{BaseURL}}/?rest_route=/wc/store/products/collection-data` with a specially URL-encoded payload containing a UNION ALL SELECT statement that injects `concat(id,':','sqli-test')` from `wp_users`. It verifies success by checking for the presence of 'sqli-test', 'attribute_counts', 'price_range', and 'term' in the JSON response body, along with `application/json` Content-Type header and HTTP 200 status.

## References
- https://woocommerce.com/posts/critical-vulnerability-detected-july-2021
- https://viblo.asia/p/phan-tich-loi-unauthen-sql-injection-woocommerce-naQZRQyQKvx
- https://securitynews.sonicwall.com/xmlpost/wordpress-woocommerce-plugin-sql-injection/
- https://wpscan.com/vulnerability/0f2089dc-9376-4d7d-95a2-25c99526804a
- https://nvd.nist.gov/vuln/detail/CVE-2021-32789
