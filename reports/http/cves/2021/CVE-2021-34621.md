---
cve_id: CVE-2021-34621
template_path: nuclei-templates/http/cves/2021/CVE-2021-34621.yaml
affected_product: ProfilePress WordPress plugin
severity: critical
authentication: none
external_callback: true
affected_versions: 3.0.0-3.1.3
preconditions: []
poc_classification: state-change
---

## Vulnerability
ProfilePress WordPress plugin versions 3.0.0-3.1.3 contain a critical weakness in the user registration component (`~/src/Classes/RegistrationAuth.php`). Unauthenticated attackers can register new users as administrators by supplying `wp_capabilities[administrator]=1` in the `pp_ajax_signup` form.

**Impact:** Attacker can create unauthorized admin accounts and gain full control over the WordPress site.  
**CVSS:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Remediation:** Update to a version newer than 3.1.3.

## PoC / Detection
Classification: state-change

The template actually exploits the flaw via a three-step process that creates and verifies an admin account:  
- Sends multipart POST to `/wp-admin/admin-ajax.php` (action=`pp_ajax_signup`) with random username, email/password ending in `@interact.sh`, and the malicious `wp_capabilities[administrator]=1` field.  
- Immediately logs in via POST to `/wp-login.php` using the newly created credentials.  
- Performs GET `/wp-admin/` and matches the string "Welcome to your WordPress Dashboard" plus HTTP 200 status to confirm successful admin access.

## References
- https://www.wordfence.com/blog/2021/06/easily-exploitable-critical-vulnerabilities-patched-in-profilepress-plugin
- https://nvd.nist.gov/vuln/detail/CVE-2021-34621
- https://www.wordfence.com/blog/2021/06/easily-exploitable-critical-vulnerabilities-patched-in-profilepress-plugin/
- http://packetstormsecurity.com/files/163973/WordPress-ProfilePress-3.1.3-Privilege-Escalation.html
