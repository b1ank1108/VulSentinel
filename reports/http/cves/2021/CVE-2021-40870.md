---
cve_id: CVE-2021-40870
template_path: nuclei-templates/http/cves/2021/CVE-2021-40870.yaml
affected_product: Aviatrix Controller
severity: critical
authentication: none
external_callback: false
affected_versions: 6.x before 6.5-1804.1922
preconditions: []
poc_classification: rce
---

## Vulnerability
Aviatrix Controller 6.x before 6.5-1804.1922 contains a vulnerability that allows unrestricted upload of a file with a dangerous type, which allows an unauthenticated user to execute arbitrary code via directory traversal. Successful exploitation allows remote attackers to execute arbitrary commands on the affected system. Upgrade Aviatrix Controller to version 6.5-1804.1922 or later to mitigate this vulnerability.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (Score: 9.8)  
CWE-ID: CWE-23  
CVE-ID: CVE-2021-40870

## PoC / Detection
Classification: rce

The template performs a two-step exploitation check:  
- POST /v1/backend1 with `account_name=/../../../var/www/php/{{randstr}}.php` and a PHP payload (`<?php echo md5("CVE-2021-40870");unlink(__FILE__);?>`) to write a temporary webshell via path traversal.  
- GET /v1/{{randstr}}.php and verifies the MD5 hash appears in the body with HTTP 200 status.  
The uploaded file self-deletes after execution.

## References
- https://docs.aviatrix.com/HowTos/UCC_Release_Notes.html#security-note-9-11-2021
- https://wearetradecraft.com/advisories/tc-2021-0002/
- https://nvd.nist.gov/vuln/detail/CVE-2021-40870
- http://packetstormsecurity.com/files/164461/Aviatrix-Controller-6.x-Path-Traversal-Code-Execution.html
- https://github.com/ARPSyndicate/cvemon
