---
cve_id: CVE-2021-46071
template_path: nuclei-templates/http/cves/2021/CVE-2021-46071.yaml
affected_product: Vehicle Service Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Vehicle Service Management System 1.0 contains a stored cross-site scripting vulnerability via the Category List section in the admin panel. An authenticated attacker with permissions to manage categories can inject arbitrary JavaScript (e.g., `<script>alert(document.domain)</script>`) into the category name field during creation or update. The payload is persisted server-side without sanitization and executes automatically in the browser context of any user (including other administrators) who subsequently views the category list page.  
CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8). Impact includes potential data theft, session hijacking, or page defacement for viewers. CWE-79. CPE: cpe:2.3:a:vehicle_service_management_system_project:vehicle_service_management_system:1.0:*:*:*:*:*:*:*

## PoC / Detection
Classification: state-change  
The template verifies the vulnerability by performing a three-step authenticated workflow that actually modifies stored data:  
1. POST `/classes/Login.php?f=login` with `username={{username}}&password={{password}}` to establish an admin session.  
2. POST `/classes/Master.php?f=save_category` submitting `id=&category=%22%3e%3cscript%3ealert%28document.domain%29%3c%2fscript%3e&status=1` to persist the unsanitized XSS payload as a category name.  
3. GET `/admin/?page=maintenance/category` and inspects the response body for the exact unescaped string `<td>\"><script>alert(document.domain)</script></td>` (plus HTML content-type and 200 status).  
This confirms the server-side storage flaw and client-side execution path without requiring out-of-band interaction.

## References
- https://github.com/plsanu/Vehicle-Service-Management-System-Category-List-Stored-Cross-Site-Scripting-XSS
- https://www.plsanu.com/vehicle-service-management-system-category-list-stored-cross-site-scripting-xss
- https://www.sourcecodester.com/php/14972/vehicle-service-management-system-php-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-46071
- https://github.com/zecool/cve
