---
cve_id: CVE-2021-28481
template_path: nuclei-templates/http/cves/2021/CVE-2021-28481.yaml
affected_product: Microsoft Exchange Server
severity: critical
authentication: none
external_callback: false
affected_versions: 2013 Cumulative Update 23, 2016 Cumulative Update 19 and 20, 2019 Cumulative Update 8 and 9
preconditions: []
poc_classification: rce
---

## Vulnerability
Microsoft Exchange Server contains a pre-authentication SSRF and ACL bypass (ProxyNotFound) due to improper input validation in the server component. Remote attackers with network access can exploit this to execute arbitrary code, potentially leading to full system compromise or data breach.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: rce

The template performs a two-request flow to detect/verify the flaw:  
1. GET /owa/ extracts the internal frontend server name from the X-FEServer header (requires 302 response containing the header).  
2. Computes an XOR-obfuscated X-BackEndCookie value incorporating the server name, epoch time and date; issues POST /ews/wssecurity using a random email in X-AnchorMailbox and the crafted cookie.  
Matchers confirm exploitation condition via 302 status, body containing `/owa/auth/errorFE.aspx`, and presence of X-Calculatedbetarget / X-Owa-Error headers.

## References
- https://sec.vnpt.vn/2021/04/microsoft-exchange-from-deserialization-to-post-auth-rce-cve-2021-28482
- https://hitcon.org/2021/agenda/279d7810-e619-4dc3-9113-b11bad5277ec/The%20Proxy%20Era%20of%20Microsoft%20Exchange%20Server.pdf
- https://www.youtube.com/watch?v=vn4niT9XEIM
- https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2021-28481
- https://nvd.nist.gov/vuln/detail/cve-2021-28481
