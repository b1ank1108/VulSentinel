---
cve_id: CVE-2021-40970
template_path: nuclei-templates/http/cves/2021/CVE-2021-40970.yaml
affected_product: Spotweb
severity: medium
authentication: none
external_callback: false
affected_versions: <= 1.5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Spotweb <= 1.5.1 is vulnerable to reflected Cross-Site Scripting (XSS) in `templates/installer/step-004.inc.php`. The `username` form parameter (submitted via POST to `/install.php?page=1`) is reflected without sanitization, allowing arbitrary JavaScript/HTML injection. Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential data theft or unauthorized actions. Fixed in version 1.5.2.

## PoC / Detection
Classification: info-leak
The template issues a POST request to `/install.php?page=1` with a crafted `settingsform[username]` value containing `pdteam'+onclick='alert(document.domain)`. Detection succeeds if the response body reflects this exact payload (alongside "Spotweb"), returns status 200, and has text/html Content-Type.

## References
- https://github.com/spotweb/spotweb/
- https://github.com/spotweb/spotweb/issues/711
- https://nvd.nist.gov/vuln/detail/CVE-2021-40970
- https://github.com/spotweb/spotweb
