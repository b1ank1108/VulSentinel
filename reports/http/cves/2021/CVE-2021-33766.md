---
cve_id: CVE-2021-33766
template_path: nuclei-templates/http/cves/2021/CVE-2021-33766.yaml
affected_product: Microsoft Exchange Server
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Microsoft Exchange Server is vulnerable to CVE-2021-33766, an authentication bypass that also results in information disclosure. Unauthenticated remote attackers can bypass authentication by supplying the cookie `SecurityToken=x`. This grants access to the Exchange Server's internal API endpoints (including the ECP interface) and sensitive information.

CVSS 3.1 score: 7.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L).  
Remediation: Apply security updates provided by Microsoft to fix the authentication bypass vulnerability.

## PoC / Detection
Classification: auth-bypass

The template issues a single GET request to `/ecp/{{randstr}}@{{rand_base(5)}}.com/PersonalSettings/HomePage.aspx?showhelp=false` while setting the header `Cookie: SecurityToken=x`. Detection confirms the bypass if all of the following match simultaneously: HTTP status 403, response body contains both `<span id="msgCode">403</span>` and `function signOut() {`, and response headers contain both `Microsoft.Exchange.Data.Storage.ObjectNotFoundException` and `X-BEResource=`.

## References
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-33766
- https://www.zerodayinitiative.com/advisories/ZDI-21-798/
- https://github.com/demossl/CVE-2021-33766-ProxyToken
- https://nvd.nist.gov/vuln/detail/CVE-2021-33766
