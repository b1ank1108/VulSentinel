---
cve_id: CVE-2021-33851
template_path: nuclei-templates/http/cves/2021/CVE-2021-33851.yaml
affected_product: WordPress Customize Login Image plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <3.5.3
preconditions: The Customize Login Image plugin must be installed and activated
poc_classification: info-leak
---

## Vulnerability
The WordPress Customize Login Image plugin (by apasionados) prior to version 3.5.3 contains a stored cross-site scripting (XSS) vulnerability. The issue occurs in the `cli_logo_url` setting on the plugin configuration page. An authenticated attacker with access to the settings can inject malicious JavaScript code into the custom logo link field. The payload is stored server-side and rendered without sanitization on the WordPress login page (`/wp-login.php`), executing in the victim's browser context. 

This enables attacks such as stealing authentication cookies or performing other client-side actions. CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4).

## PoC / Detection
Classification: info-leak

The template performs a multi-step authenticated test:
- Logs in to `/wp-login.php` with provided admin credentials.
- Visits the plugin options page to extract the WordPress `_wpnonce` value via regex.
- Submits a POST to `/wp-admin/options.php` to set `cli_logo_url` to `<script>alert(document.domain)</script>`.
- Requests `/wp-login.php` again and checks if the response body contains the unsanitized payload string "Go to <script>alert(document.domain)</script>".

This verifies that the XSS payload is persisted and reflected, confirming the vulnerability.

## References
- https://wpscan.com/vulnerability/c67753fb-9111-453e-951f-854c6ce31203
- https://cybersecurityworks.com/zerodays/cve-2021-33851-stored-cross-site-scripting-in-wordpress-customize-login-image.html
- https://wordpress.org/plugins/customize-login-image/
- https://nvd.nist.gov/vuln/detail/cve-2021-33851
- https://github.com/ARPSyndicate/kenzer-templates
