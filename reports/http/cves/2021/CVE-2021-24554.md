---
cve_id: CVE-2021-24554
template_path: nuclei-templates/http/cves/2021/CVE-2021-24554.yaml
affected_product: WordPress Paytm Donation plugin
severity: high
authentication: required
external_callback: false
affected_versions: <=1.3.2
preconditions: []
poc_classification: state-change
---

## Vulnerability
WordPress Paytm Donation plugin through version 1.3.2 contains an authenticated SQL injection vulnerability. The `id` GET parameter on the donation deletion endpoint (`/wp-admin/admin.php?page=wp_paytm_donation&action=delete`) is neither sanitized, validated, nor escaped before being used directly in a SQL statement. An authenticated attacker can therefore inject arbitrary SQL, resulting in sensitive data exposure, data modification, or unauthorized administrative operations.  
CVSS 3.1: 7.2 (High) — AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (CWE-89).  
Remediation: upgrade to a version >1.3.2.

## PoC / Detection
Classification: state-change  
The template first authenticates to WordPress by POSTing credentials to `/wp-login.php`. It then issues a GET request to the vulnerable admin endpoint with the time-based blind SQLi payload `id=0 AND (SELECT 5581 FROM (SELECT(SLEEP(6)))Pjwy)`. Detection confirms exploitation if the second response meets all conditions: duration ≥6 s, HTTP 200, `text/html` Content-Type, and the string `paytm-settings_page_wp_paytm_donation` present in the body.

## References
- https://wpscan.com/vulnerability/f2842ac8-76fa-4490-aa0c-5f2b07ecf2ad
- https://wordpress.org/plugins/wp-paytm-pay/
- https://codevigilant.com/disclosure/2021/wp-plugin-wp-paytm-pay/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24554
- https://github.com/ARPSyndicate/cvemon
