---
cve_id: CVE-2021-24212
template_path: nuclei-templates/http/cves/2021/CVE-2021-24212.yaml
affected_product: WooCommerce Help Scout
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.9.1
preconditions: []
poc_classification: rce
---

## Vulnerability
WooCommerce Help Scout WordPress plugin contains an unrestricted file upload flaw (CWE-434, CVSS 9.8). Unauthenticated remote attackers can upload arbitrary files (including PHP webshells) via the `wc_help_scout_upload_attachments` AJAX action; files land by default in `/wp-content/uploads/hstmp/`, enabling remote code execution and full site compromise.

## PoC / Detection
Classification: rce

The template detects by issuing an unauthenticated multipart/form-data POST to `/wp-admin/admin-ajax.php?action=wc_help_scout_upload_attachments` uploading a benign PHP payload `<?php echo md5(999999999); ?>` under a random `.php` filename, then immediately GETs `/wp-content/uploads/hstmp/{filename}` and asserts both HTTP 200 and the computed MD5 hash in the body.

## References
- https://wpscan.com/vulnerability/cf9305e8-f5bc-45c3-82db-0ef00fd46129/
- https://sploitus.com/exploit?id=WPEX-ID:CF9305E8-F5BC-45C3-82DB-0EF00FD46129
- https://nvd.nist.gov/vuln/detail/CVE-2021-24212
