---
cve_id: CVE-2021-20091
template_path: nuclei-templates/http/cves/2021/CVE-2021-20091.yaml
affected_product: Buffalo WSR-2533DHPL2
severity: high
authentication: required
external_callback: false
affected_versions: WSR-2533DHPL2 firmware <= 1.02, WSR-2533DHP3 firmware <= 1.24
preconditions: []
poc_classification: state-change
---

## Vulnerability
Buffalo WSR-2533DHPL2 firmware <= 1.02 and WSR-2533DHP3 firmware <= 1.24 web interfaces do not properly sanitize user input. An authenticated remote attacker can inject malicious configuration settings via path traversal and parameter manipulation, altering device configuration and potentially leading to remote code execution.

CVSS v3.1: 8.8 (High) â€” AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

## PoC / Detection
Classification: state-change

The template first performs a GET request to `/images/..%2finfo.html` (path traversal, with Referer) and extracts the `httoken` value via regex from the response body. It then issues a POST to `/images/..%2fapply_abstract.cgi` (Referer set) containing URL-encoded form data that injects a newline (`%0A`) into `ARC_ping_ipaddress` to set `ARC_SYS_TelnetdEnable=1` (enabling the Telnet daemon) while simulating a ping action. Detection succeeds if the server returns HTTP 302 status with `/Success.htm` in the Location header.

## References
- https://blogs.juniper.net/en-us/security/freshly-disclosed-vulnerability-cve-2021-20090-exploited-in-the-wild
- https://www.tenable.com/security/research/tra-2021-13
- https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2
- https://nvd.nist.gov/vuln/detail/CVE-2021-20091
- https://github.com/ARPSyndicate/cvemon
