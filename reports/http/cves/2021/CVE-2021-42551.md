---
cve_id: CVE-2021-42551
template_path: nuclei-templates/http/cves/2021/CVE-2021-42551.yaml
affected_product: NetBiblio WebOPAC
severity: medium
authentication: none
external_callback: false
affected_versions: before 4.0.0.320
preconditions: Wikipedia module enabled
poc_classification: info-leak
---

## Vulnerability
NetBiblio WebOPAC before 4.0.0.320 is affected by a reflected cross-site scripting vulnerability in its Wikipedia module through the `/NetBiblio/search/shortview` endpoint via the `searchTerm` parameter (with `searchField=W`).

**CVSS v3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**EPSS:** 0.1853 (95.109 percentile)

Successful exploitation allows arbitrary JavaScript execution in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information.

**Remediation:** Upgrade to version 4.0.0.320 or later.

## PoC / Detection
Classification: info-leak

The template sends two GET requests to `{{BaseURL}}/NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=...` using reflected XSS payloads (`x%27%2Balert(1)%2B%27x` and `x%5C%27%2Balert(1)%2C%2F%2F`). It verifies the flaw by matching unsanitized payload reflection in the response body (e.g. `"SearchTerm: 'x'+alert(1)+'x',"` or `"SearchTerm: 'x\\'+alert(1),//',"`), `text/html` Content-Type header, `"NetBiblio"` string in body, and HTTP 200 status (AND logic, with OR inside first matcher; follows up to 3 redirects).

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-42551
- https://www.redguard.ch/advisories/netbiblio_webopac.txt
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/compr00t/nuclei-templates
