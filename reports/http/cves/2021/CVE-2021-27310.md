---
cve_id: CVE-2021-27310
template_path: nuclei-templates/http/cves/2021/CVE-2021-27310.yaml
affected_product: Clansphere CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 2011.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Clansphere CMS 2011.4 contains an unauthenticated reflected cross-site scripting vulnerability via the "language" parameter in /clansphere/mods/clansphere/lang_modvalidate.php. The application fails to sanitize the parameter, allowing arbitrary JavaScript to be injected and reflected in the response body. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79. 

Successful exploitation enables arbitrary JavaScript execution in the victim's browser context, leading to session hijacking, defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to {{BaseURL}}/clansphere/mods/clansphere/lang_modvalidate.php?language=language%27%22()%26%25%3Cyes%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&module=module and confirms the flaw by matching the exact unsanitized string "</script><script>alert(document.domain)</script>" in the response body, combined with a text/html Content-Type header and HTTP 200 status code.

## References
- https://github.com/xoffense/POC/blob/main/Clansphere%202011.4%20%22language%22%20xss.md
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27310
- https://nvd.nist.gov/vuln/detail/CVE-2021-27310
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
