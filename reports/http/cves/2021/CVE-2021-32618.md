---
cve_id: CVE-2021-32618
template_path: nuclei-templates/http/cves/2021/CVE-2021-32618.yaml
affected_product: Python Flask-Security
severity: medium
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Python Flask-Security contains an open redirect vulnerability. Existing code validates that the URL specified in the `next` parameter is either relative or has the same network location as the requesting URL. Certain browsers accept and fill in the blanks of possibly incomplete or malformed URLs (e.g., sequences starting with `\\\`). An attacker can redirect a user to a malicious site and possibly obtain sensitive information, modify data, and/or execute unauthorized operations.

**Impact:** An attacker can craft a malicious URL that redirects users to a malicious website, leading to potential phishing attacks or the exploitation of other vulnerabilities.

**Remediation:** Upgrade to the latest version of the Python Flask-Security library to fix the open redirect vulnerability.

**CVSS:** 6.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-601

## PoC / Detection
Classification: detect-only

The template issues a single GET request to `{{BaseURL}}/login?next=\\\interact.sh` and inspects the `Location` response header with a regex matcher to confirm whether the server performs an open redirect to the attacker-controlled `interact.sh` domain.

## References
- https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
- https://github.com/Flask-Middleware/flask-security/issues/486
- https://nvd.nist.gov/vuln/detail/CVE-2021-32618
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
