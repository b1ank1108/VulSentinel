---
cve_id: CVE-2021-46073
template_path: nuclei-templates/http/cves/2021/CVE-2021-46073.yaml
affected_product: Vehicle Service Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: [privileged user with access to create users]
poc_classification: info-leak
---

## Vulnerability
Vehicle Service Management System 1.0 contains a stored cross-site scripting (XSS) vulnerability (CVE-2021-46073, CWE-79) via the User List section in the login/admin panel. An authenticated high-privileged user can inject a malicious JavaScript payload through the firstname field when saving a new user record; the payload is stored and rendered unsanitized for any user viewing the list page. CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8). Impact includes data theft, session hijacking, or defacement. Remediation: upgrade to the latest version.

## PoC / Detection
Classification: info-leak

The template first authenticates by POSTing username/password credentials to `/vehicle_service/classes/Login.php?f=login`, then POSTs to `/vehicle_service/classes/Users.php?f=save` with a test user whose firstname contains the unsanitized payload `test1"><script>alert(document.domain)</script>`, and finally GETs `/vehicle_service/admin/?page=user/list`. It verifies the stored XSS by confirming the exact script tag appears unescaped inside the HTML response body.

## References
- https://github.com/plsanu/Vehicle-Service-Management-System-User-List-Stored-Cross-Site-Scripting-XSS
- https://www.plsanu.com/vehicle-service-management-system-user-list-stored-cross-site-scripting-xss
- https://www.sourcecodester.com/php/14972/vehicle-service-management-system-php-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-46073
- https://github.com/SYRTI/POC_to_review
