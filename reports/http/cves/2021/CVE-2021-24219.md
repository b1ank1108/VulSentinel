---
cve_id: CVE-2021-24219
template_path: nuclei-templates/http/cves/2021/CVE-2021-24219.yaml
affected_product: All Thrive Themes and Plugins
severity: medium
authentication: none
external_callback: false
affected_versions: Thrive Optimize <1.4.13.3, Thrive Comments <1.4.15.3, Thrive Headline Optimizer <1.3.7.3, Thrive Leads <2.3.9.4, Thrive Ultimatum <2.3.9.4, Thrive Quiz Builder <2.3.9.4, Thrive Apprentice <2.3.9.4, Thrive Visual Editor <2.6.7.4, Thrive Dashboard <2.3.9.3, Thrive Ovation <2.4.5, Thrive Clever Widgets <1.57.1, Rise/Ignition/Luxe/FocusBlog/Minus/Squared/Voice/Performag/Pressive/Storied themes <2.0.0, Thrive Themes Builder <2.2.4
preconditions: ["Zapier not enabled"]
poc_classification: state-change
---

## Vulnerability
Unauthenticated option update vulnerability (CVE-2021-24219) in the Zapier REST API endpoint (`/wp-json/td/v1/optin/subscription`) of multiple Thrive Themes WordPress plugins and themes. When Zapier is disabled, the endpoint accepts an empty `api_key` parameter, allowing arbitrary data injection into a predefined `wp_options` table entry. This enables unauthorized site configuration changes and potential full compromise. Actively exploited in the wild.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N (score 5.3). CWE-306, CWE-284.

## PoC / Detection
Classification: state-change

The template issues one raw unauthenticated POST to `/wp-json/td/v1/optin/subscription` containing form-encoded `hook_url={"http:\/\/key":"random5char.php"}&api_key=`. It confirms exploitation success via three matchers: body contains `td_optin_webhook`, Content-Type is `application/json`, and HTTP status 200. (Intrusive detection that triggers the option-table write.)

## References
- https://www.wordfence.com/blog/2021/03/recently-patched-vulnerability-in-thrive-themes-actively-exploited-in-the-wild
- https://wpscan.com/vulnerability/35acd2d8-85fc-4af5-8f6c-224fa7d92900/
