---
cve_id: CVE-2021-41460
template_path: nuclei-templates/http/cves/2021/CVE-2021-41460.yaml
affected_product: ECShop
severity: high
authentication: none
external_callback: false
affected_versions: 4.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
ECShop 4.1.0 (Shopex) is affected by an unauthenticated SQL injection (CWE-89) in `/delete_cart_goods.php` via the `id` parameter. Attackers can inject arbitrary SQL, enabling extraction of sensitive database contents (e.g. credentials, session data), data manipulation, or full unauthorized access. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact includes information disclosure and potential escalation.

## PoC / Detection
Classification: info-leak

The template issues one unauthenticated POST request to `/delete_cart_goods.php` supplying the `id` payload `1||(updatexml(1,concat(0x7e,(select%20md5(999999999))),1))`. This forces error-based SQL evaluation that leaks the embedded MD5(999999999) value into the response body. The matcher confirms exploitation by checking for the exact string `c8c605999f3d8352d7bb792cf3fdb25` and HTTP 200 status.

## References
- https://www.cnvd.org.cn/flaw/show/CNVD-2020-58823
- https://nvd.nist.gov/vuln/detail/CVE-2021-41460
