---
cve_id: CVE-2021-27561
template_path: nuclei-templates/http/cves/2021/CVE-2021-27561.yaml
affected_product: YeaLink DM
severity: critical
authentication: none
external_callback: false
affected_versions: 3.6.0.20
preconditions: []
poc_classification: rce
---

## Vulnerability
YeaLink DM (Yealink Device Management) 3.6.0.20 allows command injection as root via the `/sm/api/v1/firewall/zone/services` URI without authentication.  
Successful exploitation allows remote attackers to execute arbitrary commands on the affected device.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-78.

## PoC / Detection
Classification: rce  
The template sends a single GET request to `{{BaseURL}}/premise/front/getPingData?url=http://0.0.0.0:9600/sm/api/v1/firewall/zone/services?zone=;/usr/bin/id;`. It matches on AND conditions: response body contains `uid`, `gid`, and `groups`; `Content-Type` header contains `application/json`; status is 200. A regex extractor captures `(u|g)id=.*` output.

## References
- https://ssd-disclosure.com/ssd-advisory-yealink-dm-pre-auth-root-level-rce/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-27561
- https://ssd-disclosure.com/?p=4688
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
