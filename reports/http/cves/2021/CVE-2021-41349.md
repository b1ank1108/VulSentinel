---
cve_id: CVE-2021-41349
template_path: nuclei-templates/http/cves/2021/CVE-2021-41349.yaml
affected_product: Microsoft Exchange Server
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Microsoft Exchange Server is vulnerable to a spoofing vulnerability (unique from CVE-2021-42305) manifesting as pre-authentication reflected cross-site scripting. A crafted POST request to the autodiscover endpoint reflects unsanitized input from the request body into the HTML error response, allowing arbitrary JavaScript execution in the context of the targeted user's browser. Impact includes potential session hijacking and data theft. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N (score 6.5). Remediation requires applying the latest Microsoft security updates.

## PoC / Detection
Classification: info-leak

The template sends one raw POST request to `/autodiscover/autodiscover.json` with `Content-Type: application/x-www-form-urlencoded` and body `%3Cscript%3Ealert%28document.domain%29%3B+a=%22%3C%2Fscript%3E&x=1`. It confirms the condition with an AND matcher requiring: response body contains both `alert(document.domain);` and `a=""`; `Content-Type` header contains `text/html`; HTTP status exactly 500; and absence of the string `A potentially dangerous Request.Form value was detected from the client`.

## References
- https://www.microsoft.com/en-us/download/details.aspx?id=103643
- https://github.com/httpvoid/CVE-Reverse/tree/master/CVE-2021-41349
- https://nvd.nist.gov/vuln/detail/CVE-2021-41349
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-41349
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-41349
