---
cve_id: CVE-2021-28149
template_path: nuclei-templates/http/cves/2021/CVE-2021-28149.yaml
affected_product: Hongdian H8922
severity: medium
authentication: required
external_callback: false
affected_versions: 3.0.5
preconditions: minimal privileges (e.g., guest account)
poc_classification: info-leak
---

## Vulnerability
Hongdian H8922 3.0.5 devices contain a local file inclusion vulnerability in the /log_download.cgi log export handler. The endpoint does not validate the `type` parameter, permitting path traversal with `../` sequences. A remote attacker with minimal privileges can download arbitrary files (e.g., `../../etc/passwd`) by requesting `log_download.cgi?type=../../etc/passwd` after authentication. Impact: unauthorized access to sensitive system files, potential further compromise. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (6.5). CWE-22.

## PoC / Detection
Classification: info-leak

The template sends two raw GET requests to `/log_download.cgi?type=../../etc/passwd` using Basic Authorization (`Z3Vlc3Q6Z3Vlc3Q=` for guest:guest, then `YWRtaW46YWRtaW4=` for admin:admin). It matches on `application/octet-stream` Content-Type header, HTTP 200 status, and regex patterns in body confirming /etc/passwd contents (`root:.*:0:0:`, `sshd:[x*]`, `root:[$]`).

## References
- https://ssd-disclosure.com/ssd-advisory-hongdian-h8922-multiple-vulnerabilities/
- http://en.hongdian.com/Products/Details/H8922
- https://nvd.nist.gov/vuln/detail/CVE-2021-28149
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ArrestX/--POC
