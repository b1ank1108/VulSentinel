---
cve_id: CVE-2021-24657
template_path: nuclei-templates/http/cves/2021/CVE-2021-24657.yaml
affected_product: Limit Login Attempts WordPress plugin
severity: medium
authentication: none
external_callback: false
affected_versions: < 4.0.50
preconditions: []
poc_classification: state-change
---

## Vulnerability
Limit Login Attempts WordPress plugin < 4.0.50 is vulnerable to stored cross-site scripting (CVE-2021-24657, CWE-79). Unauthenticated attackers can control IP addresses via headers such as X-Forwarded-For on login attempts; the plugin fails to escape these values before outputting them in the admin reports page. This stores and executes arbitrary JavaScript in any administrator's browser context who views the reports.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Impact includes session hijacking or defacement.

## PoC / Detection
Classification: state-change

The template first POSTs to `/wp-login.php` to establish a valid admin session (302 redirect containing `wordpress_logged_in` cookie), then POSTs a failed login to `/wp-login.php` injecting `X-Forwarded-For:{{rand}}<script>alert(document.domain)</script>`, and finally GETs `/wp-admin/admin.php?page=reports` to confirm the random string plus raw `<script>` payload appear unescaped inside the `login_reports` section.

## References
- https://wordpress.org/plugins/miniorange-limit-login-attempts
- https://nvd.nist.gov/vuln/detail/CVE-2021-24657
