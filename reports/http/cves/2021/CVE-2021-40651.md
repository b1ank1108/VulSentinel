---
cve_id: CVE-2021-40651
template_path: nuclei-templates/http/cves/2021/CVE-2021-40651.yaml
affected_product: OS4Ed OpenSIS Community
severity: medium
authentication: required
external_callback: false
affected_versions: 8.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OS4Ed OpenSIS Community 8.0 is vulnerable to a local file inclusion vulnerability in Modules.php (modname parameter), which can disclose arbitrary files from the server's filesystem as long as the application has access to the file.

Authenticated attackers can read arbitrary files from the server including /etc/passwd via path traversal in the modname parameter.

Remediation: Upgrade to OpenSIS Community version 8.1 or later.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (score 6.5) | CWE-22 | CPE: cpe:2.3:a:os4ed:opensis:8.0:*:*:*:community:*:*:*

## PoC / Detection
Classification: info-leak

The template first sends a POST login request to `/index.php` with `USERNAME={{username}}&PASSWORD={{password}}` (plus language and log fields). It then issues a GET request to `/Modules.php?modname=miscellaneous%2fPortal.php..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd` that applies repeated `..%2f` path traversal. Success is confirmed via DSL matchers requiring `regex('root:.*:0:0:', body)` on the LFI response, `contains(body_1, "openSIS")` on the login response, and `status_code == 200`.

## References
- https://www.exploit-db.com/exploits/50259
- https://github.com/MiSERYYYYY/Vulnerability-Reports-and-Disclosures/blob/main/OpenSIS-Community-8.0.md
- https://www.youtube.com/watch?v=wFwlbXANRCo
- https://nvd.nist.gov/vuln/detail/CVE-2021-40651
- https://github.com/ARPSyndicate/cvemon
