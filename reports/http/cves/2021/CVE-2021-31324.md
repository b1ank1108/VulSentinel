---
cve_id: CVE-2021-31324
template_path: nuclei-templates/http/cves/2021/CVE-2021-31324.yaml
affected_product: CentOS Web Panel
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
CentOS Web Panel's unprivileged user portal is affected by OS command injection in the `idsession` parameter of `/login/index.php?acc=newpass`. Unauthenticated remote attackers can execute arbitrary OS commands with root privileges, resulting in full server compromise. 

CVSS 3.1: 9.8 (Critical) â€” AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H. CWE-78: Improper Neutralization of Special Elements used in an OS Command.

## PoC / Detection
Classification: rce

The template performs a two-step HTTP flow:
- Issues GET / and internally matches `cwpsrv` in response headers to confirm CentOS Web Panel presence.
- Sends POST /login/index.php?acc=newpass with a specially crafted `idsession` payload (encoded UNION SELECT chain) that triggers command injection executing the `id` command.
- Matches response body regex `uid=[0-9]+.*gid=[0-9]+.*` to verify the command output is returned in-band.

## References
- https://www.shielder.com/advisories/centos-web-panel-idsession-root-rce/
- https://nvd.nist.gov/vuln/detail/CVE-2021-31324
