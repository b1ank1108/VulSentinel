---
cve_id: CVE-2021-40438
template_path: nuclei-templates/http/cves/2021/CVE-2021-40438.yaml
affected_product: Apache HTTP Server (mod_proxy)
severity: critical
authentication: none
external_callback: true
affected_versions: <= 2.4.48
preconditions: mod_proxy module enabled
poc_classification: info-leak
---

## Vulnerability
Apache HTTP Server (mod_proxy) <= 2.4.48 contains a flaw in uri-path handling where mod_proxy forwards the request to an arbitrary origin server chosen by the remote user (CWE-918). This enables SSRF attacks that access internal resources and forward requests to attacker-controlled servers.

Attackers can perform SSRF attacks via mod_proxy to access internal resources and forward requests to arbitrary origin servers, potentially exposing internal services and data.

Remediation: Upgrade to Apache version 2.4.49 or later.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H (score 9.0).

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/?unix:{{repeat("A", 7701)}}|http://{{interactsh-url}}/` (host-redirects: true, max-redirects: 2) to trigger the uri-path SSRF and force mod_proxy to proxy to the interactsh server. It matches if the response headers contain both "X-Interactsh-Version" and "Server: oast" while the body does not contain the interactsh landing page text.

## References
- https://firzen.de/building-a-poc-for-cve-2021-40438
- https://httpd.apache.org/security/vulnerabilities_24.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-40438
- https://cert-portal.siemens.com/productcert/pdf/ssa-685781.pdf
- https://lists.apache.org/thread.html/r210807d0bb55f4aa6fbe1512be6bcc4dacd64e84940429fba329967a@%3Cusers.httpd.apache.org%3E
