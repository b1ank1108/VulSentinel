---
cve_id: CVE-2021-37704
template_path: nuclei-templates/http/cves/2021/CVE-2021-37704.yaml
affected_product: phpfastcache
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [unprotected composer vendor directory, phpfastcache installed via Composer]
poc_classification: info-leak
---

## Vulnerability
phpfastcache is vulnerable to phpinfo resource exposure when the library is installed via Composer and its vendor directory (containing docs/examples/phpinfo.php or examples/phpinfo.php) is publicly accessible. This allows unauthenticated attackers to retrieve sensitive information including server configuration details, PHP version, and installed extensions.

## PoC / Detection
Classification: info-leak

The template issues GET requests to the potential exposed phpinfo.php paths under the phpfastcache vendor directory. It verifies exposure by confirming HTTP 200 responses containing both "PHP Extension" and "PHP Version" strings characteristic of phpinfo() output, and extracts the PHP version using regex.

## References
- https://github.com/PHPSocialNetwork/phpfastcache/pull/813
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-37704
- https://github.com/PHPSocialNetwork/phpfastcache/security/advisories/GHSA-cvh5-p6r6-g2qc
- https://packagist.org/packages/phpfastcache/phpfastcache
- https://github.com/PHPSocialNetwork/phpfastcache/blob/master/CHANGELOG.md#807
- https://github.com/PHPSocialNetwork/phpfastcache/commit/41a77d0d8f126dbd6fbedcd9e6a82e86cdaafa51
