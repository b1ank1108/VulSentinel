---
cve_id: CVE-2021-24170
template_path: nuclei-templates/http/cves/2021/CVE-2021-24170.yaml
affected_product: User Profile Picture
severity: high
authentication: required
external_callback: false
affected_versions: < 2.5.0
preconditions: authenticated user with upload_files capability
poc_classification: info-leak
---

## Vulnerability
User Profile Picture WordPress plugin (cozmoslabs, slug metronet-profile-picture) before 2.5.0 exposes excessive user data via the REST API endpoint `get_users` (`/mpp/v2/get_users`). Users possessing the `upload_files` capability receive password hashes (`user_pass`), hashed activation keys, usernames (`user_login`), email addresses, IDs, and additional profile fields. CWE-200 information exposure. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).

## PoC / Detection
Classification: info-leak

The template verifies exposure by executing the full exploit flow with supplied credentials:
- POST login to `/wp-login.php` (checks 302 redirect + `wordpress_logged_in_` cookie).
- POST to `/wp-admin/admin-ajax.php?action=rest-nonce` to extract nonce.
- POST to `/index.php?rest_route=/mpp/v2/get_users` (with `X-WP-Nonce`) and matches JSON body containing `"ID"`, `"user_login"`, `"user_pass"` + `application/json` content-type + HTTP 200.

## References
- https://www.wordfence.com/blog/2021/03/medium-severity-vulnerability-patched-in-user-profile-picture-plugin/
- https://wpscan.com/vulnerability/29fc5b0e-0a5f-4484-a1e6-a0a1206726cc/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24170
