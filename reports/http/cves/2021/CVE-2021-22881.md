---
cve_id: CVE-2021-22881
template_path: nuclei-templates/http/cves/2021/CVE-2021-22881.yaml
affected_product: Ruby on Rails
severity: medium
authentication: none
external_callback: false
affected_versions: action pack before 6.1.2.1, 6.0.3.5
preconditions: [attacker can control the Host header]
poc_classification: detect-only
---

## Vulnerability
Ruby on Rails Action Pack contains an open redirect (CWE-601) triggered by specially crafted Host headers in combination with allowed host formats. The flaw lets an attacker who can supply a malicious Host header force a 301/302 redirect to an arbitrary domain. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1). Impact includes phishing campaigns and malware distribution by redirecting legitimate users. Fixed in Action Pack 6.1.2.1 and 6.0.3.5; update to these or newer versions.

## PoC / Detection
Classification: detect-only

The template issues one raw GET / request with Host set to `interact.sh#<random>.<target-hostname>`. It verifies exploitation potential by matching a 301 or 302 status code together with a Location header that contains the `interact.sh` domain, confirming the application echoes the supplied Host into a redirect without validation.

## References
- https://hackerone.com/reports/1047447
- https://nvd.nist.gov/vuln/detail/CVE-2021-22881
