---
cve_id: CVE-2021-21802
template_path: nuclei-templates/http/cves/2021/CVE-2021-21802.yaml
affected_product: Advantech R-SeeNet
severity: medium
authentication: none
external_callback: false
affected_versions: 2.4.12
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Advantech R-SeeNet contains a cross-site scripting vulnerability in the device_graph_page.php script via the device_id parameter. A specially crafted URL by an attacker can lead to arbitrary JavaScript code execution.

Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.

Apply the latest security patches or updates provided by Advantech to fix the XSS vulnerability in the R-SeeNet application.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1)  
CWE-79  
CPE: cpe:2.3:a:advantech:r-seenet:2.4.12:*:*:*:*:*:*:*

## PoC / Detection
Classification: info-leak

The template sends a GET request to `{{BaseURL}}/php/device_graph_page.php?device_id=%22zlo%20onerror=alert(1)%20%22` and confirms the reflected XSS if the response body contains both the unsanitized payload string `"zlo onerror=alert(1) "` and the string `Device Status Graph`, the Content-Type header contains `text/html`, and the status code is 200.

## References
- https://talosintelligence.com/vulnerability_reports/TALOS-2021-1272
- https://nvd.nist.gov/vuln/detail/CVE-2021-21801
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
