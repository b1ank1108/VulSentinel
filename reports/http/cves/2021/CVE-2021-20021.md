---
cve_id: CVE-2021-20021
template_path: nuclei-templates/http/cves/2021/CVE-2021-20021.yaml
affected_product: SonicWall Email Security
severity: critical
authentication: none
external_callback: false
affected_versions: <= 10.0.9
preconditions: []
poc_classification: state-change
---

## Vulnerability
SonicWall Email Security version 10.0.9.x allows an attacker to create an administrative account by sending a crafted HTTP request to the remote host. Attackers can create admin accounts remotely, leading to full control over the email security system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8) | CWE-269 (Improper Privilege Management).

## PoC / Detection
Classification: state-change

The template issues a GET request to `{{BaseURL}}/login.html` and matches on status_code == 200, compare_versions(version, " <= 10.0.9"), body containing "logonTitle\">Email Security Login", and header containing "Apache-Coyote/1.1". It extracts the version via regex `class="lefthand">([0-9.]+)` from the body. This serves as passive version fingerprinting for the vulnerable release; the actual exploit (unauthenticated admin account creation) is not performed by the template.

## References
- https://www.sonicwall.com/support/product-notification/security-notice-sonicwall-email-security-zero-day-vulnerabilities/210416112932360
- https://nvd.nist.gov/vuln/detail/CVE-2021-20021
