---
cve_id: CVE-2021-34427
template_path: nuclei-templates/http/cves/2021/CVE-2021-34427.yaml
affected_product: Eclipse BIRT Viewer
severity: critical
authentication: none
external_callback: false
affected_versions: 4.8.0 and earlier
preconditions: []
poc_classification: rce
---

## Vulnerability
Eclipse BIRT Viewer (Business Intelligence and Reporting Tools) contains a JSP injection flaw via unsanitized query parameters (`__report`, `sample`, `__document`). Unauthenticated remote attackers can craft requests that write arbitrary JSP content into the viewer directory and immediately execute it, achieving full remote code execution and server compromise.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE-434 (Unrestricted Upload of File with Dangerous Type)  
CPE: cpe:2.3:a:eclipse:business_intelligence_and_reporting_tools:*:*:*:*:*:*:*:*  
Remediation: upgrade to 4.9.0 or later.

## PoC / Detection
Classification: rce  
The template performs a two-step HTTP flow to confirm active exploitation:  
1. `GET /document?__report=test.rptdesign&sample=<url-encoded JSP payload that prints a random fingerprint>&__document=./test/{{rand_filename}}.jsp/.` – triggers the injection and file write (matcher verifies “The report document file has been generated successfully.” in the first response).  
2. `GET /test/{{rand_filename}}.jsp` – executes the planted JSP and checks that the response body contains the injected fingerprint string and `Content-Type: text/html` with status 200.  
The probe is intrusive (actually writes and executes code on the target).

## References
- https://bugs.eclipse.org/bugs/show_bug.cgi?id=538142
- https://sec-consult.com/vulnerability-lab/advisory/remote-code-execution-bypass-eclipse-business-intelligence-reporting-birt/
- https://nvd.nist.gov/vuln/detail/CVE-2021-34427
