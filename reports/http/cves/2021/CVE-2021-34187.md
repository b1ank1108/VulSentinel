---
cve_id: CVE-2021-34187
template_path: nuclei-templates/http/cves/2021/CVE-2021-34187.yaml
affected_product: Chamilo
severity: critical
authentication: none
external_callback: false
affected_versions: through 1.11.14
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Chamilo LMS through 1.11.14 is vulnerable to unauthenticated SQL injection in `main/inc/ajax/model.ajax.php` via the `searchField`, `filters`, or `filters2` parameters (CWE-89). Unauthenticated remote attackers can extract arbitrary database contents, including all user credentials and LMS data (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, score 9.8). Remediation requires upgrade to 1.11.15 or later.

## PoC / Detection
Classification: info-leak

The template issues GET requests to `/main/inc/ajax/model.ajax.php?a=get_sessions_tracking` embedding UNION ALL SELECT payloads in `searchField` that inject either `md5({{num}})` or `extractvalue(0x0a,concat(0x0a,(md5({{num}}))))`. It stops at the first match and confirms exploitation by locating the precomputed MD5 hash value inside the returned `application/json` body.

## References
- https://murat.one/?p=118
- https://nvd.nist.gov/vuln/detail/CVE-2021-34187
