---
cve_id: CVE-2021-40822
template_path: nuclei-templates/http/cves/2021/CVE-2021-40822.yaml
affected_product: GeoServer
severity: high
authentication: none
external_callback: true
affected_versions: through 2.18.5 and 2.19.x through 2.19.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
GeoServer through 2.18.5 and 2.19.x through 2.19.2 allows server-side request forgery (SSRF, CVE-2021-40822, CWE-918) via the option for setting a proxy host. Unauthenticated remote attackers can force the server to make arbitrary HTTP requests to internal or external resources. Impact includes unauthorized access to internal services, data leakage, and potential further compromise (e.g., internal port scanning or credential theft). CVSS 3.1: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). Remediation: apply patches from GeoServer 2.18.6+, 2.19.3+ or later releases.

## PoC / Detection
Classification: info-leak

The template first issues GET `{{BaseURL}}/geoserver/` and matches response body for fingerprint strings ("geoserver.web", "geoserverbasepage", or "GeoServer: Redirecting") to confirm a valid GeoServer instance. It then sends raw POST `/geoserver/TestWfsPost` (Content-Type: application/x-www-form-urlencoded) with payload `form_hf_0=&url=http://oast.pro/geoserver/../&body=&username=&password=` to trigger the SSRF. Detection confirms if the response contains "<b>Interactsh</b>", has `text/html` Content-Type header, and returns HTTP 200.

## References
- https://gccybermonks.com/posts/cve-2021-40822/
- https://github.com/geoserver/geoserver/compare/2.19.2...2.19.3
- https://github.com/geoserver/geoserver/releases
- https://nvd.nist.gov/vuln/detail/CVE-2021-40822
- https://osgeo-org.atlassian.net/browse/GEOS-10229
