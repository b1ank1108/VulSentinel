---
cve_id: CVE-2021-41432
template_path: nuclei-templates/http/cves/2021/CVE-2021-41432.yaml
affected_product: FlatPress
severity: medium
authentication: required
external_callback: false
affected_versions: 1.2.1
preconditions: Requires authentication with permissions to create/publish blog entries
poc_classification: state-change
---

## Vulnerability
FlatPress 1.2.1 contains a stored cross-site scripting vulnerability in blog content handling. An authenticated attacker can inject arbitrary JavaScript (e.g. `<script>alert(document.cookie)</script>`) via the entry creation form. The payload persists and executes in the browser context of any user viewing the affected blog post, enabling session hijacking, credential theft, and website defacement.

CVSS 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N). CWE-79.

## PoC / Detection
Classification: state-change

The template executes a four-step authenticated workflow: (1) multipart POST to /login.php with username/password, (2) GET /admin.php?p=entry&action=write to extract the _wpnonce value, (3) POST to the same admin endpoint with the nonce and blog entry containing the unsanitized `<script>` payload, (4) GET /index.php/2022/10 to confirm the script tag appears verbatim in the rendered HTML body alongside FlatPress markers.

## References
- https://github.com/flatpressblog/flatpress/issues/88
- https://nvd.nist.gov/vuln/detail/CVE-2021-41432
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/martinkubecka/CVE-References
- https://github.com/ARPSyndicate/cvemon
