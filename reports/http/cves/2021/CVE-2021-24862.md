---
cve_id: CVE-2021-24862
template_path: nuclei-templates/http/cves/2021/CVE-2021-24862.yaml
affected_product: WordPress RegistrationMagic plugin
severity: high
authentication: required
external_callback: false
affected_versions: <5.0.1.6
preconditions: []
poc_classification: state-change
---

## Vulnerability
WordPress RegistrationMagic (custom-registration-form-builder-with-submission-manager) plugin before 5.0.1.6 is vulnerable to authenticated SQL injection. The plugin fails to escape user input in its rm_chronos_ajax AJAX action (template uses ays_sccp_results_export_file) before using it in a SQL statement when duplicating tasks in batches. An authenticated attacker can execute arbitrary SQL queries, leading to sensitive information disclosure, data modification, and/or unauthorized administrative operations. Impact: potential full database access or site compromise in WordPress context. CVSS 3.1: 7.2 (AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H). CWE-89. Fixed in 5.0.1.6.

## PoC / Detection
Classification: state-change

The template first authenticates via POST to /wp-login.php with supplied {{username}}/{{password}}. It then sends a GET to /wp-admin/admin-ajax.php?action=ays_sccp_results_export_file containing a time-based blind SQLi payload (sccp_id[]=3)%20AND%20(SELECT%205921%20FROM%20(SELECT(SLEEP(6)))...) in the parameter. Finally, it fetches /wp-content/plugins/custom-registration-form-builder-with-submission-manager/admin/js/script_rm_utilities.js. Detection triggers on duration of second request >=6s, HTTP 200, and presence of "rm_user_role_mananger_form" in third response body.

## References
- https://wpscan.com/vulnerability/7d3af3b5-5548-419d-aa32-1f7b51622615
- https://wordpress.org/plugins/custom-registration-form-builder-with-submission-manager/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24862
- http://packetstormsecurity.com/files/165746/WordPress-RegistrationMagic-V-5.0.1.5-SQL-Injection.html
- https://github.com/ezelnur6327/ezelnur6327
