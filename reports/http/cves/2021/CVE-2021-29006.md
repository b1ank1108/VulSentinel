---
cve_id: CVE-2021-29006
template_path: nuclei-templates/http/cves/2021/CVE-2021-29006.yaml
affected_product: rConfig
severity: medium
authentication: required
external_callback: false
affected_versions: 3.9.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
rConfig 3.9.6 is affected by a Local File Inclusion vulnerability. An authenticated user may successfully download any file on the server.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (6.5). CWE-22.  
Impact: Authenticated attackers can read arbitrary files including /etc/passwd, exposing system information and credentials.  
Remediation: Upgrade to rConfig version 3.9.7 or later.

## PoC / Detection
Classification: info-leak

The template performs a multi-step authenticated probe:  
- POST login to `/lib/crud/userprocess.php` using `{{username}}` and `{{password}}`.  
- GET `/dashboard.php` (verifies "rconfig" string in body).  
- GET `/lib/ajaxHandlers/ajaxGetFileByPath.php?path=/etc/passwd`.  

Matchers confirm success via regex `root:.*:0:0:` in the final response body and HTTP 200 status.

## References
- https://github.com/mrojz/rconfig-exploit/blob/main/CVE-2021-29006-POC.py
- https://nvd.nist.gov/vuln/detail/CVE-2021-29006
- http://rconfig.com
