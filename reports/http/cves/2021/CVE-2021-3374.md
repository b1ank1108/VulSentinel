---
cve_id: CVE-2021-3374
template_path: nuclei-templates/http/cves/2021/CVE-2021-3374.yaml
affected_product: Rstudio Shiny Server
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 1.5.16
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Rstudio Shiny Server prior to 1.5.16 is vulnerable to local file inclusion and source code leakage (CWE-22). The flaw is triggered by appending an encoded slash (`%2f/`) to any URL path, enabling path traversal and directory listing. This permits unauthenticated remote attackers to read arbitrary files on the server.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (score 5.3). Impact includes exposure of sensitive information and application source code (e.g., `.R` files). CPE: cpe:2.3:a:rstudio:shiny_server:*:*:*:*:pro:*:*:*.

## PoC / Detection
Classification: info-leak

The template sends two unauthenticated GET requests to `{{BaseURL}}/%2f/` and `{{BaseURL}}/sample-apps/hello/%2f/`. It confirms the vulnerability with an AND matcher condition requiring HTTP 200 status, the literal string "Index of /" in the body (directory listing), and a regex match for `[A-Za-z].*\\.R` (source file leakage).

## References
- https://github.com/colemanjp/shinyserver-directory-traversal-source-code-leak
- https://blog.rstudio.com/2021/01/13/shiny-server-1-5-16-update/
- https://nvd.nist.gov/vuln/detail/CVE-2021-3374
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
