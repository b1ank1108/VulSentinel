---
cve_id: CVE-2021-24681
template_path: nuclei-templates/http/cves/2021/CVE-2021-24681.yaml
affected_product: Duplicate Page WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 4.4.2
preconditions: requires high privilege user role
poc_classification: state-change
---

## Vulnerability
Duplicate Page WordPress plugin <= 4.4.2 contains a stored cross-site scripting vulnerability caused by unsanitized Duplicate Post Suffix settings when output in the admin interface. High-privilege users can inject arbitrary scripts (e.g., `"><svg/onload=alert(document.domain)>`), which execute in the context of any user viewing the affected page.  

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8). Impact includes session hijacking or site defacement. Remediation is to update the plugin.

## PoC / Detection
Classification: state-change

The template performs a full exploit sequence to verify the vulnerability:  
1. POST to `/wp-login.php` with `{{username}}`/`{{password}}` and confirms successful admin session via 302 redirect and `wordpress_logged_in` cookie.  
2. GET `/wp-admin/options-general.php?page=duplicate_page_settings` to extract the `duplicatepage_nonce_field` value.  
3. POST the same settings endpoint with `duplicate_post_suffix="><svg/onload=alert(document.domain)>&` (plus nonce) to overwrite the configuration.  
4. GET the settings page again and asserts the raw XSS payload appears unsanitized in the response body.  

This confirms the configuration can be modified to inject persistent scripts.

## References
- https://wpscan.com/vulnerability/9ebdd1df-1d6f-4399-8b0f-77a79f841464
- https://wordpress.org/plugins/duplicate-page
- https://nvd.nist.gov/vuln/detail/CVE-2021-24681
