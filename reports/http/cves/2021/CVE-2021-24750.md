---
cve_id: CVE-2021-24750
template_path: nuclei-templates/http/cves/2021/CVE-2021-24750.yaml
affected_product: WordPress Visitor Statistics (Real Time Traffic)
severity: high
authentication: required
external_callback: false
affected_versions: < 4.8
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Visitor Statistics (Real Time Traffic) plugin before 4.8 fails to sanitize and escape the `refUrl` parameter in the `refDetails` AJAX action. The endpoint is reachable by any authenticated user (subscriber role or higher). Exploitation permits arbitrary SQL query execution on the underlying WordPress database.

Impact includes complete data exfiltration, data modification, account compromise, or full database access. CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H). CWE-89. Remediation requires upgrading to version 4.8 or later.

## PoC / Detection
Classification: info-leak

The template first authenticates by posting credentials to `/wp-login.php` (using `{{username}}` and `{{password}}` variables plus a test cookie). It then sends a GET request to `/wp-admin/admin-ajax.php?action=refDetails` containing a JSON object with a malicious `refUrl` value: `' union select 1,1,md5(999999999),4-- `. The payload triggers a UNION-based SQL injection. Detection succeeds if the response body contains the literal MD5 hash of `999999999` and returns HTTP 200.

## References
- https://github.com/fimtow/CVE-2021-24750/blob/master/exploit.py
- https://wpscan.com/vulnerability/7528aded-b8c9-4833-89d6-9cd7df3620de
- https://plugins.trac.wordpress.org/changeset/2622268
- https://nvd.nist.gov/vuln/detail/CVE-2021-24750
- https://github.com/WhooAmii/POC_to_review
