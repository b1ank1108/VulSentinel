---
cve_id: CVE-2021-20158
template_path: nuclei-templates/http/cves/2021/CVE-2021-20158.yaml
affected_product: Trendnet AC2600 TEW-827DRU
severity: critical
authentication: none
external_callback: false
affected_versions: 2.08B01
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Trendnet AC2600 TEW-827DRU firmware version 2.08B01 contains an authentication bypass (CWE-306: Missing Authentication for Critical Function). An unauthenticated remote attacker can invoke a hidden administrative command at `/apply_sec.cgi` to arbitrarily change the administrator password. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Successful exploitation grants full device control.

## PoC / Detection
Classification: auth-bypass

The template actively exploits the flaw with two unauthenticated raw POST requests to `/apply_sec.cgi`. The first uses `ccp_act=set&action=tools_admin_elecom` to set `admin_password` to a random 6-character value. The second immediately performs a graph-based login as `admin` using the newly set password (base64-encoded) with `action=do_graph_auth`. Detection succeeds only if the response body simultaneously contains `setConnectDevice`, `setInternet`, `setWlanSSID` and `TEW-827DRU`, the `Content-Type` header contains `text/html`, and status is 200.

## References
- https://www.tenable.com/security/research/tra-2021-54
- https://nvd.nist.gov/vuln/detail/CVE-2021-20150
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
