---
cve_id: CVE-2021-27931
template_path: nuclei-templates/http/cves/2021/CVE-2021-27931.yaml
affected_product: LumisXP
severity: critical
authentication: none
external_callback: true
affected_versions: <10.0.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
LumisXP (aka Lumis Experience Platform) before 10.0.0 allows unauthenticated blind XML external entity (XXE) attacks via an API request to `PageControllerXml.jsp`. Crafted payloads enable reading local server files or denial of service, leading to unauthorized access to sensitive information, server compromise, or further attacks on internal systems.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H (score 9.1). CWE-611. Remediation: upgrade to 10.0.0 or above.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated POST to `/lumis/portal/controller/xml/PageControllerXml.jsp` containing a minimal XML document with `<!ENTITY xxe SYSTEM "http://{{interactsh-url}}">` referenced inside `<method name="addPage"><id>&xxe;</id></method>`. Detection confirms exploitation by matching the outbound HTTP interaction protocol on the OOB callback.

## References
- https://github.com/sl4cky/LumisXP-XXE---POC/blob/main/poc.txt
- https://nvd.nist.gov/vuln/detail/CVE-2021-27931
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
