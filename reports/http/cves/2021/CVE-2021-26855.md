---
cve_id: CVE-2021-26855
template_path: nuclei-templates/http/cves/2021/CVE-2021-26855.yaml
affected_product: Microsoft Exchange Server
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: ability to make an untrusted connection to Exchange server port 443
poc_classification: info-leak
---

## Vulnerability
Microsoft Exchange Server suffers from a Server-Side Request Forgery (SSRF) vulnerability (CVE-2021-26855, CWE-918) that forms the initial vector in the ProxyLogon attack chain and can lead to remote code execution when chained with other flaws. The flaw allows an unauthenticated attacker who can reach the server on port 443 to force arbitrary backend requests (including to internal resources or attacker-controlled endpoints). This CVE is distinct from CVE-2021-26412, CVE-2021-26854, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065, and CVE-2021-27078. CVSS 3.1 base score is 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N). Successful exploitation can result in unauthorized access to sensitive information, remote code execution, or full system compromise. Remediation requires applying the appropriate security update.

## PoC / Detection
Classification: info-leak

The template sends a single raw GET request to `/owa/auth/x.js` containing the cookies `X-AnonResource=true; X-AnonResource-Backend={{interactsh-url}}/ecp/default.flt?~3;`. It verifies the SSRF by matching on an HTTP out-of-band interaction (interactsh_protocol == "http") received at the attacker-controlled interactsh server.

## References
- https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-26855
- https://proxylogon.com/#timeline
- https://web.archive.org/web/20210306113850/https://raw.githubusercontent.com/microsoft/CSS-Exchange/main/Security/http-vuln-cve2021-26855.nse
- https://gist.github.com/testanull/324546bffab2fe4916d0f9d1f03ffa09
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-26855
