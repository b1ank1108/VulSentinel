---
cve_id: CVE-2021-24236
template_path: nuclei-templates/http/cves/2021/CVE-2021-24236.yaml
affected_product: WordPress Imagements
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.2.5
preconditions: []
poc_classification: rce
---

## Vulnerability

WordPress Imagements plugin through version 1.2.5 is susceptible to arbitrary file upload which can lead to remote code execution. The plugin allows images to be uploaded in comments but only checks for the Content-Type in the request to forbid dangerous files. An attacker can upload arbitrary files by using a valid image Content-Type along with a PHP filename and code. This vulnerability can lead to remote code execution and compromise the affected WordPress site.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)  
CWE-434

## PoC / Detection
Classification: rce  
The template simulates an unauthenticated comment submission by sending a multipart/form-data POST to `/wp-comments-post.php` that includes a file field named `image` with filename `{{randstr}}.php`, Content-Type `image/jpeg`, and a PHP payload that echoes an MD5 hash and self-deletes. It then issues a GET to `/wp-content/plugins/imagements/images/{{randstr}}.php` and matches the echoed MD5 hash in the response body to confirm the file was uploaded to the plugin's images directory and executed.

## References
- https://wpscan.com/vulnerability/8f24e74f-60e3-4100-9ab2-ec31b9c9cdea
- https://wordpress.org/plugins/imagements/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24236
- https://nvd.nist.gov/vuln/detail/CVE-2021-24236
