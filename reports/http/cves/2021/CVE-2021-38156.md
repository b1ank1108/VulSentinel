---
cve_id: CVE-2021-38156
template_path: nuclei-templates/http/cves/2021/CVE-2021-38156.yaml
affected_product: Nagios XI
severity: medium
authentication: required
external_callback: false
affected_versions: < 5.8.6
preconditions: administrative privileges to edit dashboards
poc_classification: info-leak
---

## Vulnerability
In Nagios XI before 5.8.6, XSS exists in the dashboard page (/dashboards/#) when administrative users attempt to edit a dashboard. Authenticated attackers can inject malicious JavaScript via the dashboard title field, potentially stealing administrator session cookies or performing administrative actions.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4) | CWE-79.

## PoC / Detection
Classification: info-leak

The template executes a full login flow (GET/POST login.php with username/password and NSP token extraction), updates the home dashboard title via POST to ajaxhelper.php with payload `"><script>alert(document.domain)</script>`, then retrieves /nagiosxi/dashboards/manage.php and matches the unsanitized script tag in body_5 (plus 200 status and text/html header) to confirm reflection.

## References
- https://raxis.com/blog/cve-2021-38156/
- https://nvd.nist.gov/vuln/detail/CVE-2021-38156
