---
cve_id: CVE-2021-22873
template_path: nuclei-templates/http/cves/2021/CVE-2021-22873.yaml
affected_product: Revive Adserver
severity: medium
authentication: none
external_callback: true
affected_versions: <5.1.0
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Revive Adserver before 5.1.0 contains an open redirect vulnerability (CVE-2021-22873, CWE-601) via the `dest`, `oadest`, and `ct0` parameters in the `lg.php` and `ck.php` delivery scripts. An attacker can craft a URL that redirects any user to an arbitrary malicious site, enabling phishing, sensitive information theft, data modification, or unauthorized operations.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
Impact: Successful exploitation redirects users to attacker-controlled sites for phishing or chained attacks.  
Remediation: Upgrade to 5.1.0 or later.

## PoC / Detection
Classification: detect-only  
The template issues six parallel GET requests to common installation paths (`/ads/www/delivery/lg.php`, `/adserve/www/delivery/lg.php`, `/adserver/www/delivery/lg.php`, `/openx/www/delivery/lg.php`, `/revive/www/delivery/lg.php`, `/www/delivery/lg.php`) with `?dest=http://interact.sh`. It stops at the first match, follows up to 2 host redirects, and verifies exploitation via regex on the `Location` header confirming a redirect containing `interact.sh`. No credentials, no version comparison, no ck.php/oadest/ct0 testing.

## References
- https://hackerone.com/reports/1081406
- https://github.com/revive-adserver/revive-adserver/issues/1068
- http://seclists.org/fulldisclosure/2021/Jan/60
- https://nvd.nist.gov/vuln/detail/CVE-2021-22873
- http://packetstormsecurity.com/files/161070/Revive-Adserver-5.0.5-Cross-Site-Scripting-Open-Redirect.html
