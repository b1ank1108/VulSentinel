---
cve_id: CVE-2021-25094
template_path: nuclei-templates/http/cves/2021/CVE-2021-25094.yaml
affected_product: WordPress Tatsubuilder plugin
severity: high
authentication: none
external_callback: false
affected_versions: <= 3.3.11
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Tatsubuilder plugin <= 3.3.11 contains an unrestricted file upload vulnerability in the font import feature (`add_custom_font` AJAX action). An unauthenticated attacker can upload a ZIP archive containing arbitrary PHP code, which is extracted to a publicly accessible path under `/wp-content/uploads/typehub/custom/`. This leads to remote code execution and full server compromise.  
Impact: complete server takeover on ~100,000 affected sites.  
CVSS 3.1: 8.1 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H).  
CWE-306: Missing Authentication for Critical Function.  
Remediation: update to 3.3.12.

## PoC / Detection
Classification: rce

The template performs full unauthenticated RCE verification in a two-request flow:  
1. POST multipart/form-data to `/wp-admin/admin-ajax.php` with `action=add_custom_font` and a generated ZIP containing a hidden `.{{rand_base(5)}}.php` file whose content is `<?php echo base64_decode('{{base64(randstr)}}'); ?>`. Matches response body for lowercase filename and `"status":"success"`.  
2. GET `/wp-content/uploads/typehub/custom/{{to_lower(filename)}}/.{{filename}}.php` and matches the random marker string in the response body to confirm arbitrary PHP execution.

## References
- https://darkpills.com/wordpress-tatsu-builder-preauth-rce-cve-2021-25094/
- https://wpscan.com/vulnerability/fb0097a0-5d7b-4e5b-97de-aacafa8fffcd/
- https://nvd.nist.gov/vuln/detail/CVE-2021-25094
