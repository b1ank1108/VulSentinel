---
cve_id: CVE-2021-29442
template_path: nuclei-templates/http/cves/2021/CVE-2021-29442.yaml
affected_product: Nacos
severity: high
authentication: none
external_callback: false
affected_versions: < 1.4.1
preconditions: using embedded storage (derby DB)
poc_classification: auth-bypass
---

## Vulnerability
Nacos versions prior to 1.4.1 suffer from an authentication bypass vulnerability. The ConfigOpsController exposes the `/nacos/v1/cs/ops/derby` endpoint without the `@Secured` annotation protection present on other endpoints like `/data/remove`. This permits unauthenticated users to execute management operations, including querying and potentially wiping the embedded Derby database. External storage configurations (e.g., MySQL) are unaffected.

Impact: Successful exploitation can lead to unauthorized access to sensitive data and potential compromise of the Nacos server.  
Remediation: Upgrade Nacos to version 1.4.1 or later.  
CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N) | CWE-306

## PoC / Detection
Classification: auth-bypass

The template performs a GET request to `{{BaseURL}}/nacos/v1/cs/ops/derby?sql=select+st.tablename+from+sys.systables+st` and matches on a 200 status code, `application/json` Content-Type header, and a regex confirming the presence of internal system table names (e.g. APP_CONFIGDATA_RELATION_*, CONFIG_INFO, HIS_CONFIG_INFO, etc.) in the response body to confirm the unprotected database access.

## References
- https://securitylab.github.com/advisories/GHSL-2020-325_326-nacos/
- https://github.com/alibaba/nacos/issues/4463
- https://github.com/alibaba/nacos/pull/4517
- https://github.com/advisories/GHSA-36hp-jr8h-556f
- https://nvd.nist.gov/vuln/detail/CVE-2021-29442
