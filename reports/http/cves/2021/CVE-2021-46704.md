---
cve_id: CVE-2021-46704
template_path: nuclei-templates/http/cves/2021/CVE-2021-46704.yaml
affected_product: GenieACS
severity: critical
authentication: none
external_callback: false
affected_versions: 1.2.x before 1.2.8
preconditions: []
poc_classification: rce
---

## Vulnerability
GenieACS 1.2.x before 1.2.8 contains an unauthenticated OS command injection vulnerability in the UI interface API via the ping host argument (lib/ui/api.ts and lib/ping.ts). The flaw stems from insufficient input validation combined with a missing authorization check. 

Impact: successful exploitation allows arbitrary command execution on the target system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-78.

## PoC / Detection
Classification: rce

The template performs an active check by issuing a GET request to `{{BaseURL}}/api/ping/;`id`` (command injection via semicolon). It verifies success by matching:
- `text/plain` in the Content-Type header
- regex `uid=([0-9]+)` in the response body (proving `id` command output)
- HTTP 500 status code

It also extracts `uid=(\d+)\((\w+)\)` details from the body when the injection succeeds.

## References
- https://twitter.com/shaybt12/status/1671598239835906058
- https://github.com/advisories/GHSA-2877-693q-pj33
- https://nvd.nist.gov/vuln/detail/CVE-2021-46704
- https://github.com/genieacs/genieacs/commit/7f295beeecc1c1f14308a93c82413bb334045af6
- https://github.com/genieacs/genieacs/releases/tag/v1.2.8
