---
cve_id: CVE-2021-27309
template_path: nuclei-templates/http/cves/2021/CVE-2021-27309.yaml
affected_product: Clansphere CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 2011.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Clansphere CMS 2011.4 contains an unauthenticated reflected cross-site scripting vulnerability via the "module" parameter in mods/clansphere/lang_modvalidate.php. Attacker-supplied input is reflected unsanitized into the HTML response, allowing arbitrary JavaScript execution in the victim's browser context when a crafted URL is visited.  
Impact: session hijacking, page defacement, or theft of sensitive information (cookies, localStorage, DOM data).  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79. CPE: cpe:2.3:a:csphere:clansphere:2011.4:*:*:*:*:*:*:*.

## PoC / Detection
Classification: info-leak  
The template sends one unauthenticated GET request to `{{BaseURL}}/mods/clansphere/lang_modvalidate.php?language=language&module=module%22></script><script>alert(document.domain)</script>`. It verifies exploitability by checking that the response body reflects the unsanitized payload string `"></script><script>alert(document.domain)</script>.php`, returns HTTP 200, and sets Content-Type: text/html.

## References
- https://github.com/xoffense/POC/blob/main/Clansphere%202011.4%20%22module%22%20xss.md
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27309
- https://nvd.nist.gov/vuln/detail/CVE-2021-27309
- https://github.com/ARPSyndicate/kenzer-templates
