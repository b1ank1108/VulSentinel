---
cve_id: CVE-2021-25299
template_path: nuclei-templates/http/cves/2021/CVE-2021-25299.yaml
affected_product: Nagios XI
severity: medium
authentication: required
external_callback: false
affected_versions: 5.7.5
preconditions: requires authenticated admin user to visit crafted malicious URL
poc_classification: info-leak
---

## Vulnerability
Nagios XI 5.7.5 contains a reflected cross-site scripting (XSS) vulnerability in `/usr/local/nagiosxi/html/admin/sshterm.php` due to improper sanitization of the `url` parameter. A maliciously crafted URL, when clicked by an authenticated admin user, executes arbitrary JavaScript in the victim's browser context. This enables theft of session cookies and can be chained with other vulnerabilities for one-click remote command execution and full server compromise.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection
Classification: info-leak

The template first issues a GET to `/nagiosxi/login.php` and extracts the NSP token via regex from the response body. It then performs a POST to the same login endpoint with supplied username/password credentials. Finally it sends a GET to `/nagiosxi/admin/sshterm.php?url=javascript:alert(document.domain)`. The matcher confirms reflection by verifying status_code_3 == 200, text/html content-type, and that the response body contains both the unsanitized payload inside an `iframe src="javascript:alert(document.domain)"` and the string "SSH Terminal".

## References
- https://github.com/fs0c-sh/nagios-xi-5.7.5-bugs/blob/main/README.md#cve-2021-25299
- http://nagios.com
- https://github.com/fs0c-sh/nagios-xi-5.7.5-bugs/blob/main/README.md
- https://nvd.nist.gov/vuln/detail/CVE-2021-25299
- https://assets.nagios.com/downloads/nagiosxi/versions.php
