---
cve_id: CVE-2021-24934
template_path: nuclei-templates/http/cves/2021/CVE-2021-24934.yaml
affected_product: Visual CSS Style Editor
severity: medium
authentication: required
external_callback: false
affected_versions: < 7.5.4
preconditions: WordPress site with Visual CSS Style Editor plugin installed and activated; requires authenticated administrator to visit crafted URL
poc_classification: info-leak
---

## Vulnerability

Visual CSS Style Editor WordPress plugin versions prior to 7.5.4 fails to sanitise and escape the `wyp_page_type` parameter before outputting it on the admin page `/wp-admin/admin.php?page=yellow-pencil-editor`. This produces a reflected cross-site scripting vulnerability.

An attacker can craft a malicious link containing a JavaScript payload in the `wyp_page_type` parameter. When an authenticated administrator visits the link, the payload executes in their browser context. Impact includes theft of administrator session cookies and modification of site appearance for the victim. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection

Classification: info-leak

The template first authenticates to the WordPress admin panel by POSTing `log={{username}}&pwd={{password}}` to `/wp-login.php`. It then issues a GET request to `/wp-admin/admin.php?page=yellow-pencil-editor&href=1&wyp_page_id=home&wyp_mode=single&wyp_page_type=<script>alert(document.domain)</script>`. Detection succeeds if status_code_2 is 200, content_type_2 contains "text/html", and body_2 simultaneously contains the unsanitized `<script>alert(document.domain)</script>` payload plus the string "yellow-pencil-iframe-data".

## References
- https://wpscan.com/vulnerability/0aa5a8d5-e736-4cd3-abfd-8e0a356bb6ef/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24934
