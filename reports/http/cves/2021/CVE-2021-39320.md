---
cve_id: CVE-2021-39320
template_path: nuclei-templates/http/cves/2021/CVE-2021-39320.yaml
affected_product: WordPress Under Construction plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <1.19
preconditions: Under Construction plugin active on WordPress; Apache+modPHP server configuration; authenticated admin access to wp-admin
poc_classification: info-leak
---

## Vulnerability
WordPress Under Construction plugin before 1.19 contains a reflected cross-site scripting vulnerability. The plugin unsafely echoes the raw value of `$GLOBALS['PHP_SELF']` in ucOptions.php under certain server configurations (including Apache+modPHP). 

An attacker can craft a malicious URL that injects JavaScript when visited by an authenticated administrator, resulting in unauthorized script execution in the admin context. Impact includes session hijacking, credential theft, or page defacement (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1, CWE-79).

## PoC / Detection
Classification: info-leak

The template performs a two-step HTTP interaction: first POSTs credentials to /wp-login.php to authenticate as an administrator, then issues a GET request to /wp-admin/admin.php/"><script>alert(document.domain)</script>/?page=under-construction. It matches on the exact unsanitized payload appearing inside a form action attribute in the response body, presence of the string "under-construction", HTTP 200 status, and text/html Content-Type header.

## References
- https://wpscan.com/vulnerability/49ae1df0-d6d2-4cbb-9a9d-bf3599429875
- https://www.wordfence.com/vulnerability-advisories/#CVE-2021-39320
- https://nvd.nist.gov/vuln/detail/CVE-2021-39320
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
