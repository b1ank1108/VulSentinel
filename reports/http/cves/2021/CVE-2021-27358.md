---
cve_id: CVE-2021-27358
template_path: nuclei-templates/http/cves/2021/CVE-2021-27358.yaml
affected_product: Grafana
severity: high
authentication: none
external_callback: false
affected_versions: 6.7.3 through 7.4.1
preconditions: [commonly used configuration set for snapshot functionality]
poc_classification: dos
---

## Vulnerability
Grafana 6.7.3 through 7.4.1 allows unauthenticated snapshot creation through the `/api/snapshots` API endpoint. A remote attacker can trigger Denial of Service via a crafted API call when snapshot functionality uses a commonly set configuration. Root cause is missing authentication for a critical function (CWE-306). CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H (7.5 High). Impact includes creation of snapshots that may contain sensitive dashboard data, with primary effect on availability.

## PoC / Detection
Classification: dos
The template issues a single unauthenticated raw POST request to `/api/snapshots` containing a JSON payload with a minimal dashboard definition (title "Home", empty rows array, no credentials). It verifies success by matching both `"deleteUrl":` and `"deleteKey":` in the response body (AND condition) together with `application/json` in the response `Content-Type` header, confirming the snapshot was created without authentication.

## References
- https://phabricator.wikimedia.org/T274736
- https://grafana.com/docs/grafana/latest/release-notes/release-notes-7-4-2/
- https://nvd.nist.gov/vuln/detail/CVE-2021-27358
- https://github.com/grafana/grafana/blob/master/CHANGELOG.md
- https://github.com/grafana/grafana/blob/master/CHANGELOG.md#742-2021-02-17
