---
cve_id: CVE-2021-21246
template_path: nuclei-templates/http/cves/2021/CVE-2021-21246.yaml
affected_product: OneDev
severity: high
authentication: none
external_callback: false
affected_versions: < 4.0.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OneDev versions prior to 4.0.3 expose an insecure REST API endpoint at `/rest/users/{id}` due to missing authorization checks (CWE-862). Unauthenticated attackers can retrieve detailed user information, including access tokens, for any user ID. This enables data exfiltration and potential user impersonation leading to account compromise.

Impact: High (CVSS 3.1 score 8.6, vector AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N). No special preconditions required.

## PoC / Detection
Classification: info-leak

The detection template issues a simple unauthenticated GET request to `{{BaseURL}}/rest/users/1` and matches on HTTP 200 status, `application/json` Content-Type, and the presence of both `"accessToken"` and `"email"` keywords in the JSON response body.

## References
- https://github.com/theonedev/onedev/security/advisories/GHSA-66v7-gg85-f4gx
- https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089
- https://nvd.nist.gov/vuln/detail/CVE-2021-21246
- https://securitylab.github.com/advisories/GHSL-2020-214_223-onedev/
