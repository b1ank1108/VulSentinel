---
cve_id: CVE-2021-37580
template_path: nuclei-templates/http/cves/2021/CVE-2021-37580.yaml
affected_product: Apache ShenYu
severity: critical
authentication: none
external_callback: false
affected_versions: 2.3.0 and 2.4.0
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Apache ShenYu 2.3.0 and 2.4.0 contain an authentication bypass in the Admin interface. Incorrect JWT usage in ShenyuAdminBootstrap allows unauthenticated attackers to impersonate the admin user and gain full access.

**Impact**: Unauthorized access to sensitive information, data modification, and potential full system compromise.  
**CVSS**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE**: 287  
**Remediation**: Upgrade to the latest patched version of Apache ShenYu.

## PoC / Detection
Classification: auth-bypass  
The template issues one GET request to `/dashboardUser` with a hardcoded admin JWT (`eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyTmFtZSI6ImFkbWluIiwiZXhwIjoxNjM3MjY1MTIxfQ.-jjw2bGyQxna5Soe4fLVLaD3gUT5ALTcsvutPQoE2qk`) in the `X-Access-Token` header. It confirms exploitation if the response is HTTP 200 and contains all of: `query success`, `"userName":"admin"`, `"code":200`.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-37580
- https://github.com/fengwenhua/CVE-2021-37580
- https://lists.apache.org/thread/o15j25qwtpcw62k48xw1tnv48skh3zgb
- http://www.openwall.com/lists/oss-security/2021/11/16/1
- https://github.com/ARPSyndicate/kenzer-templates
