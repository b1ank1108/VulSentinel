---
cve_id: CVE-2021-43062
template_path: nuclei-templates/http/cves/2021/CVE-2021-43062.yaml
affected_product: Fortinet FortiMail
severity: medium
authentication: none
external_callback: false
affected_versions: 7.0.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected cross-site scripting (XSS) vulnerability (CVE-2021-43062, CWE-79) in Fortinet FortiMail 7.0.1. An unauthenticated attacker can perform an attack via specially crafted HTTP GET requests to the FortiGuard URI protection service endpoint `/fmlurlsvc/`.

**Impact:** Successful exploitation allows execution of arbitrary script code in the context of the targeted user's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.

**CVSS 3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Remediation:** Apply the latest security patch or upgrade to a non-vulnerable version.

## PoC / Detection
Classification: info-leak

The template sends a single GET request to `{{BaseURL}}/fmlurlsvc/?=&url=https%3A%2F%2Fgoogle.com<Svg%2Fonload%3Dalert(document.domain)>` embedding the XSS payload in the `url` parameter. It verifies the flaw if the response body contains both the unsanitized payload string `<Svg/onload=alert(document.domain)>` and `FortiMail Click Protection`, the `Content-Type` header contains `text/html`, and the status code is 200. This confirms lack of sanitization in the FortiGuard click-protection URL handling.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-43062
- https://www.fortiguard.com/psirt/FG-IR-21-185
- https://www.exploit-db.com/exploits/50759
- https://fortiguard.com/advisory/FG-IR-21-185
- https://github.com/ARPSyndicate/cvemon
