---
cve_id: CVE-2022-1020
template_path: nuclei-templates/http/cves/2022/CVE-2022-1020.yaml
affected_product: WordPress WooCommerce
severity: critical
authentication: none
external_callback: false
affected_versions: <3.1.2
preconditions: [Woo Product Table plugin installed on WordPress]
poc_classification: rce
---

## Vulnerability
WordPress WooCommerce plugin (woo_product_table by CodeAstrology) before 3.1.2 lacks authorisation and CSRF checks in the `wpt_admin_update_notice_option` AJAX action (exposed to both unauthenticated and authenticated users) and performs no validation on the `callback` parameter. This enables unauthenticated attackers to invoke arbitrary PHP functions with zero or one controlled argument. Impact is remote code execution (CVSS 9.8: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H; CWE-352).

## PoC / Detection
Classification: rce

The template issues a single unauthenticated POST request to `/wp-admin/admin-ajax.php?action=wpt_admin_update_notice_option` containing `option_key=a&perpose=update&callback=phpinfo`. Detection succeeds on HTTP 200 combined with the simultaneous presence of the strings "PHP Extension" and "PHP Version" in the response body, confirming successful arbitrary callback execution. The template additionally extracts the running PHP version via regex `>PHP Version <\/td><td class="v">([0-9.]+)`.

## References
- https://wpscan.com/vulnerability/04fe89b3-8ad1-482f-a96d-759d1d3a0dd5
- https://nvd.nist.gov/vuln/detail/CVE-2022-1020
