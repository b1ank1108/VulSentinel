---
cve_id: CVE-2022-0827
template_path: nuclei-templates/http/cves/2022/CVE-2022-0827.yaml
affected_product: WordPress Best Books plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.6.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Best Books plugin through version 2.6.3 contains a critical SQL injection vulnerability. The plugin fails to properly sanitize and escape parameters before using them in SQL statements via an AJAX action (`bestbooks_add_transaction`). Specifically, the `debit` parameter is vulnerable to time-based SQL injection attacks. This vulnerability is exploitable without authentication, allowing unauthenticated attackers to inject arbitrary SQL queries. Successful exploitation can lead to unauthorized access to sensitive information, data modification, and execution of unauthorized administrative operations within the WordPress database context.

The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8 (Critical), indicating network-based exploitation with low attack complexity, no privileges required, and high impact on confidentiality, integrity, and availability.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability using a time-based blind SQL injection technique. It sends a POST request to `/wp-admin/admin-ajax.php` with the AJAX action `bestbooks_add_transaction`. The payload injects a conditional SLEEP statement into the `debit` parameter: `(CASE WHEN (9277=9277) THEN SLEEP(6) ELSE 9277 END)`. 

The template verifies the vulnerability by checking three conditions:
1. The response time is at least 6 seconds (indicating the SQL SLEEP command executed)
2. The HTTP status code is 200
3. The response body contains "Account added successfully"

If all conditions are met, the SQL injection vulnerability is confirmed. The time-based approach allows detection even when error messages are suppressed, as the database delay provides observable evidence of successful SQL command injection.

## References

- https://wpscan.com/vulnerability/0d208ebc-7805-457b-aa5f-ffd5adb2f3be
- https://wordpress.org/plugins/bestbooks/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0827
- https://github.com/ARPSyndicate/cvemon
- https://github.com/cyllective/CVEs
