---
cve_id: CVE-2022-2168
template_path: nuclei-templates/http/cves/2022/CVE-2022-2168.yaml
affected_product: WordPress Download Manager plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 3.2.44
preconditions: [Authenticated administrator access required]
poc_classification: state-change
---

## Vulnerability

CVE-2022-2168 is an authenticated Cross-Site Scripting (XSS) vulnerability in the WordPress Download Manager plugin versions prior to 3.2.44. The vulnerability exists in the stats history dashboard where the `user_ids` parameter is not properly sanitized and escaped. This allows authenticated attackers with administrator privileges to inject malicious JavaScript code through the vulnerable parameter. The flaw is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N), indicating it requires high privileges (administrator) and user interaction for exploitation, but can result in cross-site scripting with limited confidentiality and integrity impact.

## PoC / Detection

Classification: state-change

The template performs authenticated detection by first logging into the WordPress admin panel using provided credentials via a POST request to `/wp-login.php`. After successful authentication, it sends a GET request to the stats history dashboard endpoint (`/wp-admin/edit.php?post_type=wpdmpro&page=wpdm-stats&type=history`) with a malicious payload injected into the `user_ids[]` parameter: `user_ids[]=1&"><script>alert('document_domain')</script>`. 

The template verifies the vulnerability by checking for three conditions:
1. The injected JavaScript payload `<script>alert('document_domain')</script>` is reflected in the response body
2. The text "No downloads found" appears in the response (confirming the stats page loaded)
3. The response returns HTTP status 200 with a `text/html` content type

This confirms that the malicious script is rendered unsanitized in the HTML response, demonstrating the XSS vulnerability.

## References

- https://wpscan.com/vulnerability/66789b32-049e-4440-8b19-658649851010/
- https://nvd.nist.gov/vuln/detail/CVE-2022-2168
