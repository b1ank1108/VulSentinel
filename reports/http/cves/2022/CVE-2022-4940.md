---
cve_id: CVE-2022-4940
template_path: nuclei-templates/http/cves/2022/CVE-2022-4940.yaml
affected_product: WCFM Membership
severity: high
authentication: none
external_callback: false
affected_versions: <= 2.10.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
The WCFM Membership WordPress plugin (by wclovers) is affected by a Broken Access Control vulnerability (CWE-862) due to missing capability checks on AJAX actions `wcfm-memberships`, `wcfm-memberships-manage`, and `wcfm-memberships-settings`.

Unauthenticated attackers can modify membership details, approve or deny memberships, and change renewal information. This can result in data tampering and unauthorized access.

CVSS v3.1 score: 7.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L). Remediation is to update to version 2.10.1 or later.

## PoC / Detection
Classification: state-change

The template detects the issue through a two-request sequence:
- A GET request to `/` extracts the `wcfm_ajax_nonce` via regex from the page body.
- A subsequent POST to `/wp-admin/admin-ajax.php` submits `action=wcfm_ajax_controller&controller=wcfm-memberships` (with nonce, draw=1 parameters) without authentication.

Matchers verify success if the response is HTTP 200 and contains JSON indicators (`"recordsTotal"`, `"recordsFiltered"`, `"draw"`), confirming unauthorized access to the memberships endpoint.

## References
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wc-multivendor-membership/wcfm-membership-2100-missing-authorization
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2633191%40wc-multivendor-membership&new=2633191%40wc-multivendor-membership&sfp_email=&sfph_mail=
- https://wpscan.com/vulnerability/41bdf07c-d707-436b-8cfc-5ef852f0b7f5/
