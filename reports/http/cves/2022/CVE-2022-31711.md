---
cve_id: CVE-2022-31711
template_path: nuclei-templates/http/cves/2022/CVE-2022-31711.yaml
affected_product: VMware vRealize Log Insight
severity: medium
authentication: none
external_callback: false
affected_versions: >= 8.0.0 and < 8.10.2, or >= 3.0 and < 4.8
preconditions: []
poc_classification: info-leak
---

## Vulnerability

VMware vRealize Log Insight versions prior to v8.10.2 contain an Information Disclosure vulnerability that allows unauthenticated remote attackers to collect sensitive session and application information. The vulnerability enables malicious actors to remotely access sensitive data without requiring authentication credentials, potentially exposing session details and application configuration information. This flaw affects two version ranges: versions 8.0.0 through 8.10.1, and versions 3.0 through 4.7.

The CVSS v3.1 score of 5.3 (Medium severity) reflects the confidentiality impact (Low) with no integrity or availability impact, exploitable over the network without authentication or user interaction.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by making unauthenticated GET requests to two endpoints that should not be publicly accessible without authentication:

1. `/i18n/component/JS?locale=en-US` - Internationalization component endpoint
2. `/api/v1/version` - Version API endpoint

The detection logic verifies:
- HTTP 200 status code is returned
- Response body contains indicators of vRealize Log Insight ("logInsight" or "releaseName:")
- Extracted version number falls within the vulnerable ranges (8.0.0 to 8.10.1 or 3.0 to 4.7)

The template uses version comparison DSL functions to accurately determine if the detected version is vulnerable. It stops at the first matching endpoint to optimize detection efficiency.

## References

- http://packetstormsecurity.com/files/174606/VMware-vRealize-Log-Insight-Unauthenticated-Remote-Code-Execution.html
- https://github.com/horizon3ai/vRealizeLogInsightRCE
