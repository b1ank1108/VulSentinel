---
cve_id: CVE-2022-3933
template_path: nuclei-templates/http/cves/2022/CVE-2022-3933.yaml
affected_product: WordPress Essential Real Estate plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <3.9.6
preconditions: [User must have at least admin role]
poc_classification: state-change
---

## Vulnerability

CVE-2022-3933 is an authenticated cross-site scripting (XSS) vulnerability in the WordPress Essential Real Estate plugin versions prior to 3.9.6. The vulnerability exists due to insufficient sanitization and escaping of parameters in the plugin's AJAX handler. An authenticated user with a role as low as admin can inject arbitrary JavaScript code that executes in the browser context of other users visiting the affected site. This can lead to theft of cookie-based authentication credentials, session hijacking, and other client-side attacks. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (Medium severity).

## PoC / Detection

Classification: state-change

The template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Injection**: Sends a GET request to `/wp-admin/admin-ajax.php` with the action `ere_property_gallery_fillter_ajax` and a malicious `columns_gap` parameter containing an XSS payload: `"><script>alert(document.domain)</script><!--`

The template verifies the vulnerability by checking that:
- The response returns HTTP 200 status
- The Content-Type header is `text/html`
- The injected script payload is reflected unescaped in the response body
- The response contains `ere_property_gallery`, confirming the vulnerable AJAX handler processed the request

This confirms the plugin fails to sanitize the `columns_gap` parameter, allowing arbitrary JavaScript injection.

## References

- https://wpscan.com/vulnerability/6395f3f1-5cdf-4c55-920c-accc0201baf4
- https://wordpress.org/plugins/essential-real-estate/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2022-3933
- https://github.com/ARPSyndicate/cvemon
- https://github.com/cyllective/CVEs
