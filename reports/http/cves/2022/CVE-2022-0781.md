---
cve_id: CVE-2022-0781
template_path: nuclei-templates/http/cves/2022/CVE-2022-0781.yaml
affected_product: WordPress Nirweb Support plugin
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.8.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Nirweb Support plugin versions prior to 2.8.2 contain a critical SQL injection vulnerability. The plugin fails to properly sanitize and escape user-supplied parameters before incorporating them into SQL statements executed via an AJAX action (`answerd_ticket`). This unauthenticated SQL injection allows remote attackers to inject arbitrary SQL commands without requiring any authentication or special permissions.

The vulnerability exists in the AJAX handler that processes ticket-related operations. Due to insufficient input validation, attackers can manipulate the `id_form` parameter to inject malicious SQL code. This can lead to unauthorized access to sensitive database information, data modification, privilege escalation, or execution of administrative operations within the WordPress installation.

The CVSS score of 9.8 (Critical) reflects the severity of this flaw, with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction. The vulnerability impacts confidentiality, integrity, and availability at high levels.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this SQL injection vulnerability by sending a crafted POST request to the WordPress AJAX endpoint (`/wp-admin/admin-ajax.php`). The detection method uses a UNION-based SQL injection technique:

1. Sends a POST request with the action parameter set to `answerd_ticket`
2. Injects a UNION ALL SELECT statement into the `id_form` parameter: `1 UNION ALL SELECT NULL,NULL,md5({{num}}),NULL,NULL,NULL,NULL,NULL-- -`
3. The injected query attempts to return the MD5 hash of a random number (999999999) in the third column position
4. Verifies successful exploitation by checking if the response body contains the expected MD5 hash value
5. Confirms the vulnerability if the hash is present and the HTTP status is 200

The template uses a time-delayed or computation-based marker (MD5 hash) to confirm that the injected SQL code was executed by the database, proving the existence of the SQL injection vulnerability without causing destructive modifications.

## References

- https://wpscan.com/vulnerability/1a8f9c7b-a422-4f45-a516-c3c14eb05161
- https://wordpress.org/plugins/nirweb-support/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0781
- https://github.com/cyllective/CVEs
- https://github.com/ARPSyndicate/cvemon
