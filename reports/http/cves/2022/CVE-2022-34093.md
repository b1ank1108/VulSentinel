---
cve_id: CVE-2022-34093
template_path: nuclei-templates/http/cves/2022/CVE-2022-34093.yaml
affected_product: i3geo
severity: medium
authentication: none
external_callback: false
affected_versions: 7.0.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-34093 is a reflected cross-site scripting (XSS) vulnerability in Software Publico Brasileiro i3geo version 7.0.5. The vulnerability exists in the `access_token.php` file within the LinkedIn OAuth integration component (`/i3geo/pacotes/linkedinoauth/example/access_token.php`). The endpoint fails to properly sanitize and encode user-supplied input, allowing attackers to inject malicious JavaScript code through URL parameters. When a victim accesses a crafted URL, the injected script executes in their browser within the context of the i3geo application. This can lead to session token theft, credential harvesting, or unauthorized actions performed on behalf of the victim user within the geographic information system.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the vulnerable `access_token.php` endpoint with a URL-encoded XSS payload in a query parameter: `?=%3Cscript%3Ealert(document.domain)%3C/script%3E` (which decodes to `?=<script>alert(document.domain)</script>`).

The template confirms the vulnerability by checking for three conditions:
1. HTTP 200 status code response
2. Content-Type header contains "text/html"
3. Response body reflects the injected payload (`%3Cscript%3Ealert(document.domain)%3C/script%3E`) and contains the text "Invalid consumer key"

The presence of the reflected payload in the HTML response confirms that user input is not properly sanitized, making the application vulnerable to XSS attacks.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2022-34093
- https://github.com/wagnerdracha/ProofOfConcept/blob/main/i3geo_proof_of_concept.txt#L44
- https://owasp.org/www-community/attacks/xss/
- https://softwarepublico.gov.br/social/i3geo
- https://github.com/ARPSyndicate/cvemon
