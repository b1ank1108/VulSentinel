---
cve_id: CVE-2022-0271
template_path: nuclei-templates/http/cves/2022/CVE-2022-0271.yaml
affected_product: WordPress LearnPress plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <4.1.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress LearnPress plugin (by ThimPress) before 4.1.6 suffers from a reflected cross-site scripting vulnerability (CVE-2022-0271, CWE-79). The `lp-dismiss-notice` parameter is neither sanitized nor escaped before being echoed back in the JSON response of the `lp_background_single_email` AJAX action. CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Successful exploitation allows script injection into pages viewed by other users, enabling data theft, session hijacking or defacement.

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/wp-admin/admin-ajax.php?action=lp_background_single_email&lp-dismiss-notice=xxx<img%20src=x%20onerror=alert(document.domain)>`. It matches when the server reflects the exact unsanitized payload inside the JSON `{"dismissed": "..."}` value, the response status is 200 and the Content-Type header contains `text/html`.

## References
- https://wpscan.com/vulnerability/ad07d9cd-8a75-4f7c-bbbe-3b6b89b699f2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0271
- https://nvd.nist.gov/vuln/detail/cve-2022-0271
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
