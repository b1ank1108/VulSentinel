---
cve_id: CVE-2022-3766
template_path: nuclei-templates/http/cves/2022/CVE-2022-3766.yaml
affected_product: phpMyFAQ
severity: medium
authentication: none
external_callback: false
affected_versions: < 3.1.8
preconditions: []
poc_classification: info-leak
---

## Vulnerability
phpMyFAQ versions prior to 3.1.8 contain a reflected cross-site scripting vulnerability in the search functionality. The application fails to properly sanitize user input in the `search` parameter of `index.php`, allowing attackers to inject and execute malicious JavaScript code in the context of other users' browsers (CWE-79).  

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Impact: arbitrary JavaScript execution in victim's browser context. Remediation: upgrade to 3.1.8 or later.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}/index.php?search=1af%22+onclick%3D'alert(document.domain)'` and verifies the vulnerability by checking for unsanitized reflection of the payload (exact string `value="1af" onclick='alert(document.domain)'`) in the response body, combined with HTTP 200 status and `text/html` content-type header.

## References
- https://huntr.dev/bounties/d9666520-4ff5-43bb-aacf-50c8e5570983
- https://github.com/thorsten/phpMyFAQ/commit/c7904f2236c6c0dd64c2226b90c30af0f7e5a72d
- https://nvd.nist.gov/vuln/detail/CVE-2022-3766
