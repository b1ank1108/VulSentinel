---
cve_id: CVE-2022-0169
template_path: nuclei-templates/http/cves/2022/CVE-2022-0169.yaml
affected_product: Photo Gallery by 10Web
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.6.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Photo Gallery by 10Web WordPress plugin before 1.6.0 does not validate and escape the `bwg_tag_id_bwg_thumbnails_0` parameter before using it in a SQL statement via the `bwg_frontend_data` AJAX action (available to unauthenticated users), resulting in unauthenticated SQL injection.

CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
Impact: arbitrary SQL query execution enabling unauthorized data access, manipulation, or leakage.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}/wp-admin/admin-ajax.php?action=bwg_frontend_data&shortcode_id=1&bwg_tag_id_bwg_thumbnails_0[]` containing a UNION SELECT payload that injects `concat(md5(999999999),0x2c,8)` into the query result set. It verifies exploitation by checking for the computed MD5 hash string in the 200 OK response body.

## References
- https://wpscan.com/vulnerability/0b4d870f-eab8-4544-91f8-9c5f0538709c
- https://wordpress.org/plugins/photo-gallery/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0169
- https://plugins.trac.wordpress.org/changeset/2672822/photo-gallery#file9
