---
cve_id: CVE-2022-31137
template_path: nuclei-templates/http/cves/2022/CVE-2022-31137.yaml
affected_product: Roxy-WI
severity: critical
authentication: none
external_callback: false
affected_versions: < 6.1.1.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Roxy-WI before 6.1.1.0 is susceptible to remote code execution. System commands can be run remotely via the subprocess_execute function without processing the inputs received from the user in the /app/options.py file.

Successful exploitation allows an attacker to execute arbitrary code on the affected system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-74.

## PoC / Detection
Classification: rce

The template sends a single POST request to `/app/options.py` with the payload `alert_consumer=1&serv=127.0.0.1&ipbackend=";cat+/etc/passwd+##&backend_server=127.0.0.1` (no authentication headers or cookies). Detection succeeds on HTTP 200 and regex match `root:.*:0:0:` in the response body, confirming command injection and execution.

## References
- http://packetstormsecurity.com/files/167805/Roxy-WI-Remote-Command-Execution.html
- https://www.cve.org/CVERecord?id=CVE-2022-31137
- https://github.com/hap-wi/roxy-wi/security/advisories/GHSA-mh86-878h-43c9
- https://nvd.nist.gov/vuln/detail/CVE-2022-31137
