---
cve_id: CVE-2022-0087
template_path: nuclei-templates/http/cves/2022/CVE-2022-0087.yaml
affected_product: Keystone 6 Login Page
severity: medium
authentication: none
external_callback: true
affected_versions: @keystone-6/auth < 1.0.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Keystone 6 login page contains an open redirect and reflected cross-site scripting flaw via the unsanitized `from` query parameter on the `/signin` endpoint. The parameter is reflected in both redirect Location headers and page body, allowing arbitrary URLs or JavaScript payloads such as `javascript:alert(document.cookie)`. 

CVSS: 6.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, CWE-79). Impact includes user redirection to malicious sites (phishing) or JavaScript execution that can steal credentials/cookies.

Remediation: upgrade to @keystone-6/auth >= 1.0.2 (or migrate from @keystone-next/auth to Keystone 6).

## PoC / Detection
Classification: info-leak

The template sends two unauthenticated GET requests:
- `{{BaseURL}}/signin?from=https://interact.sh` and matches `Location: https://interact.sh` in response headers (open redirect).
- `{{BaseURL}}/signin?from=javascript:alert(document.cookie)` and matches the string `alert(document.cookie)` in response body (reflected XSS).

## References
- https://huntr.com/bounties/c9d7374f-2cb9-4bac-9c90-a965942f413e
- https://nvd.nist.gov/vuln/detail/CVE-2022-0087
- https://github.com/keystonejs/keystone/commit/96bf833a23b1a0a5d365cf394467a943cc481b38
