---
cve_id: CVE-2022-36642
template_path: nuclei-templates/http/cves/2022/CVE-2022-36642.yaml
affected_product: Omnia MPX
severity: critical
authentication: none
external_callback: false
affected_versions: through 1.5.0+r1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Telos Alliance Omnia MPX Node through 1.5.0+r1 is vulnerable to local file inclusion via the `/logs/downloadMainLog` endpoint. Path traversal in the `fname` parameter allows unauthenticated retrieval of arbitrary files, including `config/MPXnode/www/appConfig/userDB.json` (exposing cleartext usernames, passwords, roles and `mustChangePwd` flags) and `/etc/passwd`, enabling credential theft and privilege escalation to the control panel. Impact: full system compromise possible. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-862 (Missing Authorization).

## PoC / Detection
Classification: info-leak

The template performs two GET requests to `{{BaseURL}}/logs/downloadMainLog` using `fname` payloads with multiple `../` traversals (`../../../../../../..//etc/passwd` and path to `userDB.json`), with `stop-at-first-match: true`. It matches on OR condition: AND of JSON credential fields (`"username":`, `"password":`, `"mustChangePwd":`, `"roleUser":`) in body, or regex `root:[x*]:0:0`.

## References
- https://www.exploit-db.com/exploits/50996
- https://cyber-guy.gitbook.io/cyber-guy/pocs/omnia-node-mpx-auth-bypass-via-lfd
- https://nvd.nist.gov/vuln/detail/CVE-2022-36642
- https://www.telosalliance.com/radio-processing/audio-interfaces/omnia-mpx-node
