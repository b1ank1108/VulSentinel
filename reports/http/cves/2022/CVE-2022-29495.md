---
cve_id: CVE-2022-29495
template_path: nuclei-templates/http/cves/2022/CVE-2022-29495.yaml
affected_product: WordPress Popup Builder plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <= 4.1.11
preconditions: authenticated administrator victim required; social engineering (malicious link or site visit)
poc_classification: state-change
---

## Vulnerability
WordPress Popup Builder plugin <= 4.1.11 for WordPress is vulnerable to Cross-Site Request Forgery (CSRF) in its plugin settings update functionality (`action=sgpbSaveSettings`) due to missing CSRF tokens/protection. An attacker can force an authenticated administrator to modify arbitrary plugin settings by tricking them into visiting a malicious site or clicking a crafted link, resulting in unauthorized configuration changes.

## PoC / Detection
Classification: state-change

The template first performs a login POST to `/wp-login.php` with supplied `{{username}}`/`{{password}}` credentials, then issues an authenticated POST to `/wp-admin/admin-post.php?action=sgpbSaveSettings` containing forged settings parameters (e.g. `sgpb-enable-debug-mode=on&sgpb-dont-delete-data=on&sgpb-disable-analytics-general=on`). Success is verified by matching a 302 redirect whose `Location` header contains references to the plugin settings page.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2022-29495
- https://patchstack.com/database/vulnerability/popup-builder/wordpress-popup-builder-plugin-4-1-11-cross-site-request-forgery-csrf-leading-to-plugin-settings-update
