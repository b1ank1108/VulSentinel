---
cve_id: CVE-2022-43140
template_path: nuclei-templates/http/cves/2022/CVE-2022-43140.yaml
affected_product: kkFileView
severity: high
authentication: none
external_callback: true
affected_versions: 4.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-43140 is a Server-Side Request Forgery (SSRF) vulnerability in kkFileView version 4.1.0. The vulnerability exists in the component `cn.keking.web.controller.OnlinePreviewController#getCorsFile`, which fails to properly validate the `url` parameter. An attacker can inject crafted URLs into this parameter, forcing the application to make arbitrary requests to internal or external resources. This can lead to unauthorized access to internal resources, potential data leakage, disclosure of sensitive information, modification of data, and execution of unauthorized administrative operations in the context of the affected application. The vulnerability is classified as CWE-918 (Server-Side Request Forgery) with a CVSS score of 7.5, requiring no authentication or user interaction to exploit.

## PoC / Detection

Classification: info-leak

The template detects this SSRF vulnerability by sending a GET request to the `/getCorsFile` endpoint with a base64-encoded URL pointing to an external callback server (`https://oast.me`). The `urlPath` parameter is set to the base64-encoded value of the external URL. If the application is vulnerable, it will make a server-side request to the attacker-controlled URL and return the response content. The template verifies the vulnerability by checking if the response body contains the string `<h1> Interactsh Server </h1>`, which confirms that the server successfully fetched content from the external callback URL, demonstrating the SSRF condition.

## References

- https://github.com/kekingcn/kkFileView/issues/392
- https://nvd.nist.gov/vuln/detail/CVE-2022-43140
