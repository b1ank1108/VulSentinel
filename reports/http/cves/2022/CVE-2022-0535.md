---
cve_id: CVE-2022-0535
template_path: nuclei-templates/http/cves/2022/CVE-2022-0535.yaml
affected_product: WordPress E2Pdf plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.16.45
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress E2Pdf plugin before 1.16.45 contains a stored cross-site scripting (XSS) vulnerability. The plugin fails to sanitize and escape certain settings fields (including `e2pdf_developer_ips`) when rendering the admin interface, even when the `unfiltered_html` capability is explicitly disallowed. An authenticated attacker with access to the settings page can inject arbitrary HTML/JavaScript that executes in the browser of any user viewing the page, enabling cookie theft, session hijacking, or site defacement.  
CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8) | CWE-79.

## PoC / Detection
Classification: info-leak  
The template executes a multi-step authenticated attack sequence to confirm the stored XSS:  
1. POST to `/wp-login.php` with `{{username}}`/`{{password}}` to obtain a valid admin session.  
2. GET `/wp-admin/admin.php?page=e2pdf-settings` and extract the `_nonce` value via regex.  
3. POST to the same settings endpoint with the malicious payload `</textarea><svg/onload=alert(document.domain)>` injected into the `e2pdf_developer_ips` parameter (plus all other required fields and nonce).  
4. GET the settings page again and match that the exact unsanitized payload appears inside the `placeholder` attribute of the Developer IPs textarea (plus HTML content-type and 200 status).  
This verifies the setting value is persisted and reflected without escaping.

## References
- https://wpscan.com/vulnerability/a4162e96-a3c5-4f38-a60b-aa3ed9508985
- https://wordpress.org/plugins/e2pdf/
- https://mikadmin.fr/tech/XSS-Stored-E2Pdf-798ef69b0e13c36acf5446358d57c965Dx90666bNvCw98.pdf
- https://nvd.nist.gov/vuln/detail/CVE-2022-0535
- https://plugins.trac.wordpress.org/changeset/2675049/e2pdf
