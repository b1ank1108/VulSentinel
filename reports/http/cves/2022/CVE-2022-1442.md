---
cve_id: CVE-2022-1442
template_path: nuclei-templates/http/cves/2022/CVE-2022-1442.yaml
affected_product: WordPress Metform
severity: high
authentication: none
external_callback: false
affected_versions: <=2.1.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Metform plugin through 2.1.3 is susceptible to information disclosure due to improper access control in the ~/core/forms/action.php file. Unauthenticated attackers can view all API keys and secrets of integrated third-party APIs such as PayPal, Stripe, Mailchimp, Hubspot, HelpScout, reCAPTCHA and many more. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact: gain of sensitive information. Remediation: upgrade to >=2.1.4.

## PoC / Detection
Classification: info-leak

The template performs two sequential unauthenticated GET requests. The first fetches /wp-json/metform/v1/forms/templates/0 and extracts a form ID via regex on `<option value=\"([0-9]+)\"`. The second calls /wp-json/metform/v1/forms/get/{{id}} and verifies the JSON response body contains both `mf_recaptcha_secret_key` and `admin_email_from`, returns HTTP 200, and sets `Content-Type: application/json`.

## References
- https://gist.github.com/Xib3rR4dAr/6e6c6e5fa1f8818058c7f03de1eda6bf
- https://wpscan.com/vulnerability/9f3fcdd4-9ddc-45d5-a4af-e58634813c2b
- https://wordpress.org/plugins/metform/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1442
- https://plugins.trac.wordpress.org/changeset/2711944/metform/trunk/core/forms/action.php
