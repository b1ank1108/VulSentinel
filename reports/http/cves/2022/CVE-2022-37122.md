---
cve_id: CVE-2022-37122
template_path: nuclei-templates/http/cves/2022/CVE-2022-37122.yaml
affected_product: Carel pCOWeb HVAC BACnet Gateway
severity: high
authentication: none
external_callback: false
affected_versions: 2.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Carel pCOWeb HVAC BACnet Gateway 2.1.0 contains an unauthenticated arbitrary file disclosure caused by improper verification of the `file` GET parameter in `logdownload.cgi`. Attackers can disclose sensitive files via directory traversal. Impact includes exposure of configuration files, credentials, and HVAC system data. Remediation requires updating to a version later than 2.1.0.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/usr-cgi/logdownload.cgi?file=../../../../../../../../etc/passwd` and verifies success with a regex matcher for the string `root:.*:0:0:` (signature of a readable Linux `/etc/passwd` file).

## References
- https://www.zeroscience.mk/en/vulnerabilities/ZSL-2022-5709.php
- https://www.zeroscience.mk/codes/carelpco_dir.txt
- https://packetstormsecurity.com/files/167684/
- https://nvd.nist.gov/vuln/detail/CVE-2022-37122
