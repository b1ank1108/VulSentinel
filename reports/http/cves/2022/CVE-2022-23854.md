---
cve_id: CVE-2022-23854
template_path: nuclei-templates/http/cves/2022/CVE-2022-23854.yaml
affected_product: AVEVA InTouch Access Anywhere Secure Gateway
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
AVEVA InTouch Access Anywhere Secure Gateway is vulnerable to local file inclusion via path traversal. An attacker can access sensitive information stored on the server by traversing directories using encoded `../` sequences in the `/AccessAnywhere/` endpoint.

**CVSS Score:** 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
**CWE:** CWE-22, CWE-23  
**Impact:** Allows reading arbitrary local files, potentially exposing configuration, credentials, or system files leading to further compromise.  
**Remediation:** Apply the latest security patches or updates provided by AVEVA.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing a GET request with heavily URL-encoded path traversal (`%252e%252e%255c` for `../`) targeting `C:\windows\win.ini`. It verifies exploitation success through:
- Body containing signature strings from `win.ini`: 'for 16-bit app support' and 'extensions'
- Response header `Content-Type` matching 'text/ini' or 'application/octet-stream' (OR condition)
- HTTP status code 200

This non-destructive probe confirms the LFI without requiring authentication or out-of-band interaction.

## References
- https://packetstormsecurity.com/files/cve/CVE-2022-23854
- https://www.aveva.com
- https://crisec.de/advisory-aveva-intouch-access-anywhere-secure-gateway-path-traversal
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23854
- https://www.cisa.gov/uscert/ics/advisories/icsa-22-342-02
