---
cve_id: CVE-2022-48197
template_path: nuclei-templates/http/cves/2022/CVE-2022-48197.yaml
affected_product: Yahoo User Interface library (YUI2) TreeView
severity: medium
authentication: none
external_callback: false
affected_versions: YUI2 through 2.8.2
preconditions: Vulnerable sandbox PHP files (up.php, sam.php etc.) in the TreeView bower_components directory must be present and publicly accessible
poc_classification: info-leak
---

## Vulnerability

Reflected cross-site scripting (XSS) vulnerability in the Yahoo User Interface library (YUI2) TreeView component through version 2.8.2. Multiple PHP files in the sandbox/treeview directory (`up.php`, `sam.php`, `renderhidden.php`, `removechildren.php`, `removeall.php`, `readd.php`, `overflow.php`, `newnode2.php`, `newnode.php`) fail to sanitize the `mode` parameter, allowing arbitrary JavaScript injection.

Attackers can craft malicious links that, when visited by users, execute JS in the victim's browser context. Impact includes session token theft and unauthorized actions on behalf of victims. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection
Classification: info-leak

The template issues GET requests to 9 possible vulnerable paths (stop-at-first-match) such as `/libs/bower/bower_components/yui2/sandbox/treeview/up.php?mode=1'"()&%<zzz><script>alert(document.domain)</script>` and equivalents for other files. Detection succeeds if the response body contains the exact unsanitized payload string AND `widget.TreeView`, returns status 200, and has `text/html` content-type.

## References
- https://www.exploit-db.com/exploits/51198
- https://packetstormsecurity.com/files/171633/Yahoo-User-Interface-TreeView-2.8.2-Cross-Site-Scripting.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-48197
- http://packetstormsecurity.com/files/171633/Yahoo-User-Interface-TreeView-2.8.2-Cross-Site-Scripting.html
- https://github.com/ryan412/CVE-2022-48197/blob/main/README.md
