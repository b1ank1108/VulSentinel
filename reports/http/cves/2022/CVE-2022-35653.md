---
cve_id: CVE-2022-35653
template_path: nuclei-templates/http/cves/2022/CVE-2022-35653.yaml
affected_product: Moodle LTI module
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: LTI module enabled
poc_classification: info-leak
---

## Vulnerability
Reflected Cross-Site Scripting (XSS) in Moodle's LTI module due to insufficient sanitization of user-supplied data in the LTI authentication endpoint (`/mod/lti/auth.php`). A remote unauthenticated attacker can craft a malicious link that, when followed by a victim (educator or student), executes arbitrary HTML and JavaScript in the victim's browser context on the vulnerable Moodle site.  

Impact includes theft of session credentials, sensitive course data access, page defacement, phishing, and drive-by-download attacks.  

**CVSS v3.1**: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE**: CWE-79  

## PoC / Detection
Classification: info-leak

The template sends one POST request to `/mod/lti/auth.php` (Content-Type: application/x-www-form-urlencoded) with body payload `xxx"><img/src%3d'x'onerror%3dalert('document_domain')>=1`. It matches on response body containing the unsanitized reflected string `<img/src='x'onerror=alert('document_domain')>` AND `moodle-editor`, plus `text/html` Content-Type header and HTTP 200 status. This confirms the reflected XSS condition.

## References
- http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-72299
- https://nvd.nist.gov/vuln/detail/CVE-2022-35653
- https://bugzilla.redhat.com/show_bug.cgi?id=2106277
- https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6MOKYVRNFNAODP2XSMGJ5CRDUZCZKAR3/
- https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MTKUSFPSYFINSQFSOHDQIDVE6FWBEU6V/
