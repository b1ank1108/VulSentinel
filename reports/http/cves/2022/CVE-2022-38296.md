---
cve_id: CVE-2022-38296
template_path: nuclei-templates/http/cves/2022/CVE-2022-38296.yaml
affected_product: Cuppa CMS
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Cuppa CMS v1.0 contains an arbitrary file upload vulnerability (CWE-434) in the File Manager via the jQuery File Upload endpoint (/js/jquery_file_upload/server/php/). CVSS 3.1 score 9.8 (Critical). Unauthenticated remote attackers can upload malicious PHP files leading to RCE and full system compromise.

## PoC / Detection
Classification: rce

The template verifies exploitability through a 3-step process:
1. POSTs a PHP webshell (echoing md5("CVE-2022-38296")) disguised as `test-{{randstr}}.jpg` to the upload endpoint with multipart form data.
2. POSTs to the filemanager API to rename the uploaded file from `//{{filename}}` to `//{{randstr}}.php`.
3. GETs `/media/{{randstr}}.php` and matches the MD5 hash in body_3 along with text/html content-type and 200 status.

## References
- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-38296
- https://github.com/ARPSyndicate/cvemon
