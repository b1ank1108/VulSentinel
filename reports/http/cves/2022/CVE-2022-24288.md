---
cve_id: CVE-2022-24288
template_path: nuclei-templates/http/cves/2022/CVE-2022-24288.yaml
affected_product: Apache Airflow
severity: high
authentication: none
external_callback: false
affected_versions: < 2.2.4
preconditions: [example DAGs must be present, specifically 'example_passing_params_via_test_command' DAG]
poc_classification: rce
---

## Vulnerability

Apache Airflow versions prior to 2.2.4 contain an OS command injection vulnerability (CWE-78) in example DAGs. The vulnerability exists because certain example DAGs fail to properly sanitize user-provided parameters, allowing attackers to inject and execute arbitrary OS commands through the web UI. The CVSS score is 8.8 (High), with the attack vector being network-based, low attack complexity, requiring low privileges, and no user interaction. Successful exploitation enables attackers to achieve high impact on confidentiality, integrity, and availability of the target system.

The vulnerability specifically affects the `example_passing_params_via_test_command` DAG, which can be accessed and exploited through the web interface to execute arbitrary commands on the underlying operating system.

## PoC / Detection

Classification: rce

The template detects this vulnerability by attempting to access the code view of the vulnerable example DAG through two possible paths:
1. `/admin/airflow/code?root=&dag_id=example_passing_params_via_test_command`
2. `/code?dag_id=example_passing_params_via_test_command`

The detection uses a stop-at-first-match strategy and looks for the presence of a specific string in the response: `'foo was passed in via Airflow CLI Test command with value {{ params.foo }}'`. This string indicates the vulnerable example DAG is present and accessible. The template comment notes this works with unauthenticated Airflow instances, confirming the vulnerability can be exploited without authentication. While the template itself only verifies the presence of the vulnerable DAG code, the underlying vulnerability allows OS command injection through parameter manipulation.

## References

- https://github.com/advisories/GHSA-3v7g-4pg3-7r6j
- https://nvd.nist.gov/vuln/detail/CVE-2022-24288
- https://lists.apache.org/thread/dbw5ozcmr0h0lhs0yjph7xdc64oht23t
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Hax0rG1rl/my_cve_and_bounty_poc
