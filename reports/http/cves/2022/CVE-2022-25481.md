---
cve_id: CVE-2022-25481
template_path: nuclei-templates/http/cves/2022/CVE-2022-25481.yaml
affected_product: ThinkPHP
severity: high
authentication: none
external_callback: false
affected_versions: 5.0.24
preconditions: configured without the PATHINFO parameter
poc_classification: info-leak
---

## Vulnerability
ThinkPHP 5.0.24 is susceptible to information disclosure. This version was configured without the PATHINFO parameter. This can allow an attacker to access all system environment parameters from index.php, thereby possibly obtaining sensitive information, modifying data, and/or executing unauthorized operations.

An attacker can exploit this vulnerability to gain sensitive information.

CVSS v3.1: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N) | CWE-668 | CPE: cpe:2.3:a:thinkphp:thinkphp:5.0.24:*:*:*:*:*:*:*

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated GET request to `{{BaseURL}}/index.php?s=example` and confirms exposure if the response body contains all of “Exception”, “REQUEST_TIME”, and “ThinkPHP Constants” while the HTTP status is 200, 500, or 404.

## References
- https://github.com/Lyther/VulnDiscover/blob/master/Web/ThinkPHP_InfoLeak.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-25481
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
