---
cve_id: CVE-2022-46888
template_path: nuclei-templates/http/cves/2022/CVE-2022-46888.yaml
affected_product: NexusPHP
severity: medium
authentication: none
external_callback: false
affected_versions: <1.7.33
preconditions: []
poc_classification: info-leak
---

## Vulnerability

NexusPHP versions prior to 1.7.33 contain multiple reflected cross-site scripting (XSS) vulnerabilities across various endpoints. The vulnerabilities exist in multiple parameters including:
- `secret` parameter in `/login.php`
- `q` parameter in `/user-ban-log.php`
- `query` parameter in `/log.php`
- `text` parameter in `/moresmiles.php`
- `q` parameter in `/myhr.php`
- `id` parameter in `/viewrequests.php`

These XSS flaws allow attackers to inject arbitrary JavaScript or HTML code that executes in victims' browsers when they visit specially crafted URLs. The vulnerabilities are classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

Successful exploitation can lead to theft of cookie-based authentication credentials, session hijacking, and other client-side attacks against users of the NexusPHP application.

## PoC / Detection

Classification: info-leak

The template detects the XSS vulnerability by sending a GET request to `/login.php` with a malicious payload in the `secret` parameter: `"><script>alert(document.domain)</script>`. 

The detection verifies the vulnerability by checking for three conditions:
1. The injected payload is reflected unescaped in the response body as `value=""><script>alert(document.domain)</script>">`
2. The response contains the string "NexusPHP" confirming the target application
3. The response has a `text/html` content type and returns HTTP status 200

If all matchers succeed, the template confirms that user input is reflected without proper sanitization, making the application vulnerable to reflected XSS attacks.

## References

- https://www.surecloud.com/resources/blog/nexusphp-surecloud-security-review-identifies-authenticated-unauthenticated-vulnerabilities
- https://github.com/xiaomlove/nexusphp/releases/tag/v1.7.33
- https://nvd.nist.gov/vuln/detail/CVE-2022-46888
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
