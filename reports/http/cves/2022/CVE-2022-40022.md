---
cve_id: CVE-2022-40022
template_path: nuclei-templates/http/cves/2022/CVE-2022-40022.yaml
affected_product: Symmetricom SyncServer
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Microchip Technology (Microsemi) SyncServer S650, branded as Symmetricom SyncServer, contains a command injection vulnerability (CVE-2022-40022, CWE-77) in the ping controller at `/controller/ping.php`. An unauthenticated remote attacker can inject arbitrary OS commands via the `hostname` parameter.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation results in full remote command execution on the network time server appliance.

## PoC / Detection
Classification: rce

The template sends one raw POST request to `/controller/ping.php` with form-encoded payload `currentTab=ping&...&hostname=%60id%60&port=eth0&pingType=ping` (backtick-wrapped `id` command injection). It verifies exploitation by matching:
- regex `uid=([0-9(a-z)]+)` in response body (output of executed `id` command)
- HTTP status 302
- `text/html` content-type header
- absence of Cloudflare headers

## References
- http://packetstormsecurity.com/files/172907/Symmetricom-SyncServer-Unauthenticated-Remote-Command-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-40022
- https://www.microsemi.com/campaigns/network-time-servers/S650p/%3Fgd%3D1&id=5&gclid=Cj0KCQjwjbyYBhCdARIsAArC6LL-202ej5YfDB5lMIMSZ2735qjo5yaj2i-PrvLv2Cnh_kIJtFJ0oF8aAlMpEALw_wcB
- https://www.microsemi.com/campaigns/network-time-servers/syncserver-s600/?url=
- https://www.microsemi.com/document-portal/doc_download/135737-datasheet-syncserver-s650
