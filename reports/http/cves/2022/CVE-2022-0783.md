---
cve_id: CVE-2022-0783
template_path: nuclei-templates/http/cves/2022/CVE-2022-0783.yaml
affected_product: Multiple Shipping Address Woocommerce
severity: high
authentication: none
external_callback: false
affected_versions: < 2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Multiple Shipping Address Woocommerce plugin before 2.0 does not properly sanitize and escape numerous parameters before using them in SQL statements via some AJAX actions available to unauthenticated users, leading to unauthenticated SQL injections.

Impact: Unauthenticated attackers can execute time-based blind SQL injection to extract database contents, potentially exposing sensitive WooCommerce customer and order data.

Remediation: Update the Multiple Shipping Address Woocommerce plugin to version 2.0 or later.

## PoC / Detection
Classification: info-leak

The template performs a time-based blind SQL injection detection by sending a POST request to `/wp-admin/admin-ajax.php` with the `action=ocwma_choice_address` and a `sid` parameter containing `3+AND+(SELECT+1946+FROM+(SELECT(SLEEP(7)))zsme)`. It then matches on response duration >=7 seconds along with status code 200, body length 5, and body ending with 'false'.

## References
- https://wpscan.com/vulnerability/4d594424-8048-482d-b61c-45be1e97a8ba/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0783
