---
cve_id: CVE-2022-1386
template_path: nuclei-templates/http/cves/2022/CVE-2022-1386.yaml
affected_product: WordPress Fusion Builder plugin
severity: critical
authentication: none
external_callback: true
affected_versions: <3.6.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Fusion Builder plugin before 3.6.2 is susceptible to server-side request forgery. The plugin does not validate a parameter in its forms, which can be used to initiate arbitrary HTTP requests. The data returned is then reflected back in the application's response. An attacker can potentially interact with hosts on the server's local network, bypass firewalls, and access control measures.

## PoC / Detection
Classification: info-leak

The template detects/verify the SSRF via two sequential raw POST requests to `/wp-admin/admin-ajax.php`. First request uses `action=fusion_form_update_view` and extracts the `fusion-form-nonce` value via XPath (`//*[@id="fusion-form-nonce-0"]`) from the response body. Second request submits a multipart/form-data payload to `action=fusion_form_submit_form_to_url` containing `fusionAction=https://oast.me`, `fusionActionMethod=GET`, form fields, and the extracted nonce. Matcher requires HTTP 200 status and the string "Interactsh Server" present in the second response body.

## References
- https://wpscan.com/vulnerability/bf7034ab-24c4-461f-a709-3f73988b536b
- https://www.rootshellsecurity.net/rootshell-discovered-a-critical-vulnerability-in-top-wordpress-theme/
- https://theme-fusion.com/version-7-6-2-security-update/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1386
- https://github.com/ARPSyndicate/kenzer-templates
