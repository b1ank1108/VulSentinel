---
cve_id: CVE-2022-24266
template_path: nuclei-templates/http/cves/2022/CVE-2022-24266.yaml
affected_product: Cuppa CMS
severity: high
authentication: required
external_callback: false
affected_versions: v1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Cuppa CMS v1.0 contains a SQL injection vulnerability in the `/administrator/components/table_manager/` endpoint via the `order_by` parameter. This is a time-based blind SQL injection flaw (CWE-89) that allows attackers to extract sensitive data from the database through timing-based inference techniques. The vulnerability exists in the table manager component and can be exploited by authenticated users to perform unauthorized database queries.

Successful exploitation enables unauthorized access to database contents, potential data leakage, and could lead to complete system compromise depending on database privileges and configuration. The CVSS score of 7.5 (High) reflects the confidentiality impact, though authentication is required to reach the vulnerable endpoint.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Authentication**: Sends a POST request to the root endpoint (`/`) with username and password credentials to establish an authenticated session via the login task.

2. **SQL Injection Probe**: Sends a POST request to `/components/table_manager/` with a time-based SQL injection payload in the `order_by` parameter. The payload uses a conditional `if()` statement with `sleep(6)` to create a measurable time delay: `id`,if(SUBSTRING('test',1,1)='t',sleep(6),sleep(0))--+-`

The template confirms the vulnerability by checking:
- Response time is 6 seconds or greater (indicating successful SQL execution)
- HTTP status code 200
- Content-Type contains "text/html"
- Response body contains "list_admin_table" (confirming the table manager component responded)

The 20-second timeout ensures sufficient time to detect the 6-second delay introduced by the SQL injection payload.

## References

- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-24266
- https://github.com/CuppaCMS/CuppaCMS/issues/17
- https://github.com/truonghuuphuc/CVE
- https://github.com/ARPSyndicate/cvemon
