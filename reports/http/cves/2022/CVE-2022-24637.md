---
cve_id: CVE-2022-24637
template_path: nuclei-templates/http/cves/2022/CVE-2022-24637.yaml
affected_product: Open Web Analytics
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.7.4
preconditions: []
poc_classification: rce
---

## Vulnerability
Open Web Analytics (OWA) before 1.7.4 allows an unauthenticated remote attacker to obtain sensitive user information and cache hashes from cache files generated with the literal prefix `<?php` (instead of the PHP-start sequence `<?php`). These files are not interpreted by the PHP engine, exposing serialized data containing temporary passkeys. The hashes are leveraged to reset the admin password, authenticate as admin, modify application configuration (error_log_file and shell payload), and achieve full remote code execution by writing and executing a malicious PHP webshell in the caches directory.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8)  
CWE-269: Improper Privilege Management

## PoC / Detection
Classification: rce

The template implements and verifies the complete multi-step RCE exploit chain (6+ HTTP requests + JavaScript processing):
- Issues a failed admin login to populate the user cache.
- Retrieves the exposed malformed cache file `/owa-data/caches/1/owa_user/c30da9265ba0a4704db9229f864c9eb7.php`, extracts the base64-encoded serialized object via regex.
- Parses the serialized object with JavaScript to extract the temporary 32-character passkey hash.
- Uses the hash in a password-change request to set a new random admin password.
- Logs in as admin (extracts session cookie `owa_p` and nonce from optionsGeneral page).
- Updates general options twice: first to redirect error logging to an attacker-controlled `.php` file in caches/, second to inject a PHP payload that echoes a secret string.
- Requests the newly written PHP file and confirms RCE success by matching both `[debug_log]` and the injected secret in the response body.

## References
- https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/http/open_web_analytics_rce.rb
- http://packetstormsecurity.com/files/171389/Open-Web-Analytics-1.7.3-Remote-Code-Execution.html
- https://github.com/Open-Web-Analytics/Open-Web-Analytics/releases/tag/1.7.4
- https://github.com/Pflegusch/CVE-2022-24637
- https://github.com/c0derpwner/HTB-pwned
