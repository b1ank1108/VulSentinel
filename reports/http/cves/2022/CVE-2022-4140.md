---
cve_id: CVE-2022-4140
template_path: nuclei-templates/http/cves/2022/CVE-2022-4140.yaml
affected_product: WordPress Welcart e-Commerce plugin
severity: high
authentication: none
external_callback: false
affected_versions: <2.8.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-4140 is an arbitrary file access vulnerability in the WordPress Welcart e-Commerce plugin (also known as usc-e-shop) affecting versions prior to 2.8.5. The vulnerability exists in the `content-log.php` file where the plugin fails to validate user input in the `logfile` parameter before using it to output file contents. This allows unauthenticated attackers to read arbitrary files on the server through path traversal, potentially exposing sensitive information such as configuration files, credentials, and other system data. The vulnerability is classified as CWE-552 (Files or Directories Accessible to External Parties) with a CVSS v3.1 score of 7.5 (High severity), indicating network-based exploitation with no authentication required and high confidentiality impact.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending HTTP GET requests to the vulnerable `content-log.php` endpoint with path traversal payloads in the `logfile` parameter. It attempts to read two common system files:

1. `/etc/passwd` on Unix/Linux systems
2. `/Windows/win.ini` on Windows systems

The detection logic verifies successful exploitation through three conditions:
- Response contains `text/html` content-type header
- Response body matches patterns indicating successful file read:
  - Unix: `root:.*:0:0:` (passwd file format)
  - Windows: `\[(font|extension|file)s\]` (win.ini file sections)
- HTTP status code 200

The template uses stop-at-first-match to halt after successfully reading either file, confirming the arbitrary file access vulnerability.

## References

- https://wpscan.com/vulnerability/0d649a7e-3334-48f7-abca-fff0856e12c7
- https://wordpress.org/plugins/usc-e-shop/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4140
