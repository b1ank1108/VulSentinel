---
cve_id: CVE-2022-27228
template_path: nuclei-templates/http/cves/2022/CVE-2022-27228.yaml
affected_product: Bitrix Site Manager
severity: critical
authentication: none
external_callback: false
affected_versions: before 21.0.100
preconditions: [vote (Polls, Votes) module installed]
poc_classification: rce
---

## Vulnerability
Bitrix Site Manager's vote (aka "Polls, Votes") module before 21.0.100 contains a critical remote code execution flaw (CVE-2022-27228, CVSS 9.8). Remote unauthenticated attackers can trigger arbitrary code execution via insecure file-upload handling and CAllAgent event registration in `/bitrix/tools/vote/uf.php`. Impact: full system compromise. Remediation: update to 21.0.100 or later. CWE-20.

## PoC / Detection
Classification: rce

The template chains two requests to verify the vulnerable path. First, GET `/bitrix/admin/` extracts `bitrix_sessid` via regex from the body (internal check for presence of `bitrix_sessid`). Second, POST multipart/form-data to `/bitrix/tools/vote/uf.php?attachId[ENTITY_TYPE]=CFileUploader&attachId[ENTITY_ID][events][onFileIsStarted][]=CAllAgent&attachId[ENTITY_ID][events][onFileIsStarted][]=Update&attachId[MODULE_ID]=vote&action=vote` uploads a random `.jpg` file (with random marker content) using the extracted session ID and specific `bxu_*` fields. Detection succeeds on HTTP 200 + `"status":"done"` in response body. This harmless upload probe confirms the RCE condition in the vote module's agent handler.

## References
- https://alt3r.eg0.ru/p0c5/attacking_bitrix.pdf
- https://pentestnotes.ru/notes/bitrix_pentest_full/#rce-vote_agentphp-cve-2022-27228
- https://nvd.nist.gov/vuln/detail/CVE-2022-27228
