---
cve_id: CVE-2022-35507
template_path: nuclei-templates/http/cves/2022/CVE-2022-35507.yaml
affected_product: Proxmox
severity: high
authentication: none
external_callback: false
affected_versions: pve-http-server prior to 4.1-3
preconditions: []
poc_classification: dos
---

## Vulnerability
Response-header CRLF injection in Proxmox Virtual Environment (PVE) and Proxmox Mail Gateway (PMG) web interfaces (CVE-2022-35507, CWE-74). Remote unauthenticated attacker can inject arbitrary headers via %0d sequences in request path/URI, enabling Set-Cookie with oversized values. This triggers client-side DoS in Chromium-based browsers (cookie length exceeds browser limits) and may facilitate session fixation. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:H (7.1). Fixed in pve-http-server 4.1-3 by stripping CRLF from response headers.

## PoC / Detection
Classification: dos

Template sends raw GET `/404%0dnew-header:value%0da:` (CRLF injection in path) and matches on `contains(all_headers, 'new-header:value')` AND `status_code == 501` to confirm the server reflects the injected header in its response.

## References
- https://git.proxmox.com/?p=pve-http-server.git%3Ba=commitdiff%3Bh=936007ae0241811093155000486da171379c23c2
- https://github.com/advisories/GHSA-xfgp-gpjw-wmqr
- https://starlabs.sg/blog/2022/12-multiple-vulnerabilites-in-proxmox-ve--proxmox-mail-gateway/#bug-0x02-crlf-injection-in-response-headers
