---
cve_id: CVE-2022-0814
template_path: nuclei-templates/http/cves/2022/CVE-2022-0814.yaml
affected_product: Ubigeo de Peru
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.6.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Ubigeo de Peru WordPress plugin does not properly sanitise and escape parameters before using them in SQL statements via various AJAX actions (some available to unauthenticated users), leading to SQL injection. Unauthenticated attackers can exploit this to extract usernames and password hashes from the WordPress database. Fixed in version 3.6.4. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-89.

## PoC / Detection
Classification: info-leak

The template sends an unauthenticated POST request to `/wp-admin/admin-ajax.php` containing `action=rt_ubigeo_load_distritos_address` and a UNION SELECT SQL injection payload in the `idProv` parameter that extracts `user_login` and `user_pass` (WHERE ID=1) from `wp_users`. It detects success if the response returns status 200, `text/html` Content-Type header, and body contains the strings `idProv`, `idDist`, and `distrito` (confirming the plugin AJAX handler processed the injected query without SQL error).

## References
- https://wpscan.com/vulnerability/fd84dc08-0079-4fcf-81c3-a61d652e3269
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0814
- https://wordpress.org/plugins/ubigeo-peru/
- https://github.com/cyllective/CVEs
