---
cve_id: CVE-2022-0928
template_path: nuclei-templates/http/cves/2022/CVE-2022-0928.yaml
affected_product: Microweber
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.2.12
preconditions: [Authenticated user with access to Add/Edit Tax functionality in admin panel]
poc_classification: state-change
---

## Vulnerability

CVE-2022-0928 is a stored cross-site scripting (XSS) vulnerability in Microweber versions prior to 1.2.12. The vulnerability exists in the tax management functionality, specifically in the Type parameter of the Add/Edit Tax feature. When an attacker with authenticated access submits a malicious payload through the Type parameter in a POST request to `/api/shop/save_tax_item`, the unsanitized input is stored and later reflected in the admin interface without proper encoding. This allows the execution of arbitrary JavaScript code in the context of other users' browsers when they view the tax list, potentially leading to session hijacking, defacement, or theft of sensitive information. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N), indicating it requires low privileges and user interaction but has a changed scope.

## PoC / Detection

Classification: state-change

The template performs an authenticated exploitation test through three sequential HTTP requests:

1. **Authentication**: Logs into the Microweber application via `/api/user_login` using provided credentials
2. **Payload Injection**: Submits a stored XSS payload to `/api/shop/save_tax_item` with the malicious Type parameter value `"><img src=x onerror=alert(document.domain)>` along with tax item details (name=vat1, rate=10)
3. **Verification**: Retrieves the tax list module via `/module` endpoint to confirm the payload was stored and is reflected in the HTML response

The template confirms successful exploitation by checking that:
- The injected XSS payload `<img src=x onerror=alert(document.domain)>` appears unescaped in the third response body
- The response content type is text/html
- Both the injection (request 2) and verification (request 3) requests return HTTP 200 status codes

## References

- https://huntr.dev/bounties/085aafdd-ba50-44c7-9650-fa573da29bcd
- https://github.com/microweber/microweber/commit/fc9137c031f7edec5f50d73b300919fb519c924a
- https://nvd.nist.gov/vuln/detail/CVE-2022-0928
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
