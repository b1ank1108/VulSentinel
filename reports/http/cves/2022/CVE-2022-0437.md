---
cve_id: CVE-2022-0437
template_path: nuclei-templates/http/cves/2022/CVE-2022-0437.yaml
affected_product: karma-runner
severity: medium
authentication: none
external_callback: false
affected_versions: < 6.3.14
preconditions: []
poc_classification: detect-only
---

## Vulnerability
karma-runner (NPM package `karma`) contains a DOM-based Cross-Site Scripting vulnerability prior to 6.3.14. An attacker can craft malicious URLs that, when visited, execute arbitrary JavaScript in the victim's browser context. Successful exploitation could allow data theft, session hijacking, or defacement. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Affects Node.js deployments.

## PoC / Detection
Classification: detect-only

The template detects affected instances via version fingerprinting. It performs two GET requests: first to `{{BaseURL}}/karma.js` to extract the version string via regex `(?m)VERSION: '([0-9.]+)'`, then to `{{BaseURL}}/?return_url=javascript:alert(document.domain)`. Matchers require `compare_versions(version, '< 6.3.14')`, the word "Karma" present in the second response body, and HTTP 200 status. No payload execution, reflection check, or out-of-band verification occurs.

## References
- https://huntr.dev/bounties/64b67ea1-5487-4382-a5f6-e8a95f798885
- https://github.com/karma-runner/karma/commit/839578c45a8ac42fbc1d72105f97eab77dd3eb8a
- https://nvd.nist.gov/vuln/detail/CVE-2022-0437
- https://github.com/karma-runner/karma
- https://github.com/ARPSyndicate/cvemon
