---
cve_id: CVE-2022-4897
template_path: nuclei-templates/http/cves/2022/CVE-2022-4897.yaml
affected_product: WordPress BackupBuddy plugin
severity: medium
authentication: required
external_callback: false
affected_versions: before 8.8.3
preconditions: [BackupBuddy plugin installed and activated on a WordPress site]
poc_classification: info-leak
---

## Vulnerability
WordPress BackupBuddy plugin before 8.8.3 contains a reflected cross-site scripting vulnerability. The plugin fails to sanitize and escape the `callback_data` parameter (and other parameters) before outputting them in admin AJAX responses and various locations. An attacker can inject arbitrary scripts that execute in the context of an unsuspecting user's browser (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1, CWE-79). Successful exploitation enables theft of cookie-based authentication credentials, session hijacking, or website defacement.

Impact: data theft, session hijacking, defacement.  
Remediation: update to 8.8.3 or later.

## PoC / Detection
Classification: info-leak

The template first authenticates by sending a POST to `/wp-login.php` with `log={{username}}&pwd={{password}}`. It then issues a GET to `/wp-admin/admin-ajax.php?action=pb_backupbuddy_backupbuddy&function=destination_picker&add=local&filter=local&callback_data=</script><svg/onload=alert(document.domain)>`. Detection confirms the vulnerability if status_code_2 == 200, body_2 contains the unsanitized payload string, and body_2 contains "BackupBudddy iFrame" (indicating the plugin interface rendered the response).

## References
- https://wpscan.com/vulnerability/7b0eeafe-b9bc-43b2-8487-a23d3960f73f
- https://nvd.nist.gov/vuln/detail/CVE-2022-4897
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
