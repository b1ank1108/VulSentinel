---
cve_id: CVE-2022-30513
template_path: nuclei-templates/http/cves/2022/CVE-2022-30513.yaml
affected_product: School Dormitory Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability

School Dormitory Management System version 1.0 contains an authenticated cross-site scripting (XSS) vulnerability in the admin panel navigation component (admin/inc/navigation.php:125). The vulnerability allows authenticated attackers to inject arbitrary JavaScript code through the `page` parameter, which is reflected in the application response without proper sanitization. This stored/reflected XSS can be exploited to execute malicious scripts in the context of other authenticated users' sessions, enabling session hijacking, credential theft, and other client-side attacks. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), though exploitation requires authentication despite the PR:N metric.

## PoC / Detection

Classification: state-change

The template performs a two-step authenticated exploitation test:

1. **Authentication**: Sends a POST request to `/dms/admin/login.php?f=login` with username and password credentials to establish an authenticated session
2. **XSS Injection**: Sends a GET request to `/dms/admin/?page=%27%3B%20alert(document.domain)%3B%20s%3D%27` which injects the payload `'; alert(document.domain); s=''` through the page parameter

The template verifies successful exploitation by checking for:
- The reflected XSS payload `''; alert(document.domain); s='';` in the response body
- The presence of "School Dormitory Management System" text confirming the application context
- HTTP 200 status code

The detection confirms that the injected JavaScript payload is reflected without sanitization, demonstrating the XSS vulnerability can be exploited to execute arbitrary client-side code in authenticated user sessions.

## References

- https://github.com/bigzooooz/CVE-2022-30513
- https://www.sourcecodester.com/php/15319/school-dormitory-management-system-phpoop-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-30513
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/trhacknon/Pocingit
