---
cve_id: CVE-2022-2185
template_path: nuclei-templates/http/cves/2022/CVE-2022-2185.yaml
affected_product: GitLab CE/EE
severity: high
authentication: required
external_callback: false
affected_versions: GitLab CE/EE 14.0 prior to 14.10.5, 15.0 prior to 15.0.4, and 15.1 prior to 15.1.1
preconditions: authenticated user authorized to import projects
poc_classification: rce
---

## Vulnerability
GitLab CE/EE 14.0 prior to 14.10.5, 15.0 prior to 15.0.4, and 15.1 prior to 15.1.1 is susceptible to remote code execution (CWE-78). An authenticated user authorized to import projects can import a maliciously crafted project, executing arbitrary code, obtaining sensitive information, modifying data, or gaining full system control without additional credentials.  
CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).  
Impact: arbitrary code execution on the server.  
Remediation: apply the latest security patches provided by GitLab.

## PoC / Detection
Classification: rce

The template issues a single GET request to `{{BaseURL}}/users/sign_in` (with up to 3 redirects) and performs an OR match against 34 specific 64-character hexadecimal strings in the response body; these strings are version-specific asset hashes harvested from vulnerable GitLab releases. It also extracts a 64-character application CSS digest via the regex `(?:application-)(\S{64})(?:\.css)` to fingerprint the exact vulnerable version. No exploit payload is sent; this is a passive version-detection probe.

## References
- https://gitlab.com/gitlab-com/gl-security/threatmanagement/redteam/redteam-public/cve-hash-harvester
- https://gitlab.com/gitlab-org/cves/-/blob/master/2022/CVE-2022-2185.json
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2185
- https://nvd.nist.gov/vuln/detail/CVE-2022-2185
- https://gitlab.com/gitlab-org/gitlab/-/issues/366088
