---
cve_id: CVE-2022-25356
template_path: nuclei-templates/http/cves/2022/CVE-2022-25356.yaml
affected_product: Alt-n/MDaemon Security Gateway
severity: medium
authentication: none
external_callback: false
affected_versions: <=8.5.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
XML injection in Alt-n/MDaemon Security Gateway through 8.5.0 via the `/SecurityGateway.dll?view=login` endpoint. An attacker appends an arbitrary parameter to the login URL, causing the backend XML parser to fail validation and return error output that leaks internal data (2FA protection status, administrator email, product registration keys). CVSS 5.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N), CWE-91. Successful exploitation enables information disclosure and may facilitate privilege escalation.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/SecurityGateway.dll?view=login&redirect=true&9OW4L7RSDY=1` (the random parameter triggers injection) and verifies the response with status 200 containing all of: the string "Exception: Error while [Loading XML", the escaped tag `&lt;RegKey&gt;`, and the escaped tag `&lt;IsAdmin&gt;`. This confirms the parser failure and resulting leakage of sensitive XML elements.

## References
- https://www.swascan.com/security-advisory-alt-n-security-gateway/
- https://www.altn.com/Products/SecurityGateway-Email-Firewall/
- https://www.swascan.com/security-blog/
- https://nvd.nist.gov/vuln/detail/CVE-2022-25356
- https://github.com/ARPSyndicate/cvemon
