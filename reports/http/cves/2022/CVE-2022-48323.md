---
cve_id: CVE-2022-48323
template_path: nuclei-templates/http/cves/2022/CVE-2022-48323.yaml
affected_product: Sunlogin Sunflower
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0.1.43315
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2022-48323 is a critical path traversal vulnerability in Sunlogin Sunflower Simplified (also known as Sunflower Simple and Personal) version 1.0.1.43315. The vulnerability allows remote, unauthenticated attackers to execute arbitrary programs on the victim host by exploiting improper validation of command parameters. Attackers can traverse the file system path using directory traversal sequences (e.g., `../`) in the `cmd` parameter of the `/check` endpoint to reach and execute system executables like PowerShell. This enables full remote code execution capabilities without any authentication requirements. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS score of 9.8, indicating maximum severity across confidentiality, integrity, and availability impacts.

## PoC / Detection

Classification: rce

The template performs a two-step detection process to verify the remote code execution vulnerability:

1. **Session Establishment**: Sends a POST request to `/cgi-bin/rpc` with the action `verify-haras` to obtain a session identifier (CID) from the response's `verify_string` field.

2. **RCE Verification**: Uses the extracted CID in a Cookie header to send a GET request to `/check?cmd=ping../../../windows/system32/windowspowershell/v1.0/powershell.exe+ipconfig`. This crafted request exploits the path traversal vulnerability to execute PowerShell with the `ipconfig` command.

The template confirms successful exploitation by checking for:
- HTTP 200 responses from both requests
- Presence of `verify_string` in the first response
- Presence of `Windows IP` in the second response (indicating successful PowerShell execution of ipconfig)

## References

- https://www.1024sou.com/article/741374.html
- https://copyfuture.com/blogs-details/202202192249158884
- https://www.cnvd.org.cn/flaw/show/CNVD-2022-10270
- https://www.cnvd.org.cn/flaw/show/CNVD-2022-03672
- https://asec.ahnlab.com/en/47088/
