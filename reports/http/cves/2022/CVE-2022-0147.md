---
cve_id: CVE-2022-0147
template_path: nuclei-templates/http/cves/2022/CVE-2022-0147.yaml
affected_product: WordPress Cookie Information/Free GDPR Consent Solution
severity: medium
authentication: required
external_callback: false
affected_versions: <2.0.8
preconditions: [wp-gdpr-compliance plugin installed and activated]
poc_classification: info-leak
---

## Vulnerability
WordPress Cookie Information/Free GDPR Consent Solution (wp-gdpr-compliance) plugin prior to version 2.0.8 contains a reflected cross-site scripting (XSS) vulnerability in the admin dashboard via unsanitized handling of the 'x' parameter. An attacker can craft a malicious link to the admin page that, when visited by a logged-in administrator, executes arbitrary JavaScript in the victim's browser. This enables stealing cookie-based authentication credentials, session hijacking, or other attacks. CVSS: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). CWE-79.

## PoC / Detection
Classification: info-leak

The template performs a login to /wp-login.php using {{username}} and {{password}}, followed by a GET request to `/wp-admin/admin.php?page=wp-gdpr-compliance&x=%27+onanimationstart%3Dalert%28document.domain%29+style%3Danimation-name%3Arotation+x`. It detects the issue if the response body contains the reflected payload (escaped as "x=\\' onanimationstart=alert(document.domain) style=animation-name:rotation x'"), the page identifier "toplevel_page_wp-gdpr-compliance", HTTP 200 status, and text/html content-type.

## References
- https://wpscan.com/vulnerability/2c735365-69c0-4652-b48e-c4a192dfe0d1
- https://wordpress.org/plugins/wp-gdpr-compliance/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0147
- https://plugins.trac.wordpress.org/changeset/2681371
- https://github.com/ARPSyndicate/kenzer-templates
