---
cve_id: CVE-2022-31974
template_path: nuclei-templates/http/cves/2022/CVE-2022-31974.yaml
affected_product: Online Fire Reporting System
severity: high
authentication: required
external_callback: false
affected_versions: v1.0
preconditions: [Access to admin panel required]
poc_classification: info-leak
---

## Vulnerability

Online Fire Reporting System v1.0 contains a SQL injection vulnerability in the admin panel's reports page. The vulnerability exists in the `date` parameter of the `/ofrs/admin/?page=reports&date=` endpoint, where user-supplied input is not properly sanitized before being used in SQL queries.

This is a classic SQL injection flaw (CWE-89) that allows attackers to inject arbitrary SQL commands through the vulnerable parameter. The CVSS score of 7.2 (High) reflects the significant impact potential, though the CVSS metrics indicate that high privileges (PR:H) are required for exploitation, meaning the attacker must have administrative access to the system.

Successful exploitation could enable an attacker to:
- Execute arbitrary SQL queries against the backend database
- Extract sensitive data including user credentials, personal information, and system data
- Modify or delete database records
- Potentially escalate privileges or compromise the entire database server

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a UNION-based SQL injection payload to the vulnerable `date` parameter. The detection method:

1. Sends a GET request to `/admin/?page=reports&date=` with a crafted SQL injection payload
2. The payload uses a UNION SELECT statement to inject a controlled value: `2022-05-27' union select 1,2,3,md5('999999999'),5,6,7,8,9,10--+`
3. The injection attempts to return the MD5 hash of a random number (999999999) in the fourth column position
4. Verifies successful injection by checking if the response body contains the expected MD5 hash value
5. Confirms the response is HTML content (text/html header) with HTTP status 200

The template uses a time-based marker (MD5 hash of a unique number) to definitively prove that injected SQL code was executed and its output was reflected in the application response, confirming the SQL injection vulnerability.

## References

- https://github.com/debug601/bug_report/blob/main/vendors/oretnom23/online-fire-reporting-system/SQLi-1.md
- https://www.sourcecodester.com/php/15346/online-fire-reporting-system-phpoop-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-31974
