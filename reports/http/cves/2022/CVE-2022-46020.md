---
cve_id: CVE-2022-46020
template_path: nuclei-templates/http/cves/2022/CVE-2022-46020.yaml
affected_product: WBCE CMS
severity: critical
authentication: required
external_callback: false
affected_versions: 1.5.4
preconditions: []
poc_classification: rce
---

## Vulnerability
WBCE CMS v1.5.4 contains an unrestricted file upload vulnerability (CWE-434) in the integrated elFinder file manager. Authenticated administrators can bypass file-type restrictions, upload arbitrary PHP files to the `/media/` directory, and achieve remote code execution when the files are requested by the web server.  
Impact: full server compromise with arbitrary code execution.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: upgrade to v1.5.5 or later.

## PoC / Detection
Classification: rce

The template executes a complete authenticated exploit chain to confirm RCE:  
- GET `/admin/login/index.php` and regex-extract dynamic `username_fieldname`, `password_fieldname`.  
- POST login credentials to `/admin/login/index.php`.  
- GET `/admin/settings/index.php?advanced=yes` and extract `formtoken` + `app_name`.  
- POST configuration changes (including directory paths and app settings) to `/admin/settings/save.php`.  
- Multipart POST to `/modules/elfinder/ef/php/connector.wbce.php` (cmd=upload, target=l1_Lw) uploading `{{randstr}}.php` containing `<?php echo md5("CVE-2022-46020"); ?>`.  
- GET `/media/{{randstr}}.php` and match the MD5 hash `751a8ba516522786d551075a092a7a84` in body, `text/html` content-type, and status 200.  
The probe is intrusive, requires valid admin credentials, and directly executes the uploaded payload.

## References
- https://github.com/WBCE/WBCE_CMS
- https://github.com/10vexh/Vulnerability/blob/main/WBCE%20CMS%20v1.5.4%20getshell.pdf
- https://nvd.nist.gov/vuln/detail/CVE-2022-46020
