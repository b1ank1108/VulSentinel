---
cve_id: CVE-2022-28923
template_path: nuclei-templates/http/cves/2022/CVE-2022-28923.yaml
affected_product: Caddy
severity: medium
authentication: none
external_callback: false
affected_versions: 2.4.6
preconditions: []
---

## Vulnerability

CVE-2022-28923 is an open redirect vulnerability affecting Caddy version 2.4.6. The vulnerability allows an attacker to craft malicious URLs that redirect users to attacker-controlled sites. This can be exploited to conduct phishing attacks, steal credentials, or trick users into visiting malicious websites. The flaw is classified as CWE-601 (URL Redirection to Untrusted Site) with a CVSS score of 6.1 (Medium severity). The vulnerability requires user interaction (clicking a malicious link) but no authentication, and has a changed scope, meaning the vulnerable component can affect resources beyond its security scope.

## PoC / Detection

Classification: **detect-only**

The template detects this vulnerability by sending a GET request to a specially crafted path: `/%5C%5Cinteract.sh/%252e%252e%252f`. This path uses URL encoding to construct a redirect sequence that attempts to redirect to `interact.sh`. The template checks the HTTP response headers for a `Location` header that matches a pattern indicating a redirect to `interact.sh` or similar domains. The regex matcher specifically looks for redirect patterns in the Location header that would send users to external domains, confirming the presence of the open redirect vulnerability. The template does not actually exploit the vulnerability to redirect to a malicious site, but rather verifies that the server improperly handles the crafted URL and generates a redirect response.

## References

- https://lednerb.de/en/publications/responsible-disclosure/caddy-open-redirect-vulnerability/
- https://www.cve.org/CVERecord?id=CVE-2022-28923
- https://github.com/caddyserver/caddy/issues/4502
- https://nvd.nist.gov/vuln/detail/CVE-2022-28923
- https://github.com/ARPSyndicate/cvemon
