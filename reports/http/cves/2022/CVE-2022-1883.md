---
cve_id: CVE-2022-1883
template_path: nuclei-templates/http/cves/2022/CVE-2022-1883.yaml
affected_product: Terraboard
severity: high
authentication: none
external_callback: false
affected_versions: <2.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Terraboard versions prior to 2.2.0 contain a SQL injection vulnerability (CWE-89) in the search API endpoint. The vulnerability exists in the `/api/search/attribute` endpoint where the `tf_version` parameter is not properly sanitized, allowing attackers to inject arbitrary SQL commands. This is a time-based blind SQL injection flaw that can be exploited to execute unauthorized SQL queries against the backend PostgreSQL database. The CVSS score of 8.8 (High) indicates significant risk, with the potential for unauthorized access to sensitive information, data modification, and execution of administrative operations. The vulnerability requires low attack complexity and no user interaction, making it readily exploitable over the network.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a crafted GET request to the `/api/search/attribute` endpoint with a malicious `tf_version` parameter containing a PostgreSQL time-based blind SQL injection payload: `' and (select pg_sleep(7)) ISNULL--`. This payload attempts to trigger a 7-second delay in the database response if the injection is successful.

The detection mechanism verifies exploitation through three conditions:
1. The HTTP response duration is 7 seconds or longer (indicating the `pg_sleep(7)` command executed)
2. The response body contains JSON structure markers (`"page":` and `"results":`)
3. The HTTP status code is 200

The template uses a 15-second timeout to accommodate the intentional delay. This time-based approach confirms the SQL injection vulnerability without requiring visible error messages or data extraction, making it effective against blind SQL injection scenarios.

## References

- https://huntr.dev/bounties/a25d15bd-cd23-487e-85cd-587960f1b9e7/
- https://github.com/camptocamp/terraboard/commit/2a5dbaac015dc0714b41a59995e24f5767f89ddc
- https://huntr.dev/bounties/a25d15bd-cd23-487e-85cd-587960f1b9e7
- https://nvd.nist.gov/vuln/detail/CVE-2022-1883
- https://github.com/ARPSyndicate/kenzer-templates
