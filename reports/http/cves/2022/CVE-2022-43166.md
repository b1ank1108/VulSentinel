---
cve_id: CVE-2022-43166
template_path: nuclei-templates/http/cves/2022/CVE-2022-43166.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: []
poc_classification: state-change
---

## Vulnerability
A stored cross-site scripting (XSS) vulnerability in the Global Entities feature (/index.php?module=entities/entities) of Rukovoditel <= 3.2.1 allows authenticated attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the Name parameter after clicking "Add New Entity".

Impact includes execution of malicious scripts in the victim's browser context, potentially leading to data theft, session hijacking, or application defacement. CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4), CWE-79.

## PoC / Detection
Classification: state-change

The template simulates exploitation by: 1) GET /index.php?module=users/login to fetch nonce, 2) POST login with username/password and nonce to establish authenticated session, 3) POST /index.php?module=entities/&action=save with entity name set to `<script>alert(document.domain)</script>`. It matches on status_code_3 == 200, HTML content-type, presence of the unsanitized script payload in body_3, and "rukovoditel" string to confirm the stored payload.

## References
- https://github.com/anhdq201/rukovoditel/issues/2
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-43166
