---
cve_id: CVE-2022-0869
template_path: nuclei-templates/http/cves/2022/CVE-2022-0869.yaml
affected_product: spirit
severity: medium
authentication: none
external_callback: false
affected_versions: < 0.12.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-0869 is an open redirect vulnerability affecting the nitely/spirit project prior to version 0.12.3. Multiple endpoints in the application fail to properly validate the `next` parameter, allowing attackers to craft malicious URLs that redirect users to arbitrary external domains. This vulnerability is classified as CWE-601 (URL Redirection to Untrusted Site) with a CVSS v3.1 score of 6.1 (Medium severity). The flaw enables attackers to redirect users to malicious websites, facilitating phishing attacks or the theft of sensitive information by exploiting user trust in legitimate application URLs.

The vulnerability affects multiple user-facing endpoints including login, logout, registration, and account activation pages, all of which accept and process the `next` parameter without adequate validation of the redirect destination.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending GET requests to four different endpoints that accept a `next` parameter:
- `/user/login/?next=https%3A%2F%2Finteract.sh`
- `/user/logout?next=https%3A%2F%2Finteract.sh`
- `/user/register?next=https%3A%2F%2Finteract.sh`
- `/user/resend-activation?next=https%3A%2F%2Finteract.sh`

The template uses a stop-at-first-match strategy and checks for a successful redirect by matching the `Location` header in the HTTP response against a regex pattern that identifies redirects to the interact.sh domain. The regex pattern detects various redirect formats including absolute URLs, protocol-relative URLs, and path-based redirects that ultimately point to an external domain. A positive match indicates the application is vulnerable to open redirect attacks, as it accepts and processes untrusted redirect destinations without proper validation.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2022-0869
- https://huntr.dev/bounties/ed335a88-f68c-4e4d-ac85-f29a51b03342
- https://github.com/nitely/spirit/commit/8f32f89654d6c30d56e0dd167059d32146fb32ef
