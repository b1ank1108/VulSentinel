---
cve_id: CVE-2022-3768
template_path: nuclei-templates/http/cves/2022/CVE-2022-3768.yaml
affected_product: WordPress WPSmartContracts plugin
severity: high
authentication: required
external_callback: false
affected_versions: <1.3.12
preconditions: authenticated as WordPress author or higher role
poc_classification: state-change
---

## Vulnerability
WordPress WPSmartContracts plugin before 1.3.12 contains a SQL injection vulnerability. The plugin does not properly sanitize and escape the `collection_id` parameter before using it in a SQL statement on the NFT batch mint admin page (`/wp-admin/edit.php?post_type=nft&page=nft-batch-mint`). An authenticated attacker with author role or higher can execute arbitrary SQL queries, potentially leading to sensitive information disclosure, data modification, and unauthorized administrative operations. Fixed in 1.3.12. CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H). CWE-89.

## PoC / Detection
Classification: state-change

The template first sends a POST request to `/wp-login.php` with `log={{username}}&pwd={{password}}` to authenticate. It then sends a GET request to `/wp-admin/edit.php?post_type=nft&page=nft-batch-mint&step=4&collection_id=1+AND+(SELECT+7741+FROM+(SELECT(SLEEP(7)))hlAf)&uid=1` that injects a time-based blind SQL payload. The vulnerability is confirmed if the second response has `duration >= 7`, status code 200, `text/html` content-type, and body contains "Batch Mint NFTs".

## References
- https://wpscan.com/vulnerability/1d8bf5bb-5a17-49b7-a5ba-5f2866e1f8a3
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3768
- https://cve.report/CVE-2022-3768
- https://bulletin.iese.de/post/wp-smart-contracts_1-3-11/
- https://github.com/ARPSyndicate/cvemon
