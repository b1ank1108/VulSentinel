---
cve_id: CVE-2022-33965
template_path: nuclei-templates/http/cves/2022/CVE-2022-33965.yaml
affected_product: WordPress Visitor Statistics
severity: critical
authentication: none
external_callback: false
affected_versions: <=5.7
preconditions: []
poc_classification: state-change
---

## Vulnerability
WordPress Visitor Statistics plugin through version 5.7 contains multiple unauthenticated SQL injection (CWE-89) vulnerabilities. An unauthenticated remote attacker can execute arbitrary SQL queries via the `visitorId` parameter in the `wmcTrack` action, leading to sensitive data exposure, data modification, unauthorized administrative operations, and full site compromise. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Remediation requires update to >=5.8.

## PoC / Detection
Classification: state-change
The template performs a single unauthenticated time-based blind SQL injection probe by issuing the raw GET request `/?wmcAction=wmcTrack&url=test&uid=0&pid=0&visitorId=1331'+and+sleep(7)+or+'` (15 s timeout) to the target hostname. Detection succeeds on combined matchers: response duration >=7 s (sleep executed), HTTP 200 status, and regex match confirming payload reflection (`^1331' and sleep\(7\) or '$`).

## References
- https://patchstack.com/database/vulnerability/wp-stats-manager/wordpress-wp-visitor-statistics-plugin-5-7-multiple-unauthenticated-sql-injection-sqli-vulnerabilities
- https://wordpress.org/plugins/wp-stats-manager/
- https://wordpress.org/plugins/wp-stats-manager/#developers
- https://nvd.nist.gov/vuln/detail/CVE-2022-33965
- https://github.com/20142995/sectool
