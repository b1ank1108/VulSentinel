---
cve_id: CVE-2022-44949
template_path: nuclei-templates/http/cves/2022/CVE-2022-44949.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2022-44949 is a stored cross-site scripting (XSS) vulnerability in Rukovoditel version 3.2.1 and earlier. The vulnerability exists in the "Add New Field" function accessible at `/index.php?module=entities/fields&entities_id=24`. An authenticated attacker can inject malicious JavaScript or HTML code through the "Short Name" field when creating a new field. The injected payload is stored in the application and executed when other users view the affected page.

Successful exploitation allows an attacker to execute arbitrary web scripts in the context of victims' browsers, potentially leading to data theft, session hijacking, or defacement of the application. The CVSS v3.1 score is 5.4 (Medium), with the attack vector requiring network access, low attack complexity, low privileges (authenticated user), and user interaction. The scope is changed, with low impact to confidentiality and integrity.

## PoC / Detection

Classification: state-change

The template performs an authenticated stored XSS attack by:

1. **Authentication**: Sends a GET request to `/index.php?module=users/login` to retrieve the session token, then performs a POST login with credentials to establish an authenticated session.

2. **Payload Injection**: Submits a POST request to `/index.php?module=entities/fields&action=save` with multipart form data containing:
   - Entity ID: 24
   - Forms tabs ID: 29
   - Name: "test"
   - Short Name: `<script>alert(document.domain)</script>` (the XSS payload)
   - Field type: "fieldtype_input"

3. **Verification**: Confirms successful exploitation by checking that:
   - The response status is 200
   - Content-Type is text/html
   - The response body contains the injected payload `<script>alert(document.domain)</script>`
   - The response body contains "rukovoditel" (confirming the application context)

The template is marked as "intrusive" because it creates a stored XSS payload in the application database.

## References

- https://github.com/anhdq201/rukovoditel/issues/12
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-44949
- http://rukovoditel.com
