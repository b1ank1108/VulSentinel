---
cve_id: CVE-2022-29007
template_path: nuclei-templates/http/cves/2022/CVE-2022-29007.yaml
affected_product: Dairy Farm Shop Management System
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2022-29007 is a critical SQL injection vulnerability in Dairy Farm Shop Management System version 1.0. The vulnerability exists in the Admin panel login functionality, specifically in the username and password parameters. The flaw allows unauthenticated attackers to inject malicious SQL queries that bypass authentication controls. Due to improper input validation and sanitization (CWE-89), attackers can manipulate SQL queries to authenticate without valid credentials. Successful exploitation enables attackers to obtain sensitive information from the database, modify data, and execute unauthorized administrative operations within the application context. The CVSS score of 9.8 reflects the severity, with the vulnerability requiring no privileges, no user interaction, and being exploitable over the network.

## PoC / Detection

Classification: auth-bypass

The template detects this vulnerability by performing a SQL injection-based authentication bypass attack. It sends a POST request to `/dfsms/index.php` with a malicious payload in the username parameter (`admin' or '1'='1`) and an arbitrary password value. This SQL injection payload manipulates the authentication query to always evaluate to true, bypassing the login mechanism. The template then sends a follow-up GET request to `/dfsms/add-category.php`, an authenticated admin page. Detection is confirmed if the response contains specific indicators of successful admin access: the page title "Add Product", the text "Admin", and "DFSMS" (the application acronym), along with a 200 HTTP status code. The presence of these elements confirms that the SQL injection successfully bypassed authentication and granted administrative access.

## References

- https://www.exploit-db.com/exploits/50365
- https://phpgurukul.com/dairy-farm-shop-management-system-using-php-and-mysql/
- https://nvd.nist.gov/vuln/detail/CVE-2022-29007
- https://github.com/sudoninja-noob/CVE-2022-29007/blob/main/CVE-2022-29007.txt
- https://github.com/trhacknon/Pocingit
