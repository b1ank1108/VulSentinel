---
cve_id: CVE-2022-34753
template_path: nuclei-templates/http/cves/2022/CVE-2022-34753.yaml
affected_product: SpaceLogic C-Bus Home Controller
severity: high
authentication: required
external_callback: false
affected_versions: <=1.31.460
preconditions: []
poc_classification: rce
---

## Vulnerability
SpaceLogic C-Bus Home Controller through 1.31.460 is susceptible to remote command execution via improper neutralization of special elements. Remote root exploit can be enabled when the command is compromised, allowing execution of arbitrary commands (CWE-78).  

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).  
Impact: arbitrary command execution, malware deployment, sensitive information disclosure, data modification, full system control.  
Remediation: upgrade to a version higher than 1.31.460.

## PoC / Detection
Classification: rce

The template sends a raw GET request `GET /delsnap.pl?name=|id` (command injection via pipe in the `name` parameter) with Basic Authorization header using provided credentials (`{{username}}:{{password}}`). Detection succeeds on HTTP 200 status combined with regex match `uid=\d+\(([^)]+)\) gid=\d+\(([^)]+)\)` confirming the injected `id` command executed and returned its output.

## References
- https://www.zeroscience.mk/codes/SpaceLogic.txt
- https://download.schneider-electric.com/files?p_enDocType=Security+and+Safety+Notice&p_File_Name=SEVD-2022-193-02_SpaceLogic-C-Bus-Home-Controller-Wiser_MK2_Security_Notification.pdf
- http://packetstormsecurity.com/files/167783/Schneider-Electric-SpaceLogic-C-Bus-Home-Controller-5200WHC2-Remote-Root.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-34753
- https://github.com/nomi-sec/PoC-in-GitHub
