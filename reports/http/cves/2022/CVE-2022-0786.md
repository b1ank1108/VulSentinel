---
cve_id: CVE-2022-0786
template_path: nuclei-templates/http/cves/2022/CVE-2022-0786.yaml
affected_product: WordPress KiviCare plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <2.3.9
preconditions: []
poc_classification: state-change
---

## Vulnerability

WordPress KiviCare plugin versions before 2.3.9 is vulnerable to unauthenticated SQL injection. The vulnerability occurs because the `props_doctor_id` parameter (passed via `route_name=get_doctor_details` in the `ajax_get` action) is not sanitized before use in SQL statements at `/wp-admin/admin-ajax.php`.

An unauthenticated attacker can inject arbitrary SQL, leading to extraction of sensitive database information, data modification, and unauthorized administrative operations.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8, CWE-89)

## PoC / Detection
Classification: state-change

The template issues a single GET request injecting a time-based blind SQL payload `1,2)+AND+(SELECT+42+FROM+(SELECT(SLEEP(6)))b` into the `props_doctor_id` parameter. It verifies the vulnerability if the response duration is at least 6 seconds while still returning HTTP 200 with HTML content containing "Doctor details".

## References
- https://wpscan.com/vulnerability/53f493e9-273b-4349-8a59-f2207e8f8f30
- https://wordpress.org/plugins/kivicare-clinic-management-system/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0786
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
