---
cve_id: CVE-2022-37042
template_path: nuclei-templates/http/cves/2022/CVE-2022-37042.yaml
affected_product: Zimbra Collaboration Suite
severity: critical
authentication: none
external_callback: false
affected_versions: 8.8.15 and 9.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Zimbra Collaboration Suite (ZCS) 8.8.15 and 9.0 exposes mboximport functionality that accepts a ZIP archive and extracts its contents. An unauthenticated attacker (no authtoken required) can supply a malicious ZIP leveraging directory traversal to upload arbitrary files anywhere on the filesystem, resulting in remote code execution. This is an incomplete fix for CVE-2022-27925.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-22.

## PoC / Detection
Classification: rce  
The template performs an unauthenticated POST to `/service/extension/backup/mboximport` (two payload variants: `?account-name=admin&ow=2&no-switch=1&append=1` and `?account-name=admin&account-status=1&ow=cmd`) containing a hex-decoded ZIP archive. The archive uses `../../../` traversal to drop a JSP webshell at `/mailboxd/webapps/zimbraAdmin/0MVzAe6pgwe5go1D.jsp`. It then issues a GET to that JSP path and matches on HTTP 200 + the unique string `NcbWd0XGajaWS4DmOvZaCkxL1aPEXOZu` in the response body (while requiring the POST to return 401). Stops at first successful match.

## References
- https://www.volexity.com/blog/2022/08/10/mass-exploitation-of-unauthenticated-zimbra-rce-cve-2022-27925/
- https://blog.zimbra.com/2022/08/authentication-bypass-in-mailboximportservlet-vulnerability/
- https://github.com/vnhacker1337/CVE-2022-27925-PoC
- https://nvd.nist.gov/vuln/detail/CVE-2022-37042
- https://wiki.zimbra.com/wiki/Security_Center
