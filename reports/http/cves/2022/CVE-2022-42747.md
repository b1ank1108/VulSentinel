---
cve_id: CVE-2022-42747
template_path: nuclei-templates/http/cves/2022/CVE-2022-42747.yaml
affected_product: CandidATS
severity: medium
authentication: none
external_callback: false
affected_versions: 3.0.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-42747 is a reflected cross-site scripting (XSS) vulnerability in CandidATS version 3.0.0. The vulnerability exists in the `ajax.php` resource, specifically in the `sortBy` parameter of the `getPipelineJobOrder` function. The application fails to properly sanitize user-supplied input before reflecting it in the HTTP response, allowing an attacker to inject arbitrary JavaScript code. When a victim accesses a malicious URL containing the crafted payload, the injected script executes in the context of the victim's browser session. This can enable attackers to steal session cookies, perform actions on behalf of the victim, capture sensitive information, or redirect users to malicious sites. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity), requiring user interaction but no authentication.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the `/ajax.php` endpoint with a crafted `sortBy` parameter containing an XSS payload: `"><script>alert(document.domain)</script>`. The template verifies the vulnerability by checking for three conditions:

1. The injected script tag `<script>alert(document.domain)</script>` is reflected in the response body
2. The string "candidat" appears in the response body (confirming the application context)
3. The response has a Content-Type header of `text/html`
4. The HTTP status code is 404

The detection confirms that user input is reflected without proper sanitization, demonstrating the presence of the XSS vulnerability. The template uses a harmless proof-of-concept payload that would trigger a browser alert displaying the domain name if executed.

## References

- https://fluidattacks.com/advisories/modestep/
- https://fluidattacks.com/advisories/jcole/
- https://candidats.net/
- https://nvd.nist.gov/vuln/detail/CVE-2022-42747
