---
cve_id: CVE-2022-31474
template_path: nuclei-templates/http/cves/2022/CVE-2022-31474.yaml
affected_product: BackupBuddy
severity: high
authentication: none
external_callback: false
affected_versions: 8.5.8.0 - 8.7.4.1
preconditions: [BackupBuddy WordPress plugin installed and active]
poc_classification: info-leak
---

## Vulnerability
BackupBuddy WordPress plugin versions 8.5.8.0 - 8.7.4.1 are vulnerable to a local file inclusion vulnerability via the `download` and `local-destination-id` parameters (template uses `local-download` alias) on the `pb_backupbuddy_destinations` admin-post endpoint.

An attacker can exploit this vulnerability to gain unauthorized access to sensitive information stored on the server (arbitrary local file reads, e.g. `/etc/passwd`).

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5) | CWE-22 | Vendor: iThemes.

Remediation: Upgrade to at least version 8.7.5 or higher.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `{{BaseURL}}/wp-admin/admin-post.php?page=pb_backupbuddy_destinations&local-destination-id=/etc/passwd&local-download=/etc/passwd` and verifies success with HTTP status 200 combined with regex match for the root user entry (`root:.*:0:0:`) in the response body, confirming LFI by leaking system file contents.

##
