---
cve_id: CVE-2022-31706
template_path: nuclei-templates/http/cves/2022/CVE-2022-31706.yaml
affected_product: VMware vRealize Log Insight
severity: critical
authentication: none
external_callback: false
affected_versions: >= 8.0.0 and < 8.10.2 or >= 3.0 and < 4.8
preconditions: []
poc_classification: rce
---

## Vulnerability
VMware vRealize Log Insight contains a directory traversal vulnerability (CWE-22). An unauthenticated remote attacker can inject malicious files into the operating system of the impacted appliance, resulting in remote code execution and complete system compromise.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Remediation: update to version 8.10.2 or later.

## PoC / Detection
Classification: rce

The template performs unauthenticated GET requests to `/i18n/component/JS?locale=en-US` (stop-at-first-match) and `/api/v1/version`. It verifies status 200 and presence of "logInsight" or "releaseName" strings, extracts version via regex `version"\s*:\s*"([0-9.]+)`, then applies DSL `compare_versions` to flag vulnerable ranges.

## References
- http://packetstormsecurity.com/files/174606/VMware-vRealize-Log-Insight-Unauthenticated-Remote-Code-Execution.html
- https://www.vmware.com/security/advisories/VMSA-2023-0001.html
- https://nvd.nist.gov/vuln/detail/cve-2022-31706
