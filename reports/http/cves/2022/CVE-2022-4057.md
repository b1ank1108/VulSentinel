---
cve_id: CVE-2022-4057
template_path: nuclei-templates/http/cves/2022/CVE-2022-4057.yaml
affected_product: Autoptimize
severity: medium
authentication: none
external_callback: false
affected_versions: < 3.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-4057 is an information disclosure vulnerability in the Autoptimize WordPress plugin affecting versions prior to 3.1.0. The plugin stores exported settings and logs in a predictable, easily guessable path (`/wp-content/uploads/ao_ccss/queuelog.html`) that is publicly accessible without authentication. This design flaw (CWE-425: Direct Request) allows unauthorized attackers to directly access sensitive log files and configuration data by simply navigating to the known file path. The vulnerability has a CVSS score of 5.3 (Medium severity) with the impact limited to confidentiality breach (C:L/I:N/A:N), meaning attackers can read sensitive information but cannot modify data or cause service disruption.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by attempting to access the predictable log file path at two common WordPress installation locations:
1. `/wp-content/uploads/ao_ccss/queuelog.html` (standard installation)
2. `/blog/wp-content/uploads/ao_ccss/queuelog.html` (subdirectory installation)

The detection uses a GET request without any authentication credentials. The template confirms the vulnerability by checking for:
- HTTP 200 status code (successful access)
- Presence of specific log content markers in the response body: "Job id &lt;" and "log messages"

Both conditions must be satisfied to confirm the information disclosure. The template stops at the first successful match, indicating the log file is publicly accessible.

## References

- https://wpscan.com/vulnerability/95ee1b9c-1971-4c35-8527-5764e9ed64af
- https://wordpress.org/plugins/autoptimize/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4057
