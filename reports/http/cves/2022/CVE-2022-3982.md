---
cve_id: CVE-2022-3982
template_path: nuclei-templates/http/cves/2022/CVE-2022-3982.yaml
affected_product: WordPress Booking Calendar
severity: critical
authentication: none
external_callback: false
affected_versions: <3.2.2
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Booking Calendar plugin before 3.2.2 fails to validate uploaded files via the `wpdevart_form_ajax` action. Unauthenticated attackers can upload arbitrary PHP files to `/wp-content/uploads/booking_calendar/`, leading to remote code execution.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-434. Fixed in 3.2.2.

## PoC / Detection
Classification: rce

The template first GETs `/` to regex-extract the `wpdevart` ajaxNonce from inline JS, then issues a multipart POST to `/wp-admin/admin-ajax.php` (action=`wpdevart_form_ajax`, `wpdevart_id=x`, nonce, and a `{{randstr}}.php` file containing `<?php echo md5("CVE-2022-3982");unlink(__FILE__);?>`), finally GETs the uploaded path `/wp-content/uploads/booking_calendar/{{randstr}}.php` and matches the MD5 string in the body to confirm successful upload and PHP execution.

## References
- https://wpscan.com/vulnerability/4d91f3e1-4de9-46c1-b5ba-cc55b7726867
- https://wordpress.org/plugins/booking-calendar/
- https://nvd.nist.gov/vuln/detail/CVE-2022-3982
- https://github.com/cyllective/CVEs
