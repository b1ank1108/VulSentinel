---
cve_id: CVE-2022-31101
template_path: nuclei-templates/http/cves/2022/CVE-2022-31101.yaml
affected_product: Prestashop Blockwishlist
severity: high
authentication: required
external_callback: false
affected_versions: 2.0.0 to 2.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-31101 is a remote authenticated SQL injection vulnerability in the Prestashop Blockwishlist module version 2.1.0. The vulnerability exists due to improper sanitization of user input, allowing authenticated attackers to inject malicious SQL queries into the database. The flaw is classified as CWE-89 (SQL Injection) with a CVSS score of 8.1 (High severity).

Authenticated attackers can exploit this vulnerability to extract sensitive database information including customer details, order data, and administrator credentials from the PrestaShop database. The vulnerability requires low attack complexity and low privileges (authenticated user access), with no user interaction needed. The impact is rated as high for confidentiality and integrity, though availability is not affected according to the CVSS metrics.

The affected version range is 2.0.0 through 2.1.0 of the Blockwishlist module, as determined by the template's version comparison logic.

## PoC / Detection

Classification: info-leak

The template performs a multi-step detection process to verify the SQL injection vulnerability:

1. **Version Check**: Retrieves the module configuration file (`/modules/blockwishlist/config.xml`) and extracts the version number, verifying it falls within the vulnerable range (2.0.0 to 2.1.0).

2. **Account Creation**: Creates a new customer account on the PrestaShop instance with randomly generated credentials to establish authenticated access.

3. **Wishlist Setup**: Either retrieves an existing wishlist ID or creates a new wishlist and adds a product to it, establishing the necessary context for exploitation.

4. **SQL Injection Probe**: Sends a time-based blind SQL injection payload via the `order` parameter in the wishlist view endpoint: `/module/blockwishlist/view?id_wishlist=<id>&order=p.name, (select case when (1=1) then (SELECT SLEEP(7)) else 1 end); -- .asc`

5. **Verification**: Confirms the vulnerability by measuring response time (â‰¥7 seconds delay) and checking for PrestaShop-specific content in the response, indicating successful SQL injection execution.

The template uses a time-based blind SQL injection technique to verify the vulnerability without extracting actual data, making it a detection-focused proof of concept.

## References

- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31101
- https://github.com/PrestaShop/blockwishlist/security/advisories/GHSA-2jx3-5j9v-prpp
- https://packetstormsecurity.com/files/168003/Prestashop-Blockwishlist-2.1.0-SQL-Injection.html
