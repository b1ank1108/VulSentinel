---
cve_id: CVE-2022-1916
template_path: nuclei-templates/http/cves/2022/CVE-2022-1916.yaml
affected_product: WordPress Active Products Tables for WooCommerce plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <1.0.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-1916 is a reflected cross-site scripting (XSS) vulnerability in the WordPress Active Products Tables for WooCommerce plugin (also known as "woot" by vendor pluginus) affecting versions prior to 1.0.5. The vulnerability exists in an AJAX action handler (`woot_get_smth`) that fails to properly sanitize and escape user-supplied input before reflecting it in the HTTP response. Specifically, the `more_data` parameter within the AJAX request is not validated, allowing an attacker to inject arbitrary JavaScript code that executes in the context of a victim's browser session when they are tricked into visiting a malicious URL.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low impact to confidentiality and integrity.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the WordPress AJAX endpoint (`/wp-admin/admin-ajax.php`) with the vulnerable `woot_get_smth` action. The request includes a crafted payload in the query parameters where the `more_data` field contains a JavaScript alert payload: `<script>alert(document.domain)</script>`.

The template verifies the vulnerability through multiple matchers:
1. Confirms the injected script tag is reflected unescaped in the response body
2. Validates the response contains plugin-specific markers (`woot-content-in-popup`, `woot-system`, or `woot-table`) to confirm the AJAX handler processed the request
3. Checks the response has an HTML content type
4. Ensures a 200 OK status code

This detection approach confirms the XSS vulnerability exists by demonstrating that malicious JavaScript is reflected without sanitization, though the template uses a benign alert() for detection rather than exploiting the flaw for data exfiltration.

## References

- https://wpscan.com/vulnerability/d16a0c3d-4318-4ecd-9e65-fc4165af8808
- https://nvd.nist.gov/vuln/detail/CVE-2022-1916
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/cyllective/CVEs
