---
cve_id: CVE-2022-3142
template_path: nuclei-templates/http/cves/2022/CVE-2022-3142.yaml
affected_product: NEX-Forms Plugin
severity: high
authentication: required
external_callback: false
affected_versions: < 7.9.7
preconditions: [User must have permissions to view form statistics charts (default: administrators, but configurable via plugin settings)]
poc_classification: info-leak
---

## Vulnerability

The NEX-Forms WordPress plugin versions prior to 7.9.7 contains a SQL injection vulnerability in the form statistics dashboard functionality. The vulnerability exists due to improper sanitization and escaping of the `form_id` parameter before it is used in SQL statements. This allows authenticated users with form statistics viewing permissions (typically administrators, though this can be configured through plugin settings) to inject arbitrary SQL commands into database queries. The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 8.8, indicating high severity due to the potential for complete database compromise including extraction of user credentials, email addresses, and other sensitive site data.

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection detection by:

1. First authenticating to the WordPress admin panel using provided credentials via POST request to `/wp-login.php`
2. Sending a GET request to `/wp-admin/admin.php?page=nex-forms-dashboard` with a malicious `form_id` parameter containing a time-based SQL injection payload: `1+AND+(SELECT+42+FROM+(SELECT(SLEEP(7)))b)--`
3. Verifying the vulnerability by checking if:
   - The response takes 7 or more seconds to complete (indicating successful SQL injection with SLEEP command execution)
   - The response returns HTTP 200 status
   - The response body contains "NEX-Forms" text
   - The content type is "text/html"

The template uses a 30-second timeout to accommodate the intentional 7-second delay introduced by the SQL injection payload.

## References

- https://wpscan.com/vulnerability/8acc0fc6-efe6-4662-b9ac-6342a7823328/
- https://www.exploit-db.com/exploits/51042
- https://nvd.nist.gov/vuln/detail/CVE-2022-3142
- http://packetstormsecurity.com/files/171477/WordPress-NEX-Forms-SQL-Injection.html
- https://medium.com/%40elias.hohl/authenticated-sql-injection-vulnerability-in-nex-forms-wordpress-plugin-35b8558dd0f5
