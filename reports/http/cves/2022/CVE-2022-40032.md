---
cve_id: CVE-2022-40032
template_path: nuclei-templates/http/cves/2022/CVE-2022-40032.yaml
affected_product: Simple Task Managing System
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-40032 is a critical SQL injection vulnerability in Simple Task Managing System v1.0. The vulnerability exists in the `loginValidation.php` file where the `login` parameter is not properly validated or sanitized before being used in SQL queries. This allows unauthenticated attackers to inject malicious SQL code through the login form, enabling time-based blind SQL injection attacks. The vulnerability can be exploited to extract sensitive database information including user credentials, task data, and system configuration without requiring any authentication. The CVSS score of 9.8 reflects the severity of this flaw, as it allows network-based attacks with low complexity, requires no privileges or user interaction, and impacts confidentiality, integrity, and availability.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a POST request to `/task/loginValidation.php` with a crafted SQL injection payload in the `login` parameter. The payload uses a time-based blind SQL injection technique with a `SLEEP(10)` function embedded within conditional logic that queries the `INFORMATION_SCHEMA.SCHEMATA` table. The detection mechanism verifies the vulnerability by checking four conditions: (1) the response takes at least 10 seconds to complete (indicating the SQL injection executed successfully), (2) the server returns a 302 redirect status code, (3) the redirect location contains 'login.php', and (4) the content type is 'text/html'. The template uses a 30-second timeout to accommodate the intentional delay. This confirms that the application is vulnerable to time-based blind SQL injection, which can be leveraged to extract database contents character by character.

## References

- https://www.exploit-db.com/exploits/51273
- https://www.sourcecodester.com/php/15624/simple-task-managing-system-php-mysqli-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-40032
- http://packetstormsecurity.com/files/171739/Simple-Task-Managing-System-1.0-SQL-Injection.html
- https://www.sourcecodester.com/sites/default/files/download/razormist/Task%20Managing%20System%20in%20PHP.zip
