---
cve_id: CVE-2022-29006
template_path: nuclei-templates/http/cves/2022/CVE-2022-29006.yaml
affected_product: Directory Management System
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

Directory Management System 1.0 contains multiple SQL injection vulnerabilities in the Admin panel authentication mechanism. The vulnerabilities exist in the username and password parameters of the login functionality. An attacker can exploit these SQL injection flaws to bypass authentication without valid credentials and gain unauthorized administrative access to the system. The vulnerability allows attackers to manipulate SQL queries through specially crafted input, potentially enabling them to obtain sensitive information from the database, modify data, and execute unauthorized administrative operations. The CVSS score of 9.8 (Critical) reflects the severity of this flaw, which requires no authentication, has low attack complexity, and can result in complete compromise of confidentiality, integrity, and availability.

## PoC / Detection

Classification: auth-bypass

The template detects this SQL injection vulnerability by attempting to bypass authentication through SQL injection in the login form. It sends a POST request to `/admin/index.php` with a malicious SQL injection payload in the username parameter (`admin' or '1'='1`) and an arbitrary password value. This classic SQL injection technique attempts to manipulate the authentication query to always evaluate to true. Following the login attempt, the template sends a GET request to `/admin/dashboard.php` to verify successful authentication bypass. The detection confirms the vulnerability by checking for the presence of multiple strings indicating successful admin panel access: 'DMS || Dashboard', 'DMS Admin', and 'Admin Profile' in the response body, along with a 200 HTTP status code. The successful retrieval of the admin dashboard without valid credentials confirms the authentication bypass via SQL injection.

## References

- https://www.exploit-db.com/exploits/50370
- https://phpgurukul.com/directory-management-system-using-php-and-mysql/
- https://nvd.nist.gov/vuln/detail/CVE-2022-29006
- https://github.com/sudoninja-noob/CVE-2022-29006/blob/main/CVE-2022-29006.txt
- https://github.com/sudoninja-noob/CVE-2022-29006
