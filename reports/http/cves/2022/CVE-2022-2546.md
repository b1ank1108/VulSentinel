---
cve_id: CVE-2022-2546
template_path: nuclei-templates/http/cves/2022/CVE-2022-2546.yaml
affected_product: WordPress All-in-One WP Migration
severity: medium
authentication: required
external_callback: false
affected_versions: <=7.62
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress All-in-One WP Migration plugin <=7.62 contains a reflected cross-site scripting (XSS) vulnerability (CWE-79) in the `ai1wm_export` AJAX handler. Attacker-controlled input passed via the `options[replace][new_value]` parameter is reflected unsanitized in the JSON response, enabling arbitrary JavaScript execution in the context of any user who visits the crafted link (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N, score 4.7). Successful exploitation allows theft of cookie-based authentication credentials, session hijacking, site defacement, or further client-side attacks.

## PoC / Detection
Classification: info-leak

The template executes a three-request chain to confirm the reflected XSS: (1) POST to `/wp-login.php` with `{{username}}`/`{{password}}` to establish an authenticated session; (2) GET `/wp-admin/admin.php?page=ai1wm_export` to extract the per-session `secret_key` via regex `ai1wm_feedback"},"secret_key":"([0-9a-zA-Z]+)"`; (3) GET `/wp-admin/admin-ajax.php` with `action=ai1wm_export`, `ai1wm_import=1`, `ai1wm_manual_export=1`, and the XSS payload `XSSPAYLOAD<svg onload=alert(document.domain)>` inside `options[replace][new_value][]` plus the extracted `secret_key`. Detection succeeds when response #3 returns status 200, `text/html` Content-Type, and the literal unsanitized payload string appears inside the body.

## References
- https://wpscan.com/vulnerability/f84920e4-a1fe-47cf-9ba5-731989c70f58
- https://wordpress.org/plugins/all-in-one-wp-migration/
- https://patchstack.com/database/vulnerability/all-in-one-wp-migration/wordpress-all-in-one-wp-migration-plugin-7-62-unauthenticated-reflected-cross-site-scripting-xss-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2022-2546
- https://github.com/0xvinix/CVE-2022-2546
