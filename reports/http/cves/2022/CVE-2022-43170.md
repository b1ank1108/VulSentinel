---
cve_id: CVE-2022-43170
template_path: nuclei-templates/http/cves/2022/CVE-2022-43170.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: [Authenticated user with access to Dashboard Configuration feature]
poc_classification: state-change
---

## Vulnerability

CVE-2022-43170 is a stored cross-site scripting (XSS) vulnerability in Rukovoditel version 3.2.1 and earlier. The vulnerability exists in the Dashboard Configuration feature, specifically at the endpoint `index.php?module=dashboard_configure/index`. An authenticated attacker can inject malicious JavaScript or HTML code through the Title parameter when adding an info block. The injected payload is stored in the application and executed when other users view the affected dashboard, allowing the attacker to execute arbitrary web scripts in the context of victims' browsers. This can lead to data theft, session hijacking, or defacement of the application interface.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (Medium severity). The attack vector is network-based with low attack complexity, requires low privileges (authenticated user), and requires user interaction. The scope is changed, meaning the vulnerable component impacts resources beyond its security scope.

## PoC / Detection

Classification: state-change

The template performs authenticated exploitation to verify the stored XSS vulnerability through a three-step process:

1. **Initial GET request**: Retrieves the login page to extract the CSRF token (form_session_token)
2. **Authentication**: Submits credentials via POST to `/index.php?module=users/login&action=login` with the extracted CSRF token, username, and password
3. **XSS payload injection**: After successful authentication, sends a POST request to `/index.php?module=dashboard_configure/index&action=save` with a crafted payload containing `<script>alert(document.domain)</script>` in the `name` parameter (Title field)

The template verifies successful exploitation by checking that:
- The response returns HTTP 200
- The content type is text/html
- The response body contains the injected script tag exactly as submitted (indicating stored XSS)
- The response body contains "rukovoditel" (confirming the application context)

This demonstrates that the malicious payload is stored and reflected back without proper sanitization, confirming the stored XSS vulnerability.

## References

- https://github.com/anhdq201/rukovoditel/issues/6
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-43170
