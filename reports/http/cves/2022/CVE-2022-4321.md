---
cve_id: CVE-2022-4321
template_path: nuclei-templates/http/cves/2022/CVE-2022-4321.yaml
affected_product: PDF Generator for WordPress
severity: medium
authentication: none
external_callback: false
affected_versions: < 1.1.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

PDF Generator for WordPress versions prior to 1.1.2 contain a Reflected Cross-Site Scripting (XSS) vulnerability (CWE-79). The plugin includes a vendored dompdf example file (`Query.php`) that is susceptible to reflected XSS attacks. This vulnerability could be exploited against high-privilege users such as administrators. The CVSS v3.1 score is 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), indicating network-based exploitation with no privileges required but requiring user interaction.

The vulnerable endpoint is located at `/wp-content/plugins/pdf-generator-for-wp/package/lib/dompdf/vendor/dompdf/dompdf/I18N/Arabic/Examples/Query.php` and accepts unsanitized input through the `keyword` parameter, allowing injection of arbitrary JavaScript code that executes in the victim's browser context.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the vulnerable Query.php file with a crafted `keyword` parameter containing an XSS payload: `"><script>alert(document.domain)</script>`. 

The detection verifies exploitation by checking for three conditions:
1. The injected XSS payload (`><script>alert(document.domain)</script>`) is reflected in the response body
2. The response contains plugin-specific strings (`pdf-generator-for-wp` and `Total execution time is`) confirming the vulnerable file is present and executing
3. The response has a `text/html` content type and returns HTTP status 200

This confirms the presence of the vulnerable dompdf example file and that user-supplied input is reflected without proper sanitization, making XSS exploitation possible.

## References

- https://wpscan.com/vulnerability/6ac1259c-86d9-428b-ba98-7f3d07910644
- https://nvd.nist.gov/vuln/detail/CVE-2022-4321
- https://wordpress.org/plugins/pdf-generator-for-wp/
- https://github.com/ARPSyndicate/cvemon
- https://github.com/kwalsh-rz/github-action-ecr-scan-test
