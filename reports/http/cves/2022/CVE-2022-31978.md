---
cve_id: CVE-2022-31978
template_path: nuclei-templates/http/cves/2022/CVE-2022-31978.yaml
affected_product: Online Fire Reporting System
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Online Fire Reporting System v1.0 is vulnerable to SQL injection via `/ofrs/classes/Master.php?f=delete_inquiry` (CVE-2022-31978, CWE-89).  
The `id` parameter is unsanitized and directly concatenated into a SQL query inside the `delete_inquiry` function.  
Successful exploitation allows arbitrary SQL execution, leading to unauthorized access, data leakage, or data manipulation.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Remediation requires proper validation and sanitization of all user input before SQL usage.

## PoC / Detection
Classification: state-change  
The template issues one unauthenticated POST request to `/classes/Master.php?f=delete_inquiry` with the time-based blind SQLi payload `id='+AND+(SELECT+7774+FROM+(SELECT(SLEEP(6)))dPPt)+AND+'rogN'='rogN` in the form-urlencoded body.  
Matchers confirm exploitation if the response satisfies all of: duration â‰¥ 6 s, status_code == 200, content_type contains "text/html", and body contains `"status":"success"`.  
This verifies the injectable sink and confirms the endpoint can be abused for arbitrary SQL statements that modify database state (INSERT/UPDATE/DELETE/DROP).

## References
- https://github.com/debug601/bug_report/blob/main/vendors/oretnom23/online-fire-reporting-system/SQLi-5.md
- https://www.sourcecodester.com/php/15346/online-fire-reporting-system-phpoop-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-31978
