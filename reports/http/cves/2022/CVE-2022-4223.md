---
cve_id: CVE-2022-4223
template_path: nuclei-templates/http/cves/2022/CVE-2022-4223.yaml
affected_product: pgAdmin
severity: critical
authentication: none
external_callback: false
affected_versions: < 6.17
preconditions: []
poc_classification: rce
---

## Vulnerability
pgAdmin prior to 6.17 contains an insecure HTTP API caused by improper access control, allowing unauthenticated users to execute arbitrary external utilities via path manipulation in the `utility_path` parameter of the `/misc/validate_binary_path` endpoint. Exploit requires no authentication.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8).  
CWE-94, CWE-862.  
Impact: full remote code execution and potential server compromise.

## PoC / Detection
Classification: rce

Template performs a GET to `/login` to extract the `csrf_token` via regex, then issues a POST to `/misc/validate_binary_path` containing `{"utility_path":"/tmp/$(id)"}` (with the extracted CSRF token and proper Referer). Detection matcher confirms successful exploitation by checking HTTP 200 and presence of `uid=` + `gid=` strings in the JSON response body (output of the injected `id` command).

## References
- https://github.com/advisories/GHSA-3v6v-2x6p-32mc
- https://nvd.nist.gov/vuln/detail/CVE-2022-4223
