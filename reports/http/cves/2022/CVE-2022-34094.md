---
cve_id: CVE-2022-34094
template_path: nuclei-templates/http/cves/2022/CVE-2022-34094.yaml
affected_product: Software Publico Brasileiro i3geo
severity: medium
authentication: none
external_callback: false
affected_versions: 7.0.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Software Publico Brasileiro i3geo v7.0.5 contains a reflected cross-site scripting (XSS) vulnerability via request_token.php in the LinkedIn OAuth package. An unauthenticated attacker can inject malicious JavaScript through URL query parameters that is reflected unsanitized and executes in the victim's browser context.

Attackers can inject malicious JavaScript through parameters in the LinkedIn OAuth request_token.php endpoint that executes in users' browsers, potentially stealing session tokens or performing unauthorized actions in the i3geo geographic information system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1) | CWE-79.

Remediation: Update i3geo to a version later than 7.0.5 that properly sanitizes and encodes user input in request_token.php.

## PoC / Detection
Classification: info-leak

The template sends a single GET request to `{{BaseURL}}/i3geo/pacotes/linkedinoauth/example/request_token.php?=%3Cscript%3Ealert(document.domain)%3C/script%3E`. It verifies the vulnerability if the response meets all conditions: HTTP 200 status, text/html content-type, and the body contains both the reflected raw payload and the string "Invalid consumer key".

## References
- https://github.com/edmarmoretti/i3geo/issues/5
- https://nvd.nist.gov/vuln/detail/CVE-2022-34093
- https://owasp.org/www-community/attacks/xss/
- https://softwarepublico.gov.br/social/i3geo
- https://github.com/wagnerdracha/ProofOfConcept
