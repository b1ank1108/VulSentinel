---
cve_id: CVE-2022-36446
template_path: nuclei-templates/http/cves/2022/CVE-2022-36446.yaml
affected_product: Webmin
severity: critical
authentication: required
external_callback: false
affected_versions: <1.997
preconditions: []
poc_classification: rce
---

## Vulnerability
Webmin before 1.997 is susceptible to authenticated remote code execution via `software/apt-lib.pl`, which lacks HTML escaping for a UI command. An authenticated attacker can perform command injection attacks and thereby execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system. Successful exploitation allows an authenticated attacker to execute arbitrary code on the target system. Remediation: upgrade to version 1.997 or later. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: rce

The template first authenticates by sending a POST request to `/session_login.cgi` with `user={{username}}&pass={{password}}`. It then sends a second POST to `/package-updates/update.cgi` with the command-injection payload embedded in the `u` parameter (`0;echo '{{randstr}}''{{randstr}}'; id; echo '{{randstr}}''{{randstr}}'`). Detection succeeds on HTTP 200 if the response body simultaneously contains both random strings and the output of the executed `id` command (`uid`, `gid`, `groups`).

## References
- https://medium.com/@emirpolat/cve-2022-36446-webmin-1-997-7a9225af3165
- https://www.exploit-db.com/exploits/50998
- https://github.com/webmin/webmin/compare/1.996...1.997
- https://nvd.nist.gov/vuln/detail/CVE-2022-36446
- http://packetstormsecurity.com/files/167894/Webmin-1.996-Remote-Code-Execution.html
