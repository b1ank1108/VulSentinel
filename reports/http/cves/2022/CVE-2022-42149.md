---
cve_id: CVE-2022-42149
template_path: nuclei-templates/http/cves/2022/CVE-2022-42149.yaml
affected_product: kkFileView
severity: critical
authentication: none
external_callback: false
affected_versions: 4.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
kkFileView 4.0 contains a server-side request forgery (SSRF, CWE-918) vulnerability caused by improper validation of the `url` parameter in OnlinePreviewController.java. Unauthenticated attackers can send crafted requests to force the server to make arbitrary HTTP requests. Impact includes accessing internal services, bypassing firewall restrictions, and exfiltrating sensitive data from internal networks.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: info-leak

The nuclei template sends a single GET request to `{{BaseURL}}/onlinePreview?url={{base64('http://oast.fun/robots.txt')}}`. It extracts the base64 value from the hidden `id="textData"` field in the response HTML via regex, base64-decodes it, and matches for the string "Disallow" to confirm the server fetched and reflected the external resource content.

## References
- https://github.com/kekingcn/kkFileView/issues/296
- https://nvd.nist.gov/vuln/detail/CVE-2022-42149
