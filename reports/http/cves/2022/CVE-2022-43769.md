---
cve_id: CVE-2022-43769
template_path: nuclei-templates/http/cves/2022/CVE-2022-43769.yaml
affected_product: Hitachi Pentaho Business Analytics Server
severity: high
authentication: none
external_callback: true
affected_versions: prior to versions 9.4.0.1 and 9.3.0.2, including 8.3.x
preconditions: []
poc_classification: rce
---

## Vulnerability

Hitachi Pentaho Business Analytics Server prior to versions 9.4.0.1 and 9.3.0.2 (including 8.3.x) is affected by a server-side template injection (SSTI) vulnerability in Spring templates processed by certain web services. This enables unauthenticated remote code execution, allowing arbitrary code execution, sensitive data access, data modification, or unauthorized operations. 

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2). CWE-94, CWE-74. Impact includes malware execution and system compromise.

## PoC / Detection
Classification: rce

The template performs detection by issuing a GET request to `/pentaho/api/ldap/config/ldapTreeNodeChildren/require.js?url=%23{T(java.net.InetAddress).getByName('{{interactsh-url}}')}&mgrDn=a&pwd=a`, injecting a SpEL expression to force DNS resolution of the interactsh domain upon template evaluation. Confirmation occurs via OOB DNS interaction, presence of "false" in the body, and `application/json` Content-Type header.

## References
- https://support.pentaho.com/hc/en-us/articles/14455561548301--Resolved-Pentaho-BA-Server-Failure-to-Sanitize-Special-Elements-into-a-Different-Plane-Special-Element-Injection-Versions-before-9-4-0-1-and-9-3-0-2-including-8-3-x-Impacted-CVE-2022-43769-
- https://nvd.nist.gov/vuln/detail/CVE-2022-43769
- http://packetstormsecurity.com/files/172296/Pentaho-Business-Server-Authentication-Bypass-SSTI-Code-Execution.html
