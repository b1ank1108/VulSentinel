---
cve_id: CVE-2022-1580
template_path: nuclei-templates/http/cves/2022/CVE-2022-1580.yaml
affected_product: Site Offline WP Plugin
severity: medium
authentication: none
external_callback: false
affected_versions: < 1.5.3
preconditions: [maintenance mode enabled]
poc_classification: auth-bypass
---

## Vulnerability
Site Offline WP Plugin for WordPress (< 1.5.3) contains an authorization bypass vulnerability (CVE-2022-1580, CWE-639). The plugin prevents users from accessing a website but does not do so if the URL contained certain keywords. Adding those keywords to the URL's query string bypasses the plugin's main feature. Attackers can bypass the site offline/maintenance mode, gaining unauthorized access to the website. Fixed in 1.5.3.

## PoC / Detection
Classification: auth-bypass

The template first performs a GET to `/wp-content/plugins/site-offline/readme.txt` (internal) to confirm the plugin is present and extracts the version via regex on "Stable tag: ([0-9.]+)". It then performs a GET to `{{BaseURL}}/?admin` and applies a DSL matcher requiring status_code == 200, body containing both "wp-block" and "author", and compare_versions(version, '< 1.5.3').

## References
- https://wpscan.com/vulnerability/7b6f91cd-5a00-49ca-93ff-db7220d2630a/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1580
