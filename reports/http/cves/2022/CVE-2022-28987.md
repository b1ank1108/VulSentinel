---
cve_id: CVE-2022-28987
template_path: nuclei-templates/http/cves/2022/CVE-2022-28987.yaml
affected_product: Zoho ManageEngine ADSelfService Plus
severity: medium
authentication: none
external_callback: false
affected_versions: 6121 (fixed in 6202)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Zoho ManageEngine ADSelfService Plus 6121 is vulnerable to username enumeration (CVE-2022-28987, CWE-203). The Forgot Password functionality responds differently for existing and non-existing usernames via the login API, allowing unauthenticated attackers to enumerate valid usernames. This aids in targeted attacks such as password spraying and account harvesting.

CVSS v3.1 score: 5.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

## PoC / Detection
Classification: info-leak

The template issues two unauthenticated POST requests to `/ServletAPI/accounts/login` using form data `loginName=asdfnonexistent` (invalid) and `loginName=Guest` (valid example). It identifies the vulnerability through matcher conditions checking for distinct error strings in the JSON response bodies ("eSTATUS":"Permission Denied" vs "eSTATUS":"Your account has been disabled"), confirming differential behavior based on username validity (both require status 200 and application/json content-type).

## References
- https://github.com/passtheticket/vulnerability-research/blob/main/manage-engine-apps/adselfservice-userenum.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-28987
