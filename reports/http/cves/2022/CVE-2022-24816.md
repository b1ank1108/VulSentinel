---
cve_id: CVE-2022-24816
template_path: nuclei-templates/http/cves/2022/CVE-2022-24816.yaml
affected_product: GeoServer
severity: critical
authentication: none
external_callback: false
affected_versions: <1.2.2
preconditions: jt-jiffle extension enabled and allows Jiffle script to be provided via network request
poc_classification: rce
---

## Vulnerability
GeoServer versions before 1.2.2 that incorporate the jt-jiffle extension (part of jai-ext) and permit Jiffle scripts to be supplied over the network are vulnerable to remote code execution. A malicious Jiffle script is compiled into Java bytecode via Janino and then executed on the server. This issue specifically affects downstream GeoServer 1.1.22 deployments.

**CVSS Score:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-94  
**Impact:** Successful exploitation results in arbitrary code execution on the target system.  
**Remediation:** Upgrade to 1.2.22 (which patches by disabling malicious code injection into resulting scripts) or remove janino JAR from the classpath.

## PoC / Detection
Classification: rce

The template sends a single unauthenticated raw POST request to `/geoserver/wms` containing a WPS Execute XML payload that invokes the `ras:Jiffle` process. It supplies a crafted Jiffle `script` LiteralData field embedding Java code (hidden in a comment block) that uses `Runtime.getRuntime().exec("cat /etc/passwd")`, reads the output, and throws a `RuntimeException` containing the leaked content. Detection matches on HTTP 200 status together with regexes confirming both the passwd root entry and `ExceptionInInitializerError` in the response body.

## References
- https://www.synacktiv.com/en/publications/exploiting-cve-2022-24816-a-code-injection-in-the-jt-jiffle-extension-of-geoserver.html
- https://github.com/geosolutions-it/jai-ext/security/advisories/GHSA-v92f-jx6p-73rx
- https://github.com/geosolutions-it/jai-ext/commit/cb1d6565d38954676b0a366da4f965fef38da1cb
- https://nvd.nist.gov/vuln/detail/CVE-2022-24816
- https://github.com/tanjiti/sec_profile
