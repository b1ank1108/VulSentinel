---
cve_id: CVE-2022-0963
template_path: nuclei-templates/http/cves/2022/CVE-2022-0963.yaml
affected_product: Microweber
severity: medium
authentication: required
external_callback: false
affected_versions: prior to 1.2.12
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Microweber prior to 1.2.12 contains a stored cross-site scripting vulnerability. It allows unrestricted upload of XML files. Authenticated attackers can upload malicious XML files containing XSS payloads that execute when users access the uploaded files, potentially stealing session cookies or performing unauthorized actions. CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4). CWE-79.

## PoC / Detection
Classification: info-leak

The template sends a POST to /api/user_login with username and password credentials, followed by a multipart POST to /plupload (with Referer simulating the admin files module) containing a randomly-named .xml file whose body is the XSS payload `<x:script xmlns:x="http://www.w3.org/1999/xhtml">alert(document.domain)</x:script>`. It then issues a GET to /userfiles/media/default/{{to_lower(randstr)}}.xml and verifies the payload string and a 200 status are present along with upload success indicators from the second response.

## References
- https://huntr.dev/bounties/a89a4198-0880-4aa2-8439-a463f39f244c/
- https://github.com/advisories/GHSA-q3x2-jvp3-wj78
- https://huntr.dev/bounties/a89a4198-0880-4aa2-8439-a463f39f244c
- https://nvd.nist.gov/vuln/detail/CVE-2022-0963
- https://github.com/microweber/microweber/commit/975fc1d6d3fba598ee550849ceb81af23ce72e08
