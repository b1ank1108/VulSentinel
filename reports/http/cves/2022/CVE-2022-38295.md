---
cve_id: CVE-2022-38295
template_path: nuclei-templates/http/cves/2022/CVE-2022-38295.yaml
affected_product: Cuppa CMS
severity: medium
authentication: required
external_callback: false
affected_versions: v1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2022-38295 is a stored cross-site scripting (XSS) vulnerability in Cuppa CMS v1.0. The vulnerability exists in the table manager component at `/table_manager/view/cu_user_groups`, specifically in the "Add New Group" functionality. An authenticated attacker can inject malicious JavaScript or HTML code through the Name field when creating a new user group. The injected payload is stored in the application and executed when other users view the affected page.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low impact to confidentiality and integrity.

Successful exploitation could lead to session hijacking, website defacement, theft of sensitive information, or execution of unauthorized actions in the context of victim users' sessions.

## PoC / Detection

Classification: state-change

The Nuclei template performs an authenticated exploitation test through three sequential HTTP requests:

1. **Authentication**: Sends a POST request to the root path with username and password credentials to establish an authenticated session
2. **Payload Injection**: Submits a POST request to `/components/table_manager/classes/functions.php` with a crafted XSS payload (`"><script>alert(document.domain)</script>`) in the `name_field` parameter while creating a new user group via the `saveAdminTable` function
3. **Verification**: Retrieves the user groups view at `/components/table_manager/` to confirm the payload was stored and is reflected in the response

The template confirms successful exploitation by checking for:
- Presence of the injected XSS payload in the response body
- Presence of the string 'cuppa_html' indicating the Cuppa CMS interface
- Content-Type header containing "text/html"
- HTTP 200 status code

## References

- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-38295
- https://github.com/ARPSyndicate/cvemon
