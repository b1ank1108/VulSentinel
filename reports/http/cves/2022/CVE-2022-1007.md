---
cve_id: CVE-2022-1007
template_path: nuclei-templates/http/cves/2022/CVE-2022-1007.yaml
affected_product: WordPress Advanced Booking Calendar plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <1.7.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

WordPress Advanced Booking Calendar plugin versions before 1.7.1 contain a reflected cross-site scripting (XSS) vulnerability in the admin interface. The vulnerability exists because the plugin fails to properly sanitize and escape the `room` parameter before outputting it back in an admin page (`admin.php?page=advanced-booking-calendar-show-seasons-calendars`). An attacker can inject arbitrary JavaScript code that executes in the browser of an authenticated administrator who clicks on a malicious link. This can enable the attacker to steal cookie-based authentication credentials, perform actions on behalf of the victim administrator, or launch additional attacks against the WordPress installation.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

## PoC / Detection

Classification: state-change

The Nuclei template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress administrator credentials to establish an authenticated session.

2. **XSS Probe**: Sends a GET request to the vulnerable admin page endpoint `/wp-admin/admin.php?page=advanced-booking-calendar-show-seasons-calendars` with a crafted `room` parameter containing an XSS payload: `1111"><script>alert(document.domain)</script><"`.

The template confirms the vulnerability by verifying that:
- The injected JavaScript payload `<script>alert(document.domain)</script>` is reflected in the response body without sanitization
- The response contains references to 'advanced-booking-calendar' (confirming the correct plugin page)
- The response has a `text/html` content type
- The HTTP status code is 200

This demonstrates that malicious JavaScript can be injected and executed in the context of an authenticated administrator's browser session, enabling potential session hijacking or unauthorized administrative actions.

## References

- https://wpscan.com/vulnerability/6f5b764b-d13b-4371-9cc5-91204d9d6358
- https://wordpress.org/plugins/advanced-booking-calendar/
- https://nvd.nist.gov/vuln/detail/cve-2022-1007
- https://plugins.trac.wordpress.org/changeset/2695427
- https://github.com/ARPSyndicate/kenzer-templates
