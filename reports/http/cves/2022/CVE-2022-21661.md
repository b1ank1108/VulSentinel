---
cve_id: CVE-2022-21661
template_path: nuclei-templates/http/cves/2022/CVE-2022-21661.yaml
affected_product: WordPress
severity: high
authentication: none
external_callback: false
affected_versions: <5.8.3
preconditions: plugins or themes utilizing WP_Query
poc_classification: info-leak
---

## Vulnerability
WordPress before 5.8.3 suffers from SQL injection (CWE-89) in WP_Query due to improper sanitization of inputs such as tax_query. The issue can be triggered through multiple plugins and themes. 

Successful exploitation allows arbitrary SQL query execution, potentially resulting in sensitive data exposure, data manipulation, and unauthorized administrative actions. CVSS 3.1 score 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated POST request to `/wp-admin/admin-ajax.php` using action=ecsload and a crafted query JSON containing a tax_query with an empty terms array to induce an SQL syntax error. Detection matches on HTTP 200 responses containing WordPress database error strings like "WordPress database error:" and "error in your SQL syntax".

## References
- https://wpscan.com/vulnerability/7f768bcf-ed33-4b22-b432-d1e7f95c1317
- https://www.zerodayinitiative.com/blog/2022/1/18/cve-2021-21661-exposing-database-info-via-wordpress-sql-injection
- http://packetstormsecurity.com/files/165540/WordPress-Core-5.8.2-SQL-Injection.html
- https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-6676-cqfm-gw84
- https://nvd.nist.gov/vuln/detail/cve-2022-21661
