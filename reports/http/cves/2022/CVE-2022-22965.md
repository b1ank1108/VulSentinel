---
cve_id: CVE-2022-22965
template_path: nuclei-templates/http/cves/2022/CVE-2022-22965.yaml
affected_product: Spring Framework
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: [Application must run on Java Development Kit 9+, Application must be deployed as WAR on Tomcat (not as Spring Boot executable jar)]
poc_classification: rce
---

## Vulnerability

CVE-2022-22965 is a critical remote code execution vulnerability in Spring Framework affecting Spring MVC and Spring WebFlux applications. The vulnerability exploits data binding mechanisms to allow attackers to execute arbitrary code on the target system. This flaw, commonly known as "Spring4Shell," enables attackers to execute malware, obtain sensitive information, modify data, and gain full control over compromised systems without authentication.

The vulnerability is specifically exploitable when applications run on Java Development Kit 9 or higher and are deployed as WAR files on Tomcat. Applications deployed as Spring Boot executable jars (the default deployment method) are not vulnerable to this exploit. The vulnerability is classified under CWE-94 (Improper Control of Generation of Code) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low attack complexity, and no privileges or user interaction required.

## PoC / Detection

Classification: rce

The template detects CVE-2022-22965 by attempting to trigger an out-of-band interaction that confirms the presence of the vulnerability. It sends two types of HTTP requests (POST and GET) with malicious payloads designed to manipulate Spring's data binding mechanism. The payloads target the `class.module.classLoader.resources.context.configFile` parameter chain, attempting to set configuration values that would cause the server to make an HTTP/HTTPS callback to an attacker-controlled Interactsh server.

The detection works by:
1. Sending requests with payloads that manipulate the classLoader resources context
2. Using both HTTP and HTTPS protocols for the callback URL
3. Monitoring for incoming HTTP interactions from the target server
4. Verifying that the callback originates from a Java-based application (by checking for "User-Agent: Java" in the interaction request)

The template confirms the vulnerability when it receives an HTTP callback from the target server with a Java user agent, indicating that the malicious data binding was processed and executed by the Spring application.

## References

- https://tanzu.vmware.com/security/cve-2022-22965
- https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/
- https://twitter.com/RandoriAttack/status/1509298490106593283
- https://mp.weixin.qq.com/s/kgw-O4Hsd9r2vfme3Y2Ynw
- https://twitter.com/_0xf4n9x_/status/1509935429365100546
- https://nvd.nist.gov/vuln/detail/cve-2022-22965
