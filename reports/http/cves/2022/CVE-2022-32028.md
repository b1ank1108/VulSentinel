---
cve_id: CVE-2022-32028
template_path: nuclei-templates/http/cves/2022/CVE-2022-32028.yaml
affected_product: Car Rental Management System
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: [Valid admin credentials required for authentication]
poc_classification: info-leak
---

## Vulnerability

CVE-2022-32028 is an SQL injection vulnerability in Car Rental Management System version 1.0. The vulnerability exists in the `/admin/manage_user.php` endpoint via the `id` parameter. An authenticated attacker with administrative privileges can inject malicious SQL queries to manipulate database operations. This allows the attacker to extract sensitive information from the database, modify data, and execute unauthorized administrative operations within the application context. The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS v3.1 score of 7.2 (High severity), requiring high privileges (PR:H) but no user interaction.

The template metadata notes that login bypass may also be possible using the SQL injection payload `admin'+or+'1'%3D'1'` in the username field, potentially allowing authentication bypass in addition to the post-authentication SQL injection.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/admin/ajax.php?action=login` with username and password credentials to establish an authenticated session.

2. **SQL Injection Probe**: Sends a GET request to `/admin/manage_user.php?id=-1%20union%20select%201,md5({{num}}),3,4,5--+` where `{{num}}` is a variable set to "999999999". This UNION-based SQL injection payload attempts to inject a SELECT statement that returns the MD5 hash of the number.

The template verifies the vulnerability by checking if the response body contains the MD5 hash of the injected number (`{{md5({{num}})}}`) and returns a 200 status code. Successful detection confirms that the application is vulnerable to SQL injection, allowing arbitrary SQL query execution that can be leveraged to extract database contents.

## References

- https://github.com/k0xx11/bug_report/blob/main/vendors/campcodes.com/car-rental-management-system/SQLi-8.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-32028
- https://github.com/ARPSyndicate/kenzer-templates
