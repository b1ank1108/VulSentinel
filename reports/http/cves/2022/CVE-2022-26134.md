---
cve_id: CVE-2022-26134
template_path: nuclei-templates/http/cves/2022/CVE-2022-26134.yaml
affected_product: Confluence
severity: critical
authentication: none
external_callback: true
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Confluence Server and Data Center is susceptible to an unauthenticated remote code execution vulnerability via OGNL expression language injection (CWE-917).  
Impact: Successful exploitation allows arbitrary code execution on the affected system.  
Remediation: Apply the latest security patches or updates provided by Atlassian.  
CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
The flaw is present in the product's request handling and requires no authentication, specific features, or configuration changes.

## PoC / Detection
Classification: rce  
The template issues two sequential GET requests to `{{BaseURL}}/` with URL-encoded OGNL payloads. The first executes `whoami` via `@java.lang.Runtime@getRuntime().exec()` and forces the response to include an `X-Cmd-Response` header containing the command output. The second executes `nslookup {{interactsh-url}}` to trigger an out-of-band DNS callback. Detection succeeds on either (stop-at-first-match) the presence of the custom header or a DNS interactsh interaction combined with the string "confluence" in the response body. The `x_cmd_response` header value is extracted when present.

## References
- https://attackerkb.com/topics/BH1D56ZEhs/cve-2022-26134/rapid7-analysis
- https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html
- https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134/
- https://jira.atlassian.com/browse/CONFSERVER-79016
- http://packetstormsecurity.com/files/167431/Through-The-Wire-CVE-2022-26134-Confluence-Proof-Of-Concept.html
