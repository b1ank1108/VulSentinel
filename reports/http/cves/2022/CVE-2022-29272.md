---
cve_id: CVE-2022-29272
template_path: nuclei-templates/http/cves/2022/CVE-2022-29272.yaml
affected_product: Nagios XI
severity: medium
authentication: optional
external_callback: false
affected_versions: <5.8.5
preconditions: []
poc_classification: detect-only
---

## Vulnerability

CVE-2022-29272 is an open redirect vulnerability affecting Nagios XI versions prior to 5.8.5. The vulnerability exists in the login function where the `redirect` parameter is not properly validated. An attacker can craft a malicious URL that redirects authenticated or unauthenticated users to an external malicious website after interacting with the login page. This can be exploited to conduct phishing attacks, potentially leading to credential theft or other social engineering attacks. The vulnerability is classified as CWE-601 (URL Redirection to Untrusted Site) with a CVSS score of 6.1, requiring user interaction but no privileges.

## PoC / Detection

Classification: detect-only

The template detects this vulnerability through two HTTP requests:

1. **GET request**: Tests the redirect parameter in the login URL (`/nagiosxi/login.php?redirect=/www.interact.sh`) to verify if the application accepts external redirect destinations.

2. **POST request**: Submits login credentials with the redirect parameter embedded in the POST body to test if the redirect occurs after authentication. The template extracts the CSRF token (`nsp`) from the initial response and includes it in the POST request along with username and password parameters.

The template follows up to 2 redirects and uses regex pattern matching on the `Location` header to detect if the application redirects to the specified external domain (interact.sh). A successful match indicates the application is vulnerable to open redirect attacks. Note that while the template includes authentication parameters, it tests both pre-auth (GET) and post-auth (POST) scenarios.

## References

- https://github.com/sT0wn-nl/CVEs/tree/master/CVE-2022-29272
- https://github.com/4LPH4-NL/CVEs
- https://github.com/sT0wn-nl/CVEs/blob/master/README.md#nagios-xi
- https://nvd.nist.gov/vuln/detail/CVE-2022-29272
- https://assets.nagios.com/downloads/nagiosxi/CHANGES-5.TXT
