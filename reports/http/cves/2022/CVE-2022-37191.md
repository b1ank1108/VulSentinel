---
cve_id: CVE-2022-37191
template_path: nuclei-templates/http/cves/2022/CVE-2022-37191.yaml
affected_product: Cuppa CMS
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: [authenticated user]
poc_classification: info-leak
---

## Vulnerability
Cuppa CMS v1.0 contains an authenticated local file inclusion (LFI) vulnerability in the `cuppa/api/index.php` component. An authenticated user can read arbitrary system files by supplying a path-traversal payload in the `function` POST parameter (e.g. `./../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/passwd/`).

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (6.5). CWE-829.

## PoC / Detection
Classification: info-leak

The template verifies exploitation via a three-request sequence:  
- POST `/` with `user`, `password` and `task=login` to authenticate.  
- POST `/components/table_manager/` to extract `apikey` via regex from `<td class='td_key'>` cell.  
- POST `/api/index.php` (with `key: {{apikey}}` header) using the LFI payload in `function`.  

Matchers confirm: status 200, `text/html` header, and regex `root:[x*]:0:0` in body_3.

## References
- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-37191
- https://github.com/ARPSyndicate/cvemon
