---
cve_id: CVE-2022-0785
template_path: nuclei-templates/http/cves/2022/CVE-2022-0785.yaml
affected_product: WordPress Daily Prayer Time
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 2022.03.01
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Daily Prayer Time plugin prior to 2022.03.01 contains an unauthenticated SQL injection vulnerability. The `month` parameter in the `get_monthly_timetable` AJAX action is not sanitized before use in a SQL statement, allowing unauthenticated attackers to manipulate database queries. Impact includes unauthorized WordPress database access and sensitive information leakage (CVSS 3.1: 9.8).

## PoC / Detection
Classification: info-leak
The template issues a GET request to `/wp-admin/admin-ajax.php?action=get_monthly_timetable&month=1+AND+(SELECT+6881+FROM+(SELECT(SLEEP(6)))iEAn)` and detects exploitation by checking for a response delay of 6+ seconds (time-based blind SQLi) while confirming HTTP 200 status and expected Daily Prayer Time content in the body.

## References
- https://wpscan.com/vulnerability/e1e09f56-89a4-4d6f-907b-3fb2cb825255
- https://wordpress.org/plugins/daily-prayer-time-for-mosques/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0785
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
