---
cve_id: CVE-2022-43015
template_path: nuclei-templates/http/cves/2022/CVE-2022-43015.yaml
affected_product: OpenCATS
severity: medium
authentication: required
external_callback: false
affected_versions: 0.9.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OpenCATS 0.9.6 is affected by a reflected cross-site scripting (XSS) vulnerability via the `entriesPerPage` parameter in the `ajax.php` endpoint (`f=getPipelineJobOrder`). 

**CVSS v3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**EPSS:** 0.01677 (0.81904 percentile)  
**CPE:** cpe:2.3:a:opencats:opencats:0.9.6:*:*:*:*:*:*:*

An attacker can inject arbitrary JavaScript that executes in the context of an authenticated victim's browser. This enables theft of cookie-based authentication credentials, session hijacking, or site defacement. The flaw stems from unsanitized use of the parameter, with evidence of reflection even alongside backend SQL errors.

Successful exploitation requires only a crafted URL sent to a logged-in user (no server-side code execution or data modification on the backend). Remediation requires upgrading to a patched OpenCATS release.

## PoC / Detection
Classification: info-leak

The template first sends a POST to `/index.php?m=login&a=attemptLogin` (form-urlencoded `username={{username}}&password={{password}}`) to establish an authenticated session. It then issues a GET to `/ajax.php?f=getPipelineJobOrder&joborderID=2&page=0&entriesPerPage=15)"></a>%20<script>alert(document.domain)</script>&sortBy=dateCreatedInt&sortDirection=desc&indexFile=index.php&isPopup=0`.  

Detection matches on HTTP 200, `text/html` Content-Type, and the response body simultaneously containing both the injected `<script>alert(document.domain)</script>` string and the literal phrase "MySQL Query Failed". This confirms unsafe reflection of the `entriesPerPage` value without sanitization.

## References
- https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_entriesPerPage.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-43015
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Henry4E36/POCS
