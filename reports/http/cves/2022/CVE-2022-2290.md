---
cve_id: CVE-2022-2290
template_path: nuclei-templates/http/cves/2022/CVE-2022-2290.yaml
affected_product: Trilium
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 0.52.4, 0.53.1-beta
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Trilium prior to 0.52.4 and 0.53.1-beta contains a reflected cross-site scripting (XSS) vulnerability (CWE-79) in the custom handler, /share/api/notes, and /share/api/images endpoints. Insufficient sanitization of user-controlled path segments causes raw injection of JavaScript payloads into 404 error responses served as text/html. An unauthenticated remote attacker can craft a malicious URL that, when visited by any authenticated or unauthenticated victim, executes arbitrary script in the victim's browser context (CVSS 3.1: 6.1, AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), enabling data theft, session hijacking, or page defacement. Remediation requires upgrade to 0.52.4 or later.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability by issuing three sequential GET requests (stop-at-first-match) that embed a harmless reflected-XSS test payload (`<img src=x onerror=alert(document.domain)>`, URL-encoded) directly into the vulnerable path segments:
- `{{BaseURL}}/custom/<payload>`
- `{{BaseURL}}/share/api/notes/<payload>`
- `{{BaseURL}}/share/api/images/<payload>/filename`

Success is confirmed when any response returns HTTP 404, Content-Type text/html, and the exact unsanitized payload string appears in the body within one of the expected error messages ("No handler matched for custom <img src=x onerror=alert(document.domain)>" or "Note '<img src=x onerror=alert(document.domain)>' not found"). The probe therefore verifies that user input reaches the response body without HTML escaping, confirming exploitable reflected XSS.

## References
- https://huntr.dev/bounties/367c5c8d-ad6f-46be-8503-06648ecf09cf/
- https://github.com/zadam/trilium
- https://github.com/zadam/trilium/commit/3faae63b849a1fabc31b823bb7af3a84d32256a7
- https://nvd.nist.gov/vuln/detail/CVE-2022-2290
- https://github.com/ARPSyndicate/cvemon
