---
cve_id: CVE-2022-34047
template_path: nuclei-templates/http/cves/2022/CVE-2022-34047.yaml
affected_product: WAVLINK WN530HG4
severity: high
authentication: none
external_callback: false
affected_versions: M30HG4.V5030.191116
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-34047 is an improper access control vulnerability affecting the WAVLINK WN530HG4 router firmware version M30HG4.V5030.191116. The vulnerability allows unauthenticated remote attackers to access sensitive configuration pages that should be restricted. Specifically, the `/set_safety.shtml` endpoint exposes system credentials (usernames and passwords) in the HTML source code without requiring authentication. The credentials are embedded in JavaScript variables that can be extracted by viewing the page source. This access control failure enables attackers to obtain administrative credentials, potentially leading to complete compromise of the router and the network it protects.

The vulnerability is classified under CWE-668 (Exposure of Resource to Wrong Sphere) and has a CVSS v3.1 score of 7.5 (High severity) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, indicating network-exploitable, low complexity, no privileges required, and high confidentiality impact. The EPSS score of 0.59183 (98.191 percentile) suggests a high probability of active exploitation.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending an unauthenticated HTTP GET request to `/set_safety.shtml?r=52300` on the target host. The template verifies the vulnerability by checking for two conditions:

1. The presence of the string `var syspasswd="` in the response body, which indicates the JavaScript variable containing the system password
2. The presence of `<title>APP</title>` in the response, confirming the correct page is returned
3. An HTTP 200 status code

If all conditions are met, the template extracts the password value using a regex pattern `syspasswd="(.+?)"` to capture the credential stored in the JavaScript variable. This detection method confirms that sensitive authentication credentials are exposed without requiring any authentication, demonstrating the improper access control vulnerability.

## References

- https://drive.google.com/file/d/1sTQdUc12aZvJRFeb5wp8AfPdUEkkU9Sy/view?usp=sharing
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34047
- http://packetstormsecurity.com/files/167891/Wavlink-WN530HG4-Password-Disclosure.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-34047
- https://github.com/ARPSyndicate/cvemon
