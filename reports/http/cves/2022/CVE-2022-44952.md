---
cve_id: CVE-2022-44952
template_path: nuclei-templates/http/cves/2022/CVE-2022-44952.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: authenticated user with permission to modify application configuration
poc_classification: state-change
---

## Vulnerability
Rukovoditel <= 3.2.1 contains a stored cross-site scripting (XSS) vulnerability in the application configuration module (`/index.php?module=configuration/application`). Unsanitized input in the Copyright Text field (`CFG[APP_COPYRIGHT_NAME]`) allows injection of arbitrary HTML/JavaScript that persists server-side and executes in the context of any user viewing the dashboard.

CVSS: 5.4 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N), CWE-79.  
Impact: session hijacking, credential theft, or page defacement for victims.  
Remediation: upgrade to a version higher than 3.2.1.

## PoC / Detection
Classification: state-change

The template executes an authenticated workflow: GETs the login page to extract the `form_session_token` nonce via regex extractor, POSTs credentials to complete login, then issues a multipart/form-data POST to `/index.php?module=configuration/save` that overwrites multiple CFG fields while injecting `<script>alert(document.domain)</script>` into `CFG[APP_COPYRIGHT_NAME]`, finally GETs `/index.php?module=dashboard/` and confirms successful storage/reflection by checking that the exact payload appears unescaped in the HTML body (plus 200 status and text/html content-type).

## References
- https://github.com/anhdq201/rukovoditel/issues/9
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-44952
- http://rukovoditel.com
