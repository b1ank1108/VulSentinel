---
cve_id: CVE-2022-1057
template_path: nuclei-templates/http/cves/2022/CVE-2022-1057.yaml
affected_product: Pricing Deals for WooCommerce
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.0.2.02
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Pricing Deals for WooCommerce plugin through version 2.0.2.02 contains a SQL injection vulnerability. The plugin fails to properly sanitize and escape a parameter before using it in a SQL statement via an AJAX action (`vtprd_product_search_ajax`). This unauthenticated SQL injection allows attackers to inject arbitrary SQL commands through the `term` parameter without requiring any authentication or special permissions.

The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8 (Critical), indicating network-based exploitation with low attack complexity, no privileges required, and high impact on confidentiality, integrity, and availability. The EPSS score of 0.58137 (98.143rd percentile) suggests a high probability of active exploitation in the wild.

Successful exploitation enables attackers to:
- Extract sensitive information from the WordPress database (user credentials, customer data, payment information)
- Modify or delete database records
- Execute unauthorized administrative operations
- Potentially achieve complete database compromise

## PoC / Detection

Classification: info-leak

The template detects this vulnerability using a time-based blind SQL injection technique. It sends a GET request to `/wp-admin/admin-ajax.php` with the AJAX action `vtprd_product_search_ajax` and injects a SQL payload in the `term` parameter:

```
term=aaa' union select 1,sleep(6),3--+-
```

The payload attempts to execute a `sleep(6)` command through a UNION-based SQL injection. The template verifies the vulnerability by checking three conditions:
1. Response time is 6 seconds or greater (indicating the sleep command executed)
2. HTTP status code is 500 (server error from malformed SQL)
3. Response body contains "been a critical error" (WordPress error message)

All three conditions must be satisfied to confirm the vulnerability. The 15-second timeout ensures sufficient time to detect the 6-second delay while avoiding false positives from network latency.

## References

- https://wpscan.com/vulnerability/7c33ffc3-84d1-4a0f-a837-794cdc3ad243
- https://wordpress.org/plugins/pricing-deals-for-woocommerce/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1057
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
