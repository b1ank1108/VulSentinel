---
cve_id: CVE-2022-47945
template_path: nuclei-templates/http/cves/2022/CVE-2022-47945.yaml
affected_product: ThinkPHP
severity: critical
authentication: none
external_callback: false
affected_versions: before 6.0.14
preconditions: language pack feature enabled (lang_switch_on=true)
poc_classification: rce
---

## Vulnerability
ThinkPHP Framework before 6.0.14 is vulnerable to local file inclusion via the `lang` parameter when the language pack feature is enabled (`lang_switch_on=true`). An unauthenticated remote attacker can exploit this to include arbitrary local files (e.g., `pearcmd.php`) and achieve arbitrary operating system command execution.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-22.  
Impact: unauthorized access, data leakage, remote code execution.  
Remediation: apply the latest security patches and updates.

## PoC / Detection
Classification: rce

The template sends two GET requests to `{{BaseURL}}/?lang=../../thinkphp/base` and `{{BaseURL}}/?lang=../../../../../vendor/topthink/think-trace/src/TraceDebug` (stopping at the first match) and verifies the condition with an `and` matcher requiring HTTP 500 status plus the words "Call Stack" and `class="trace"` present in the response body.

## References
- https://tttang.com/archive/1865/
- https://nvd.nist.gov/vuln/detail/CVE-2022-47945
- https://github.com/top-think/framework/compare/v6.0.13...v6.0.14
- https://github.com/top-think/framework/commit/c4acb8b4001b98a0078eda25840d33e295a7f099
- https://github.com/ARPSyndicate/kenzer-templates
