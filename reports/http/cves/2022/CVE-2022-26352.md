---
cve_id: CVE-2022-26352
template_path: nuclei-templates/http/cves/2022/CVE-2022-26352.yaml
affected_product: DotCMS
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
DotCMS contains an arbitrary file upload vulnerability in the management system via the `/api/content/` endpoint. The flaw allows unauthenticated attackers to upload malicious files (e.g., JSP webshells) using path traversal in the filename parameter, placing them directly in the Tomcat web root (`/srv/dotserver/tomcat-9.0.41/webapps/ROOT/`). This leads to remote code execution.

**Impact:** Successful exploitation leads to remote code execution, compromising the confidentiality, integrity, and availability of the affected system.

**CVSS v3.1:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-22 (Path Traversal)  
**Remediation:** Apply the latest security patches or updates provided by the vendor.

## PoC / Detection
Classification: rce

The template detects the vulnerability by performing an actual file upload: it sends a POST request with a multipart form-data payload containing a test JSP file named with path traversal (`../../../../../../../../../srv/dotserver/tomcat-9.0.41/webapps/ROOT/{{randstr}}.jsp`). The JSP simply outputs the string "CVE-2022-26352". It follows up with a GET request to the uploaded file and matches if the response contains the string and has status code 200, confirming the upload succeeded and the JSP executed.

## References
- https://blog.assetnote.io/2022/05/03/hacking-a-bank-using-dotcms-rce/
- https://github.com/h1ei1/POC/tree/main/CVE-2022-26352
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26352
- http://packetstormsecurity.com/files/167365/dotCMS-Shell-Upload.html
- https://groups.google.com/g/dotcms
