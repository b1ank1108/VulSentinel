---
cve_id: CVE-2022-31854
template_path: nuclei-templates/http/cves/2022/CVE-2022-31854.yaml
affected_product: Codoforum
severity: high
authentication: required
external_callback: false
affected_versions: 5.1
preconditions: [administrator access to the admin panel]
poc_classification: rce
---

## Vulnerability
Codoforum 5.1 contains an arbitrary file upload vulnerability (CWE-434) via the logo change option in the admin panel. An authenticated administrator can upload arbitrary files (including PHP code) that are stored in a publicly accessible directory and executed by the server, enabling remote code execution. This can lead to sensitive information disclosure, data modification, and unauthorized operations. Impact: unauthorized remote code execution on the affected system. CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2).

## PoC / Detection
Classification: rce

The template simulates the full attack chain to verify the vulnerability:  
- POSTs to `/admin/?page=login` with supplied `{{username}}`/`{{password}}` credentials.  
- GETs `/admin/index.php?page=config` and extracts the CSRF token via regex.  
- POSTs to `/admin/index.php?page=config` with multipart form data containing a `forum_logo` field named `{{randstr}}.php` (Content-Type: application/x-httpd-php) holding the payload `<?php echo md5('CVE-2022-31854'); ?>` plus the CSRF token.  
- GETs `/sites/default/assets/img/attachments/{{randstr}}.php` and matches status 200 + text/html content containing the exact MD5 hash `a63fd49130de6406a66600cd8caa162f`.

## References
- https://bitbucket.org/evnix/codoforum_downloads/downloads/codoforum.v.5.1.zip
- https://codoforum.com
- https://vikaran101.medium.com/codoforum-v5-1-authenticated-rce-my-first-cve-f49e19b8bc
- https://nvd.nist.gov/vuln/detail/CVE-2022-31854
- https://github.com/trhacknon/Pocingit
