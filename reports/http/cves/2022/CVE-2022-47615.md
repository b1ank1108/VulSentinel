---
cve_id: CVE-2022-47615
template_path: nuclei-templates/http/cves/2022/CVE-2022-47615.yaml
affected_product: LearnPress Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 4.1.7.3.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Local File Inclusion vulnerability in LearnPress â€“ WordPress LMS Plugin <= 4.1.7.3.2 versions (fixed in 4.2.0). The issue exists in unsanitized handling of the `template_path` parameter within the REST API endpoint `/wp-json/lp/v1/courses/archive-course`, enabling unauthenticated path traversal (`../`) to include and read arbitrary local files on the server.

Impact: Successful exploitation could lead to unauthorized access to sensitive files, remote code execution, or information disclosure.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-434.

## PoC / Detection
Classification: info-leak

The template sends one unauthenticated raw GET request:  
`GET /wp-json/lp/v1/courses/archive-course?template_path=..%2F..%2F..%2Fetc%2Fpasswd&return_type=html`  
and detects successful LFI if the JSON response body matches the regex `root:.*:0:0:`, contains the words `"status":` and `"pagination":`, returns `application/json` Content-Type header, and HTTP status 200.

## References
- https://github.com/RandomRobbieBF/CVE-2022-47615/tree/main
- https://nvd.nist.gov/vuln/detail/CVE-2022-47615
- https://patchstack.com/database/vulnerability/learnpress/wordpress-learnpress-plugin-4-1-7-3-2-local-file-inclusion?_s_id=cve
- https://github.com/RandomRobbieBF/CVE-2022-47615
