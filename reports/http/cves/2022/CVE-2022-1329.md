---
cve_id: CVE-2022-1329
template_path: nuclei-templates/http/cves/2022/CVE-2022-1329.yaml
affected_product: Elementor Website Builder
severity: high
authentication: required
external_callback: false
affected_versions: 3.6.0 to 3.6.2
preconditions: []
poc_classification: rce
---

## Vulnerability

The Elementor Website Builder plugin for WordPress versions 3.6.0 to 3.6.2 contains a remote code execution vulnerability due to a missing capability check in the `~/core/app/modules/onboarding/module.php` file. The flaw allows unauthorized execution of several AJAX actions, specifically the `elementor_upload_and_install_pro` action. Attackers with authenticated access can exploit this vulnerability to upload malicious files and modify site data without proper authorization checks, leading to arbitrary code execution on the affected WordPress installation.

The vulnerability is classified under CWE-434 (Unrestricted Upload of File with Dangerous Type) and CWE-862 (Missing Authorization). The CVSS v3.1 score is 8.8 (High), with the attack vector being network-based, low attack complexity, requiring low privileges, and no user interaction. The EPSS score of 0.93475 (99.816th percentile) indicates a very high probability of exploitation in the wild.

## PoC / Detection

Classification: rce

The template performs an authenticated exploitation attempt to verify the vulnerability. It executes a four-step attack sequence:

1. **Authentication**: Sends a POST request to `/wp-login.php` with username and password credentials to establish an authenticated session
2. **Session Validation**: Accesses `/wp-admin/` to confirm successful authentication
3. **Nonce Extraction**: Extracts a WordPress nonce value from the admin interface using regex pattern matching
4. **Malicious File Upload**: Sends a POST request to `/wp-admin/admin-ajax.php` with the `elementor_upload_and_install_pro` AJAX action, uploading a specially crafted ZIP file containing a PHP file (`elementor-pro.php`) with a known MD5 hash marker
5. **Verification**: Attempts to access `/index.php?activate=1` and checks for the presence of the hash `5f9bc5edd71c78284dabe630df8cd71d` in the response body, confirming successful file upload and code execution capability

The template is marked as intrusive and performs actual file upload operations to verify exploitability.

## References

- https://www.wordfence.com/blog/2022/04/elementor-critical-remote-code-execution-vulnerability/
- https://wordpress.org/plugins/elementor/
- https://plugins.trac.wordpress.org/changeset/2708766/elementor/trunk/core/app/modules/onboarding/module.php
- https://nvd.nist.gov/vuln/detail/CVE-2022-1329
- https://github.com/dexit/CVE-2022-1329
