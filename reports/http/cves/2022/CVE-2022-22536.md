---
cve_id: CVE-2022-22536
template_path: nuclei-templates/http/cves/2022/CVE-2022-22536.yaml
affected_product: SAP Memory Pipes (MPI) Desynchronization
severity: critical
authentication: none
external_callback: false
affected_versions: SAP NetWeaver Application Server ABAP/Java, ABAP Platform, SAP Content Server 7.53 and SAP Web Dispatcher
preconditions: []
poc_classification: state-change
---

## Vulnerability
SAP Memory Pipes (MPI) in SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server 7.53 and SAP Web Dispatcher is vulnerable to request smuggling and request concatenation. An unauthenticated attacker can prepend arbitrary data to a victim's request, enabling impersonation of the victim to execute functions or poison web caches. This can result in complete compromise of Confidentiality, Integrity, and Availability (CVSS 3.1: 10.0, AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H, CWE-444).

## PoC / Detection
Classification: state-change

The template sends a crafted raw HTTP request with a large Content-Length (82646) filled with repeated 'A' characters followed by a second GET / request to test for MPI desynchronization (using unsafe: true and read-all). It targets SAP paths such as /sap/admin/public/default.html and /sap/public/bc/ur/Login/assets/corbu/sap_logo.png. Detection matches on response body containing 'administration' or PNG content-type headers (indicating smuggled admin/logo response) OR specific 400/500 error strings from concatenated processing, combined with HTTP 200 status.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2022-22536
- https://wiki.scn.sap.com/wiki/display/PSR/SAP+Security+Patch+Day+-+February+2022
- https://github.com/Onapsis/onapsis_icmad_scanner
- https://blogs.sap.com/2022/02/11/remediation-of-cve-2022-22536-request-smuggling-and-request-concatenation-in-sap-netweaver-sap-content-server-and-sap-web-dispatcher/
- https://launchpad.support.sap.com/#/notes/3123396
