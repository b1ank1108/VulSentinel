---
cve_id: CVE-2022-4328
template_path: nuclei-templates/http/cves/2022/CVE-2022-4328.yaml
affected_product: WooCommerce Checkout Field Manager
severity: critical
authentication: none
external_callback: false
affected_versions: < 18.0
preconditions: []
poc_classification: rce
---

## Vulnerability
WooCommerce Checkout Field Manager WordPress plugin before 18.0 fails to validate files uploaded via the `cfom_upload_file` AJAX action. Unauthenticated attackers can upload arbitrary PHP files (e.g., webshells) to `/wp-content/uploads/cfom_files/`, achieving remote code execution on the WordPress server and full compromise of the WooCommerce installation.

CVSSv3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE-434 (Unrestricted Upload of File with Dangerous Type)  
Fixed in version 18.0

## PoC / Detection
Classification: rce

The template actively exploits the flaw with a two-request chain:  
- POST to `/wp-admin/admin-ajax.php?action=cfom_upload_file&name={randstr}.pHp` (multipart/form-data) containing a self-deleting PHP payload `<?php echo md5("CVE-2022-4328");unlink(__FILE__);?>`.  
- Follow-up GET to `/wp-content/uploads/cfom_files/{lowercase(randstr)}.php`.  
Matcher confirms the MD5 hash appears in the second response body, verifying successful upload and PHP code execution.

## References
- https://wpscan.com/vulnerability/4dc72cd2-81d7-4a66-86bd-c9cfaf690eed
- https://wordpress.org/plugins/n-media-woocommerce-checkout-fields/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4328
