---
cve_id: CVE-2022-0479
template_path: nuclei-templates/http/cves/2022/CVE-2022-0479.yaml
affected_product: Popup Builder WordPress plugin
severity: critical
authentication: required
external_callback: false
affected_versions: < 4.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Popup Builder WordPress plugin (Sygnoos) is vulnerable to SQL injection (CWE-89) and reflected XSS via the `sgpb-subscription-popup-id` parameter on the admin subscribers page (`/wp-admin/edit.php?post_type=popupbuilder&page=sgpbSubscribers`).  
Description: The plugin before 4.1.1 fails to sanitize the parameter in both SQL queries and HTML output.  
Impact: Authenticated attackers can execute arbitrary SQL and inject scripts.  
CVSS: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: Update to version 4.1.1 or later.

## PoC / Detection
Classification: info-leak

The template first fingerprints the plugin by requesting `/` and confirming the presence of `/wp-content/plugins/popup-builder` in the response body. It then performs a full WordPress admin login via `POST /wp-login.php` using the supplied `{{username}}`/`{{password}}` credentials. Finally it issues a `GET` request to the subscribers page injecting the payload `0) union all select 1,0x3c696d6720737263206f6e6572726f723d616c65727428646f63756d656e742e646f6d61696e293e,3,4,5,6 --g` (decoded: UNION SELECT containing `<img src onerror=alert(document.domain)>`). Detection succeeds if the response status is 200, `Content-Type` contains `text/html`, and the exact string `<img src=onerror=alert(document.domain)></td><td>` appears unescaped in the body.

## References
