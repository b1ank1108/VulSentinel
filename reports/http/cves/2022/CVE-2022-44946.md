---
cve_id: CVE-2022-44946
template_path: nuclei-templates/http/cves/2022/CVE-2022-44946.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Rukovoditel <= 3.2.1 contains a stored cross-site scripting (XSS) vulnerability in the Add Page function at `/index.php?module=help_pages/pages&entities_id=24`. Authenticated attackers can inject arbitrary web scripts or HTML via a crafted payload in the Title (`name`) field; the payload is stored unsanitized and executes when the page is viewed by other users.

**CVSS:** 5.4 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**Impact:** Malicious JavaScript can steal administrator credentials, hijack sessions, and expose project management data when the crafted help page is rendered.

## PoC / Detection
Classification: info-leak

The template first issues a GET to `/index.php?module=users/login` to extract the `form_session_token` nonce via regex, then authenticates via POST to the login action using supplied `username`/`password`. It then sends a POST to `/index.php?module=help_pages/pages&action=save&entities_id=24` containing the payload `name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`. Detection matches on the third response: status_code == 200, content-type containing "text/html", body containing the unsanitized `<script>alert(document.domain)</script>` string plus "rukovoditel".

## References
- https://github.com/anhdq201/rukovoditel/issues/15
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-44946
- http://rukovoditel.com
