---
cve_id: CVE-2022-45805
template_path: nuclei-templates/http/cves/2022/CVE-2022-45805.yaml
affected_product: WordPress Paytm Payment Gateway plugin
severity: critical
authentication: required
external_callback: false
affected_versions: <=2.7.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Paytm Payment Gateway plugin through version 2.7.3 contains an authenticated SQL injection vulnerability. The vulnerability allows authenticated attackers to inject arbitrary SQL queries into the application's database through vulnerable parameters. This is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8 (Critical). An attacker who successfully exploits this vulnerability can potentially obtain sensitive information from the database, modify data, and execute unauthorized administrative operations in the context of the affected WordPress site. The vulnerability exists in the post.php endpoint when processing the 'post' parameter.

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection detection by:

1. First authenticating to the WordPress admin panel by sending credentials via POST to `/wp-login.php`
2. Then sending a GET request to `/wp-admin/post.php` with a malicious SQL injection payload in the 'post' parameter: `post=1+AND+(SELECT+6205+FROM+(SELECT(SLEEP(6)))RtRs)&action=edit`
3. The payload attempts to trigger a 6-second delay using SQL SLEEP function

The template confirms the vulnerability by checking:
- Response time is 6 seconds or greater (indicating successful SQL injection execution)
- HTTP status code is 200
- Response body contains "toplevel_page_paytm" (confirming the Paytm plugin context)

The time-based approach is used because the vulnerability is a blind SQL injection where direct data extraction is not immediately visible in the response.

## References

- https://patchstack.com/database/vulnerability/paytm-payments/wordpress-paytm-payment-gateway-plugin-2-7-3-auth-sql-injection-sqli-vulnerability
- https://wordpress.org/plugins/paytm-payments/
- https://nvd.nist.gov/vuln/detail/CVE-2022-45805
- https://patchstack.com/database/vulnerability/paytm-payments/wordpress-paytm-payment-gateway-plugin-2-7-3-auth-sql-injection-sqli-vulnerability?_s_id=cve
- https://github.com/ARPSyndicate/kenzer-templates
