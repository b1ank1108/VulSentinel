---
cve_id: CVE-2022-0220
template_path: nuclei-templates/http/cves/2022/CVE-2022-0220.yaml
affected_product: WordPress GDPR & CCPA plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <1.9.27
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress GDPR & CCPA plugin before 1.9.27 is vulnerable to reflected cross-site scripting (XSS) via the `check_privacy_settings` AJAX action (available to unauthenticated users). The endpoint returns JSON-like data without an `application/json` Content-Type header, allowing attacker-controlled input in the `settings[41]` parameter to be interpreted and executed as HTML/JavaScript in the victim's browser context.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1). CWE-116. Impact includes client-side data theft, session hijacking, or defacement. Fixed by adding CSRF check in 1.9.26 (full patch in 1.9.27).

## PoC / Detection
Classification: info-leak

The template first issues `GET /wp-admin` to extract a valid WordPress nonce via regex from the response body. It then chains a `POST /wp-admin/admin-ajax.php` request (Content-Type: application/x-www-form-urlencoded) containing `action=check_privacy_settings&settings[41]=<body onload=alert(document.domain)>` and the extracted nonce. Detection succeeds if response #2 has status 200, Content-Type containing `text/html`, and the body reflects the exact unescaped payload string while also containing `/wp-content/plugins/`.

## References
- https://wpscan.com/vulnerability/a91a01b9-7e36-4280-bc50-f6cff3e66059
- https://nvd.nist.gov/vuln/detail/CVE-2022-0220
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
