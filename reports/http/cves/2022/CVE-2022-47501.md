---
cve_id: CVE-2022-47501
template_path: nuclei-templates/http/cves/2022/CVE-2022-47501.yaml
affected_product: Apache OFBiz
severity: high
authentication: none
external_callback: false
affected_versions: before 18.12.07
preconditions: Solr plugin enabled
poc_classification: info-leak
---

## Vulnerability
Apache OFBiz < 18.12.07 contains a pre-authentication local file inclusion vulnerability when using the Solr plugin. Unauthenticated attackers can read arbitrary files from the server filesystem through the Solr plugin debug endpoint (`/solr/solrdefault/debug/dump?param=ContentStreams&stream.url=file://...`), exposing configuration files, credentials, and other sensitive system information (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, score 7.5; CWE-22).

## PoC / Detection
Classification: info-leak

The template performs GET requests to `{{BaseURL}}/solr/solrdefault/debug/dump?param=ContentStreams&stream.url=file://{{path}}` using payloads `/etc/passwd` (Linux) and `c:/windows/win.ini` (Windows), stopping at first match. It verifies exploitation via DSL matchers checking HTTP 200 status plus either `regex('root:.*:0:0:', body)` or body containing Windows INI strings (`bit app support`, `fonts`, `extensions`).

## References
- https://lists.apache.org/thread/k8s76l0whydy45bfm4b69vq0mf94p3wc
- http://www.openwall.com/lists/oss-security/2023/04/18/5
- https://nvd.nist.gov/vuln/detail/CVE-2022-47501
- http://www.openwall.com/lists/oss-security/2023/04/18/9
- http://www.openwall.com/lists/oss-security/2023/04/19/1
