---
cve_id: CVE-2022-0787
template_path: nuclei-templates/http/cves/2022/CVE-2022-0787.yaml
affected_product: Limit Login Attempts (Spam Protection)
severity: critical
authentication: none
external_callback: false
affected_versions: < 5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The Limit Login Attempts (Spam Protection) WordPress plugin before 5.1 fails to sanitise and escape parameters before using them in SQL statements via AJAX actions available to unauthenticated users. This leads to time-based blind SQL injection. Unauthenticated remote attackers can extract database contents (WordPress user credentials and login attempt data). Fixed in version 5.1. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: info-leak

The template issues a single POST to `/wp-admin/admin-ajax.php` (Content-Type: application/x-www-form-urlencoded) containing `action=WPLFLA_get_log_data&order[][column]=0&columns[][data]=(SELECT+7382+FROM+(SELECT(SLEEP(6)))ameU)`. It detects the vulnerability by confirming the response duration is >=6 seconds, status_code==200, Content-Type contains "text/html", and body contains "iTotalDisplayRecords".

## References
- https://wpscan.com/vulnerability/69329a8a-2cbe-4f99-a367-b152bd85b3dd
- https://wordpress.org/plugins/wp-limit-failed-login-attempts/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0787
- https://github.com/cyllective/CVEs
