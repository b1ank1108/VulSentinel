---
cve_id: CVE-2022-24265
template_path: nuclei-templates/http/cves/2022/CVE-2022-24265.yaml
affected_product: Cuppa CMS
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: Requires valid administrator credentials
poc_classification: info-leak
---

## Vulnerability
Cuppa CMS v1.0 contains a time-based blind SQL injection vulnerability in the administrator menu component at `/administrator/components/menu/` via the `path=component/menu/&menu_filter=3` parameter (CWE-89). Successful exploitation enables unauthorized database access, full data leakage, and potential full system compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, score 7.5).

## PoC / Detection
Classification: info-leak  
The template first authenticates by sending a POST to `/` with `user={{username}}&password={{password}}&task=login`. It then issues a second POST to `/components/menu/` that injects the time-based blind SQLi payload `' and sleep(6)--+-` into the `menu_filter` value inside the `path` parameter (base64-encoded `data_get` payload also supplied). Detection matches on server response delay (`duration>=6`), HTTP 200 status on the second request, `text/html` content-type, and presence of the string `menu/html/edit.php` in the body.

## References
- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-24265
- https://github.com/truonghuuphuc/CVE
- https://github.com/Nguyen-Trung-Kien/CVE-1
- https://github.com/oxf5/CVE
