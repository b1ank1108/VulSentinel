---
cve_id: CVE-2022-44944
template_path: nuclei-templates/http/cves/2022/CVE-2022-44944.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: [user with permission to create announcements]
poc_classification: state-change
---

## Vulnerability
Rukovoditel <= 3.2.1 contains a stored cross-site scripting (XSS) vulnerability in the Add Announcement function at `/index.php?module=help_pages/pages&entities_id=24`. Authenticated attackers inject arbitrary JavaScript or HTML via a crafted payload in the Title (`name`) field; the payload is stored unsanitized and executes in the browser context of any user viewing the announcement.

CVSS: 5.4 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
CWE: CWE-79  
Impact: session hijacking, credential theft, or defacement.  
Remediation: upgrade to 3.2.2 or later.

## PoC / Detection
Classification: state-change

Template GETs the login page and extracts the `form_session_token` nonce via regex, POSTs provided username/password to complete authentication, then POSTs to the announcement save endpoint with the payload `<script>alert(document.domain)</script>` in the `name` field. Detection matches on the final response (status 200, HTML content-type, body containing the raw unsanitized script tag plus "rukovoditel" string), confirming the malicious data was written without sanitization.

## References
- https://github.com/anhdq201/rukovoditel/issues/14
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-44944
- http://rukovoditel.com
