---
cve_id: CVE-2022-1040
template_path: nuclei-templates/http/cves/2022/CVE-2022-1040.yaml
affected_product: Sophos Firewall
severity: critical
authentication: none
external_callback: false
affected_versions: <=18.5 MR3
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2022-1040 is a critical authentication bypass vulnerability in Sophos Firewall version 18.5 MR3 and older that affects both the User Portal and Webadmin interfaces. The vulnerability allows remote attackers to bypass authentication mechanisms (CWE-287) and execute arbitrary code on the affected firewall system without requiring any credentials. With a CVSS score of 9.8 and an EPSS score of 0.94439 (99.987th percentile), this vulnerability represents an extremely high risk of active exploitation. Successful exploitation could lead to complete compromise of the firewall, including unauthorized access to sensitive data, modification of firewall configurations, and potential pivot points into protected networks.

## PoC / Detection

Classification: auth-bypass

The template detects this vulnerability by sending a crafted POST request to the User Portal endpoint (`/userportal/Controller`) with specific parameters that exploit the authentication bypass. The request includes:
- Mode parameter set to 8700 with operation 1
- A datagrid parameter set to 179
- A JSON payload containing a test value with an unusual Unicode character (`{"ðŸ¦ž":"test"}`)
- An `X-Requested-With: XMLHttpRequest` header to simulate an AJAX request

The vulnerability is confirmed when the server responds with:
1. HTTP 200 status code
2. A body containing `{"status":"Session Expired"}` message
3. A `Server: xxxx` header in the response

This detection pattern indicates that the endpoint is accessible without proper authentication and processes the request, revealing the authentication bypass condition. The "Session Expired" message paradoxically confirms the vulnerability exists, as the endpoint should reject unauthenticated requests entirely rather than processing them and returning session-related messages.

## References

- https://github.com/killvxk/CVE-2022-1040
- https://github.com/CronUp/Vulnerabilidades/blob/main/CVE-2022-1040_checker
- https://nvd.nist.gov/vuln/detail/CVE-2022-1040
- https://www.sophos.com/en-us/security-advisories/sophos-sa-20220325-sfos-rce
- https://github.com/Mr-xn/Penetration_Testing_POC
