---
cve_id: CVE-2022-0412
template_path: nuclei-templates/http/cves/2022/CVE-2022-0412.yaml
affected_product: WordPress TI WooCommerce Wishlist plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <1.40.1
preconditions: TI WooCommerce Wishlist plugin installed and active on WordPress
poc_classification: info-leak
---

## Vulnerability
WordPress TI WooCommerce Wishlist plugin before 1.40.1 contains a SQL injection vulnerability. The plugin does not sanitize and escape the `item_id` parameter before using it in a SQL statement via the `wishlist/remove_product` REST endpoint.

Successful exploitation leads to unauthorized access to the WordPress database (data exfiltration, modification or deletion possible). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8) | CWE-89 | verified in template metadata.

## PoC / Detection
Classification: info-leak

The template issues a single raw GET request (`@timeout:15s`) to `/?rest_route=/wc/v3/wishlist/remove_product/1&item_id=0%20union%20select%20sleep(7)%20--%20g` and confirms the time-based blind SQLi by matching all three conditions: response duration >=7 seconds, body contains the string "Product not found", and HTTP status 400.

## References
- https://wpscan.com/vulnerability/e984ba11-abeb-4ed4-9dad-0bfd539a9682
- https://wordpress.org/plugins/ti-woocommerce-wishlist/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0412
- https://plugins.trac.wordpress.org/changeset/2668899
- https://github.com/ARPSyndicate/cvemon
