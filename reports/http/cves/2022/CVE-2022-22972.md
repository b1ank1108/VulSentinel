---
cve_id: CVE-2022-22972
template_path: nuclei-templates/http/cves/2022/CVE-2022-22972.yaml
affected_product: VMware Workspace ONE Access/Identity Manager/vRealize Automation
severity: critical
authentication: none
external_callback: true
affected_versions: Identity Manager 3.3.3 (additional affected versions likely but not fully specified in template)
preconditions: [Network access to the UI, local domain users configured]
poc_classification: auth-bypass
---

## Vulnerability

CVE-2022-22972 is a critical authentication bypass vulnerability affecting VMware Workspace ONE Access, Identity Manager, and vRealize Automation. The vulnerability specifically impacts local domain users and allows a malicious actor with network access to the user interface to obtain administrative access without authentication. This is classified as CWE-287 (Improper Authentication) with a CVSS score of 9.8, indicating maximum severity across availability, confidentiality, and integrity impacts. The EPSS score of 0.93758 (99.846th percentile) indicates this vulnerability is actively exploited in the wild.

The flaw enables attackers to bypass authentication mechanisms entirely, gaining unauthorized administrative privileges to the affected VMware identity and access management systems. This represents a complete failure of authentication controls for local domain user accounts.

## PoC / Detection

Classification: auth-bypass

The template performs a three-step detection process to verify the authentication bypass vulnerability:

1. **Initial request**: Sends a GET request to `/vcac/` to establish baseline connectivity
2. **State extraction**: Sends a second GET request to `/vcac/?original_uri={{RootURL}}%2Fvcac` to extract authentication state parameters including `protected_state`, `horizonRelayState`, `userstore`, `userstoreDisplay`, and `stickyConnectorId` from the response body
3. **Bypass attempt**: Sends a POST request to `/SAAS/auth/login/embeddedauthbroker/callback` with the extracted state parameters and hardcoded credentials (`username=administrator&password=horizon`) to an attacker-controlled interactsh server

The template confirms successful exploitation by checking for:
- The presence of an `HZN=` session cookie in the response headers (indicating successful authentication)
- HTTP callback to the interactsh server (confirming the authentication flow completed)
- HTTP 302 redirect status (indicating successful login redirect)

The use of interactsh-url as the Host header in the final POST request allows detection of the vulnerability through out-of-band HTTP callbacks, confirming that the authentication bypass can be triggered without valid credentials.

## References

- https://github.com/horizon3ai/CVE-2022-22972
- https://www.horizon3.ai/vmware-authentication-bypass-vulnerability-cve-2022-22972-technical-deep-dive
- https://www.vmware.com/security/advisories/VMSA-2022-0014.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-22972
- https://github.com/djytmdj/Tool_Summary
