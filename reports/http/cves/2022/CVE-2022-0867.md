---
cve_id: CVE-2022-0867
template_path: nuclei-templates/http/cves/2022/CVE-2022-0867.yaml
affected_product: WordPress ARPrice
severity: critical
authentication: none
external_callback: false
affected_versions: <3.6.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress ARPrice plugin prior to 3.6.1 contains a SQL injection vulnerability. It fails to properly sanitize and escape user supplied POST data before being inserted in an SQL statement and executed via an AJAX action. An unauthenticated attacker can obtain sensitive information, modify data, and/or execute unauthorized administrative operations.

## PoC / Detection
Classification: info-leak

The template performs a time-based blind SQL injection check by sending a POST request to `/wp-admin/admin-ajax.php` containing the payload `arp_template_id=1+AND+(SELECT+8948+FROM+(SELECT(SLEEP(6)))iIic)` in the `arplite_insert_plan_id` action. It measures whether the response duration is >=6 seconds, then issues a second GET request to `/wp-content/plugins/arprice-responsive-pricing-table/js/arprice.js` and confirms the plugin is present by checking for the string "ArpPriceTable" in the body.

## References
- https://wpscan.com/vulnerability/62803aae-9896-410b-9398-3497a838e494
- https://wordpress.org/plugins/arprice-responsive-pricing-table/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0867
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
