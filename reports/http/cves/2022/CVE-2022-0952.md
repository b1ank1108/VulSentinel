---
cve_id: CVE-2022-0952
template_path: nuclei-templates/http/cves/2022/CVE-2022-0952.yaml
affected_product: WordPress Sitemap by click5
severity: high
authentication: none
external_callback: false
affected_versions: <1.0.36
preconditions: []
poc_classification: state-change
---

## Vulnerability
WordPress Sitemap by click5 plugin before 1.0.36 is susceptible to missing authorization. The plugin does not have authorization or CSRF checks when updating options via a REST endpoint and does not ensure that the option to be updated belongs to the plugin. An attacker can possibly obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (score 8.8). CWE-352.

## PoC / Detection
Classification: state-change

The template sends three unauthenticated raw POST requests to `/wp-json/click5_sitemap/API/update_html_option_AJAX` with JSON payloads that set `users_can_register` to "1", then `default_role` to "administrator", then reset `users_can_register` to "0". It verifies exploitation success via `and` matchers requiring HTTP 200 status, `application/json` Content-Type header, and each response body containing the respective updated option key.

## References
- https://wpscan.com/vulnerability/0f694961-afab-44f9-846c-e80a0f6c768b
- https://nvd.nist.gov/vuln/detail/CVE-2022-0952
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/RandomRobbieBF/CVE-2022-0952
- https://github.com/nomi-sec/PoC-in-GitHub
