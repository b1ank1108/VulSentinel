---
cve_id: CVE-2022-0381
template_path: nuclei-templates/http/cves/2022/CVE-2022-0381.yaml
affected_product: WordPress Embed Swagger plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <=1.0.0
preconditions: Embed Swagger plugin installed on a WordPress site
poc_classification: info-leak
---

## Vulnerability
WordPress Embed Swagger plugin <=1.0.0 contains a reflected cross-site scripting (XSS) vulnerability in `swagger-iframe.php` due to insufficient escaping/sanitization/validation of the `url` parameter. An attacker can inject arbitrary web scripts that execute in the victim's browser context (CWE-79, CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1). Impact includes session hijacking, page defacement, or theft of sensitive information.

## PoC / Detection
Classification: info-leak

The template first issues an internal GET to `/wp-content/plugins/embed-swagger/readme.txt` and matches for both 'Embed Swagger' and 'Tags:' to confirm plugin presence. It then sends a GET to `{{BaseURL}}/wp-content/plugins/embed-swagger/swagger-iframe.php?url=xss://%22-alert(document.domain)-%22` and matches on status 200, `text/html` Content-Type header, and the exact unsanitized payload string reflected in the body (`url: "xss://"-alert(document.domain)`), verifying the lack of sanitization that enables client-side data exfiltration via JavaScript.

## References
- https://gist.github.com/Xib3rR4dAr/4b3ea7960914e23c3a875b973a5b37a3
- https://www.wordfence.com/vulnerability-advisories/#CVE-2022-0381
- https://nvd.nist.gov/vuln/detail/CVE-2022-0381
- https://plugins.trac.wordpress.org/browser/embed-swagger/trunk/swagger-iframe.php#L59
- https://github.com/ARPSyndicate/cvemon
