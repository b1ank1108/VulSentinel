---
cve_id: CVE-2022-0765
template_path: nuclei-templates/http/cves/2022/CVE-2022-0765.yaml
affected_product: WordPress Loco Translate plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 2.6.1
preconditions: Loco Translate plugin installed and activated on WordPress; user has access to translation editor
poc_classification: state-change
---

## Vulnerability
Stored cross-site scripting (XSS) in Loco Translate WordPress plugin before 2.6.1.  
Caused by failure to strip inline event handlers (e.g. `ontoggle=`) from source translation strings in POT files.  
Authenticated attackers can inject arbitrary JavaScript that is saved and later rendered unsanitized in the admin panel.  
CVSS 3.1: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N). CWE-79.  
Impact: session hijacking, admin account takeover, or UI defacement when any admin views the affected translation file.  
Remediation: update to 2.6.1 or newer.

## PoC / Detection
Classification: state-change

The template executes the full attack chain:  
1. POST to `/wp-login.php` with supplied username/password to obtain an authenticated session.  
2. GET to the Loco Translate file-edit page (`?path=plugins/loco-translate/languages/loco-translate.pot`) and extracts the `loco-nonce` via regex.  
3. POST to `/wp-admin/admin-ajax.php` (action=loco_json, route=save) with a crafted multipart PO payload containing `msgid "\">'><details/open/ontoggle=alert(document.domain)>"`.  
4. Final GET to the same edit page verifies the exact payload string appears unsanitized in the response body, confirming the translation file was modified with the XSS vector.

## References
- https://wpscan.com/vulnerability/58838f51-323d-41e0-8c85-8e113dc2c587
- https://patchstack.com/database/vulnerability/loco-translate/wordpress-loco-translate-plugin-2-6-0-authenticated-stored-cross-site-scripting-xss-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2022-0765
