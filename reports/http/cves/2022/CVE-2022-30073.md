---
cve_id: CVE-2022-30073
template_path: nuclei-templates/http/cves/2022/CVE-2022-30073.yaml
affected_product: WBCE CMS
severity: medium
authentication: required
external_callback: false
affected_versions: 1.5.2
preconditions: requires administrator login and access to user management
poc_classification: state-change
---

## Vulnerability
WBCE CMS 1.5.2 contains a stored cross-site scripting vulnerability via the Display Name parameter when saving users through `/admin/user/save.php` (processed via `/admin/users/index.php`).

Authenticated administrative users can inject arbitrary JavaScript that persists on the server and executes for any user (including other administrators) viewing the affected page. 

Impact includes session hijacking via `alert(document.cookie)`, data theft, or site defacement. 

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4) | CWE-79.

## PoC / Detection
Classification: state-change

The template verifies the vulnerability through a four-request sequence that performs data modification:

- POST login to `/admin/login/index.php` with supplied admin credentials.
- GET `/admin/users/index.php` to extract the CSRF `formtoken` via regex.
- POST to `/admin/users/index.php` to create a new user with `display_name=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E` (unsanitized XSS payload).
- GET `/admin/users/index.php` again and matches the raw `<script>alert(document.cookie)</script>` tag in the response body (plus "WBCECMS" string, text/html header, and 200 status).

This confirms successful storage of malicious data without sanitization.

## References
- https://github.com/APTX-4879/CVE
- https://github.com/APTX-4879/CVE/blob/main/CVE-2022-30073.pdf
- https://nvd.nist.gov/vuln/detail/CVE-2022-30073
- https://github.com/ARPSyndicate/kenzer-templates
