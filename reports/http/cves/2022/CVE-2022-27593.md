---
cve_id: CVE-2022-27593
template_path: nuclei-templates/http/cves/2022/CVE-2022-27593.yaml
affected_product: QNAP QTS Photo Station
severity: critical
authentication: none
external_callback: false
affected_versions: QTS 5.0.1: Photo Station <6.1.2; QTS 5.0.0/4.5.x: <6.0.22; QTS 4.3.6: <5.7.18; QTS 4.3.3: <5.4.15; QTS 4.2.6: <5.2.14
preconditions: []
poc_classification: info-leak
---

## Vulnerability
QNAP QTS Photo Station is vulnerable to local file inclusion via an externally controlled reference to a resource in the `combine.php` endpoint (CWE-610). If exploited, this could allow an attacker to modify system files. An attacker can exploit this vulnerability to read sensitive files, execute arbitrary code, or launch further attacks. CVSS v3.1: 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H).

## PoC / Detection
Classification: info-leak

The template sends a GET request to `/photo/combine.php?type=javascript&g=core-r7rules/../../../hello.php.` and confirms the condition with HTTP 200 status plus presence of the strings `!function(p,qa){`, `module.exports`, and `application/javascript` in the response body.

## References
- https://attackerkb.com/topics/7We3SjEYVo/cve-2022-27593
- https://www.qnap.com/en/security-advisory/qsa-22-24
- https://nvd.nist.gov/vuln/detail/CVE-2022-27593
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
