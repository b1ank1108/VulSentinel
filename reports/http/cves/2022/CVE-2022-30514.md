---
cve_id: CVE-2022-30514
template_path: nuclei-templates/http/cves/2022/CVE-2022-30514.yaml
affected_product: School Dormitory Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

School Dormitory Management System 1.0 contains an authenticated cross-site scripting vulnerability in `admin/inc/navigation.php:126`. An attacker with valid credentials can inject arbitrary JavaScript via the `s` query parameter on `/dms/admin/`, which is reflected unsanitized into the page. This executes in the victim's browser context, enabling theft of cookie-based authentication credentials, defacement, or additional client-side attacks.

CVSS: 6.1 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
CWE: CWE-79  
Impact: Session hijacking and sensitive information theft.  
Remediation: Upgrade to the latest version.

## PoC / Detection

Classification: info-leak

The template first performs a POST request to `/dms/admin/login.php?f=login` with `username` and `password` parameters to establish an authenticated session (with redirects enabled). It then sends a GET request to `/dms/admin/?s=%27%3B%20alert(document.domain)%3B%20s%3D%27` embedding the XSS payload. Detection succeeds when the second response body contains both the literal unsanitized payload string `''; alert(document.domain); s='';` and the application banner "School Dormitory Management System" under HTTP 200 status.

## References

- https://github.com/bigzooooz/CVE-2022-30514
- https://www.sourcecodester.com/php/15319/school-dormitory-management-system-phpoop-free-source-code.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30514
- https://nvd.nist.gov/vuln/detail/CVE-2022-30514
- https://github.com/Marcuccio/kevin
