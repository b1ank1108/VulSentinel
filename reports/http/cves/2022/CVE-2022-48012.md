---
cve_id: CVE-2022-48012
template_path: nuclei-templates/http/cves/2022/CVE-2022-48012.yaml
affected_product: OpenCATS
severity: medium
authentication: required
external_callback: false
affected_versions: 0.9.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OpenCATS 0.9.7 is vulnerable to a reflected cross-site scripting (XSS) issue in the `/index.php?m=settings&a=ajax_tags_upd` component. The vulnerability occurs when the `tag_title` parameter in a POST request is not properly sanitized, allowing injection of arbitrary JavaScript (e.g., `<script>alert(document.domain);</script>`). 

This flaw enables an attacker to execute scripts in the victim's browser context, potentially leading to session hijacking via cookie theft, page defacement, or exfiltration of sensitive data. The issue has a CVSS v3.1 score of 6.1 (Medium): AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N and is classified as CWE-79.

## PoC / Detection
Classification: info-leak

The template verifies the vulnerability with a sequence of HTTP requests:
1. GET /index.php to confirm the OpenCATS login page is present.
2. POST /index.php?m=login&a=attemptLogin with username/password to authenticate.
3. POST /index.php?m=settings&a=ajax_tags_upd with the XSS payload in tag_title.

Matchers check for the login page and unsanitized reflection of the `<script>alert(document.domain);</script>` payload in the final response body.

## References
- https://github.com/Sakura-501/Opencats-0.9.7-Vulnerabilities
- https://github.com/Sakura-501/Opencats-0.9.7-Vulnerabilities/blob/main/Opencats-0.9.7-Reflected%20XSS%20in%20onChangeTag.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-48012
