---
cve_id: CVE-2022-0864
template_path: nuclei-templates/http/cves/2022/CVE-2022-0864.yaml
affected_product: UpdraftPlus
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.22.9
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2022-0864 is a Reflected Cross-Site Scripting (XSS) vulnerability in the UpdraftPlus WordPress plugin affecting versions prior to 1.22.9. The vulnerability exists due to insufficient sanitization and escaping of the `updraft_interval` parameter before it is output in an admin page. An attacker can inject malicious JavaScript code through this parameter, which will be reflected back and executed in the context of an authenticated administrator's browser session.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low confidentiality and integrity impact.

Successful exploitation could enable attackers to inject malicious scripts leading to data theft, session hijacking, or website defacement when an authenticated administrator is tricked into accessing a crafted URL.

## PoC / Detection

Classification: state-change

The Nuclei template performs authenticated testing to detect this XSS vulnerability. It executes a two-step process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Injection**: Sends a GET request to `/wp-admin/options-general.php?page=updraftplus` with a crafted `updraft_interval` parameter containing an XSS payload: `"></script><script>confirm('document_domain')</script>`

The template confirms the vulnerability by checking for:
- The reflected XSS payload `<script>confirm('document_domain')</script>` in the response body
- The presence of "Existing backups" text (confirming the UpdraftPlus admin page loaded)
- A 200 HTTP status code
- Content-Type header indicating HTML response

The detection verifies that the malicious script is reflected unescaped in the admin interface, confirming the XSS vulnerability is exploitable.

## References

- https://wpscan.com/vulnerability/7337543f-4c2c-4365-aebf-3423e9d2f872
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0864
- https://wordpress.org/plugins/updraftplus
- https://github.com/ARPSyndicate/cvemon
