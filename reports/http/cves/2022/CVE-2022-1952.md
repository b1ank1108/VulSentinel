---
cve_id: CVE-2022-1952
template_path: nuclei-templates/http/cves/2022/CVE-2022-1952.yaml
affected_product: WordPress eaSYNC Booking
severity: critical
authentication: none
external_callback: false
affected_versions: <1.1.16
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress eaSYNC Booking plugin (for hotels, restaurants, and car rentals) before 1.1.16 is vulnerable to arbitrary file upload via the `easync_session_store` AJAX action in `/wp-admin/admin-ajax.php`. The plugin defines an allowlist of valid file extensions but does not enforce it during validation of multipart uploads (e.g., `driver_license_image2`). Unauthenticated attackers can upload arbitrary PHP files to `/wp-content/uploads/`.

- **CVSS v3.1**: 9.8 (Critical) â€“ AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
- **CWE**: 434
- **Impact**: Remote code execution, enabling full compromise of the WordPress site.
- **Remediation**: Update to 1.1.16 or later.

## PoC / Detection
Classification: rce

The template verifies RCE by simulating the full exploit chain:
- Issues a multipart POST to `/wp-admin/admin-ajax.php` (action=`easync_session_store`, type=`car`, with_driver=`self-driven`) uploading `{{randstr}}.php` containing `<?php echo md5("CVE-2022-1952");unlink(__FILE__);?>` as `driver_license_image2` (with dummy `PHPSESSID` cookie).
- Follows with GET to `/wp-admin/admin-ajax.php?action=easync_success_and_save`.
- Extracts uploaded filename via regex (`wp-content/uploads/([0-9a-zA-Z]+).php`).
- GETs the uploaded file and matches the MD5 hash in `body_3` to confirm successful PHP execution.

## References
- https://wpscan.com/vulnerability/ecf61d17-8b07-4cb6-93a8-64c2c4fbbe04
- https://wordpress.org/plugins/easync-booking/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1952
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/cyllective/CVEs
