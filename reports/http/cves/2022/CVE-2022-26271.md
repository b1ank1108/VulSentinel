---
cve_id: CVE-2022-26271
template_path: nuclei-templates/http/cves/2022/CVE-2022-26271.yaml
affected_product: 74cms
severity: high
authentication: none
external_callback: false
affected_versions: 3.4.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-26271 is an arbitrary file read vulnerability in 74cmsSE version 3.4.1. The vulnerability exists in the `\index\controller\Download.php` file, where the `$url` parameter is not properly validated, allowing attackers to traverse the file system and read arbitrary files. This is classified as CWE-552 (Files or Directories Accessible to External Parties). The CVSS v3.1 score is 7.5 (High), with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction. Successful exploitation allows unauthorized access to sensitive information, including configuration files containing database credentials and other sensitive data.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the `/index/download/index` endpoint with crafted `name` and `url` parameters. Specifically, it attempts to read the `application/database.php` file by using path traversal (`../../application/database.php`) in the `url` parameter. The template verifies successful exploitation by checking for:

1. The presence of PHP code markers (`<?php`)
2. Configuration array syntax (`return array`)
3. Sensitive keywords (`password`, `database`) in the response body
4. The response Content-Type header set to `application/octet-stream`, indicating file download

The detection confirms that the application improperly handles file path parameters, allowing attackers to read sensitive configuration files containing database credentials and other critical information.

## References

- https://github.com/N1ce759/74cmsSE-Arbitrary-File-Reading/issues/1
- https://nvd.nist.gov/vuln/detail/cve-2022-26271
