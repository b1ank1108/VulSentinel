---
cve_id: CVE-2022-4049
template_path: nuclei-templates/http/cves/2022/CVE-2022-4049.yaml
affected_product: WordPress WP User plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 7.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-4049 is a critical SQL injection vulnerability in the WP User WordPress plugin through version 7.0. The vulnerability exists in the `wpuser_group_action` AJAX endpoint where the `id` parameter is not properly sanitized or escaped before being used in a SQL statement. This flaw is exploitable by unauthenticated users, allowing them to execute time-based blind SQL injection attacks against the WordPress database.

The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS v3.1 score of 9.8 (Critical), indicating network-based exploitation with low attack complexity, no privileges required, and no user interaction needed. The impact encompasses high confidentiality, integrity, and availability risks. Attackers can potentially extract sensitive database information including user credentials, personal data, and WordPress configuration details.

The flaw stems from improper input validation in the admin-ajax.php handler for the wpuser_group_action action, specifically when processing the `id` parameter during group action operations.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability through a time-based blind SQL injection technique. The detection process involves:

1. **Initial Request**: The template first sends a GET request to potential WP User plugin paths (`/index.php/user/` or `/user`) to extract a nonce value (`wpuser_update_setting`) from the response using regex pattern matching.

2. **SQL Injection Probe**: Using the extracted nonce, the template sends a POST request to `/wp-admin/admin-ajax.php` with:
   - Action: `wpuser_group_action`
   - Group action: `x`
   - The extracted nonce value
   - Malicious `id` parameter: `1+AND+(SELECT+1+FROM+(SELECT(SLEEP(6)))khkM)`

3. **Verification**: The template confirms the vulnerability by checking:
   - Response time is 6 seconds or greater (indicating successful SQL injection with SLEEP command)
   - HTTP status code is 200
   - Response contains `text/html` content type
   - Response body contains the string "Invalid Access"

The template uses a clusterbomb attack with multiple path payloads and stops at the first successful match. The 20-second timeout ensures sufficient time to detect the 6-second delay caused by the SQL SLEEP function.

## References

- https://wpscan.com/vulnerability/9b0781e2-ad62-4308-bafc-d45b9a2472be
- https://wordpress.org/plugins/wp-user/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4049
- https://github.com/cyllective/CVEs
