---
cve_id: CVE-2022-0870
template_path: nuclei-templates/http/cves/2022/CVE-2022-0870.yaml
affected_product: Gogs
severity: medium
authentication: required
external_callback: true
affected_versions: <0.12.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Gogs GitHub repository before 0.12.5 is susceptible to server-side request forgery (SSRF, CWE-918). An authenticated attacker can possibly obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.  
Impact: Successful exploitation can result in unauthorized access to sensitive internal resources.  
Remediation: Fixed in version 0.12.5.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (5.3).

## PoC / Detection
Classification: info-leak  
The template performs these steps:  
1. GET /user/login to extract `_csrf` token.  
2. POST /user/login with supplied `{{username}}`/`{{password}}` to obtain authenticated session.  
3. GET /repo/migrate to extract second `_csrf` token.  
4. POST /repo/migrate with `clone_addr=https://{{interactsh-url}}` (plus random repo name) to trigger SSRF.  
Detection succeeds if an OOB DNS or HTTP callback reaches interactsh and the login-page body contains `content="Gogs"`.

## References
- https://github.com/gogs/gogs/commit/91f2cde5e95f146bfe4765e837e7282df6c7cabb
- https://huntr.dev/bounties/327797d7-ae41-498f-9bff-cc0bf98cf531
- https://nvd.nist.gov/vuln/detail/CVE-2022-0870
- https://github.com/cokeBeer/go-cves
- https://github.com/michaellrowley/michaellrowley
