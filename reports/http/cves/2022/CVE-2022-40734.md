---
cve_id: CVE-2022-40734
template_path: nuclei-templates/http/cves/2022/CVE-2022-40734.yaml
affected_product: Laravel Filemanager
severity: medium
authentication: none
external_callback: false
affected_versions: through version 2.5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Laravel Filemanager (aka UniSharp) through version 2.5.1 contains a local file inclusion vulnerability via unsanitized `working_dir` parameter in the `/download` endpoint, enabling path traversal (e.g. `working_dir=%2F../../../../../../../../../../../../../../../../../../../etc`).  
**CVE ID:** CVE-2022-40734  
**CWE:** CWE-22 (Path Traversal)  
**CVSS 3.1:** 6.5 Medium (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)  
**Impact:** Unauthorized file reads leading to sensitive data exposure and potential remote code execution.

## PoC / Detection
Classification: info-leak

The template sends GET requests to `{{BaseURL}}/download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd` and the alternative path `{{BaseURL}}/laravel-filemanager/download?...` (stop-at-first-match), then applies a regex matcher for `root:[x*]:0:0` to confirm successful inclusion of `/etc/passwd`.

## References
- https://github.com/UniSharp/laravel-filemanager/issues/1150
- https://nvd.nist.gov/vuln/detail/CVE-2022-40734
- https://github.com/UniSharp/laravel-filemanager/issues/1150#issuecomment-1320186966
- https://github.com/UniSharp/laravel-filemanager/issues/1150#issuecomment-1825310417
- https://github.com/ARPSyndicate/cvemon
