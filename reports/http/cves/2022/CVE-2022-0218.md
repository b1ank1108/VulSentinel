---
cve_id: CVE-2022-0218
template_path: nuclei-templates/http/cves/2022/CVE-2022-0218.yaml
affected_product: HTML Email Template Designer
severity: medium
authentication: none
external_callback: false
affected_versions: < 3.1
preconditions: HTML Email Template Designer plugin installed and activated on a WordPress site
poc_classification: state-change
---

## Vulnerability
WordPress plugin HTML Email Template Designer (WP HTML Mail / wp-html-mail by codemiq) < 3.1 suffers from stored cross-site scripting via an unprotected REST-API endpoint (`/whm/v3/themesettings`). An unauthenticated attacker can inject arbitrary JavaScript into the subject field of email templates; the payload is stored server-side and executes in the browser context of any user (e.g., admins) who later views or receives the rendered template.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
Impact: session hijacking, credential theft, data exfiltration, or UI manipulation.  
Remediation: update to 3.1 or later.

## PoC / Detection
Classification: state-change

The template issues a single unauthenticated GET request to `{{BaseURL}}/index.php?rest_route=/whm/v3/themesettings` and verifies HTTP 200 status, `application/json` Content-Type header, and the simultaneous presence of the JSON keys `"background":` and `"footer":` in the response body. This confirms the vulnerable plugin installation and exposed endpoint that permits unauthenticated data writes (XSS payload storage).

## References
- https://www.wordfence.com/blog/2022/01/unauthenticated-xss-vulnerability-patched-in-html-email-template-designer-plugin/
- https://wordpress.org/plugins/wp-html-mail/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0218
- https://plugins.trac.wordpress.org/changeset/2656984/wp-html-mail/trunk/includes/class-template-designer.php
- https://github.com/ARPSyndicate/cvemon
