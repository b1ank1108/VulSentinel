---
cve_id: CVE-2022-34305
template_path: nuclei-templates/http/cves/2022/CVE-2022-34305.yaml
affected_product: Apache Tomcat Examples Web Application
severity: medium
authentication: required
external_callback: false
affected_versions: 8.5.50 to 8.5.81, 9.0.30 to 9.0.64, 10.0.0-M1 to 10.0.22, 10.1.0-M1 to 10.1.0-M16
preconditions: [Examples web application must be deployed and accessible]
poc_classification: info-leak
---

## Vulnerability

Apache Tomcat Examples Web Application contains a reflected cross-site scripting (XSS) vulnerability in the Form authentication example. The vulnerability exists in versions 8.5.50 to 8.5.81, 9.0.30 to 9.0.64, 10.0.0-M1 to 10.0.22, and 10.1.0-M1 to 10.1.0-M16. The flaw is caused by displaying unfiltered user data in the Form authentication example, allowing attackers to craft malicious input that executes arbitrary JavaScript in victim browsers. This can lead to session hijacking, website defacement, or redirection to malicious sites. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS score of 6.1 (Medium severity).

## PoC / Detection

Classification: info-leak

The template performs authenticated detection of the XSS vulnerability through a three-step process:

1. **Session Establishment**: Sends a GET request to `/examples/jsp/security/protected/index.jsp` to retrieve the JSESSIONID from the form action parameter
2. **Authentication**: Performs a POST request to `/examples/jsp/security/protected/j_security_check` with username and password credentials to authenticate to the protected area
3. **XSS Verification**: Sends a GET request to `/examples/jsp/security/protected/index.jsp` with a crafted payload in the `dataName` parameter containing `<script>alert(document.domain)</script>`

The template confirms the vulnerability by checking for:
- HTTP 200 status code
- Content-Type containing "text/html"
- The injected script tag reflected unescaped in the response body

The detection requires valid credentials (username and password variables) to access the protected examples area where the vulnerable Form authentication example resides.

## References

- https://nvd.nist.gov/vuln/detail/cve-2022-34305
- https://github.com/zeroc00I/CVE-2022-34305
- https://lists.apache.org/thread/k04zk0nq6w57m72w5gb0r6z9ryhmvr4k
- https://security.gentoo.org/glsa/202208-34
