---
cve_id: CVE-2022-0660
template_path: nuclei-templates/http/cves/2022/CVE-2022-0660.yaml
affected_product: Microweber
severity: high
authentication: required
external_callback: false
affected_versions: <1.2.11
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Microweber before 1.2.11 is susceptible to information disclosure. An error message is generated in microweber/microweber which contains sensitive information while viewing comments from load_module:comments#search=. An attacker can possibly obtain sensitive information (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, CWE-209).

## PoC / Detection
Classification: info-leak

The template first executes POST /api/user_login with username/password to obtain a session, then issues POST /module/ (Content-Type application/x-www-form-urlencoded, Referer pointing to admin/view:comments) containing class=module module-comments-manage, data-type=comments/manage and data-search-keyword set to a random string. It detects the flaw by matching the second response for status_code==500, header Content-Type text/html, and body containing QueryException, SQLSTATE and runQueryCallback strings, confirming error-based leakage of internal SQL details and stack traces.

## References
- https://huntr.dev/bounties/01fd2e0d-b8cf-487f-a16c-7b088ef3a291/
- https://github.com/advisories/GHSA-hhrj-wp42-32v3
- https://nvd.nist.gov/vuln/detail/CVE-2022-0660
- https://github.com/microweber/microweber/commit/2417bd2eda2aa2868c1dad1abf62341f22bfc20a
