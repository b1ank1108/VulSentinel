---
cve_id: CVE-2022-2187
template_path: nuclei-templates/http/cves/2022/CVE-2022-2187.yaml
affected_product: WordPress Contact Form 7 Captcha plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <0.1.2
preconditions: [Access to WordPress admin panel at /wp-admin/options-general.php]
poc_classification: state-change
---

## Vulnerability

WordPress Contact Form 7 Captcha plugin versions before 0.1.2 contain a reflected cross-site scripting (XSS) vulnerability classified as CWE-79. The vulnerability exists because the plugin fails to properly escape the `$_SERVER['REQUEST_URI']` parameter before outputting it back in an HTML attribute. This allows an attacker to inject arbitrary JavaScript code through crafted URLs.

The vulnerability has a CVSS v3.1 score of 6.1 (Medium severity) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, indicating it requires user interaction and can result in low confidentiality and integrity impacts with changed scope. The EPSS score of 0.07773 (91.788th percentile) suggests a relatively elevated probability of exploitation in the wild.

Successful exploitation could enable attackers to inject malicious scripts into the WordPress admin interface, potentially leading to session hijacking, credential theft, defacement, or theft of sensitive administrative information.

## PoC / Detection

Classification: state-change

The template detects this XSS vulnerability by sending a GET request to the WordPress admin settings page at `/wp-admin/options-general.php?page=cf7sr_edit` with a malicious payload that attempts to break out of an HTML attribute context and inject a JavaScript alert: `&"></script><script>alert(document.domain)</script>`.

The detection verifies successful exploitation through three conditions:
1. The injected payload `</script><script>alert(document.domain)</script>` is reflected in the response body
2. The string "Contact Form 7" appears in the response, confirming the plugin is active
3. The response has a 200 status code and Content-Type of text/html

This confirms the vulnerability allows arbitrary JavaScript injection that would execute in the context of an authenticated administrator's session.

## References

- https://wpscan.com/vulnerability/4fd2f1ef-39c6-4425-8b4d-1a332dabac8d
- https://wordpress.org/plugins/contact-form-7-simple-recaptcha
- https://nvd.nist.gov/vuln/detail/CVE-2022-2187
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
