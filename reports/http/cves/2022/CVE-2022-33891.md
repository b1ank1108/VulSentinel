---
cve_id: CVE-2022-33891
template_path: nuclei-templates/http/cves/2022/CVE-2022-33891.yaml
affected_product: Apache Spark UI
severity: high
authentication: none
external_callback: false
affected_versions: 3.0.3 and earlier, 3.1.1 to 3.1.2, and 3.2.0 to 3.2.1
preconditions: ['ACLs enabled (spark.acls.enable=true)', 'authentication filter configured']
poc_classification: rce
---

## Vulnerability
Apache Spark UI is susceptible to remote command injection (CVE-2022-33891, CWE-78). ACLs can be enabled via `spark.acls.enable`. With an authentication filter, the HttpSecurityFilter code path allows impersonation by providing an arbitrary user name in the `doAs` parameter. This reaches a permission check that builds a Unix shell command from attacker input and executes it.

CVSS 3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).  
Impact: unauthorized access, data leakage, and potential full system compromise.  
Remediation: apply the latest security patches or updates from Apache Spark.

## PoC / Detection
Classification: rce

The template sends a single GET request to `{{BaseURL}}/?doAs=` with the URL-encoded payload `` `echo CVE-2022-33891 | rev` `` and matches the string "19833-2202-EVC" in the response body to confirm arbitrary command execution.

## References
- https://github.com/W01fh4cker/cve-2022-33891
- https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc
- http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-33891
- http://www.openwall.com/lists/oss-security/2023/05/02/1
