---
cve_id: CVE-2022-1391
template_path: nuclei-templates/http/cves/2022/CVE-2022-1391.yaml
affected_product: WordPress Cab fare calculator
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.0.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Cab fare calculator plugin (by kanev) suffers from unauthenticated Local File Inclusion (CWE-22) via the unvalidated `controller` parameter passed directly to a `require` statement in `tblight.php`. The issue is present in all versions before 1.0.4.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
An attacker can read arbitrary files on the server (including `/etc/passwd`, configuration files, or source code), leading to full information disclosure and potential further compromise.

## PoC / Detection
Classification: info-leak  
The template performs a single unauthenticated GET request to `{{BaseURL}}/wp-content/plugins/cab-fare-calculator/tblight.php?controller=../../../../../../../../../../../etc/passwd%00&action=1&ajax=1`. It confirms successful LFI by checking for HTTP 200 and the regex match `root:[x*]:0:0` (the root entry from `/etc/passwd`) in the response body.

## References
- https://www.exploit-db.com/exploits/50843
- https://wordpress.org/plugins/cab-fare-calculator
- https://wpscan.com/vulnerability/680121fe-6668-4c1a-a30d-e70dd9be5aac
- https://nvd.nist.gov/vuln/detail/CVE-2022-1391
- https://github.com/ARPSyndicate/cvemon
