---
cve_id: CVE-2022-2627
template_path: nuclei-templates/http/cves/2022/CVE-2022-2627.yaml
affected_product: WordPress Newspaper
severity: medium
authentication: none
external_callback: false
affected_versions: < 12
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Newspaper theme versions prior to 12 (tagdiv) contain a reflected cross-site scripting flaw (CVE-2022-2627, CWE-79). The `loopState[moduleId]` parameter passed to the `td_ajax_loop` AJAX action at `/wp-admin/admin-ajax.php` is inserted into an HTML attribute without sanitization. Unauthenticated remote attackers can supply malicious payloads that execute in the victim's browser context when the AJAX response is rendered. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Successful exploitation enables data theft, session hijacking, or page defacement. Fixed in version 12.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated POST request to `/wp-admin/admin-ajax.php?td_theme_name=Newspaper&v=11.2` with form data `action=td_ajax_loop&loopState[moduleId]=--><form><math><img+onerror=alert(document.domain)+src=1><mtext></form>&loopState[server_reply_html_data]=`. It confirms the vulnerability by matching the exact unsanitized payload string (plus the theme-specific `td-block-` marker) in the response body, HTTP status 200, and `text/html` content-type header. This verifies reflection in an HTML context without escaping.

## References
- https://wpscan.com/vulnerability/038327d0-568f-4011-9b7e-3da39e8b6aea
- https://nvd.nist.gov/vuln/detail/CVE-2022-2627
