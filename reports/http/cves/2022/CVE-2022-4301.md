---
cve_id: CVE-2022-4301
template_path: nuclei-templates/http/cves/2022/CVE-2022-4301.yaml
affected_product: WordPress Sunshine Photo Cart plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <2.9.15
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress Sunshine Photo Cart plugin before 2.9.15 contains a reflected cross-site scripting (XSS) vulnerability (CVE-2022-4301, CWE-79). The plugin does not sanitize and escape a parameter before outputting it back in the page. An unauthenticated remote attacker can inject arbitrary script that executes in the context of the affected site's unsuspecting users. Successful exploitation can lead to theft of cookie-based authentication credentials, session hijacking, data theft, or defacement. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1). Fixed in version 2.9.15.

## PoC / Detection
Classification: info-leak

The template performs an unauthenticated GET request to `{{BaseURL}}/wp-login.php?action=register&redirect_to=x%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E`. It verifies the vulnerability if the response body simultaneously contains the unsanitized payload string `<script>alert(document.domain)</script>` and `Registration Form`, the `Content-Type` header contains `text/html`, and the status code is 200. This confirms the `redirect_to` parameter is reflected without HTML escaping on the registration page.

## References
- https://wpscan.com/vulnerability/a8dca528-fb70-44f3-8149-21385039179d
- https://nvd.nist.gov/vuln/detail/CVE-2022-4301
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/cyllective/CVEs
