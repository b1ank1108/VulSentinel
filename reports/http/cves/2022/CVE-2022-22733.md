---
cve_id: CVE-2022-22733
template_path: nuclei-templates/http/cves/2022/CVE-2022-22733.yaml
affected_product: Apache ShardingSphere ElasticJob-UI
severity: medium
authentication: required
external_callback: false
affected_versions: 3.0.0 and prior versions (3.x)
preconditions: guest account available
poc_classification: auth-bypass
---

## Vulnerability

Apache ShardingSphere ElasticJob-UI is affected by an Exposure of Sensitive Information to an Unauthorized Actor (CWE-200) that enables privilege escalation. An attacker who possesses guest account credentials can escalate privileges, resulting in unauthorized access and control of the ElasticJob-UI application. CVSS 3.1: 6.5 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N). This issue impacts the 3.x branch up to and including version 3.0.0.

## PoC / Detection
Classification: auth-bypass

The template sends a POST request to `/api/login` containing `{"username":"guest","password":"guest"}` and verifies the vulnerability by matching on a 200 OK response with `application/json` content-type that includes `"success":true`, `"isGuest":true`, and an `accessToken` value in the body.

## References
- https://www.vicarius.io/vsociety/blog/cve-2022-22733-apache-shardingsphere-elasticjob-ui-privilege-escalation
- https://nvd.nist.gov/vuln/detail/CVE-2022-22733
- https://lists.apache.org/thread/qpdsm936n9bhksb0rzn6bq1h7ord2nm6
- http://www.openwall.com/lists/oss-security/2022/01/20/2
- https://github.com/Zeyad-Azima/CVE-2022-22733
