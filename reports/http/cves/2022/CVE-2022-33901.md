---
cve_id: CVE-2022-33901
template_path: nuclei-templates/http/cves/2022/CVE-2022-33901.yaml
affected_product: WordPress MultiSafepay for WooCommerce
severity: high
authentication: none
external_callback: false
affected_versions: <=4.13.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress MultiSafepay for WooCommerce plugin through version 4.13.1 is affected by an unauthenticated arbitrary file read vulnerability. The flaw allows remote attackers to read arbitrary files on the web server via path traversal using the `log_filename` parameter when the `admin_init` action is called on `wp-admin/admin-ajax.php`. This can lead to disclosure of sensitive files (e.g., /etc/passwd, configuration files) in the context of the web server user.

CVSS 3.1 score: 7.5 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N). Impact includes potential further system compromise through leaked credentials or data.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/wp-admin/admin-ajax.php?action=admin_init&log_filename=../../../../../../../../../../../../../etc/passwd` and confirms exploitation success via AND matchers: HTTP 200 status, `application/octet-stream` Content-Type header, and regex match for `root:.*:0:0:` in the response body (verifying /etc/passwd contents were returned).

## References
- https://wordpress.org/plugins/multisafepay/
- https://wordpress.org/plugins/multisafepay/#developers
- https://patchstack.com/database/vulnerability/multisafepay/wordpress-multisafepay-plugin-for-woocommerce-plugin-4-13-1-unauthenticated-arbitrary-file-read-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2022-33901
- https://github.com/ARPSyndicate/kenzer-templates
