---
cve_id: CVE-2022-0595
template_path: nuclei-templates/http/cves/2022/CVE-2022-0595.yaml
affected_product: WordPress Drag and Drop Multiple File Upload - Contact Form 7 plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <1.3.6.3
preconditions: []
poc_classification: state-change
---

## Vulnerability

WordPress Drag and Drop Multiple File Upload - Contact Form 7 plugin versions before 1.3.6.3 contain an unauthenticated stored cross-site scripting (XSS) vulnerability. The plugin allows SVG files to be uploaded by default through the `dnd_codedropz_upload` AJAX action without proper sanitization or authentication checks. Since SVG files can contain embedded JavaScript code, attackers can upload malicious SVG files that execute arbitrary scripts when accessed by victims. This stored XSS vulnerability can lead to unauthorized access, session hijacking, data theft, or website defacement. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS score of 5.4.

## PoC / Detection

Classification: state-change

The template performs a two-step detection process:

1. **Upload malicious SVG file**: Sends a POST request to `/wp-admin/admin-ajax.php` with the AJAX action `dnd_codedropz_upload`. The request uploads an SVG file containing an XSS payload (`<svg xmlns="http://www.w3.org/2000/svg" onload="alert(document.domain)"/>`). The file is uploaded with a randomized filename and Content-Type of `image/jpeg` (though the actual content is SVG).

2. **Verify stored XSS**: Sends a GET request to retrieve the uploaded SVG file from the default upload location (`/wp-content/uploads/wp_dndcf7_uploads/wpcf7-files/`). The template confirms the vulnerability by checking that the response contains the XSS payload and returns a 200 status code.

The template successfully detects the vulnerability by demonstrating that malicious SVG files can be uploaded without authentication and stored on the server, creating a persistent XSS condition.

## References

- https://wpscan.com/vulnerability/1b849957-eaca-47ea-8f84-23a3a98cc8de
- https://plugins.trac.wordpress.org/changeset/2686614
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
