---
cve_id: CVE-2022-43167
template_path: nuclei-templates/http/cves/2022/CVE-2022-43167.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2022-43167 is a stored cross-site scripting (XSS) vulnerability in Rukovoditel version 3.2.1 and earlier. The vulnerability exists in the Users Alerts feature, specifically at the endpoint `/index.php?module=users_alerts/users_alerts`. An authenticated attacker can inject malicious JavaScript or HTML code through the Title parameter when creating a new alert by clicking "Add". The injected payload is stored in the application and executed when other users view the affected alert.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (Medium severity). The attack vector is network-based with low attack complexity, requires low privileges (authenticated user), and requires user interaction. The scope is changed, meaning the vulnerable component impacts resources beyond its security scope, with low impact to both confidentiality and integrity.

Successful exploitation allows attackers to execute arbitrary JavaScript in victims' browsers, potentially leading to session hijacking, credential theft, phishing attacks, or defacement of the application interface.

## PoC / Detection

Classification: state-change

The template performs an authenticated exploitation test by:

1. **Authentication**: First, it retrieves the login page to extract the CSRF token (form_session_token), then authenticates using provided credentials via POST to `/index.php?module=users/login&action=login`

2. **Payload Injection**: After successful authentication, it creates a new user alert by sending a POST request to `/index.php?module=users_alerts/users_alerts&action=save` with the following parameters:
   - `type=warning`
   - `title=<script>alert(document.domain)</script>` (XSS payload)
   - `description=` (empty)
   - `location=all`
   - Empty start and end dates

3. **Verification**: The template confirms successful exploitation by checking that:
   - The response returns HTTP 200
   - The response body contains the reflected XSS payload `<script>alert(document.domain)</script>`
   - The response body contains the string "rukovoditel" (confirming the application context)

The template demonstrates that the malicious script is stored and reflected back in the application response, confirming the stored XSS vulnerability.

## References

- https://github.com/anhdq201/rukovoditel/issues/7
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-43167
