---
cve_id: CVE-2022-34487
template_path: nuclei-templates/http/cves/2022/CVE-2022-34487.yaml
affected_product: WordPress Shortcode Addons plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 3.0.2
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2022-34487 is an unauthenticated arbitrary options update vulnerability in the WordPress Shortcode Addons plugin version 3.0.2 and earlier. The vulnerability stems from insufficient access controls in the plugin's REST API endpoint, allowing unauthenticated attackers to modify arbitrary WordPress options without any authentication. This critical flaw enables attackers to tamper with site configuration, potentially leading to site defacement, data manipulation, privilege escalation, or further exploitation vectors. The vulnerability is classified with a CVSS score of 9.8 (Critical) and has an EPSS score of 0.49676 (97.742 percentile), indicating a high probability of exploitation in the wild.

## PoC / Detection

Classification: state-change

The template performs a two-step verification process to detect the vulnerability:

1. **Exploitation Step**: Sends an unauthenticated POST request to the vulnerable REST API endpoint `/wp-json/ShortCodeAddonsUltimate/v2/addons_settings` with a payload that attempts to modify the WordPress `blogname` option to a random string value. The payload is URL-encoded JSON containing the option name and new value.

2. **Verification Step**: Sends a GET request to the site's homepage to verify that the `blogname` option was successfully modified by checking if the random string appears in the response body alongside WordPress indicators (`/wp-`).

The template confirms the vulnerability if both requests succeed: the first returns a 200 status with the success message `oxi-confirmation-success`, and the second shows the modified blogname value on the homepage.

## References

- https://wpscan.com/vulnerability/c8dd91d5-fdc4-4852-9823-6d0047b214fe/
- https://patchstack.com/database/vulnerability/shortcode-addons/wordpress-shortcode-addons-plugin-3-0-3-unauthenticated-arbitrary-option-update-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2022-34487
