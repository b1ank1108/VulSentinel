---
cve_id: CVE-2022-24124
template_path: nuclei-templates/http/cves/2022/CVE-2022-24124.yaml
affected_product: Casdoor
severity: high
authentication: none
external_callback: false
affected_versions: before 1.13.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Casdoor 1.13.0 suffers from a remote unauthenticated SQL injection vulnerability via the query API in Casdoor before 1.13.1 related to the `field` and `value` parameters, as demonstrated by `/api/get-organizations`.  
Arbitrary SQL query execution is possible, leading to unauthorized access and data leakage.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5), CWE-89.

## PoC / Detection
Classification: info-leak  
The template issues a single GET request to `{{BaseURL}}/api/get-organizations?p=123&pageSize=123&value=cfx&sortField=&sortOrder=&field=updatexml(1,version(),1)`. It verifies the vulnerability by matching HTTP status 200 AND response body containing both the regex "XPATH syntax error.*&#39" (triggered by MySQL error-based injection leaking DB version) and the string "casdoor".

## References
- https://packetstormsecurity.com/files/166163/Casdoor-1.13.0-SQL-Injection.html
- https://www.exploit-db.com/exploits/50792
- https://github.com/cckuailong/reapoc/tree/main/2022/CVE-2022-24124/vultarget
- https://nvd.nist.gov/vuln/detail/CVE-2022-24124
- https://github.com/casdoor/casdoor/compare/v1.13.0...v1.13.1
