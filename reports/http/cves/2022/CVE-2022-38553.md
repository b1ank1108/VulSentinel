---
cve_id: CVE-2022-38553
template_path: nuclei-templates/http/cves/2022/CVE-2022-38553.yaml
affected_product: Academy Learning Management System
severity: medium
authentication: none
external_callback: false
affected_versions: <5.9.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Academy Learning Management System (by Creative Item) contains a reflected cross-site scripting vulnerability in the search functionality via the `query` parameter. Input is not sanitized and is echoed directly into the HTML response, allowing an attacker to inject arbitrary JavaScript that executes in the context of an unsuspecting victim's browser. This can be triggered by crafting a malicious link or forcing the victim to visit the vulnerable search URL.  

Successful exploitation enables theft of cookie-based authentication credentials, session hijacking, keylogging, or defacement for any user who views the tainted page. The vulnerability is present in all versions before 5.9.1. CVSS 3.1 vector: AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79. No server-side code execution or persistent storage of the payload occurs.

## PoC / Detection
Classification: info-leak  

The template issues a single unauthenticated GET request to `{{BaseURL}}/search?query=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E`. It then asserts that the response body simultaneously contains the exact unsanitized payload string `"><script>alert(document.domain)</script>` and the product marker `Study any topic`, that the `Content-Type` header includes `text/html`, and that the HTTP status is 200. Positive match confirms the reflected XSS condition.

## References
- https://www.youtube.com/watch?v=yFiZffHoeKs&ab_channel=4websecurity
- https://github.com/4websecurity/CVE-2022-38553
- https://codecanyon.net/item/academy-course-based-learning-management-system/22703468
- https://nvd.nist.gov/vuln/detail/CVE-2022-38553
- http://academy.com
