---
cve_id: CVE-2022-37190
template_path: nuclei-templates/http/cves/2022/CVE-2022-37190.yaml
affected_product: Cuppa CMS
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: [authenticated user access]
poc_classification: rce
---

## Vulnerability
Cuppa CMS v1.0 is vulnerable to Remote Code Execution (RCE). An authenticated user can control both the `action` and `function` parameters sent to `/api/index.php` (specifically `action=system&function=exec`) to execute arbitrary system commands.

CVSS v3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).  
CWE-732.  
Impact: Successful exploitation allows arbitrary code execution on the target system.

## PoC / Detection
Classification: rce

The template detects the flaw by executing a three-step workflow: (1) POST login credentials (`user`, `password`) to `/` to establish an authenticated session; (2) POST to `/components/table_manager/` (no additional auth headers) and extract the `apikey` value via regex on `<td class='td_key'>` in the HTML response; (3) POST to `/api/index.php` supplying the `key: {{apikey}}` header and the payload `action=system&function=exec&cmd=cat+/etc/passwd`. Success is confirmed by HTTP 200 status, `text/html` in the third response header, and regex matches on Linux `/etc/passwd` entries (`root:.*:0:0:` or `postgres:.*:1001:`) in the body.

## References
- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-37190
- https://github.com/ARPSyndicate/cvemon
