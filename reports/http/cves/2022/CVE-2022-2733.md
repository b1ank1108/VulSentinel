---
cve_id: CVE-2022-2733
template_path: nuclei-templates/http/cves/2022/CVE-2022-2733.yaml
affected_product: Openemr
severity: medium
authentication: required
external_callback: false
affected_versions: < 7.0.0.1
preconditions: [authenticated user session required]
poc_classification: info-leak
---

## Vulnerability
Openemr < 7.0.0.1 suffers from a reflected Cross-Site Scripting (XSS) vulnerability (CVE-2022-2733) in the `pricelevel` parameter of `/interface/forms/fee_sheet/review/fee_sheet_options_ajax.php`.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

Successful exploitation could allow an attacker to execute malicious scripts in the victim's browser context, potentially leading to session hijacking, defacement, or theft of sensitive information.

Remediation: Upgrade to 7.0.0.1 or later.

## PoC / Detection
Classification: info-leak

The template first authenticates by sending a POST login request to `/interface/main/main_screen.php?auth=login&site=default` using `{{username}}` and `{{password}}`, then issues a GET request to the vulnerable endpoint with the reflected XSS payload `pricelevel=<img src=a onerror=alert(document.cookie)>`. It verifies the flaw by confirming the unsanitized payload and the string `pricelevel` both appear in the response body (along with status 200 and `text/html` content-type).

## References
- https://huntr.dev/bounties/25b91301-dfb0-4353-a732-e051bbe8420c/
- https://nvd.nist.gov/vuln/detail/CVE-2022-2733
- https://github.com/openemr/openemr/commit/59458bc15ab0cb556c521de9d5187167d6f88945
