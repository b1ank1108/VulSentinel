---
cve_id: CVE-2022-39986
template_path: nuclei-templates/http/cves/2022/CVE-2022-39986.yaml
affected_product: RaspAP
severity: critical
authentication: none
external_callback: false
affected_versions: 2.8.0 thru 2.8.7
preconditions: []
poc_classification: rce
---

## Vulnerability
A Command injection vulnerability in RaspAP 2.8.0 thru 2.8.7 allows unauthenticated attackers to execute arbitrary commands via the cfg_id parameter in /ajax/openvpn/activate_ovpncfg.php and /ajax/openvpn/del_ovpncfg.php.

Successful exploitation of this vulnerability can lead to remote code execution, compromising the confidentiality, integrity, and availability of the affected system.

Remediation: Upgrade to a patched version of RaspAP or apply the vendor-supplied patch.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-77.

## PoC / Detection
Classification: rce

The template issues a raw POST request to `/ajax/openvpn/del_ovpncfg.php` with form data `cfg_id=;id;#` (injecting the `id` command). It verifies success by matching the regex `uid=([0-9(a-z-)]+) gid=([0-9(a-z-)]+) groups=([0-9(a-z-)]+)` in the response body, plus `text/html` content-type header and HTTP 200 status.

## References
- https://packetstormsecurity.com/files/174190/RaspAP-2.8.7-Unauthenticated-Command-Injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-39986
- https://medium.com/@ismael0x00/multiple-vulnerabilities-in-raspap-3c35e78809f2
- http://packetstormsecurity.com/files/174190/RaspAP-2.8.7-Unauthenticated-Command-Injection.html
- https://github.com/RaspAP/raspap-webgui/blob/master/ajax/openvpn/activate_ovpncfg.php
