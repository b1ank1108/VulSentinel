---
cve_id: CVE-2022-35493
template_path: nuclei-templates/http/cves/2022/CVE-2022-35493.yaml
affected_product: eShop
severity: medium
authentication: none
external_callback: false
affected_versions: 3.0.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
eShop 3.0.4 (wrteam multipurpose ecommerce store website) contains a reflected cross-site scripting vulnerability in JSON search parse and response handling at the `/home/get_products` endpoint. User-supplied `search` parameter input is reflected unsanitized.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

Successful exploitation allows injection of malicious scripts into web pages viewed by other users, enabling potential data theft, session hijacking, or website defacement.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}/home/get_products?search=%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(document.domain)%3E` and matches if the response body contains the exact unsanitized payload string "Search Result for \"><img src=x onerror=alert(document.domain)>", the header contains `text/html`, and status code is 200. This confirms the reflected XSS flaw via direct payload reflection.

## References
- https://github.com/Keyvanhardani/Exploit-eShop-Multipurpose-Ecommerce-Store-Website-3.0.4-Cross-Site-Scripting-XSS/blob/main/README.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-35493
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Keyvanhardani/Exploit-eShop-Multipurpose-Ecommerce-Store-Website-3.0.4-Cross-Site-Scripting-XSS
