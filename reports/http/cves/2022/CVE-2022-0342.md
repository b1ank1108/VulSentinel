---
cve_id: CVE-2022-0342
template_path: nuclei-templates/http/cves/2022/CVE-2022-0342.yaml
affected_product: Zyxel
severity: critical
authentication: none
external_callback: false
affected_versions: Zyxel USG/ZyWALL series firmware versions 4.20 through 4.70, USG FLEX series firmware versions 4.50 through 5.20, ATP series firmware versions 4.32 through 5.20, VPN series firmware versions 4.30 through 5.20, and NSG series firmware versions V1.20 through V1.33 Patch 4
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
An authentication bypass vulnerability in the CGI program of Zyxel USG/ZyWALL series firmware versions 4.20 through 4.70, USG FLEX series firmware versions 4.50 through 5.20, ATP series firmware versions 4.32 through 5.20, VPN series firmware versions 4.30 through 5.20, and NSG series firmware versions V1.20 through V1.33 Patch 4, which could allow an attacker to bypass the web authentication and obtain administrative access of the device.

## PoC / Detection
Classification: auth-bypass  
The template sends a GET request to `{{BaseURL}}/cgi-bin/export-cgi?category=config&arg0=startup-config.conf` and matches on the response containing "interface-name" and "saved at" in the body, "text/zyxel" and "attachment; filename=" in the headers, and status code 200 to detect the authentication bypass by successfully retrieving the startup configuration file without credentials.

## References
- https://github.com/gobysec/GobyVuls/blob/master/CVE-2022-0342.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-0342
- https://www.zyxel.com/support/Zyxel-security-advisory-for-authentication-bypass-vulnerability-of-firewalls.shtml
- https://github.com/f1tao/awesome-iot-security-resource
- https://github.com/murchie85/twitterCyberMonitor
