---
cve_id: CVE-2022-35413
template_path: nuclei-templates/http/cves/2022/CVE-2022-35413.yaml
affected_product: WAPPLES Web Application Firewall
severity: critical
authentication: none
external_callback: false
affected_versions: <=6.0
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
WAPPLES Web Application Firewall through 6.0 contains a hardcoded credentials vulnerability (CWE-798). A system account with username `systemi` and password `db/wp.no1` is embedded in `/opt/penta/wapples/script/wcc_auto_scaling.py`. This enables attackers to authenticate to the administrative web API (`/webapi/`) on ports 443 or 5001 and access sensitive system configuration and confidential data such as SSL keys.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
Impact: unauthorized access to system configuration and confidential information.  
Remediation: upgrade to a version without hardcoded credentials or apply vendor patch.

## PoC / Detection
Classification: auth-bypass

The template sends a POST request to `/webapi/auth` (Content-Type: application/x-www-form-urlencoded) with form data `id=systemi&password=db/wp.no1` using a pitchfork payload attack, then verifies exploitation success if the response body contains both `"res_msg":"Authentication Success."` and `"doc_id":"user_systemi"`, the `WP_SESSID=` cookie appears in headers, and HTTP status is 200.

## References
- https://medium.com/@_sadshade/wapples-web-application-firewall-multiple-vulnerabilities-35bdee52c8fb
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35413
- https://azuremarketplace.microsoft.com/en/marketplace/apps/penta-security-systems-inc.wapples_sa_v6?tab=Overview
- https://nvd.nist.gov/vuln/detail/CVE-2022-35413
- https://www.pentasecurity.com/product/wapples/
