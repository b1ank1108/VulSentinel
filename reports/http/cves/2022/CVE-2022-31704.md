---
cve_id: CVE-2022-31704
template_path: nuclei-templates/http/cves/2022/CVE-2022-31704.yaml
affected_product: VMware vRealize Log Insight
severity: critical
authentication: none
external_callback: false
affected_versions: >= 3.0 < 4.8 or >= 8.0.0 < 8.10.2
preconditions: []
poc_classification: rce
---

## Vulnerability
VMware vRealize Log Insight contains a broken access control vulnerability (CVE-2022-31704, CWE-22). An unauthenticated malicious actor can remotely inject code into sensitive files of an impacted appliance, resulting in remote code execution.  
Impact: remote, unauthenticated attacker achieves full system compromise.  
CVSS: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Remediation: update to version 8.10.2 or later.

## PoC / Detection
Classification: rce  
The template sends GET requests to `{{BaseURL}}/i18n/component/JS?locale=en-US` (or falls back to `{{BaseURL}}/api/v1/version`) and verifies HTTP 200 with body containing "logInsight" or "releaseName\":", then extracts version via regex `version"\s*:\s*"([0-9.]+)` from the response body. DSL matchers confirm the extracted version lies in the vulnerable ranges (`>= 3.0 < 4.8` or `>= 8.0.0 < 8.10.2`). The probe itself is a harmless fingerprint; the underlying flaw is unauthenticated code injection into appliance files.

## References
- http://packetstormsecurity.com/files/174606/VMware-vRealize-Log-Insight-Unauthenticated-Remote-Code-Execution.html
- https://www.vmware.com/security/advisories/VMSA-2023-0001.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-31704
