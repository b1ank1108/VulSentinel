---
cve_id: CVE-2022-0165
template_path: nuclei-templates/http/cves/2022/CVE-2022-0165.yaml
affected_product: WordPress Page Builder KingComposer plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <=2.9.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-0165 is an open redirect vulnerability in the WordPress Page Builder KingComposer plugin version 2.9.6 and earlier. The vulnerability exists in the `kc_get_thumbn` AJAX action, which fails to properly validate the `id` parameter before using it to redirect users. This AJAX endpoint is accessible to both unauthenticated and authenticated users, making it exploitable without any authentication requirements.

The flaw is classified as CWE-601 (URL Redirection to Untrusted Site) and has a CVSS v3.1 score of 6.1 (Medium severity) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N. The vulnerability requires user interaction (UI:R) as the victim must click on a malicious link, but no privileges are required (PR:N) for exploitation. The scope is changed (S:C), indicating the vulnerable component impacts resources beyond its security scope.

An attacker can craft malicious URLs that leverage this unvalidated redirect to send users to phishing sites or other malicious destinations, potentially leading to credential theft, malware distribution, or further attacks against the redirected users.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the WordPress AJAX endpoint `/wp-admin/admin-ajax.php` with the action parameter set to `kc_get_thumbn` and the `id` parameter set to `https://interact.sh`. 

The template verifies the vulnerability by checking if the HTTP response contains a `Location` header that redirects to the attacker-controlled domain (interact.sh). The regex matcher looks for a redirect header pattern that includes the interact.sh domain, confirming that the plugin accepts and processes the unvalidated redirect parameter without proper sanitization.

This detection method demonstrates that arbitrary URLs can be injected into the redirect mechanism, proving the open redirect vulnerability exists and is exploitable without authentication.

## References

- https://wpscan.com/vulnerability/906d0c31-370e-46b4-af1f-e52fbddd00cb
- https://nvd.nist.gov/vuln/detail/CVE-2022-0165
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/K3ysTr0K3R/CVE-2022-0165-EXPLOIT
