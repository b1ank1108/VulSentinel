---
cve_id: CVE-2022-31977
template_path: nuclei-templates/http/cves/2022/CVE-2022-31977.yaml
affected_product: Online Fire Reporting System
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
Online Fire Reporting System v1.0 is vulnerable to SQL injection via `/ofrs/classes/Master.php?f=delete_team`. The `id` parameter in POST requests is unsanitized, allowing injection of arbitrary SQL statements (CWE-89). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Successful exploitation enables unauthorized data access, leakage, or manipulation.

## PoC / Detection
Classification: state-change

The template sends a POST request to `/classes/Master.php?f=delete_team` with form data `id='+AND+(SELECT+7774+FROM+(SELECT(SLEEP(6)))dPPt)+AND+'rogN'='rogN`. It matches if response duration >=6s, status_code==200, content_type contains "text/html", and body contains "status\":\"success\"}".

## References
- https://github.com/debug601/bug_report/blob/main/vendors/oretnom23/online-fire-reporting-system/SQLi-3.md
- https://www.sourcecodester.com/php/15346/online-fire-reporting-system-phpoop-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-31977
