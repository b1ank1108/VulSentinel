---
cve_id: CVE-2022-21705
template_path: nuclei-templates/http/cves/2022/CVE-2022-21705.yaml
affected_product: October CMS
severity: high
authentication: required
external_callback: false
affected_versions: prior to 1.0.474 (Build 474) and 1.1.10
preconditions: [authenticated user with permissions to create, modify, and delete website pages]
poc_classification: rce
---

## Vulnerability
October CMS is susceptible to remote code execution. In affected versions, user input is not properly sanitized before rendering. An authenticated user with the permissions to create, modify, and delete website pages can bypass `cms.safe_mode` and `cms.enableSafeMode` in order to execute arbitrary code. This affects admin panels that rely on safe mode and restricted permissions.

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H (score 7.2).  
Impact: Successful exploitation allows arbitrary code execution on the affected system.  
Remediation: Upgrade to Build 474 (1.0.474) or 1.1.10 (or manually apply the linked library patch).

## PoC / Detection
Classification: rce

The template performs a full authenticated exploit chain to detect the vulnerability:  
- GET `/backend/backend/auth/signin` extracts `_session_key` and `_token` (via XPath).  
- POST `/backend/backend/auth/signin` (with provided username/password) obtains admin session cookies.  
- POST `/backend/cms` (X-OCTOBER-REQUEST-HANDLER: onSave) injects `<?php function onInit() { phpinfo(); } ?>` into a new page's markup (under random title/URL and current theme).  
- Follow-up POSTs create/open the template.  
Success is verified by matching injected code strings (`function onInit()`, `phpinfo()`) + safe-mode bypass warning in response body AND HTTP 200 status. This confirms the safe-mode restriction is bypassed, allowing PHP execution (phpinfo() would render at the new `/{{randstr}}` endpoint).

## References
- https://github.com/octobercms/library/commit/c393c5ce9ca2c5acc3ed6c9bb0dab5ffd61965fe
- https://github.com/octobercms/october/security/advisories/GHSA-79jw-2f46-wv22
- https://cyllective.com/blog/post/octobercms-cve-2022-21705/
- https://nvd.nist.gov/vuln/detail/CVE-2022-21705
- https://github.com/cyllective/CVEs
