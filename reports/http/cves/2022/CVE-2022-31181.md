---
cve_id: CVE-2022-31181
template_path: nuclei-templates/http/cves/2022/CVE-2022-31181.yaml
affected_product: PrestaShop
severity: critical
authentication: none
external_callback: false
affected_versions: versions from 1.6.0.10 and before 1.7.8.7
preconditions: [BlockWishlist module enabled]
poc_classification: rce
---

## Vulnerability
PrestaShop e-commerce platform (cpe:2.3:a:prestashop:prestashop) contains an SQL injection in the BlockWishlist module's `order` parameter at `/module/blockwishlist/view`. Unsanitized input allows attackers to UPDATE `ps_configuration` (enable MySQL Smarty cache) and `ps_smarty_cache` (inject arbitrary PHP code). The injected code is later evaluated during template rendering, chaining SQLi â†’ PHP eval for full remote code execution and system compromise. Impact: arbitrary PHP execution. Remediation in template context: upgrade to 1.7.8.7+ or disable MySQL Smarty cache.

## PoC / Detection
Classification: rce

The template performs a complete unauthenticated exploit chain (9 HTTP requests) that registers a throwaway customer account, obtains a wishlist ID, enables MySQL-based Smarty caching via SQLi, injects `echo md5('999999999');` into the cache table, triggers evaluation on GET /, confirms RCE success by presence of the MD5 hash in the homepage body, then cleans up the injection and restores filesystem cache. All steps use internal matchers/extractors for flow control; detection succeeds only on vulnerable versions with the BlockWishlist module present.

## References
- https://www.xmco.fr/wp-content/uploads/2022/12/XMCO-ActuSecu-59-Forwardshell-UXSS-cyberguerre.pdf
- https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-hrgx-p36p-89q4
- https://github.com/PrestaShop/PrestaShop/commit/b6d96e7c2a4e35a44e96ffbcdfd34439b56af804
- https://nvd.nist.gov/vuln/detail/CVE-2025-27007
