---
cve_id: CVE-2022-0949
template_path: nuclei-templates/http/cves/2022/CVE-2022-0949.yaml
affected_product: WordPress Stop Bad Bots plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <6.930
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Stop Bad Bots plugin versions before 6.930 contain a critical SQL injection vulnerability in the `stopbadbots_grava_fingerprint` AJAX action. The plugin fails to properly sanitize and escape the `fingerprint` parameter before using it in a SQL statement. This vulnerability is exploitable by unauthenticated users, as the AJAX action is accessible without authentication.

The flaw allows attackers to inject arbitrary SQL queries into the database, potentially enabling them to extract sensitive information (including user credentials, database contents), modify data, execute unauthorized administrative operations, or compromise the entire WordPress installation. The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8, indicating critical severity with network-based attack vector, low attack complexity, and no privileges or user interaction required.

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection detection using three sequential requests:

1. **Baseline request**: Sends a benign fingerprint value (`fingerprint=0`) to establish normal response timing
2. **Time-based SQL injection probe**: Injects a SQL SLEEP command (`fingerprint=(SELECT SLEEP(6))`) with a 10-second timeout to test for SQL injection vulnerability
3. **Plugin verification**: Confirms the plugin's presence by requesting the plugin's JavaScript file (`stopbadbots.js`)

The template detects the vulnerability by verifying:
- The second request takes 6 or more seconds to complete (indicating successful SQL injection with SLEEP execution)
- The second request returns HTTP 200 status
- The third request confirms plugin presence by checking for "commentform" string in the JavaScript file

The template uses a randomized IP address in the `X-Real-IP` header to simulate different client origins during testing.

## References

- https://wpscan.com/vulnerability/a0fbb79a-e160-49df-9cf2-18ab64ea66cb
- https://wordpress.org/plugins/stopbadbots/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0949
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
