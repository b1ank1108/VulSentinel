---
cve_id: CVE-2022-44957
template_path: nuclei-templates/http/cves/2022/CVE-2022-44957.yaml
affected_product: WebTareas
severity: medium
authentication: required
external_callback: false
affected_versions: 2.4p5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
webtareas 2.4p5 was discovered to contain a stored cross-site scripting (XSS) vulnerability in the component /clients/listclients.php. This vulnerability allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the Name field (form parameter `cn`).

Authenticated attackers can inject malicious JavaScript through the client Name field when adding a client. The payload is persisted and reflected unsanitized when the clients list is subsequently viewed, potentially stealing session tokens and performing unauthorized actions on behalf of other WebTareas users.

CVSS v3.1: 5.4 (Medium) â€” AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (CWE-79).  
Remediation: Update to a version newer than 2.4p5 that properly sanitizes the Name field input and encodes output in listclients.php.

## PoC / Detection
Classification: info-leak

The template performs a three-step authenticated workflow to verify the stored XSS:
- POST /general/login.php (multipart) with supplied `{{username}}`/`{{password}}` to obtain a session.
- GET /clients/editclient.php to extract the `csrfToken` value via regex extractor (internal).
- POST /clients/editclient.php (multipart) creating a client whose `cn` field contains `{{randstr}}<details/open/ontoggle=alert(document.domain)>`.

Matchers then confirm the exact unsanitized payload string together with `clients/listclients.php?` appears in `body_3` (the post-add list view) and that `header_3` contains `text/html`.

## References
- http://webtareas.com/
- https://github.com/anhdq201/webtareas/issues/11
- https://nvd.nist.gov/vuln/detail/CVE-2022-44957
- http://webtareas.com
