---
cve_id: CVE-2022-2487
template_path: nuclei-templates/http/cves/2022/CVE-2022-2487.yaml
affected_product: Wavlink WN535K2/WN535K3
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
Wavlink WN535K2 and WN535K3 routers contain an OS command injection vulnerability in unknown code at the /cgi-bin/nightled.cgi endpoint. The flaw is triggered by manipulating the `start_hour` argument, allowing unauthenticated attackers to execute arbitrary OS commands. This can result in malware execution, sensitive information disclosure, data modification, and full system compromise.

CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

## PoC / Detection
Classification: rce

The template issues a POST request to `/cgi-bin/nightled.cgi` injecting `;{{cmd}};` (default cmd=`id`) into the `start_hour` parameter via form data `page=night_led&start_hour=;id;`. It verifies exploitation by checking for the presence of "uid=", "gid=", and "nightStart" strings in the response body, along with status code 200 and text/html content type.

## References
- https://github.com/1angx/webray.com.cn/blob/main/Wavlink/Wavlink%20nightled.cgi%20.md
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2487
- https://vuldb.com/?id.204538
- https://nvd.nist.gov/vuln/detail/CVE-2022-2487
