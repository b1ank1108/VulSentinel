---
cve_id: CVE-2022-4059
template_path: nuclei-templates/http/cves/2022/CVE-2022-4059.yaml
affected_product: Cryptocurrency Widgets Pack
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Cryptocurrency Widgets Pack WordPress plugin versions prior to 2.0 is affected by unauthenticated time-based blind SQL injection. The plugin fails to sanitise and escape the `columns[0][name]` parameter before using it in a SQL statement via the `mcwp_table` AJAX action, which is exposed to unauthenticated users.

Impact: Unauthenticated attackers can execute time-based blind SQL injection, potentially extracting sensitive database information including cryptocurrency data, user credentials, and plugin configuration.  
Remediation: Fixed in version 2.0.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-89.

## PoC / Detection
Classification: info-leak

The template sends a crafted unauthenticated GET request to `/wp-admin/admin-ajax.php?action=mcwp_table` embedding the payload `name+AND+(SELECT+1+FROM+(SELECT(SLEEP(7)))aaaa)--+-` in the `columns[0][name]` parameter, then verifies a response delay of at least 7 seconds, HTTP 302 status with empty body. A follow-up request to `/wp-content/plugins/cryptocurrency-widgets-pack/readme.txt` confirms the plugin is present by matching the product name in the response body.

## References
- https://wpscan.com/vulnerability/d94bb664-261a-4f3f-8cc3-a2db8230895d
- https://nvd.nist.gov/vuln/detail/CVE-2022-4059
- https://github.com/cyllective/CVEs
