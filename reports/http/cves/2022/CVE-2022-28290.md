---
cve_id: CVE-2022-28290
template_path: nuclei-templates/http/cves/2022/CVE-2022-28290.yaml
affected_product: WordPress Country Selector
severity: medium
authentication: required
external_callback: false
affected_versions: <1.6.6
preconditions: [WordPress installation with Country Selector plugin installed and active]
poc_classification: info-leak
---

## Vulnerability
WordPress Country Selector plugin prior to 1.6.6 contains a reflected cross-site scripting vulnerability. The plugin does not sanitize and escape the `country` and `lang` parameters before outputting them back in the response. An attacker can inject arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.

Successful exploitation could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website. Remediation: update to version 1.6.6 or later. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection
Classification: info-leak

The template first authenticates by sending a POST to `/wp-login.php` with supplied `{{username}}`/`{{password}}` credentials. It then issues a second POST to `/wp-admin/admin-ajax.php?action=check_country_selector` embedding the payload `<img src=x onerror=alert(document.domain)>` in both the `country` and `lang` form fields. The vulnerability is confirmed if the response body reflects the unsanitized payload (plus the string `country_selector_`), returns HTTP 200, and has `text/html` Content-Type.

## References
- https://wpscan.com/vulnerability/6c5a4bce-6266-4cfc-bc87-4fc3e36cb479
- https://cybersecurityworks.com/zerodays/cve-2022-28290-reflected-cross-site-scripting-in-welaunch.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-28290
- https://github.com/ARPSyndicate/kenzer-templates
