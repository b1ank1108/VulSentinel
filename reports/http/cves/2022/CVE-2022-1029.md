---
cve_id: CVE-2022-1029
template_path: nuclei-templates/http/cves/2022/CVE-2022-1029.yaml
affected_product: Limit Login Attempts (miniorange-limit-login-attempts) WordPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 4.0.72
preconditions: [Administrator privileges required]
poc_classification: state-change
---

## Vulnerability

The Limit Login Attempts WordPress plugin (miniorange-limit-login-attempts) versions prior to 4.0.72 contains a stored cross-site scripting (XSS) vulnerability (CWE-79). The vulnerability exists due to unsanitized and unescaped settings in the plugin's configuration interface. Malicious administrators can inject arbitrary Javascript code through the referrer blocking settings, which is then stored and executed when the settings page is viewed. This vulnerability requires administrator-level privileges to exploit, limiting its attack surface to compromised admin accounts or malicious insiders.

The CVSS v3.1 score is 4.8 (AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N), indicating network-exploitable with low complexity but requiring high privileges and user interaction, with cross-site scope and low confidentiality/integrity impact.

## PoC / Detection

Classification: state-change

The template performs authenticated exploitation testing in two stages:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated administrator session. Validates successful login by checking for HTTP 302 redirect and the presence of `wordpress_logged_in` cookie.

2. **XSS Injection**: With the authenticated session, sends a POST request to `/wp-admin/admin.php?page=advancedblocking` with a malicious payload in the `referrer_1` parameter: `"><img src=x onerror=alert(document.domain)>`. This attempts to inject XSS code through the referrer blocking configuration.

3. **Verification**: Confirms the vulnerability by checking that:
   - The response returns HTTP 200
   - Content-Type is text/html
   - The response body contains both "referrerblockingtable" (indicating the settings page) and the injected payload `<img src=x onerror=alert(document.domain)>` in its unescaped form, proving the stored XSS vulnerability

## References

- https://nvd.nist.gov/vuln/detail/CVE-2022-1029
