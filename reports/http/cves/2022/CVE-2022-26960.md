---
cve_id: CVE-2022-26960
template_path: nuclei-templates/http/cves/2022/CVE-2022-26960.yaml
affected_product: elFinder
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.1.60
preconditions: []
poc_classification: info-leak
---

## Vulnerability
elFinder through 2.1.60 is affected by local file inclusion (CWE-22) via `connector.minimal.php`. Unauthenticated remote attackers can read, write, and browse arbitrary files outside the configured document root due to improper handling of absolute file paths supplied in the `target` parameter.  
CVSS 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N).  
Successful exploitation leads to unauthorized access to sensitive files, remote code execution, and full system compromise.  
Remediation: upgrade to 2.1.61 or later.

## PoC / Detection
Classification: info-leak

The template issues a single raw GET request to `/elfinder/php/connector.minimal.php?cmd=file&target=l1_<@base64>/var/www/html/elfinder/files//..//..//..//..//..//../etc/passwd<@/base64>&download=1`, then asserts HTTP 200 and the regex `root:.*:0:0:` in the response body to confirm the LFI path-traversal read of `/etc/passwd`.

## References
- https://www.synacktiv.com/publications/elfinder-the-story-of-a-repwning.html
- https://github.com/Studio-42/elFinder/commit/3b758495538a448ac8830ee3559e7fb2c260c6db
- https://www.synacktiv.com/publications.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-26960
- https://github.com/ARPSyndicate/kenzer-templates
