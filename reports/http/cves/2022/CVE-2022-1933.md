---
cve_id: CVE-2022-1933
template_path: nuclei-templates/http/cves/2022/CVE-2022-1933.yaml
affected_product: WordPress CDI plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <5.1.9
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress CDI (Collect and Deliver Interface for WooCommerce) plugin versions prior to 5.1.9 contains a reflected cross-site scripting (XSS) vulnerability (CVE-2022-1933, CWE-79). The `trk` parameter in the `cdi_collect_follow` AJAX action is not sanitized or escaped before being echoed back in the response.

Unauthenticated remote attackers can craft malicious links that, when visited by victims, execute arbitrary JavaScript in the victim's browser in the context of the affected site (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1). This enables theft of cookie-based authentication credentials, session hijacking, or other client-side attacks.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/wp-admin/admin-ajax.php?action=cdi_collect_follow&trk=<script>alert(document.domain)</script>` and confirms the vulnerability if the response body simultaneously contains the exact injected payload string, the error text "Tracking code not correct", a `text/html` Content-Type header, and HTTP 200 status.

## References
- https://wpscan.com/vulnerability/6cedb27f-6140-4cba-836f-63de98e521bf
- https://wordpress.org/plugins/collect-and-deliver-interface-for-woocommerce/advanced/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1933
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
