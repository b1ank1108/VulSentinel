---
cve_id: CVE-2022-0439
template_path: nuclei-templates/http/cves/2022/CVE-2022-0439.yaml
affected_product: Email Subscribers & Newsletters WordPress plugin
severity: high
authentication: required
external_callback: false
affected_versions: <= 5.3.1
preconditions: [authenticated as Subscriber role or higher]
poc_classification: info-leak
---

## Vulnerability

The Email Subscribers & Newsletters WordPress plugin before 5.3.2 does not correctly escape the `order` and `orderby` parameters to the `ajax_fetch_report_list` AJAX action, resulting in an authenticated blind SQL injection. The vulnerability is exploitable by users with roles as low as Subscriber. The action also lacks any CSRF protection, allowing an attacker to trick any logged-in user into performing the action via a malicious link.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).  
Impact: arbitrary SQL command execution leading to sensitive data access (data breach) or data tampering.

## PoC / Detection
Classification: info-leak

The template first performs a POST to `/wp-login.php` with `{{username}}`/`{{password}}` credentials and verifies successful authentication via 302 redirect containing the `wordpress_logged_in` cookie (internal matcher). It then issues a GET to `/wp-admin/admin-ajax.php?action=ajax_fetch_report_list&order=,(SELECT+1+FROM+(SELECT(SLEEP(10)))a)--+-` (with 20s timeout). Detection succeeds if response duration >= 10s, status_code == 200, and body contains "column-email".

## References
- https://nvd.nist.gov/vuln/detail/CVE-2022-0439
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/email-subscribers/email-subscribers-newsletters-531-authenticated-or-cross-site-request-forgery-blind-sql-injection
