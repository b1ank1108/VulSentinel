---
cve_id: CVE-2022-4260
template_path: nuclei-templates/http/cves/2022/CVE-2022-4260.yaml
affected_product: WordPress WP-Ban plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <1.69.1
preconditions: [high-privilege user account required (administrator or equivalent)]
poc_classification: state-change
---

## Vulnerability

CVE-2022-4260 is a stored cross-site scripting (XSS) vulnerability in the WordPress WP-Ban plugin versions prior to 1.69.1. The vulnerability exists because the plugin fails to properly sanitize and escape certain settings fields, specifically the banned referers and template message fields. This allows authenticated users with high privileges to inject malicious JavaScript code that will be stored in the database and executed when triggered by specific conditions (matching referer header). The vulnerability is particularly significant because it can be exploited even when the `unfiltered_html` capability is disallowed, such as in WordPress multisite configurations where HTML filtering is typically enforced for non-super-admin users.

The CVSS score of 4.8 (Medium) reflects that while the vulnerability requires high privileges (PR:H) and user interaction (UI:R), it has a changed scope (S:C) allowing the attacker to affect resources beyond the vulnerable component, with low impact to confidentiality and integrity.

## PoC / Detection

Classification: state-change

The template performs an authenticated exploitation test by:

1. Authenticating to WordPress using provided credentials via POST to `/wp-login.php`
2. Extracting a CSRF nonce token from the WordPress admin interface
3. Submitting a malicious payload to the WP-Ban settings page (`/wp-admin/admin.php?page=wp-ban/ban-options.php`) with:
   - `banned_referers` set to "XSS"
   - `banned_template_message` containing the XSS payload: `<script>alert(document.domain);</script>`
4. Making a request to the homepage with the `Referer: XSS` header to trigger the stored XSS
5. Verifying successful exploitation by detecting the injected script in the response body

The template confirms the vulnerability by checking that the malicious script appears unescaped in the HTML response with a 200 status code and text/html content type.

## References

- https://wpscan.com/vulnerability/d0cf24be-df87-4e1f-aae7-e9684c88e7db
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4260
- https://drive.google.com/file/d/11nQ21cQ9irajYqNqsQtNrLJOkeRcwCXn/view?usp=drivesdk
- https://github.com/ARPSyndicate/kenzer-templates
