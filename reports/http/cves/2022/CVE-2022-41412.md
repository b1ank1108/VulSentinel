---
cve_id: CVE-2022-41412
template_path: nuclei-templates/http/cves/2022/CVE-2022-41412.yaml
affected_product: perfSONAR
severity: high
authentication: none
external_callback: false
affected_versions: <= 4.4.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-41412 is a Server-Side Request Forgery (SSRF) vulnerability in the graphData.cgi component of perfSONAR version 4.4.5 and prior. The vulnerability exists due to insufficient validation and restriction of URL parameters in the graphData.cgi component, allowing unauthenticated attackers to manipulate the `url` parameter to make the server issue requests to arbitrary destinations.

The SSRF vulnerability enables attackers to access internal resources that would normally be protected by network segmentation or firewall rules, bypass security controls, and potentially retrieve sensitive performance measurement data from internal network monitoring systems. The vulnerability is classified as CWE-918 (Server-Side Request Forgery) with a CVSS v3.1 score of 8.6 (High severity), reflecting its network-accessible attack vector, low attack complexity, no authentication requirement, and high confidentiality impact with changed scope.

## PoC / Detection

Classification: info-leak

The template detects this SSRF vulnerability by sending a GET request to the vulnerable `/perfsonar-graphs/cgi-bin/graphData.cgi` endpoint with crafted parameters. The request includes:
- `action=ma_data` to trigger the measurement archive data retrieval functionality
- `url=http://oast.fun/esmond/perfsonar/archive/../../../` containing a path traversal sequence pointing to an external server (oast.fun, which hosts an Interactsh-like test server)
- `src=8.8.8.8` and `dest=8.8.4.4` as source and destination parameters

The template confirms the vulnerability by checking for two conditions:
1. The response body contains the string `<h1> Interactsh Server </h1>`, indicating the server successfully fetched content from the attacker-specified external URL
2. The HTTP response status is 200

This detection method demonstrates that the server processes the malicious URL parameter and returns the fetched external content, proving the SSRF vulnerability exists and can be exploited to access arbitrary URLs.

## References

- https://github.com/renmizo/CVE-2022-41412
- https://hackerone.com/reports/2445802
- https://github.com/perfsonar/graphs/commit/463e1d9dc30782d9b1c002143551ec78b74e03bb
- https://www.perfsonar.net/releasenotes-2022-09-20-4-4-5.html
- http://packetstormsecurity.com/files/170069/perfSONAR-4.4.4-Open-Proxy-Relay.html
