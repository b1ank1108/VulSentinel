---
cve_id: CVE-2022-42748
template_path: nuclei-templates/http/cves/2022/CVE-2022-42748.yaml
affected_product: CandidATS
severity: medium
authentication: none
external_callback: false
affected_versions: 3.0.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CandidATS version 3.0.0 contains a reflected cross-site scripting (XSS) vulnerability in the ajax.php resource. The vulnerability exists in the `sortDirection` parameter, which fails to properly sanitize user input before reflecting it in the HTTP response. An attacker can craft a malicious URL containing JavaScript code that, when accessed by a victim, executes in the context of the victim's browser session. This allows the attacker to steal session cookies, perform actions on behalf of the victim, or redirect users to malicious sites. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity), requiring user interaction but no authentication.

## PoC / Detection

Classification: info-leak

The template detects this XSS vulnerability by sending a GET request to the `/ajax.php` endpoint with malicious JavaScript payloads injected into both the `sortDirection` and `indexFile` parameters. The payload `"><script>alert(document.domain)</script>` attempts to break out of the parameter context and inject executable JavaScript. The template verifies successful exploitation by checking for three conditions: (1) the injected script tag `<script>alert(document.domain)</script>` appears unencoded in the response body, (2) the response contains the string "candidat" (confirming the target application), and (3) the HTTP status code is 404. The 404 status matcher suggests the vulnerability manifests in error pages or invalid resource handlers where input sanitization is bypassed.

## References

- https://fluidattacks.com/advisories/modestep/
- https://fluidattacks.com/advisories/jcole/
- https://candidats.net/
- https://nvd.nist.gov/vuln/detail/CVE-2022-42748
- https://github.com/ARPSyndicate/cvemon
