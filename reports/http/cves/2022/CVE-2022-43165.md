---
cve_id: CVE-2022-43165
template_path: nuclei-templates/http/cves/2022/CVE-2022-43165.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: [authenticated user with access to Global Variables feature at /index.php?module=global_vars/vars]
poc_classification: state-change
---

## Vulnerability

CVE-2022-43165 is a stored cross-site scripting (XSS) vulnerability in Rukovoditel version 3.2.1 and earlier. The vulnerability exists in the Global Variables feature accessible at `/index.php?module=global_vars/vars`. An authenticated attacker can inject malicious JavaScript or HTML code through the "Value" parameter when creating a new global variable. The injected payload is stored in the application and executed when other users view the affected page.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (Medium severity). The attack vector is network-based with low attack complexity, requires low privileges (authenticated user), and requires user interaction. The scope is changed, meaning the vulnerable component impacts resources beyond its security scope, with low impact to both confidentiality and integrity.

Successful exploitation allows attackers to execute arbitrary JavaScript in victims' browsers, potentially leading to session hijacking, credential theft, phishing attacks, or defacement of the application interface.

## PoC / Detection

Classification: state-change

The Nuclei template performs an authenticated exploitation test by:

1. **Authentication**: First, it retrieves the login page to extract the CSRF token (form_session_token), then authenticates using provided credentials via POST to `/index.php?module=users/login&action=login`

2. **Payload Injection**: After successful authentication, it sends a POST request to `/index.php?module=global_vars/vars&action=save` with a crafted payload in the "value" parameter containing `<script>alert(document.domain)</script>`. The request creates a new global variable with the XSS payload stored in its value field.

3. **Verification**: The template confirms successful exploitation by checking that:
   - The response returns HTTP 200 status
   - Content-Type is text/html
   - The injected script tag `<script>alert(document.domain)</script>` appears unescaped in the response body
   - The response contains "rukovoditel" string confirming the application context

The template demonstrates that the application fails to sanitize user input in the Value parameter, allowing stored XSS payloads to persist and execute.

## References

- https://github.com/anhdq201/rukovoditel/issues/5
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-43165
