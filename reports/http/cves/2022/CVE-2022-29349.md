---
cve_id: CVE-2022-29349
template_path: nuclei-templates/http/cves/2022/CVE-2022-29349.yaml
affected_product: kkFileView
severity: medium
authentication: none
external_callback: false
affected_versions: 4.0.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
kkFileView 4.0.0 is affected by multiple reflected cross-site scripting (XSS) vulnerabilities. The flaws exist via the `url` and `currentUrl` parameters in `/controller/OnlinePreviewController.java`. An unauthenticated remote attacker can craft a malicious URL that injects arbitrary JavaScript executed in the victim's browser context when the online preview is rendered. Impact includes session hijacking, page defacement, or theft of sensitive information (e.g., cookies, tokens). CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). CPE: cpe:2.3:a:keking:kkfileview:4.0.0:*:*:*:*:*:*:*.

## PoC / Detection
Classification: info-leak

The template issues a single GET request to `{{BaseURL}}/onlinePreview?url=aHR0cDovL3d3dy54eHguY29tL3h4eC50eHQiPjxpbWcgc3JjPTExMSBvbmVycm9yPWFsZXJ0KDEpPjEyMw%3D%3D` (base64 payload embedding a breakout sequence and `<img src=111 onerror=alert(1)>`). It verifies the exact string `'txt"><img src=111 onerror=alert(1)>123'` appears unsanitized in the response body, the `Content-Type` header contains `text/html`, and HTTP status is 200. This confirms lack of input sanitization/encoding in the preview rendering logic.

## References
- https://github.com/kekingcn/kkFileView/issues/347
- https://nvd.nist.gov/vuln/detail/CVE-2022-29349
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
