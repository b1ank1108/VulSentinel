---
cve_id: CVE-2022-3934
template_path: nuclei-templates/http/cves/2022/CVE-2022-3934.yaml
affected_product: WordPress FlatPM plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 3.0.13
preconditions: requires authenticated WordPress administrator privileges
poc_classification: info-leak
---

## Vulnerability
WordPress FlatPM plugin before version 3.0.13 is vulnerable to reflected Cross-Site Scripting (XSS) due to lack of sanitization and escaping of the `block_cat_ID` parameter in the `blocks_form` admin page (CWE-79).  

The issue affects high-privilege users such as administrators. Exploitation allows injection of malicious JavaScript, enabling session hijacking via cookie theft and other client-side attacks.  

CVSS v3.1: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
Remediation: Update to 3.0.13 or newer.

## PoC / Detection
Classification: info-leak

The template first performs authentication via POST to `/wp-login.php` using `{{username}}` and `{{password}}`, then sends a GET to the vulnerable `/wp-admin/admin.php?page=blocks_form` endpoint embedding the XSS payload `1%22+style%3Danimation-name%3Arotation+onanimationstart%3Dalert%28document.domain%29%2F%2F` in `block_cat_ID`. It verifies by checking for HTTP 200 and the presence of `alert(document.domain)` (unsanitized reflection) plus "Flat PM" in the response body.

## References
- https://wpscan.com/vulnerability/ab68381f-c4b8-4945-a6a5-1d4d6473b73a
- https://nvd.nist.gov/vuln/detail/CVE-2022-3934
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
- https://github.com/cyllective/CVEs
