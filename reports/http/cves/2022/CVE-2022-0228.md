---
cve_id: CVE-2022-0228
template_path: nuclei-templates/http/cves/2022/CVE-2022-0228.yaml
affected_product: Popup Builder
severity: high
authentication: required
external_callback: false
affected_versions: < 4.0.7
preconditions: [high-privilege (administrator) access to WordPress admin dashboard]
poc_classification: info-leak
---

## Vulnerability
Popup Builder WordPress plugin before 4.0.7 does not validate and properly escape the `orderby` and `order` parameters before using them in a SQL statement in the admin dashboard, which could allow high privilege users to perform SQL injection (CWE-89).

CVSS 3.1: 7.2 (High) â€” AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H  
Impact: Authenticated administrators with high privileges can exploit the injection to extract database contents, exposing sensitive WordPress data and user credentials.  
Remediation: Update to version 4.0.7.  
CPE: cpe:2.3:a:sygnoos:popup_builder:*:*:*:*:*:wordpress:*:*

## PoC / Detection
Classification: info-leak

The template first POSTs credentials to `/wp-login.php` to authenticate, then issues a GET to `/wp-admin/admin-post.php?action=csv_file` with a crafted `orderby=email,(select * from (select(sleep(7)))b)` parameter that triggers time-based blind SQL injection. Detection succeeds if the second response shows >=7s duration, HTTP 200, contains CSV headers ("first name", "last name", "email"), and `application/octet-stream` content-type.

## References
- https://wpscan.com/vulnerability/22facac2-52f4-4e5f-be59-1d2934b260d9
- https://nvd.nist.gov/vuln/detail/CVE-2022-0228
- https://plugins.trac.wordpress.org/changeset/2659117
- https://github.com/ARPSyndicate/cvemon
