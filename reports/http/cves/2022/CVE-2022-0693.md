---
cve_id: CVE-2022-0693
template_path: nuclei-templates/http/cves/2022/CVE-2022-0693.yaml
affected_product: WordPress Master Elements plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=8.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Master Elements plugin through version 8.0 contains a critical SQL injection vulnerability (CWE-89) in the `remove_post_meta_condition` AJAX action. The vulnerability stems from insufficient validation and sanitization of the `meta_ids` parameter before its use in SQL statements. This AJAX endpoint is accessible to both unauthenticated and authenticated users, significantly expanding the attack surface.

The vulnerability allows attackers to inject arbitrary SQL commands into database queries. Successful exploitation could enable attackers to extract sensitive information from the database, modify existing data, execute unauthorized administrative operations, or potentially compromise the entire WordPress installation. The CVSS v3.1 score of 9.8 (Critical) reflects the severity, with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction.

The EPSS score of 0.62576 (98.333rd percentile) indicates a high probability of active exploitation in the wild.

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection detection by sending a GET request to the vulnerable AJAX endpoint `/wp-admin/admin-ajax.php`. The request includes:
- `action=remove_post_meta_condition` to trigger the vulnerable AJAX handler
- `meta_ids=1+AND+(SELECT+3066+FROM+(SELECT(SLEEP(6)))CEHy)` containing a SQL injection payload that forces a 6-second delay using MySQL's SLEEP() function

The template verifies the vulnerability by checking three conditions:
1. The response time is at least 6 seconds (confirming SQL execution)
2. HTTP status code is 200
3. The response body contains "Post Meta Setting Deleted Successfully"

The time-based approach confirms SQL injection without requiring data exfiltration, making it a safe detection method that proves the vulnerability exists while demonstrating the potential for more severe exploitation (data extraction, modification, or administrative compromise).

## References

- https://wpscan.com/vulnerability/a72bf075-fd4b-4aa5-b4a4-5f62a0620643
- https://wordpress.org/plugins/master-elements
- https://nvd.nist.gov/vuln/detail/CVE-2022-0693
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
