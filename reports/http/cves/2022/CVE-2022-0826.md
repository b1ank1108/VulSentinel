---
cve_id: CVE-2022-0826
template_path: nuclei-templates/http/cves/2022/CVE-2022-0826.yaml
affected_product: WordPress WP Video Gallery
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.7.1
preconditions: [WP Video Gallery plugin installed and activated on WordPress]
poc_classification: state-change
---

## Vulnerability

WordPress WP Video Gallery plugin (wp-video-gallery-free) <=1.7.1 contains an unauthenticated SQL injection vulnerability (CVE-2022-0826, CWE-89) in the `url` parameter passed to the `wp_video_gallery_ajax_add_single_youtube` AJAX action at `/wp-admin/admin-ajax.php`. User-supplied input reaches a SQL statement without sanitization or escaping.

**Impact:** Arbitrary SQL query execution allowing sensitive information disclosure, data modification, unauthorized administrative operations, and potential full site compromise on the affected WordPress installation. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

**Remediation:** Update to version 1.7.2 or later.

## PoC / Detection
Classification: state-change

The template issues a single POST request to `/wp-admin/admin-ajax.php` injecting a time-based blind SQLi payload (`SLEEP(6)`) within the `url` parameter of the `wp_video_gallery_ajax_add_single_youtube` action. It confirms exploitation if the response duration is >=6 seconds, status code is 200, Content-Type contains "text/html", and the body includes "Registred videos :".

This verifies the lack of input sanitization in the plugin's AJAX handler, confirming conditions for data modification and administrative actions via SQL.

## References
- https://wpscan.com/vulnerability/7a3eed3b-c643-4e24-b833-eba60ab631c5
- https://wordpress.org/plugins/wp-video-gallery-free/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0826
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/cyllective/CVEs
