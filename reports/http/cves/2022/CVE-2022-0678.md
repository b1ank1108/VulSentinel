---
cve_id: CVE-2022-0678
template_path: nuclei-templates/http/cves/2022/CVE-2022-0678.yaml
affected_product: Microweber
severity: medium
authentication: none
external_callback: false
affected_versions: <1.2.11
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Microweber CMS prior to version 1.2.11 is affected by a reflected Cross-Site Scripting (XSS) vulnerability in the logout API endpoint. The flaw exists because the `$redirectUrl` parameter is not escaped when inserted into a meta tag, allowing an attacker to close the attribute with a double quote and inject arbitrary JavaScript.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

Successful exploitation could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.

Remediation: Upgrade Microweber CMS to version 1.2.11 or later.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/demo/api/logout?redirect_to=/asdf%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E`. It verifies success if the response body contains the unescaped payload `><script>alert(document.domain)</script>` together with `content="Microweber"`, the Content-Type header contains `text/html`, and the status code is 404.

## References
- https://huntr.dev/bounties/d707137a-aace-44c5-b15c-1807035716c0/
- https://twitter.com/CVEnew/status/1495001503249178624?s=20&t=sfABvm7oG39Fd6rG44vQWg
- https://huntr.dev/bounties/d707137a-aace-44c5-b15c-1807035716c0
- https://nvd.nist.gov/vuln/detail/CVE-2022-0678
- https://github.com/microweber/microweber/commit/2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8
