---
cve_id: CVE-2022-29005
template_path: nuclei-templates/http/cves/2022/CVE-2022-29005.yaml
affected_product: Online Birth Certificate System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.2
preconditions: []
poc_classification: state-change
---

## Vulnerability
Online Birth Certificate System 1.2 suffers from stored cross-site scripting (XSS) vulnerabilities in /obcs/user/profile.php. An attacker can inject arbitrary JavaScript or HTML via the fname and lname parameters during profile updates. The malicious payload is stored on the server and executes in the browser of any user viewing the affected page, such as the dashboard.

CVSS 3.1 Score: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
CWE-79: Improper Neutralization of Input During Web Page Generation  

**Impact:** Successful exploitation allows injection of malicious scripts leading to data theft, session hijacking, or website defacement.  
**Remediation:** Implement proper input validation and sanitization on fname/lname before storage and output.  
**Vendor/Product:** phpgurukul / online_birth_certificate_system

## PoC / Detection
Classification: state-change

The template verifies the vulnerability through these steps:  
1. POST login credentials (mobno/password) to /obcs/user/login.php to establish an authenticated session.  
2. POST to /obcs/user/profile.php injecting a unique random string prefixed XSS payload (`{{str}}<script>alert(document.domain);</script>`) into fname and lname fields.  
3. GET /obcs/user/dashboard.php and match if the unsanitized payload appears in the response body within the admin-name HTML element (plus HTML content-type and 200 status).  

This confirms stored unsanitized input that executes on page view.

## References
- https://github.com/sudoninja-noob/CVE-2022-29005/blob/main/CVE-2022-29005.txt
- https://phpgurukul.com/online-birth-certificate-system-using-php-and-mysql/
- https://nvd.nist.gov/vuln/detail/CVE-2022-29005
- http://online.com
- https://github.com/ARPSyndicate/kenzer-templates
