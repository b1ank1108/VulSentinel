---
cve_id: CVE-2022-0824
template_path: nuclei-templates/http/cves/2022/CVE-2022-0824.yaml
affected_product: Webmin
severity: high
authentication: required
external_callback: true
affected_versions: <1.990
preconditions: [filemin module enabled]
poc_classification: rce
---

## Vulnerability
Webmin before 1.990 is susceptible to improper access control in the filemin module (CWE-284, CWE-863). The flaw in /extensions/file-manager/http_download.cgi allows authenticated low-privilege users to trigger remote code execution, enabling execution of malware, sensitive data access, data modification, and full system control. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). CPE: cpe:2.3:a:webmin:webmin:*:*:*:*:*:*:*:*. Impact includes unauthorized actions on the host.

## PoC / Detection
Classification: rce

The template first performs authentication by sending a POST to /session_login.cgi with form-encoded `user={{username}}&pass={{password}}` (plus testing cookie) to establish a valid session. It then issues a second POST to /extensions/file-manager/http_download.cgi?module=filemin containing `link=http://{{interactsh-url}}&username=&password=&path=/{{ranstr}}` (with X-Requested-With and Referer headers). Success is confirmed by an out-of-band DNS callback on the interactsh domain plus the exact string "Failed to write to /{{ranstr}}/index.html" appearing in the JSON response body.

## References
- https://github.com/faisalfs10x/Webmin-CVE-2022-0824-revshell/blob/main/Webmin-revshell.py
- https://github.com/webmin/webmin/commit/39ea464f0c40b325decd6a5bfb7833fa4a142e38
- https://huntr.dev/bounties/d0049a96-de90-4b1a-9111-94de1044f295
- https://nvd.nist.gov/vuln/detail/CVE-2022-0824
- https://github.com/nomi-sec/PoC-in-GitHub
