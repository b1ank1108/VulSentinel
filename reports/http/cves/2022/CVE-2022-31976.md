---
cve_id: CVE-2022-31976
template_path: nuclei-templates/http/cves/2022/CVE-2022-31976.yaml
affected_product: Online Fire Reporting System
severity: critical
authentication: none
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability

Online Fire Reporting System v1.0 suffers from a critical SQL injection vulnerability (CWE-89) in the `/ofrs/classes/Master.php?f=delete_request` endpoint. The `id` parameter of POST requests is vulnerable to injection of malicious SQL payloads, allowing unauthenticated remote attackers to execute arbitrary SQL queries on the backend database.

This can result in complete data leakage, unauthorized data manipulation/deletion, or full database compromise. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: state-change

The template sends a single POST request to `/classes/Master.php?f=delete_request` (Content-Type: application/x-www-form-urlencoded) with the `id` parameter set to a time-based blind SQLi payload: `'+AND+(SELECT+7774+FROM+(SELECT(SLEEP(6)))dPPt)+AND+'rogN'='rogN`.

Matchers verify exploitation conditions via `duration>=6` (confirming sleep execution), HTTP 200 status, text/html content-type, and body containing `"status":"success"}`.

## References
- https://github.com/debug601/bug_report/blob/main/vendors/oretnom23/online-fire-reporting-system/SQLi-4.md
- https://www.sourcecodester.com/php/15346/online-fire-reporting-system-phpoop-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-31976
