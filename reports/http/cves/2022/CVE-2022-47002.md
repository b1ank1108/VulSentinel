---
cve_id: CVE-2022-47002
template_path: nuclei-templates/http/cves/2022/CVE-2022-47002.yaml
affected_product: Masa CMS
severity: critical
authentication: none
external_callback: false
affected_versions: 7.2, 7.3, 7.4-beta
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2022-47002 is a critical authentication bypass vulnerability affecting Masa CMS versions 7.2, 7.3, and 7.4-beta. The flaw exists in the "Remember Me" authentication function and allows an attacker to bypass authentication mechanisms entirely through crafted web requests. The vulnerability is classified as CWE-863 (Incorrect Authorization) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no privileges or user interaction required.

Successful exploitation enables an attacker to gain unauthorized administrative access to the CMS without valid credentials. This allows the attacker to obtain sensitive information, modify data, execute unauthorized administrative operations, and potentially achieve full compromise of the affected system. The vulnerability requires no authentication and can be exploited remotely over the network.

## PoC / Detection

Classification: auth-bypass

The template performs a three-step detection process to verify the authentication bypass vulnerability:

1. **Initial reconnaissance**: Sends a GET request to the root path to extract the site ID from the response body using the regex pattern `siteid:"(.*?)"`.

2. **UUID extraction**: Makes a request to the JSON API endpoint `/index.cfm/_api/json/v1/{{siteid}}/content/?fields=lastupdatebyid` to extract a valid user UUID from the `lastupdatebyid` field using the pattern `"lastupdatebyid":"([A-F0-9-]+)"`.

3. **Authentication bypass verification**: Attempts to access the administrative profile editing page at `/admin/?muraAction=cEditProfile.edit` by setting a cookie with the extracted UUID as the `userid` value and an empty `userhash` value (`Cookie: userid={{uuid}}; userhash=`). This crafted cookie bypasses the authentication mechanism.

The template confirms successful exploitation when the response contains both the string `"userid"` and "Edit Profile", indicating unauthorized access to the administrative profile editing interface without valid authentication credentials.

## References

- https://hoyahaxa.blogspot.com/2023/03/authentication-bypass-mura-masa.html
- https://github.com/MasaCMS/MasaCMS/releases/tag/7.3.10
- https://hoyahaxa.blogspot.com/2023/01/preliminary-security-advisory.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-47002
- https://www.hoyahaxa.com/2023/01/preliminary-security-advisory.html
