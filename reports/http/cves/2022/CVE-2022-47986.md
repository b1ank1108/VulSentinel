---
cve_id: CVE-2022-47986
template_path: nuclei-templates/http/cves/2022/CVE-2022-47986.yaml
affected_product: IBM Aspera Faspex
severity: critical
authentication: none
external_callback: false
affected_versions: <=4.4.2 PL1
preconditions: []
poc_classification: rce
---

## Vulnerability
IBM Aspera Faspex through 4.4.2 Patch Level 1 contains a critical YAML deserialization vulnerability in the obsolete `/aspera/faspex/package_relay/relay_package` API endpoint. Unauthenticated attackers can submit a specially crafted JSON payload to achieve remote code execution, obtain sensitive data, or perform other unauthorized operations.

**CVSS**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE**: CWE-502  
**Impact**: Successful exploitation allows arbitrary code execution on the target system.

## PoC / Detection
Classification: rce

The template sends a single raw POST request to `/aspera/faspex/package_relay/relay_package` containing a malicious Ruby YAML gadget chain (Gem::Installer/SpecFetcher/Requirement + Net::BufferedIO/WriteAdapter/PrettyPrint/Kernel.eval) embedded in the `external_emails` field that forces execution of the `id` command. Detection succeeds when the response contains `text/html` Content-Type header, HTTP 500 status, and the regex `uid=\d+\(([^)]+)\) gid=\d+\(([^)]+)\)` confirming command output.

## References
- https://blog.assetnote.io/2023/02/02/pre-auth-rce-aspera-faspex/
- https://www.ibm.com/support/pages/node/6952319
- https://exchange.xforce.ibmcloud.com/vulnerabilities/243512
- http://packetstormsecurity.com/files/171772/IBM-Aspera-Faspex-4.4.1-YAML-Deserialization.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-47986
