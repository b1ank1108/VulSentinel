---
cve_id: CVE-2022-24716
template_path: nuclei-templates/http/cves/2022/CVE-2022-24716.yaml
affected_product: Icinga Web 2
severity: high
authentication: none
external_callback: false
affected_versions: prior to 2.9.6 and 2.10
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Icinga Web 2 is an open source monitoring web interface, framework and command-line interface. Unauthenticated users can leak the contents of files of the local system accessible to the web-server user, including `icingaweb2` configuration files with database credentials. The vulnerability can lead to unauthorized access to sensitive information, potentially exposing credentials, configuration files, and other sensitive data. Resolved in versions 2.9.6 and 2.10; database credentials should be rotated. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5) â€¢ CWE-22.

## PoC / Detection
Classification: info-leak

The template sends GET requests to three candidate LFI paths appending `/etc/passwd` (`{{BaseURL}}/lib/icinga/icinga-php-thirdparty/etc/passwd`, `/icinga2/lib/icinga/icinga-php-thirdparty/etc/passwd`, `/icinga-web/lib/icinga/icinga-php-thirdparty/etc/passwd`) with `stop-at-first-match`. It verifies exploitation by matching `text/plain` in the `Content-Type` header, the regex `root:.*:0:0:` in the response body, and HTTP 200 status.

## References
- https://github.com/JacobEbben/CVE-2022-24716/blob/main/exploit.py
- http://packetstormsecurity.com/files/171774/Icinga-Web-2.10-Arbitrary-File-Disclosure.html
- https://github.com/Icinga/icingaweb2/commit/9931ed799650f5b8d5e1dc58ea3415a4cdc5773d
- https://github.com/Icinga/icingaweb2/security/advisories/GHSA-5p3f-rh28-8frw
- https://security.gentoo.org/glsa/202208-05
