---
cve_id: CVE-2022-24681
template_path: nuclei-templates/http/cves/2022/CVE-2022-24681.yaml
affected_product: ManageEngine ADSelfService Plus
severity: medium
authentication: none
external_callback: false
affected_versions: < 6121
preconditions: []
poc_classification: info-leak
---

## Vulnerability
ManageEngine ADSelfService Plus before 6121 contains a stored cross-site scripting vulnerability. The flaw resides in the unsanitized welcome name attribute rendered on the Reset Password, Unlock Account, or User Must Change Password screens. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1, Medium) | CWE-79.  
Successful exploitation enables arbitrary JavaScript execution in the victim's browser context, leading to theft of sensitive information (cookies, session tokens) or further client-side attacks. No server-side code execution or persistent state changes occur.

Remediation: Upgrade to version 6121 or higher.

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated POST request to `/servlet/GetProductVersion`. It extracts the `BUILD_NUMBER` value via regex from the JSON response body, then applies a DSL matcher `compare_versions(buildnumber, '< 6121')`. Supporting matchers verify the presence of the word "ManageEngine" in the body and HTTP status 200. The extractor runs internally; no payload is injected and no XSS is triggered.

## References
- https://raxis.com/blog/cve-2022-24681
- https://www.manageengine.com/products/self-service-password/advisory/CVE-2022-24681.html
- https://manageengine.com
- https://nvd.nist.gov/vuln/detail/CVE-2022-24681
- https://www.manageengine.com/products/self-service-password/kb/CVE-2022-24681.html
