---
cve_id: CVE-2022-45808
template_path: nuclei-templates/http/cves/2022/CVE-2022-45808.yaml
affected_product: LearnPress Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: < 4.2.0
preconditions: [WordPress site with LearnPress plugin installed and active]
poc_classification: info-leak
---

## Vulnerability
LearnPress – WordPress LMS Plugin versions < 4.2.0 (≤ 4.1.7.3.2) contains an unauthenticated time-based blind SQL injection vulnerability in the `order_by` parameter of the courses archive REST API endpoint (`/wp-json/lp/v1/courses/archive-course`).

Unauthenticated remote attackers can inject SQL payloads to infer database contents via response timing differences. Impact includes extraction of sensitive data like user credentials, course details, and student information. CVSS 9.9 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L), CWE-89.

## PoC / Detection
Classification: info-leak

The template issues a single POST request to the archive-course endpoint with a crafted `order_by=ID AND (SELECT 1471 FROM (SELECT(SLEEP(6)))VcSO)` payload designed to trigger a 6-second delay on vulnerable instances. Detection succeeds if response duration >= 6 seconds while returning HTTP 200, application/json content-type, and body containing "status" and "message" keys.

## References
- https://patchstack.com/database/vulnerability/learnpress/wordpress-learnpress-wordpress-lms-plugin-plugin-4-1-7-3-2-sql-injection?_s_id=cve
- https://github.com/RandomRobbieBF/CVE-2022-45808
