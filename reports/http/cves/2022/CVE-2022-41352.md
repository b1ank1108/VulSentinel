---
cve_id: CVE-2022-41352
template_path: nuclei-templates/http/cves/2022/CVE-2022-41352.yaml
affected_product: Zimbra Collaboration
severity: critical
authentication: none
external_callback: false
affected_versions: 8.8.15, 9.0
preconditions: [cpio used instead of pax for archive extraction in amavis]
poc_classification: detect-only
---

## Vulnerability

CVE-2022-41352 is a critical unrestricted file upload vulnerability in Zimbra Collaboration Suite (ZCS) versions 8.8.15 and 9.0. The vulnerability stems from a cpio loophole in the amavis component that allows arbitrary file uploads. When cpio is used for archive extraction instead of pax, attackers can exploit this to extract files to `/opt/zimbra/jetty/webapps/zimbra/public`, the public web application directory.

This vulnerability enables unauthenticated attackers to upload arbitrary files through amavis, potentially achieving remote code execution by placing malicious files (such as JSP web shells) in the publicly accessible webapps directory. The flaw also allows unauthorized access to other user accounts within the Zimbra Collaboration Suite. The vulnerability is classified as CWE-22 (Path Traversal) and has a CVSS score of 9.8, with an EPSS score of 0.93958 (99.88th percentile), indicating active exploitation in the wild. It is listed in CISA's Known Exploited Vulnerabilities (KEV) catalog.

The root cause is that pax, which handles archive extraction more securely, is no longer included by default in Red Hat-based distributions after RHEL 6/CentOS 6, causing amavis to fall back to the vulnerable cpio utility.

## PoC / Detection

Classification: detect-only

The Nuclei template performs passive version detection by sending a GET request to `/js/zimbraMail/share/model/ZmSettings.js`, a JavaScript configuration file in the Zimbra web client. The template verifies the presence of Zimbra Collaboration Suite by checking for:

1. The string "Zimbra Collaboration Suite Web Client" in the response body
2. Content-Type header matching "application/x-javascript"
3. Version strings "8.8.15" or "9.0" in the response body

The template extracts the exact client version using a regex pattern that captures the `CLIENT_VERSION` configuration value from the JavaScript settings file. This is a non-invasive detection method that only fingerprints the vulnerable version without attempting to exploit the file upload vulnerability itself.

## References

- https://www.secpod.com/blog/unpatched-rce-bug-in-zimbra-collaboration-suite-exploited-in-wild/
- https://nvd.nist.gov/vuln/detail/CVE-2022-41352
