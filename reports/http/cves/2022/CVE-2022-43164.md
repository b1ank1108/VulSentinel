---
cve_id: CVE-2022-43164
template_path: nuclei-templates/http/cves/2022/CVE-2022-43164.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: authenticated access to Global Lists feature
poc_classification: state-change
---

## Vulnerability
Stored XSS in Rukovoditel <= 3.2.1 Global Lists feature (`/index.php?module=global_lists/lists`). Authenticated attackers inject arbitrary scripts/HTML via the `Name` parameter when adding a list entry.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4, CWE-79).  
Impact: malicious scripts execute in victims' browsers (data theft, session hijacking, defacement).  
Remediation: upgrade to version > 3.2.1 or apply vendor patch.

## PoC / Detection
Classification: state-change  
Template performs authenticated data-write attack:  
- GET `/index.php?module=users/login` extracts nonce from hidden `form_session_token`.  
- POST login with `{{username}}`/`{{password}}` + nonce to establish session.  
- POST `/index.php?module=global_lists/lists&action=save&token={{nonce}}` injects `name=<script>alert(document.domain)</script>`.  
With `redirects: true`, matcher verifies status_code_3 == 200 && body_3 contains unsanitized payload && "rukovoditel", confirming storage and reflection without sanitization.

## References
- https://github.com/anhdq201/rukovoditel/issues/4
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-43164
