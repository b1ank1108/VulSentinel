---
cve_id: CVE-2022-44948
template_path: nuclei-templates/http/cves/2022/CVE-2022-44948.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

Rukovoditel version 3.2.1 and earlier contains a stored cross-site scripting (XSS) vulnerability in the Entities Group feature. The vulnerability exists at the endpoint `/index.php?module=entities/entities_groups` where user input in the Name field is not properly sanitized before being stored and rendered. When an authenticated user creates a new entity group by clicking "Add" and submits a crafted payload in the Name field, the malicious script is stored in the application and executed in the browser context of any user who subsequently views the entities groups page.

Successful exploitation allows an attacker to execute arbitrary JavaScript code in victims' browsers, potentially leading to session hijacking, credential theft, or defacement. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 5.4 (Medium severity). The attack vector is network-based with low attack complexity, but requires low-level privileges (authenticated user) and user interaction.

## PoC / Detection

Classification: state-change

The template performs authenticated exploitation testing through a three-step process:

1. **Initial GET request**: Retrieves the login page at `/index.php?module=users/login` to extract the CSRF token (form_session_token)

2. **Authentication**: Submits credentials via POST to `/index.php?module=users/login&action=login` with the extracted CSRF token, username, and password to establish an authenticated session

3. **XSS payload injection**: Sends a POST request to `/index.php?module=entities/entities_groups&action=save` with the CSRF token and a URL-encoded XSS payload (`<script>alert(document.domain)</script>`) in the `name` parameter

The template verifies successful exploitation by checking that the response contains the injected script tag in the HTML body, confirming the stored XSS vulnerability. The detection requires valid credentials to be provided as template variables.

## References

- https://github.com/anhdq201/rukovoditel/issues/8
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-44948
- http://rukovoditel.com
