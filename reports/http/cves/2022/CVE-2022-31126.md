---
cve_id: CVE-2022-31126
template_path: nuclei-templates/http/cves/2022/CVE-2022-31126.yaml
affected_product: Roxy-WI
severity: critical
authentication: none
external_callback: false
affected_versions: < 6.1.1.0
preconditions: []
poc_classification: rce
---

## Vulnerability

Roxy-WI versions prior to 6.1.1.0 contain a critical remote code execution vulnerability. The flaw exists in the `/app/funct.py` file where the `ssh_command` function fails to properly sanitize user-supplied input before executing system commands. This allows unauthenticated attackers to inject and execute arbitrary operating system commands remotely through the `/app/options.py` endpoint. The vulnerability is classified as CWE-74 (Improper Neutralization of Special Elements in Output Used by a Downstream Component) and carries a CVSS v3.1 score of 9.8, indicating maximum severity with no privileges, user interaction, or special conditions required for exploitation.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to `/app/options.py` with a crafted payload that exploits command injection in the `getcert` parameter. The payload `getcert=;id;` appends the `id` command to the expected input, leveraging the lack of input validation in the ssh_command function. The template verifies successful exploitation by checking for the presence of Unix `id` command output patterns (matching `uid=` and `gid=` with numeric/alphanumeric values) in the HTTP response body, along with a 200 status code. The detection confirms that arbitrary commands can be executed on the underlying system without authentication.

## References

- https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/
- https://github.com/roxy-wi/roxy-wi/security/advisories/GHSA-mh86-878h-43c9
- https://nvd.nist.gov/vuln/detail/CVE-2022-31126
