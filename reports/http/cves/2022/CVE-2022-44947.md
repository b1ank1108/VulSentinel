---
cve_id: CVE-2022-44947
template_path: nuclei-templates/http/cves/2022/CVE-2022-44947.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 3.2.1
preconditions: [Highlight Row feature at entities_id=24]
poc_classification: state-change
---

## Vulnerability
Rukovoditel <= 3.2.1 contains a stored cross-site scripting (XSS) vulnerability in the Highlight Row feature at `/index.php?module=entities/listing_types&entities_id=24`. Authenticated attackers can inject arbitrary web scripts or HTML via a crafted payload in the Note field after clicking "Add".  
CVSS: 5.4 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N) • CWE-79 • EPSS: 0.01093 (0.78th percentile).  
Successful exploitation executes malicious scripts in the victim's browser context, enabling data theft, session hijacking, or defacement. Remediation requires upgrade to a version higher than 3.2.1.

## PoC / Detection
Classification: state-change  
The template first GETs the login page to extract the `form_session_token` nonce, performs a POST login with supplied credentials, then issues a POST to `/index.php?module=entities/listing_highlight&action=save&entities_id=24` injecting `<script>alert(document.domain)</script>` into the `notes` field. It verifies exploitation success when the response (status 200, HTML) contains the unsanitized payload string and the string "rukovoditel".

## References
- https://github.com/anhdq201/rukovoditel/issues/13
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-44947
- http://rukovoditel.com
