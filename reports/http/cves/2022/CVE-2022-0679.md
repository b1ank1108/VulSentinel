---
cve_id: CVE-2022-0679
template_path: nuclei-templates/http/cves/2022/CVE-2022-0679.yaml
affected_product: WordPress Narnoo Distributor plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.5.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Narnoo Distributor plugin version 2.5.1 and prior contains a critical local file inclusion (LFI) vulnerability. The plugin fails to validate and sanitize the `lib_path` parameter before passing it to a `require()` call via the `narnoo_distributor_lib_request` AJAX action. The contents of the accessed file are displayed in the response as JSON data. This vulnerability allows unauthenticated attackers to read arbitrary files from the server's filesystem. Depending on system configuration and the ability to upload or inject executable code into accessible files, this LFI can potentially escalate to remote code execution (RCE). The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS score of 9.8, indicating critical severity with no authentication required and high impact on confidentiality, integrity, and availability.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending an unauthenticated POST request to `/wp-admin/admin-ajax.php` with the AJAX action `narnoo_distributor_lib_request` and a malicious `lib_path` parameter set to `/etc/passwd`. The template verifies successful exploitation by checking for:

1. A regex pattern matching typical `/etc/passwd` file content (`root:.*:0:0:`)
2. An HTTP 200 status code response

The detection confirms that the plugin allows arbitrary file read access without authentication, demonstrating the local file inclusion vulnerability. While the underlying vulnerability can lead to RCE under certain conditions, the template itself only verifies the ability to read sensitive system files.

## References

- https://wpscan.com/vulnerability/0ea79eb1-6561-4c21-a20b-a1870863b0a8
- https://nvd.nist.gov/vuln/detail/CVE-2022-0679
- https://github.com/cyllective/CVEs
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
