---
cve_id: CVE-2022-2756
template_path: nuclei-templates/http/cves/2022/CVE-2022-2756.yaml
affected_product: Kavita
severity: medium
authentication: required
external_callback: false
affected_versions: <0.5.4.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-2756 is a Server-Side Request Forgery (SSRF) vulnerability in Kavita versions prior to 0.5.4.1. The vulnerability exists in the upload-by-url functionality, allowing authenticated attackers to force the server to make arbitrary HTTP requests to internal or external resources. This is classified as CWE-918 (Server-Side Request Forgery) with a CVSS score of 6.5 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N), indicating network-exploitable conditions requiring low-privileged authentication with high confidentiality impact.

An attacker with valid credentials can abuse the `/api/upload/upload-by-url` endpoint to make the Kavita server fetch content from arbitrary URLs. This can lead to unauthorized access to internal network resources, information disclosure from systems that trust the Kavita server, or potential reconnaissance of internal infrastructure. The vulnerability was fixed in version 0.5.4.1.

## PoC / Detection

Classification: info-leak

The template performs authenticated exploitation testing through a three-step process:

1. **Authentication**: Sends a POST request to `/api/account/login` with provided credentials to obtain a JWT bearer token
2. **SSRF Trigger**: Uses the obtained token to POST to `/api/upload/upload-by-url` with a URL pointing to `http://oast.me/#.png` (a known external test service)
3. **Verification**: Attempts to retrieve the uploaded content via GET request to `/api/image/cover-upload` to confirm the server fetched the external resource

The template confirms the vulnerability by checking for:
- HTTP 200 status code
- Content-Type header indicating `image/png`
- Response body containing "Interactsh Server" text (confirming the external fetch occurred)

This demonstrates the server's ability to be coerced into making arbitrary HTTP requests, proving the SSRF vulnerability exists.

## References

- https://huntr.dev/bounties/95e7c181-9d80-4428-aebf-687ac55a9216/
- https://github.com/kareadita/kavita
- https://github.com/kareadita/kavita/commit/9c31f7e7c81b919923cb2e3857439ec0d16243e4
- https://nvd.nist.gov/vuln/detail/CVE-2022-2756
