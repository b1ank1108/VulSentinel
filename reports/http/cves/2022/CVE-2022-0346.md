---
cve_id: CVE-2022-0346
template_path: nuclei-templates/http/cves/2022/CVE-2022-0346.yaml
affected_product: WordPress XML Sitemap Generator for Google
severity: medium
authentication: none
external_callback: false
affected_versions: <2.0.4
preconditions: PHP allow_url_include enabled (for RCE)
poc_classification: rce
---

## Vulnerability
WordPress XML Sitemap Generator for Google plugin before 2.0.4 fails to validate the `xsg-provider` query parameter, allowing an arbitrary value. This produces reflected cross-site scripting via error messages or remote code execution via the `data://` stream wrapper when PHP's `allow_url_include` directive is turned on. Impact includes arbitrary code execution on the server or malicious script injection into pages viewed by other users (CVSS 6.1, CWE-79).

## PoC / Detection
Classification: rce

The template sends two unauthenticated GET requests to `/?p=1` and stops at the first match:

- Request 1 injects XSS payload `<img src onerror=alert(document.domain)>` (plus dummy `xsg-format`/`xsg-type`/`xsg-page`); matcher requires both the literal payload and string "Invalid Provider type specified" in `body_1`.
- Request 2 injects RCE payload `data://text/html,<?php echo md5("CVE-2022-0346"); //` (plus dummy params); matcher checks for MD5 hash `2ef3baa95802a4b646f2fc29075efe34` in `body_2`.

## References
- https://wpscan.com/vulnerability/4b339390-d71a-44e0-8682-51a12bd2bfe6
- https://wordpress.org/plugins/www-xml-sitemap-generator-org/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0346
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
