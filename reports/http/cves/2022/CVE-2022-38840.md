---
cve_id: CVE-2022-38840
template_path: nuclei-templates/http/cves/2022/CVE-2022-38840.yaml
affected_product: Güralp MAN-EAM-0003
severity: high
authentication: none
external_callback: false
affected_versions: 3.2.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Güralp MAN-EAM-0003 3.2.4 contains an XML External Entity (XXE) vulnerability (CWE-611) in cgi-bin/xmlstatus.cgi via XML file upload, enabling unauthenticated local file disclosure. Remote attackers can read arbitrary files (e.g. /etc/passwd) from the seismic monitoring device, exposing sensitive configuration data and system credentials. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5).

## PoC / Detection
Classification: info-leak  
The template issues a single POST multipart/form-data request to `/cgi-bin/xmlstatus.cgi` containing a crafted `xml_data` payload with `<!DOCTYPE replace [<!ENTITY example SYSTEM "file:///etc/passwd">]>` and `&example;` injected into the build_label reading. Detection succeeds on HTTP 200 responses that contain the regex `root:.*:0:0:` (confirming /etc/passwd leakage) together with status-page markers `<title>XML status</title>`, `Software repository label`, and `<code>xmlstatus.cgi</code>`.

## References
- https://www.exploit-db.com/exploits/51037
- https://nvd.nist.gov/vuln/detail/CVE-2022-38840
