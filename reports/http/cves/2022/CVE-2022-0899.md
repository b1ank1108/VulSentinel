---
cve_id: CVE-2022-0899
template_path: nuclei-templates/http/cves/2022/CVE-2022-0899.yaml
affected_product: Header Footer Code Manager
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.1.24
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2022-0899 is a Reflected Cross-Site Scripting (XSS) vulnerability in the Header Footer Code Manager WordPress plugin versions prior to 1.1.24. The vulnerability exists in an admin page where the plugin fails to properly escape generated URLs before outputting them back in HTML attributes. This allows authenticated attackers to inject malicious JavaScript code through crafted URL parameters. When an administrator accesses a specially crafted URL, the injected script executes in their browser context, potentially enabling session hijacking, credential theft, or unauthorized administrative actions. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).

## PoC / Detection

Classification: state-change

The template performs authenticated detection of the XSS vulnerability through a two-step process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Probe**: Sends a GET request to `/wp-admin/admin.php?page=hfcm-list` with an XSS payload (`'><script>alert(/document.domain/)</script>`) appended to the URL

The template verifies successful exploitation by checking:
- HTTP 200 status code on the second request
- Content-Type is `text/html`
- The injected script tag `<script>alert(/document.domain/)</script>` is reflected in the response body
- The response contains "All Snippets" text, confirming the admin page loaded correctly

The detection confirms the vulnerability allows injection of arbitrary JavaScript that executes in the administrator's browser context, enabling potential session hijacking or unauthorized administrative actions.

## References

- https://wpscan.com/vulnerability/1772417a-1abb-4d97-9694-1254840defd1
- https://nvd.nist.gov/vuln/detail/CVE-2022-0899
