---
cve_id: CVE-2022-31299
template_path: nuclei-templates/http/cves/2022/CVE-2022-31299.yaml
affected_product: Haraj
severity: medium
authentication: none
external_callback: false
affected_versions: 3.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-31299 is a reflected cross-site scripting (XSS) vulnerability in Haraj version 3.7, specifically affecting the User Upgrade Form component. The vulnerability exists in the `payform.php` endpoint where user-supplied input in the `note` parameter is not properly sanitized before being reflected in the HTML response. An attacker can inject malicious JavaScript code that executes in the context of a victim's browser session when they visit a crafted URL. This can lead to theft of authentication credentials, session hijacking, or other client-side attacks. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity), requiring user interaction but no authentication.

## PoC / Detection

Classification: info-leak

The template detects this XSS vulnerability by sending a GET request to the `/payform.php` endpoint with a crafted `note` parameter containing an XSS payload: `</textarea><script>alert(document.domain)</script>`. The payload attempts to break out of a textarea HTML element and inject JavaScript code.

The detection verifies the vulnerability through three conditions:
1. The injected payload `><script>alert(document.domain)</script></textarea>` is reflected in the response body
2. The response contains the string `content="nextHaraj"`, confirming the page is a Haraj application
3. The response has a `text/html` content type and returns HTTP status 200

The template uses a harmless `alert(document.domain)` probe rather than executing malicious actions, but confirms that arbitrary JavaScript can be injected and executed in the victim's browser context.

## References

- https://github.com/bigzooooz/CVE-2022-31299
- https://angtech.org
- https://nvd.nist.gov/vuln/detail/CVE-2022-31299
- https://angtech.org/product/view/3
- https://github.com/trhacknon/Pocingit
