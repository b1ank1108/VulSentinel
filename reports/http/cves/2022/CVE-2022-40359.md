---
cve_id: CVE-2022-40359
template_path: nuclei-templates/http/cves/2022/CVE-2022-40359.yaml
affected_product: Kae's File Manager
severity: medium
authentication: none
external_callback: false
affected_versions: <=1.4.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-40359 is a reflected cross-site scripting (XSS) vulnerability in Kae's File Manager through version 1.4.7. The vulnerability exists in the `/kfm/index.php` endpoint, which fails to properly sanitize user input passed via GET requests. An attacker can craft a malicious URL containing JavaScript code that, when accessed by a victim, executes in the context of the victim's browser session. This allows the attacker to steal cookie-based authentication credentials, perform actions on behalf of the victim, deface the application interface, or redirect users to malicious sites. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity), requiring user interaction but no authentication to exploit.

## PoC / Detection

Classification: info-leak

The template detects this XSS vulnerability by sending a GET request to `/kfm/index.php/` with a crafted payload containing `<script>alert(document.domain);</script>` appended to the path. The detection verifies successful exploitation by checking for three conditions in the response:

1. The injected script tag `<script>alert(document.domain);</script>` is reflected in the response body
2. Application-specific strings (`x_kfm_changeCaption` and `kfm_copyFiles`) are present, confirming the target is running Kae's File Manager
3. The response has a 200 status code and `text/html` content type

The presence of the unescaped script tag in the HTML response confirms that user input is not properly sanitized, making the application vulnerable to XSS attacks.

## References

- https://cxsecurity.com/issue/WLB-2022090057
- https://code.google.com/archive/p/kfm/downloads
- https://nvd.nist.gov/vuln/detail/CVE-2022-40359
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
