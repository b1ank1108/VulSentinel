---
cve_id: CVE-2022-29464
template_path: nuclei-templates/http/cves/2022/CVE-2022-29464.yaml
affected_product: WSO2 Management Console
severity: critical
authentication: none
external_callback: false
affected_versions: WSO2 API Manager 2.2.0 through 4.0.0; WSO2 Identity Server 5.2.0 through 5.11.0; WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0; WSO2 Identity Server as Key Manager 5.3.0 through 5.10.0; WSO2 Enterprise Integrator 6.2.0 through 6.6.0
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2022-29464 is a critical arbitrary file upload vulnerability affecting multiple WSO2 products that leads to remote code execution. The vulnerability allows unauthenticated attackers to upload files without restriction to arbitrary paths on the server filesystem. By exploiting path traversal in the file upload endpoint (`/fileupload/toolsAny`), attackers can write malicious JSP files directly into the web application deployment directory (`repository/deployment/server/webapps/authenticationendpoint/`), achieving immediate code execution when the uploaded file is accessed.

The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no authentication or user interaction requirements. The EPSS score of 0.94434 (99.984th percentile) indicates extremely high probability of active exploitation in the wild. This vulnerability is listed in CISA's Known Exploited Vulnerabilities (KEV) catalog.

Affected products include WSO2 API Manager, Identity Server, Identity Server Analytics, Identity Server as Key Manager, and Enterprise Integrator across multiple version ranges spanning several years of releases.

## PoC / Detection

Classification: rce

The template performs a two-step exploitation and verification process:

1. **File Upload with Path Traversal**: Sends a POST request to `/fileupload/toolsAny` with a multipart form-data payload. The Content-Disposition header exploits path traversal using `../../../../repository/deployment/server/webapps/authenticationendpoint/` to escape the intended upload directory and write a JSP file with a randomized name to the web-accessible authentication endpoint directory. The uploaded JSP contains a simple output statement: `<% out.print("WSO2-RCE-CVE-2022-29464"); %>`.

2. **Code Execution Verification**: Sends a GET request to access the uploaded JSP file at `/authenticationendpoint/[randomized-filename].jsp`. If the file was successfully uploaded and executed, the server processes the JSP code and returns the marker string.

The template confirms the vulnerability by matching the presence of `WSO2-RCE-CVE-2022-29464` in the second response body, proving both arbitrary file write capability and remote code execution. The template is marked as `intrusive` due to the actual file upload operation that modifies server state.

## References

- https://shanesec.github.io/2022/04/21/Wso2-Vul-Analysis-cve-2022-29464/
- https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2021-1738
- https://github.com/hakivvi/CVE-2022-29464
- https://nvd.nist.gov/vuln/detail/CVE-2022-29464
- http://www.openwall.com/lists/oss-security/2022/04/22/7
