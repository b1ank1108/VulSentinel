---
cve_id: CVE-2022-43016
template_path: nuclei-templates/http/cves/2022/CVE-2022-43016.yaml
affected_product: OpenCATS
severity: medium
authentication: required
external_callback: false
affected_versions: 0.9.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

OpenCATS version 0.9.6 contains a reflected cross-site scripting (XSS) vulnerability in the callback component. The vulnerability exists in the toolbar module's callback parameter, which fails to properly sanitize user input before reflecting it in the application response. An attacker can inject arbitrary JavaScript code through this parameter, which will execute in the browser of an unsuspecting user in the context of the affected site. This can enable the attacker to steal cookie-based authentication credentials, hijack user sessions, perform actions on behalf of the victim, or launch additional attacks against users of the application.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity), characterized by network-based attack vector, low attack complexity, no privileges required, but requiring user interaction with changed scope.

## PoC / Detection

Classification: info-leak

The Nuclei template performs a two-step detection process:

1. **Authentication Step**: Sends a POST request to `/index.php?m=login&a=attemptLogin` with username and password credentials to establish an authenticated session.

2. **XSS Probe**: Sends a GET request to `/index.php?m=toolbar&callback=<script>alert(document.domain)</script>&a=authenticate` with the XSS payload injected into the callback parameter.

The template confirms the vulnerability by checking for:
- The reflected XSS payload in the response body: `EVAL=<script>alert(document.domain)</script>`
- The presence of `cats_connected` string indicating successful authentication context
- A `text/html` content-type header
- HTTP 200 status code

The detection requires valid credentials to access the vulnerable endpoint, demonstrating that the XSS vulnerability exists in an authenticated portion of the application.

## References

- https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_callback.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-43016
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Henry4E36/POCS
