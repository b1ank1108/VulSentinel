---
cve_id: CVE-2022-43018
template_path: nuclei-templates/http/cves/2022/CVE-2022-43018.yaml
affected_product: OpenCATS
severity: medium
authentication: required
external_callback: false
affected_versions: 0.9.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability
OpenCATS 0.9.6 contains a cross-site scripting vulnerability via the email parameter in the Check Email function. An attacker can inject arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks. Authenticated attackers can inject malicious JavaScript through the email parameter in the Check Email function to steal OpenCATS user session cookies and recruitment data. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). CWE-79.

## PoC / Detection
Classification: info-leak
The template first issues a POST request to `/index.php?m=login&a=attemptLogin` supplying `username={{username}}&password={{password}}` to establish an authenticated session, then issues a GET request to `/index.php?m=toolbar&callback=abcd&a=checkEmailIsInSystem&email=</script><script>alert(document.domain)</script>`. Detection confirms successful reflection by matching the exact unsanitized payload string `'</script><script>alert(document.domain)</script>:0'` in the body, `text/html` in the header, and HTTP 200 status.

## References
- https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_checkEmail.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-43018
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Henry4E36/POCS
