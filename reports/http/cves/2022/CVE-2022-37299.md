---
cve_id: CVE-2022-37299
template_path: nuclei-templates/http/cves/2022/CVE-2022-37299.yaml
affected_product: Shirne CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 1.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Shirne CMS 1.2.0 (vendor: shirne_cms_project; CPE: cpe:2.3:a:shirne_cms_project:shirne_cms:1.2.0:*:*:*:*:*:*:*) contains a local file inclusion flaw in `/static/ueditor/php/controller.php`. The `action=proxy` endpoint accepts a `remote` parameter that accepts PHP stream wrappers, enabling arbitrary local file reads (e.g., via `php://filter/convert.base64-encode/resource=/etc/passwd`).

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N (score 6.5, CWE-22).  
Impact: unauthorized access to sensitive files, remote code execution, and full system compromise possible.  
Remediation: upgrade to the latest version or apply vendor patch.

## PoC / Detection
Classification: info-leak

The template issues one unauthenticated GET request to `{{BaseURL}}/static/ueditor/php/controller.php?action=proxy&remote=php://filter/convert.base64-encode/resource=/etc/passwd&maxwidth=-1&referer=test`. Detection succeeds if the response body contains the word `cm9vd` (base64-encoded “root” line from /etc/passwd), the `Content-Type` (or other) header contains `image/png`, and the status code is 200.

## References
- https://twitter.com/pikpikcu/status/1568316864690028544
- https://gitee.com/shirnecn/ShirneCMS/issues/I5JRHJ?from=project-issue
- https://nvd.nist.gov/vuln/detail/CVE-2022-37299
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Henry4E36/POCS
