---
cve_id: CVE-2022-29004
template_path: nuclei-templates/http/cves/2022/CVE-2022-29004.yaml
affected_product: Diary Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Diary Management System 1.0 contains a reflected cross-site scripting (XSS) vulnerability via the Name parameter (submitted as `searchdata`) in `search-result.php`. User-controlled input is reflected unsanitized in the HTML response body.  

Successful exploitation allows an attacker to inject arbitrary JavaScript that executes in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1, CWE-79). The endpoint is reachable only after authentication.

## PoC / Detection
Classification: info-leak

The template first issues a POST login request to `/edms/login.php` with `logindetail` and `userpassword` credentials, then issues a second POST to `/edms/search-result.php` containing `searchdata=<script>alert(document.domain);</script>`. Detection succeeds if the response body contains the literal injected payload string `'Serach Result Against "<script>alert(document.domain);</script>'`, the `Content-Type` header includes `text/html`, and the status code is 200. This confirms the parameter is reflected without sanitization.

## References
- https://github.com/sudoninja-noob/CVE-2022-29004/blob/main/CVE-2022-29004.txt
- https://phpgurukul.com/e-diary-management-system-using-php-and-mysql/
- http://phpgurukul.com
- https://nvd.nist.gov/vuln/detail/CVE-2022-29004
- https://github.com/manas3c/CVE-POC
