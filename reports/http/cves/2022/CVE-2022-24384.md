---
cve_id: CVE-2022-24384
template_path: nuclei-templates/http/cves/2022/CVE-2022-24384.yaml
affected_product: SmarterTools SmarterTrack
severity: medium
authentication: none
external_callback: false
affected_versions: 100.0.8019.14010
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Reflected Cross-Site Scripting (XSS) vulnerability (CVE-2022-24384, CWE-79) in SmarterTools SmarterTrack. This issue affects SmarterTools SmarterTrack 100.0.8019.14010. The flaw exists in the `viewSurveyError` query parameter of `/Main/Default.aspx` where attacker-supplied input is reflected unsanitized in the JSON error response.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
Successful exploitation allows arbitrary JavaScript execution in the victim's browser context (same origin), enabling session hijacking, page defacement, or theft of sensitive information such as cookies or form data.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `/Main/Default.aspx?viewSurveyError=Unknown+survey"><img%20src=x%20onerror=alert(document.domain)>` and verifies the vulnerability by matching the exact unsanitized payload inside the JSON error field (`"type":"error","text":"Unknown survey\"><img src=x onerror=alert(document.domain)>"`) together with the string `smartertrack` to confirm the target application.

## References
- https://csirt.divd.nl/CVE-2022-24384
- https://csirt.divd.nl/DIVD-2021-00029
