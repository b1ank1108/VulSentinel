---
cve_id: CVE-2022-3506
template_path: nuclei-templates/http/cves/2022/CVE-2022-3506.yaml
affected_product: WordPress Related Posts
severity: medium
authentication: required
external_callback: false
affected_versions: <2.1.3
preconditions: Related Posts for WordPress plugin installed and activated
poc_classification: state-change
---

## Vulnerability
WordPress Related Posts plugin (never5/related_posts) prior to 2.1.3 contains a stored cross-site scripting vulnerability in the `rp4wp[heading_text]` parameter. User-controlled input submitted to the plugin's admin settings is not sanitized or escaped before storage and display, allowing injection of arbitrary JavaScript (e.g., event-handler payloads). Successful exploitation permits an authenticated attacker to inject malicious scripts into the administrative interface, enabling theft of cookie-based authentication credentials, session hijacking, or other client-side attacks (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N, CWE-79).

## PoC / Detection
Classification: state-change

The template executes a multi-step authenticated workflow: POSTs credentials to `/wp-login.php`, GETs `/wp-admin/options-general.php?page=rp4wp` to extract the `_wpnonce`, POSTs to `/wp-admin/options.php` to update `rp4wp` settings with the malicious payload embedded in `rp4wp[heading_text]` (`" autofocus onfocus=alert(document.domain)>`), then GETs the settings page again and matches on the exact unsanitized payload appearing in the HTML response body along with expected status and content-type to confirm successful storage of the injected value.

## References
- https://huntr.dev/bounties/08251542-88f6-4264-9074-a89984034828/
- https://huntr.dev/bounties/08251542-88f6-4264-9074-a89984034828
- https://github.com/barrykooij/related-posts-for-wp/commit/37733398dd88863fc0bdb3d6d378598429fd0b81
- https://nvd.nist.gov/vuln/detail/CVE-2022-3506
- https://github.com/ARPSyndicate/cvemon
