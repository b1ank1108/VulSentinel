---
cve_id: CVE-2022-1162
template_path: nuclei-templates/http/cves/2022/CVE-2022-1162.yaml
affected_product: GitLab CE/EE
severity: critical
authentication: none
external_callback: false
affected_versions: 14.7 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2
preconditions: accounts registered using an OmniAuth provider (e.g. OAuth, LDAP, SAML)
poc_classification: auth-bypass
---

## Vulnerability
GitLab Community Edition (CE) and Enterprise Edition (EE) contain a hard-coded credentials vulnerability (CVE-2022-1162, CWE-798). A hardcoded password was set for every account registered using an OmniAuth provider (OAuth, LDAP, SAML), enabling attackers to authenticate as those users.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Impact: full account takeover, access to sensitive data, and unauthorized actions inside the instance. Remediation requires upgrading beyond the fixed versions; positive version detection does not guarantee an exploitable account exists.

## PoC / Detection
Classification: auth-bypass

The template issues a single unauthenticated GET to `{{BaseURL}}/users/sign_in` (following up to 3 redirects) and checks the response body for any of six specific SHA-256 hashes that appear in the `application-<hash>.css` file link present only in vulnerable releases. It also extracts the 64-character CSS hash via regex for optional post-processing. This is purely passive version fingerprinting; the template never attempts login, credential use, or exploitation.

## References
- https://gitlab.com/gitlab-com/gl-security/threatmanagement/redteam/redteam-public/cve-hash-harvester
- https://gitlab.com/gitlab-org/cves/-/blob/master/2022/CVE-2022-1162.json
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1162
- http://packetstormsecurity.com/files/166828/Gitlab-14.9-Authentication-Bypass.html
- https://nvd.nist.gov/vuln/detail/cve-2022-1162
