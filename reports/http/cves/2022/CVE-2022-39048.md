---
cve_id: CVE-2022-39048
template_path: nuclei-templates/http/cves/2022/CVE-2022-39048.yaml
affected_product: ServiceNow
severity: medium
authentication: required
external_callback: false
affected_versions: Quebec (and potentially other versions prior to patch)
preconditions: [Attacker must persuade authenticated user to click maliciously crafted URL]
poc_classification: info-leak
---

## Vulnerability

CVE-2022-39048 is a reflected Cross-Site Scripting (XSS) vulnerability in ServiceNow's `assessment_redirect.do` UI page. The vulnerability exists due to improper sanitization of the `sysparm_survey_url` parameter, which allows JavaScript code injection. 

An attacker can craft a malicious URL containing JavaScript payloads that execute in the context of an authenticated user's browser session when the victim clicks the link. This vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity, AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).

Successful exploitation enables various client-side attacks including phishing campaigns, session hijacking through CSRF token theft, cookie stealing, redirection to malicious sites, and leveraging the authenticated user's browser to attack other systems within the ServiceNow environment.

## PoC / Detection

Classification: info-leak

The template performs authenticated detection of the XSS vulnerability through a three-step process:

1. **Initial request**: Fetches the login page at `/navpage.do` to obtain a CSRF token required for authentication
2. **Authentication**: Submits credentials via POST to `/login.do` with the extracted CSRF token and user-provided credentials (`{{username}}` and `{{password}}`)
3. **Vulnerability probe**: Sends a GET request to `/assessment_redirect.do` with a JavaScript payload in the `sysparm_survey_url` parameter: `javascript:alert(document.domain)//assessment_take2.do`

The template confirms the vulnerability by checking for:
- The reflected JavaScript payload in the response body: `unwrapped_url = "javascript:alert(document.domain)//assessment_take2.do"`
- Presence of `assessment_list.do` string indicating the vulnerable page context
- HTTP 200 status code
- Content-Type header containing `text/html`

The detection verifies that the malicious JavaScript is reflected unsanitized in the HTML response, confirming the XSS vulnerability is exploitable.

## References

- https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1221892
- https://blog.amanrawat.in/2023/05/05/CVE-2022-39048.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-39048
- https://support.servicenow.com/
