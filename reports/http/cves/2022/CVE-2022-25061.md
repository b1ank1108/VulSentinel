---
cve_id: CVE-2022-25061
template_path: nuclei-templates/http/cves/2022/CVE-2022-25061.yaml
affected_product: TP-Link TL-WR840N
severity: critical
authentication: required
external_callback: false
affected_versions: 6.20_180709
preconditions: []
poc_classification: rce
---

## Vulnerability
TP-Link TL-WR840N(ES)_V6.20_180709 router firmware contains a command injection vulnerability (CWE-78) in the oal_setIp6DefaultRoute component. Authenticated attackers can execute arbitrary system commands via crafted requests to the CGI endpoint, resulting in complete device compromise (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H score 9.8).

## PoC / Detection
Classification: rce

The template performs two sequential raw POST requests to `/cgi?2` authenticated via Basic Auth (using `username` and `password` variables plus random `filename`). The first request injects shell commands (`cat /etc/passwd > /tmp/{{filename}}.txt` and `cat /proc/cpuinfo`) inside the NOIP_DNS_CFG block via the `userName` parameter. The second request re-injects via the `__ifName` parameter in the L3_IP6_FORWARDING block to output the temporary file. Detection succeeds on HTTP 200 status and regex match `root:[x*]:0:0` in the response body.

## References
- https://github.com/exploitwritter/CVE-2022-25061/blob/main/CVE-2022-25061.py
- https://east-trowel-102.notion.site/CVE-2021-XXXX-Injection-of-commands-through-object-oal_setIp6DefaultRoute-EN-ddf9c1db199d49829269147ada6cb312
- https://nvd.nist.gov/vuln/detail/CVE-2022-25061
- http://router.com
- http://tp-link.com
