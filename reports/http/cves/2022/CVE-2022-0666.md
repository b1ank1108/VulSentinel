---
cve_id: CVE-2022-0666
template_path: nuclei-templates/http/cves/2022/CVE-2022-0666.yaml
affected_product: Microweber
severity: high
authentication: none
external_callback: false
affected_versions: < 1.2.11
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Microweber prior to 1.2.11 is affected by a CRLF injection vulnerability in the `redirect_to` parameter of the `/api/logout` endpoint. Lack of proper filtering allows injection of CRLF sequences (`%0d%0a`), enabling stack trace exposure and arbitrary HTTP header injection (e.g., custom Set-Cookie headers). 

Potential impacts include sensitive information disclosure via stack traces, session hijacking, and cache poisoning. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5). CWE-93.

## PoC / Detection
Classification: info-leak

The template issues a GET request to `{{BaseURL}}/api/logout?redirect_to=%0d%0aSet-Cookie:crlfinjection=1;` and matches the regex `^Set-Cookie: crlfinjection=1;` in the response headers to confirm successful header injection.

## References
- https://github.com/microweber/microweber/commit/f0e338f1b7dc5ec9d99231f4ed3fa6245a5eb128
- https://huntr.dev/bounties/7215afc7-9133-4749-8e8e-0569317dbd55
- https://nvd.nist.gov/vuln/detail/CVE-2022-0666
