---
cve_id: CVE-2022-1711
template_path: nuclei-templates/http/cves/2022/CVE-2022-1711.yaml
affected_product: draw.io
severity: high
authentication: none
external_callback: true
affected_versions: < 18.0.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
draw.io (also known as diagrams.net) prior to version 18.0.5 contains an SSRF in the ProxyServlet component due to missing URL validation. Unauthenticated remote attackers can supply arbitrary URLs (including internal IPs, localhost, or external hosts) to the /proxy endpoint, bypassing all restrictions and forcing the server to issue requests on their behalf. This enables internal network reconnaissance, access to non-public services, and sensitive data exfiltration. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). CWE-918.

## PoC / Detection
Classification: info-leak
The template issues a single unauthenticated GET request to `{{BaseURL}}/proxy?url=http://{{interactsh-url}}` and confirms exploitation via the matcher DSL: `status_code == 200 && contains(interactsh_protocol, 'dns') && contains(content_type, 'application/octet-stream')`. A DNS callback to the interactsh server proves the proxy blindly forwards the attacker-controlled URL.

## References
- https://huntr.dev/bounties/c32afff5-6ad5-4d4d-beea-f55ab4925797
- https://github.com/jgraph/drawio/commit/cf5c78aa0f3127fb10053db55b39f3017a0654ae
- https://nvd.nist.gov/vuln/detail/CVE-2022-1711
