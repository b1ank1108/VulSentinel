---
cve_id: CVE-2022-43017
template_path: nuclei-templates/http/cves/2022/CVE-2022-43017.yaml
affected_product: OpenCATS
severity: medium
authentication: required
external_callback: false
affected_versions: 0.9.6
preconditions: []
poc_classification: info-leak
---

## Vulnerability

OpenCATS version 0.9.6 contains a reflected cross-site scripting (XSS) vulnerability in the indexFile component accessed through the ajax.php endpoint. The vulnerability exists in the getPipelineJobOrder function where the indexFile parameter is not properly sanitized before being reflected in the HTTP response. An attacker can inject arbitrary JavaScript code through this parameter, which will execute in the browser of an authenticated user who clicks on a malicious link or visits a crafted page. This can lead to theft of cookie-based authentication credentials, session hijacking, or other client-side attacks within the context of the OpenCATS application.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v3.1 score of 6.1 (Medium severity). The attack vector is network-based with low attack complexity, requires no privileges but does require user interaction, and has a changed scope with low impact to confidentiality and integrity.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/index.php?m=login&a=attemptLogin` with username and password credentials to establish an authenticated session.

2. **XSS Probe**: Sends a GET request to `/ajax.php` with the following parameters:
   - `f=getPipelineJobOrder`
   - `joborderID=1`
   - `page=0`
   - `entriesPerPage=1`
   - `sortBy=dateCreatedInt`
   - `sortDirection=desc`
   - `indexFile=15)"></a><script>alert(document.domain)</script>` (XSS payload)
   - `isPopup=0`

The template verifies the vulnerability by checking for:
- The reflected XSS payload `<script>alert(document.domain)</script>` in the response body
- The presence of `CATS=` string (indicating OpenCATS application context)
- Content-Type header containing `text/html`
- HTTP status code 200

Successful detection confirms that the injected JavaScript is reflected unescaped in the HTML response, demonstrating the XSS vulnerability.

## References

- https://github.com/hansmach1ne/opencats_zero-days/blob/main/XSS_in_indexFile.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-43017
