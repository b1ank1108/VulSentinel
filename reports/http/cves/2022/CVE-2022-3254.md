---
cve_id: CVE-2022-3254
template_path: nuclei-templates/http/cves/2022/CVE-2022-3254.yaml
affected_product: AWP Classifieds
severity: critical
authentication: none
external_callback: false
affected_versions: <= 4.2.1
preconditions: [premium module active]
poc_classification: info-leak
---

## Vulnerability
AWP Classifieds (AWPCP) WordPress plugin <= 4.2.1 contains an unauthenticated SQL injection in the `awpcp-get-regions-options` AJAX action caused by improper sanitization and escaping of parameters (notably `type`). Unauthenticated attackers can execute arbitrary SQL commands when the premium module is active, enabling data theft, data tampering, or full database compromise.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated GET request to `/wp-admin/admin-ajax.php` with the `action=awpcp-get-regions-options` endpoint, injecting a UNION SELECT VERSION() payload into the `type` parameter. It verifies success with a DSL matcher requiring HTTP 200, presence of both "options" and "status" keys in the JSON body, and a non-empty/non-false options array (confirming the injected query executed and data was returned in the response).

## References
- https://nvd.nist.gov/vuln/detail/CVE-2022-3254
- https://wpscan.com/vulnerability/546c47c2-5b4b-46db-b754-c6b43aef2660
