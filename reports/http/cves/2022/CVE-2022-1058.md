---
cve_id: CVE-2022-1058
template_path: nuclei-templates/http/cves/2022/CVE-2022-1058.yaml
affected_product: Gitea
severity: medium
authentication: none
external_callback: true
affected_versions: <1.16.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Gitea before 1.16.5 is susceptible to an open redirect via improper validation of the `redirect_to` cookie on the login endpoint (CWE-601). An attacker can supply an arbitrary redirect target (e.g., via cookie) that is reflected in a 302 Location header, enabling redirection of authenticated or unauthenticated users to malicious sites.  

**Impact**  
Phishing, credential theft, or execution of unauthorized operations via attacker-controlled redirect.  

**CVSS 3.1**  
6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  

**Remediation**  
Upgrade to Gitea 1.16.5 or later.

## PoC / Detection
**Classification: info-leak**  

The template performs a two-request detection sequence:  
1. GET `/user/login` to extract the `_csrf` token via regex.  
2. POST `/user/login` with `Cookie: redirect_to=//interact.sh`, the extracted CSRF value, and arbitrary `user_name`/`password` form data.  

It matches on HTTP 302 status and the presence of `//interact.sh` in the second response's `Location` header, confirming the server accepted and reflected the attacker-controlled redirect target without validation.

## References
- https://github.com/go-gitea/gitea/commit/e3d8e92bdc67562783de9a76b5b7842b68daeb48
- https://huntr.dev/bounties/4fb42144-ac70-4f76-a5e1-ef6b5e55dc0d
- https://nvd.nist.gov/vuln/detail/CVE-2022-1058
