---
cve_id: CVE-2022-41697
template_path: nuclei-templates/http/cves/2022/CVE-2022-41697.yaml
affected_product: Ghost CMS
severity: medium
authentication: none
external_callback: false
affected_versions: 5.9.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Ghost CMS version 5.9.4 contains a user enumeration vulnerability (CWE-204) in the login functionality at the `/ghost/api/admin/session` endpoint. The application reveals whether a user account exists through different error messages in the authentication response. When an invalid email address is submitted, the system returns a specific error message "There is no user with that email address" with error type "NotFoundError", allowing attackers to distinguish between valid and invalid user accounts. This information disclosure vulnerability has a CVSS score of 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N), indicating low confidentiality impact with no authentication required for exploitation.

## PoC / Detection

Classification: info-leak

The template detects this user enumeration vulnerability by sending a POST request to `/ghost/api/admin/session` with randomly generated credentials (non-existent email and password). The detection verifies the vulnerability by checking for:

1. The presence of both the specific error message "There is no user with that email address" and error type "NotFoundError" in the JSON response body
2. A Content-Type header indicating `application/json`
3. The absence of a generic "Resource not found" message (confirming the specific enumeration message is returned)
4. An HTTP 404 status code

All four conditions must be met simultaneously to confirm the vulnerability. The template uses random strings to ensure it's testing with non-existent accounts, demonstrating that the application leaks information about account existence through distinguishable error responses.

## References

- https://talosintelligence.com/vulnerability_reports/TALOS-2022-1625
- https://nvd.nist.gov/vuln/detail/CVE-2022-41697
- https://github.com/tryghost/ghost
