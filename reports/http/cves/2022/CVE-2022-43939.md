---
cve_id: CVE-2022-43939
template_path: nuclei-templates/http/cves/2022/CVE-2022-43939.yaml
affected_product: Hitachi Vantara Pentaho Business Analytics Server
severity: high
authentication: none
external_callback: false
affected_versions: < 9.4.0.1, < 9.3.0.2, all 8.3.x versions
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability

CVE-2022-43939 is an authorization bypass vulnerability in Hitachi Vantara Pentaho Business Analytics Server. The vulnerability stems from improper security restrictions when processing non-canonical URL paths (CWE-647). Attackers can exploit this flaw to circumvent authorization checks and access protected administrative endpoints without authentication.

Versions prior to 9.4.0.1 and 9.3.0.2, including all 8.3.x releases, are affected. The vulnerability allows unauthenticated remote attackers to bypass authorization controls by crafting non-canonical URL paths, potentially gaining unauthorized access to sensitive analytics data, configurations, and administrative functions.

The CVSS v3.1 score is 8.6 (High), with the vector string CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H, indicating network-based exploitation requiring no privileges or user interaction, with potential for low confidentiality and integrity impact but high availability impact. The EPSS score of 0.93384 (99.807th percentile) indicates a very high probability of active exploitation in the wild. This vulnerability is listed in the Known Exploited Vulnerabilities (KEV) catalog.

## PoC / Detection

Classification: auth-bypass

The template performs a two-step detection process to verify the authorization bypass vulnerability:

1. **Initial verification**: Sends a GET request to `/pentaho/Login` to confirm the Pentaho Business Analytics Server is present by checking for HTTP 200 status and the presence of "Pentaho User Console - Login" in the response body.

2. **Exploitation probe**: Attempts to access a protected administrative API endpoint at `/pentaho/api/ldap/config/ldapTreeNodeChildren/require.js` using a non-canonical URL path. This endpoint should normally require authentication and authorization.

The template confirms successful exploitation by verifying:
- HTTP 200 status code (successful access)
- Response contains `application/json` content-type header
- Response contains `Path=/pentaho` cookie header
- Response body contains `{}` (empty JSON object, indicating successful API access)

The successful retrieval of this protected LDAP configuration endpoint without authentication demonstrates the authorization bypass vulnerability.

## References

- https://support.pentaho.com/hc/en-us/articles/14455394120333--Resolved-Pentaho-BA-Server-Use-of-Non-Canonical-URL-Paths-for-Authorization-Decisions-Versions-before-9-4-0-1-and-9-3-0-2-including-8-3-x-Impacted-CVE-2022-43939-
- https://nvd.nist.gov/vuln/detail/CVE-2022-43769
- https://research.aurainfosec.io/pentest/pentah0wnage/
