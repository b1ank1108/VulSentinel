---
cve_id: CVE-2022-24990
template_path: nuclei-templates/http/cves/2022/CVE-2022-24990.yaml
affected_product: TerraMaster TOS
severity: high
authentication: none
external_callback: false
affected_versions: < 4.2.30
preconditions: []
poc_classification: info-leak
---

## Vulnerability
TerraMaster NAS devices running TOS prior to version 4.2.30 are vulnerable to information disclosure. An unauthenticated remote attacker can trigger this flaw to obtain sensitive server details (including IP addresses, firmware version, hostname, port, URL, and credential-related patterns).  

**Impact**  
An attacker can exploit this vulnerability to gain sensitive information about the server, potentially leading to further attacks.  

**Remediation**  
Upgrade the TerraMaster TOS server to version 4.2.30 or later to mitigate the vulnerability.  

**CVE Metadata**  
- CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5)  
- CWE-306  
- CPE: cpe:2.3:o:terra-master:terramaster_operating_system:*:*:*:*:*:*:*:*  

## PoC / Detection
Classification: info-leak  

The template sends a single unauthenticated GET request to `{{BaseURL}}/module/api.php?mobile/webNasIPS` with the `User-Agent: TNAS` header. Detection succeeds on HTTP 200 responses where the `Content-Type` header contains both `application/json` and `TerraMaster`, and the body matches any of the following patterns: the string `webNasIPS successful`, regex indicators of network/credential fields `(ADDR|(IFC|PWD|[DS]AT)):`, or JSON keys for firmware/version/mask/mac/port/url/ip/hostname.

## References
- https://octagon.net/blog/2022/03/07/cve-2022-24990-terrmaster-tos-unauthenticated-remote-command-execution-via-php-object-instantiation/
- https://www.broadcom.com/support/security-center/attacksignatures/detail?asid=33732
- https://forum.terra-master.com/en/viewforum.php?f=28
- http://packetstormsecurity.com/files/172904/TerraMaster-TOS-4.2.29-Remote-Code-Execution.html
- https://github.com/ArrestX/--POC
