---
cve_id: CVE-2022-47966
template_path: nuclei-templates/http/cves/2022/CVE-2022-47966.yaml
affected_product: ManageEngine
severity: critical
authentication: none
external_callback: true
affected_versions: ServiceDesk Plus through 14003 (multiple other on-premise products)
preconditions: on-premise deployment
poc_classification: rce
---

## Vulnerability
Multiple Zoho ManageEngine on-premise products are vulnerable to unauthenticated remote command execution. Root cause is inclusion of Apache xmlsec 1.4.1 (XML Security for Java), whose XSLT processing delegates security controls to the calling application; ManageEngine’s SAMLResponseServlet does not enforce them. An attacker-supplied SAML Assertion containing a malicious XSLT Transform (using Xalan Java extensions) can invoke `Runtime.getRuntime().exec()`.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). Successful exploitation yields arbitrary command execution on the server.

## PoC / Detection
Classification: rce

The template actively triggers the flaw by sending a single unauthenticated POST to `/SamlResponseServlet`. The body contains a URL-encoded, base64-wrapped SAMLResponse XML with a crafted `<ds:Signature>` embedding an XSLT stylesheet inside a Transform. The stylesheet calls `rt:getRuntime()` and `rt:exec` to run `nslookup {{interactsh-url}}`. Detection matches on (1) DNS interaction via interactsh, (2) HTTP 500 status, and (3) the literal string “Unknown error occurred while processing your request” in the response body.

## References
- https://twitter.com/horizon3attack/status/1616062915097886732?s=46&t=ER_is9G4FlEebVFQPpnM0Q
- https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/
- https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-47966
- http://packetstormsecurity.com/files/170882/Zoho-ManageEngine-ServiceDesk-Plus-14003-Remote-Code-Execution.html
