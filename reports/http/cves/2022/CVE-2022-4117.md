---
cve_id: CVE-2022-4117
template_path: nuclei-templates/http/cves/2022/CVE-2022-4117.yaml
affected_product: WordPress IWS Geo Form Fields plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <=1.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
WordPress IWS Geo Form Fields plugin <=1.0 contains an unauthenticated SQL injection (CWE-89) in the `iws_gff_fetch_states` AJAX action. The `country_id` POST parameter is not escaped before use in a SQL statement. Arbitrary SQL execution is possible, resulting in sensitive data access, data modification, or unauthorized administrative operations on the WordPress site. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Fixed in version >=1.1.

## PoC / Detection
Classification: state-change

The template sends a single POST request to `/wp-admin/admin-ajax.php?action=iws_gff_fetch_states` containing the time-based blind SQLi payload `country_id=1%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP(6)))b)`. It matches on response duration >=6 seconds, HTTP 200 status, and body containing `"status":200` together with `{"html":`.

## References
- https://wpscan.com/vulnerability/1fac3eb4-13c0-442d-b27c-7b7736208193
- https://wordpress.org/plugins/iws-geo-form-fields/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4117
- https://github.com/ARPSyndicate/cvemon
- https://github.com/cyllective/CVEs
