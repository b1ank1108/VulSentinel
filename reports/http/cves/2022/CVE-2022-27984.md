---
cve_id: CVE-2022-27984
template_path: nuclei-templates/http/cves/2022/CVE-2022-27984.yaml
affected_product: Cuppa CMS
severity: critical
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: authenticated administrator access
poc_classification: info-leak
---

## Vulnerability
Cuppa CMS v1.0 contains a SQL injection vulnerability (CVE-2022-27984, CWE-89) via the unsanitized `menu_filter` parameter at `/administrator/templates/default/html/windows/right.php`. An authenticated attacker can inject arbitrary SQL, enabling database query manipulation that results in data exfiltration, unauthorized access, and potential complete compromise of the CMS instance. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection
Classification: info-leak

The template first issues a POST login request to `/` supplying `{{username}}` and `{{password}}` to establish an authenticated session. It then sends a second POST to `/templates/default/html/windows/right.php` with the time-based blind SQLi payload `menu_filter=3'+AND+SLEEP(6)--+-` (plus fixed `id` and `url`/`path` parameters). Vulnerability is confirmed if the second response shows >=6s duration, HTTP 200 status, text/html content-type, and body containing the string "components/menu/classes/functions.php".

## References
- https://github.com/CuppaCMS/CuppaCMS
- https://nvd.nist.gov/vuln/detail/CVE-2022-27984
- https://www.cuppacms.com/
- http://cuppa.com
