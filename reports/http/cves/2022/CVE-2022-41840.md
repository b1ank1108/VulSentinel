---
cve_id: CVE-2022-41840
template_path: nuclei-templates/http/cves/2022/CVE-2022-41840.yaml
affected_product: Welcart eCommerce
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.7.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Welcart eCommerce WordPress plugin <=2.7.7 is vulnerable to unauthenticated local file inclusion (LFI) / directory traversal. The flaw is in `wp-content/plugins/usc-e-shop/functions/progress-check.php` where the `progressfile` GET parameter fails to sanitize path traversal sequences (`../../../../..`).

Description: Welcart eCommerce 2.7.7 and before are vulnerable to unauthenticated local file inclusion.  
Impact: The LFI vulnerability can lead to unauthorized access to sensitive files, potentially exposing sensitive information or allowing for further exploitation.  
Remediation: Upgrade Welcart eCommerce plugin to the latest version (>=2.7.8) or apply the provided patch.  
CVSS: 9.8 Critical (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | CWE-22

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/wp-content/plugins/usc-e-shop/functions/progress-check.php?progressfile=../../../../../../../../../../../../../etc/passwd` and matches on:
- `application/json` header
- regex `root:.*:0:0:` in body (successful /etc/passwd inclusion)
- HTTP 200 status

## References
- https://patchstack.com/database/vulnerability/usc-e-shop/wordpress-welcart-e-commerce-plugin-2-7-7-unauth-directory-traversal-vulnerability
- https://wordpress.org/plugins/usc-e-shop/
- https://patchstack.com/database/vulnerability/usc-e-shop/wordpress-welcart-e-commerce-plugin-2-7-7-unauth-directory-traversal-vulnerability?_s_id=cve
- https://nvd.nist.gov/vuln/detail/CVE-2022-41840
