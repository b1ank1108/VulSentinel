---
cve_id: CVE-2022-23131
template_path: nuclei-templates/http/cves/2022/CVE-2022-23131.yaml
affected_product: Zabbix
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 5.4.9rc2, 6.0.0beta1, 6.0
preconditions: SAML SSO authentication enabled (non-default)
poc_classification: auth-bypass
---

## Vulnerability
Zabbix SAML SSO Authentication Bypass (CVE-2022-23131). When SAML SSO authentication is enabled (non-default), session data can be modified by a malicious actor because a user login stored in the session was not verified. Successful exploitation leads to unauthorized access to sensitive information and potential full compromise of the Zabbix monitoring system. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H), CWE-290.

## PoC / Detection
Classification: auth-bypass

The template sends a GET request to `{{BaseURL}}/zabbix/index_sso.php` (or `/index_sso.php`) with a crafted `zbx_session` cookie embedding SAML data that sets the `username_attribute` to "Admin". It detects successful bypass if the server responds with HTTP 302 and a `Location` header containing `zabbix.php?action=dashboard.view`.

## References
- https://support.zabbix.com/browse/ZBX-20350
- https://blog.sonarsource.com/zabbix-case-study-of-unsafe-session-storage
- https://nvd.nist.gov/vuln/detail/CVE-2022-23131
- https://github.com/1mxml/CVE-2022-23131
- https://github.com/20142995/sectool
