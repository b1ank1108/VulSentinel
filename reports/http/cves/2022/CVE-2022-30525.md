---
cve_id: CVE-2022-30525
template_path: nuclei-templates/http/cves/2022/CVE-2022-30525.yaml
affected_product: Zyxel Firewall
severity: critical
authentication: none
external_callback: true
affected_versions: USG FLEX 100(W)/200/500/700 (5.00 through 5.21 Patch 1), USG FLEX 50(W)/USG20(W)-VPN (5.10 through 5.21 Patch 1), ATP series (5.10 through 5.21 Patch 1), VPN series (4.60 through 5.21 Patch 1)
preconditions: []
poc_classification: rce
---

## Vulnerability

Zyxel Firewall devices contain an unauthenticated OS command injection vulnerability (CVE-2022-30525, CWE-78) in the CGI program at `/ztp/cgi-bin/handler`. Attackers can inject OS commands via the `mtu` parameter in a `setWanPortSt` JSON request, allowing arbitrary command execution on the device.

This affects multiple Zyxel USG FLEX, ATP, and VPN firewall models running specific firmware versions. Successful exploitation leads to full remote code execution (RCE), enabling attackers to compromise confidentiality, integrity, and availability of the firewall system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).

## PoC / Detection

Classification: rce

The template sends a single POST request with a crafted JSON payload injecting `; curl {{interactsh-url}};` into the mtu field to trigger an out-of-band callback. Detection succeeds if an HTTP interactsh callback is received alongside a 500 status code response from the server.

## References
- https://www.rapid7.com/blog/post/2022/05/12/cve-2022-30525-fixed-zyxel-firewall-unauthenticated-remote-command-injection/
- https://github.com/rapid7/metasploit-framework/pull/16563
- https://www.zyxel.com/support/Zyxel-security-advisory-for-OS-command-injection-vulnerability-of-firewalls.shtml
- https://nvd.nist.gov/vuln/detail/CVE-2022-30525
- http://packetstormsecurity.com/files/167176/Zyxel-Remote-Command-Execution.html
