---
cve_id: CVE-2022-4063
template_path: nuclei-templates/http/cves/2022/CVE-2022-4063.yaml
affected_product: WordPress InPost Gallery plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <2.1.4.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress InPost Gallery plugin versions before 2.1.4.1 contain a critical local file inclusion vulnerability. The plugin insecurely uses PHP's `extract()` function when rendering HTML views, allowing attackers to force the inclusion of arbitrary files. This vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory) and has a CVSS score of 9.8 (Critical). The flaw can be exploited without authentication, enabling remote attackers to read arbitrary files on the server, potentially exposing sensitive information such as configuration files, credentials, and other system data. The vulnerability can also be leveraged to execute malicious code remotely on affected servers.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending an unauthenticated GET request to the WordPress AJAX endpoint `/wp-admin/admin-ajax.php` with the action parameter `inpost_gallery_get_gallery`. The request includes a base64-encoded payload in the `popup_shortcode_attributes` parameter that decodes to `{"pagepath": "file:///etc/passwd"}`, exploiting the insecure `extract()` function to force inclusion of the `/etc/passwd` file.

The template confirms successful exploitation by checking for:
1. A response with `text/html` content type header
2. The presence of Unix password file patterns (regex: `root:.*:0:0:`) in the response body
3. HTTP status code 200

This detection method verifies that the plugin is vulnerable to local file inclusion by successfully reading a system file that should not be accessible through the web application.

## References

- https://wpscan.com/vulnerability/6bb07ec1-f1aa-4f4b-9717-c92f651a90a7
- https://wordpress.org/plugins/inpost-gallery/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4063
- https://github.com/cyllective/CVEs
- https://github.com/im-hanzou/INPGer
