---
cve_id: CVE-2022-0658
template_path: nuclei-templates/http/cves/2022/CVE-2022-0658.yaml
affected_product: CommonsBooking
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.6.8
preconditions: []
poc_classification: info-leak
---

## Vulnerability

**CVE ID:** CVE-2022-0658  
**Product:** CommonsBooking WordPress plugin  
**Affected versions:** < 2.6.8  
**Severity:** critical (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-89  
**Description:** The plugin does not sanitise and escape the location parameter of the calendar_data AJAX action (available to unauthenticated users) before it is used in dynamically constructed SQL queries, leading to an unauthenticated SQL injection.  
**Impact:** Unauthenticated attackers can execute SQL injection via unsanitized AJAX parameters to extract database contents, potentially exposing sensitive WordPress data including user credentials.  
**Remediation:** Fixed in version 2.6.8

## PoC / Detection

Classification: info-leak

The template performs a time-based blind SQL injection test by sending a crafted POST request to `/wp-admin/admin-ajax.php` containing a SLEEP(6) payload in the `location` parameter. Detection succeeds if the server response is delayed by at least 6 seconds, returns HTTP 200, has `application/json` content-type, and the JSON body contains expected calendar data fields such as "partiallyBookedDays" and "lockDays".

## References
- https://wpscan.com/vulnerability/d7f0805a-61ce-454a-96fb-5ecacd767578
- https://wordpress.org/plugins/commonsbooking/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0658
- https://github.com/cyllective/CVEs
