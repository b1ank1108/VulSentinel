---
cve_id: CVE-2022-38870
template_path: nuclei-templates/http/cves/2022/CVE-2022-38870.yaml
affected_product: Free5gc
severity: high
authentication: required
external_callback: false
affected_versions: 3.2.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2022-38870 is an information disclosure vulnerability in Free5gc version 3.2.1. The vulnerability is classified as CWE-306 (Missing Authentication for Critical Function), with a CVSS score of 7.5 (High severity). The flaw allows unauthorized access to sensitive subscriber information through an API endpoint that fails to properly validate authentication tokens. An attacker can obtain sensitive information including subscriber PLMN IDs and UE IDs, and potentially modify data or execute unauthorized operations. The vulnerability stems from improper authentication controls on the `/api/subscriber` endpoint, which accepts a static "admin" token without proper validation.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the `/api/subscriber` API endpoint with a static authentication token (`Token: admin`) in the request header. The detection verifies the vulnerability by checking for:

1. The presence of subscriber-related JSON fields (`"plmnID":` and `"ueId":`) in the response body, indicating that sensitive subscriber data is being returned
2. A `application/json` content-type header, confirming the API is responding with structured data
3. An HTTP 200 status code, indicating successful access to the endpoint

The template uses authentication (the Token header), suggesting the vulnerability lies in weak or bypassable authentication rather than complete absence of authentication controls. The successful retrieval of subscriber data confirms the information disclosure vulnerability.

## References

- https://github.com/free5gc/free5gc/issues/387
- https://nvd.nist.gov/vuln/detail/CVE-2022-38870
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Henry4E36/POCS
