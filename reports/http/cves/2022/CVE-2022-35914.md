---
cve_id: CVE-2022-35914
template_path: nuclei-templates/http/cves/2022/CVE-2022-35914.yaml
affected_product: GLPI
severity: critical
authentication: none
external_callback: false
affected_versions: <=10.0.2
preconditions: []
poc_classification: rce
---

## Vulnerability

GLPI through version 10.0.2 is susceptible to unauthenticated remote command execution in the htmlawed module at `/vendor/htmlawed/htmlawed/htmLawedTest.php`. The vulnerability arises from unsafe processing of the `hhook` and `text` parameters allowing injection and execution of arbitrary PHP functions such as `system` and `passthru`.

Successful exploitation enables arbitrary command execution on the underlying server, potentially leading to full system compromise. CVSS 3.1 score: 9.8 (Critical). CWE-74.

## PoC / Detection
Classification: rce

The template sends three POST requests to the htmLawedTest.php endpoint with varying payloads:
- Direct `hhook=exec`
- `hhook=array_map` combined with `system`
- `hhook=array_map` combined with `passthru`

Each executes `cat /etc/passwd` (URL-encoded). It matches for status 200 and regex `root:.*:0:0:` in the response body to confirm command output leakage indicating successful RCE.

## References
- https://mayfly277.github.io/posts/GLPI-htmlawed-CVE-2022-35914
- https://github.com/cosad3s/CVE-2022-35914-poc
- http://www.bioinformatics.org/phplabware/sourceer/sourceer.php?&Sfs=htmLawedTest.php&Sl=.%2Finternal_utilities%2FhtmLawed
- https://nvd.nist.gov/vuln/detail/CVE-2022-35914
- https://github.com/glpi-project/glpi/releases
- https://senderend.medium.com/pg-practice-box-deep-dive-glpi-c3a1cf1520f8
- https://github.com/allendemoura/CVE-2022-35914
