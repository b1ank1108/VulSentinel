---
cve_id: CVE-2022-46443
template_path: nuclei-templates/http/cves/2022/CVE-2022-46443.yaml
affected_product: Bangresto
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Bangresto 1.0 contains a SQL Injection vulnerability in the `itemqty[]` parameter of the order insertion functionality. The vulnerability exists in the `/bangresto-main/staff/insertorder.php` endpoint, where user-supplied input is not properly sanitized before being used in SQL queries. This allows authenticated attackers to inject arbitrary SQL commands into the database query.

The CVSS score of 8.8 (High) reflects the significant impact potential, with the vulnerability requiring low attack complexity and low privileges (authenticated staff access). Successful exploitation can lead to unauthorized access to sensitive data, data leakage, manipulation of database contents, and potential compromise of the entire application and underlying database infrastructure. The vulnerability is classified as CWE-89 (SQL Injection) and has a high EPSS score of 0.80383 (99.094th percentile), indicating active exploitation likelihood.

## PoC / Detection

Classification: info-leak

The Nuclei template performs a two-step detection process:

1. **Authentication**: First, it sends a POST request to `/bangresto-main/staff/process.php` with username and password credentials to establish an authenticated session.

2. **SQL Injection Probe**: After authentication, it sends a POST request to `/bangresto-main/staff/insertorder.php` with a crafted SQL injection payload in the `itemqty[]` parameter. The payload uses a time-based blind SQL injection technique with an MD5 hash calculation: `itemqty[]=2 AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x716a7a6b71,md5({{num}}),0x7178717a71,0x78))s), 8446744073709551610, 8446744073709551610)))`.

The template verifies the vulnerability by checking if the response contains the MD5 hash of the injected number (999999999), confirming that the SQL injection was successful and the database executed the attacker's query. This demonstrates the ability to extract data from the database through SQL injection, classifying it as an info-leak vulnerability.

## References

- https://yuyudhn.github.io/CVE-2022-46443/
- https://nvd.nist.gov/vuln/detail/CVE-2022-46443
- https://github.com/ARPSyndicate/cvemon
