---
cve_id: CVE-2022-31984
template_path: nuclei-templates/http/cves/2022/CVE-2022-31984.yaml
affected_product: Online Fire Reporting System
severity: high
authentication: required
external_callback: false
affected_versions: v1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Online Fire Reporting System v1.0 contains a SQL injection vulnerability in the `/ofrs/admin/requests/take_action.php` endpoint via the `id` parameter. This vulnerability is classified as CWE-89 (SQL Injection) and has a CVSS score of 7.2 (High severity). The CVSS metrics indicate the vulnerability requires high privileges (PR:H) to exploit, suggesting administrative access is needed.

Successful exploitation allows an attacker to inject arbitrary SQL commands into database queries, potentially leading to unauthorized access to sensitive data, data leakage, manipulation of database contents, or complete compromise of the database backend. The vulnerability affects the admin interface of the application, specifically the request management functionality.

## PoC / Detection

Classification: info-leak

The template detects this SQL injection vulnerability by sending a UNION-based SQL injection payload to the vulnerable endpoint. It crafts a GET request to `/admin/requests/take_action.php?id=6'+UNION+ALL+SELECT+md5('{{num}}'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--+-` where `{{num}}` is a randomly generated value (999999999).

The detection mechanism works by:
1. Injecting a UNION SELECT statement that returns the MD5 hash of a known value
2. Checking if the response body contains the expected MD5 hash
3. Verifying the server returns a 200 status code

If both conditions are met, the vulnerability is confirmed, demonstrating that the application executes the injected SQL query and returns the results, proving the SQL injection is exploitable for data extraction.

## References

- https://github.com/debug601/bug_report/blob/main/vendors/oretnom23/online-fire-reporting-system/SQLi-10.md
- https://www.sourcecodester.com/php/15346/online-fire-reporting-system-phpoop-free-source-code.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-31984
