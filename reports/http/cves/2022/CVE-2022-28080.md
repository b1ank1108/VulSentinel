---
cve_id: CVE-2022-28080
template_path: nuclei-templates/http/cves/2022/CVE-2022-28080.yaml
affected_product: Royal Event
severity: high
authentication: required
external_callback: false
affected_versions: 1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Royal Event (event management system, CPE `cpe:2.3:a:event_management_system_project:event_management_system:1.0:*:*:*:*:*:*:*`) contains an SQL injection (CWE-89) flaw. CVSS 3.1 score 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H). The issue lies in the `todate` parameter of `btndates_report.php`. Exploitation by an authenticated attacker yields unauthorized database access, full data exfiltration, and potential complete database compromise.

## PoC / Detection
Classification: info-leak

The template first issues a multipart POST to `/royal_event/` submitting `username`/`password` (login step) then immediately follows with a second multipart POST to `/royal_event/btndates_report.php` containing `todate=1' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(md5("{{randstr}}"),0x1,0x2),NULL-- -` (plus dummy `search`/`fromdate` fields). It verifies exploitation by matching the computed `md5("{{randstr}}")` string inside the HTTP 200 response body.

## References
- https://www.exploit-db.com/exploits/50934
- https://www.sourcecodester.com/sites/default/files/download/oretnom23/Royal%20Event.zip
- https://github.com/erengozaydin/Royal-Event-Management-System-todate-SQL-Injection-Authenticated
- https://nvd.nist.gov/vuln/detail/CVE-2022-28080
- https://www.sourcecodester.com/php/15238/event-management-system-project-php-source-code.html
