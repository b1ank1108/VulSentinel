---
cve_id: CVE-2022-1388
template_path: nuclei-templates/http/cves/2022/CVE-2022-1388.yaml
affected_product: F5 BIG-IP iControl
severity: critical
authentication: none
external_callback: false
affected_versions: F5 BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions
preconditions: []
poc_classification: rce
---

## Vulnerability

F5 BIG-IP iControl REST Auth Bypass RCE (CVE-2022-1388).

F5 BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions may allow undisclosed requests to bypass iControl REST authentication.

Successful exploitation allows an attacker to bypass authentication and execute arbitrary code on the affected system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score: 9.8)  
CWE-306: Missing Authentication for Critical Function

## PoC / Detection
Classification: rce

The template sends two raw POST requests to `/mgmt/tm/util/bash` (first to `{{Hostname}}`, fallback to `localhost`) using bypass headers `Connection: keep-alive, X-F5-Auth-Token`, `X-F5-Auth-Token: a`, and `Authorization: Basic YWRtaW46` (admin:). The JSON payload runs the command `echo CVE-2022-1388 | rev`. Detection matches on response body containing both `commandResult` and `8831-2202-EVC` (reversed output confirming execution). `stop-at-first-match: true`.

## References
- https://twitter.com/GossiTheDog/status/1523566937414193153
- https://www.horizon3.ai/f5-icontrol-rest-endpoint-authentication-bypass-technical-deep-dive/
- https://support.f5.com/csp/article/K23605346
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388
- https://www.secpod.com/blog/critical-f5-big-ip-remote-code-execution-vulnerability-patch-now/
