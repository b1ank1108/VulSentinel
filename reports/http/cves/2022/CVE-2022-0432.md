---
cve_id: CVE-2022-0432
template_path: nuclei-templates/http/cves/2022/CVE-2022-0432.yaml
affected_product: Mastodon
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 3.5.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Mastodon contains a Prototype Pollution vulnerability (CVE-2022-0432, CWE-1321) in versions prior to 3.5.0. The flaw is present in the mastodon/mastodon GitHub repository. Impact includes remote code execution. CVSS v3.1 score 6.1 (Medium) with vector AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N.

## PoC / Detection
Classification: rce

The template issues a GET request to `{{BaseURL}}/embed.js` and checks for HTTP 200 status along with the presence of the string "if (data.type !== 'setHeight' || !iframes[data.id]) {" in the response body. This acts as a fingerprint to detect vulnerable Mastodon instances.

## References
- https://github.com/mastodon/mastodon/commit/4d6d4b43c6186a13e67b92eaf70fe1b70ea24a09
- https://drive.google.com/file/d/1vpZ0CcmFhTEUasLTPUBf8o-4l7G6ojtG/view
- https://nvd.nist.gov/vuln/detail/CVE-2022-0432
- https://huntr.dev/bounties/d06da292-7716-4d74-a129-dd04773398d7
- https://github.com/ARPSyndicate/cvemon
