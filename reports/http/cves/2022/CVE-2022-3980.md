---
cve_id: CVE-2022-3980
template_path: nuclei-templates/http/cves/2022/CVE-2022-3980.yaml
affected_product: Sophos Mobile managed on-premises
severity: critical
authentication: none
external_callback: true
affected_versions: 5.0.0 to 9.7.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Sophos Mobile managed on-premises is affected by an XML External Entity (XXE) Injection vulnerability (CWE-611) in versions 5.0.0 to 9.7.4. The flaw resides in the processing of XML input by the OmaDsServlet, enabling unauthenticated remote attackers to perform SSRF and read arbitrary files on the server, with potential for code execution.

CVSS 3.1 score: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: info-leak

The template performs a single unauthenticated POST request to `/servlets/OmaDsServlet` containing a crafted XML payload with an external entity definition pointing to `http://{{interactsh-url}}`. Detection succeeds if an out-of-band interaction occurs and the server responds with HTTP 400 and empty body.

## References
- https://www.sophos.com/en-us/security-advisories/sophos-sa-20221116-smc-xee
- https://nvd.nist.gov/vuln/detail/CVE-2022-3980
- https://github.com/bigblackhat/oFx
