---
cve_id: CVE-2022-42094
template_path: nuclei-templates/http/cves/2022/CVE-2022-42094.yaml
affected_product: Backdrop CMS
severity: medium
authentication: required
external_callback: false
affected_versions: 1.23.0
preconditions: [User must have permissions to create 'Card' content type, 'full_html' text format must be available]
poc_classification: state-change
---

## Vulnerability

Backdrop CMS version 1.23.0 contains a stored cross-site scripting (XSS) vulnerability in the 'Card' content type. The vulnerability exists due to insufficient input sanitization when processing HTML content in the body field of Card nodes. When an authenticated user with content creation privileges submits a Card with malicious JavaScript code using the 'full_html' format, the payload is stored in the database and executed in the browsers of users who subsequently view the content.

Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of victims' browsers, potentially leading to session hijacking, credential theft, defacement, or other malicious actions. The CVSS score of 4.8 reflects that exploitation requires high privileges (PR:H) and user interaction (UI:R), with cross-site scope (S:C) enabling attacks beyond the vulnerable application's security context.

The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) and affects the specific version 1.23.0 of Backdrop CMS.

## PoC / Detection

Classification: state-change

The template performs an authenticated exploitation test by:

1. **Authentication**: Sends a GET request to retrieve the login form, then POSTs credentials to `/user/login` to establish an authenticated session
2. **Form Retrieval**: Accesses the Card content creation page at `/node/add/card` to extract CSRF tokens and form identifiers
3. **XSS Injection**: Submits a new Card node via POST to `/node/add/card` with:
   - A malicious XSS payload in the body field: `<img src=x onerror=alert(document.domain)>`
   - The `full_html` text format explicitly specified to bypass sanitization
   - All required form fields including title, status, and CSRF tokens
4. **Verification**: Confirms successful exploitation by checking for:
   - The reflected XSS payload in the response: `<img src="x" onerror="alert(document.domain)" />`
   - The presence of "Backdrop CMS" text indicating the page rendered successfully
   - HTTP 200 status code

The template creates actual stored XSS content in the target system, making it an intrusive test that modifies application state.

## References

- https://github.com/backdrop/backdrop/releases/tag/1.23.0
- https://github.com/bypazs/CVE-2022-42094
- https://nvd.nist.gov/vuln/detail/CVE-2022-42094
- https://backdropcms.org
- https://github.com/ARPSyndicate/cvemon
