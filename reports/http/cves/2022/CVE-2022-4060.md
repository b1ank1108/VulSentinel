---
cve_id: CVE-2022-4060
template_path: nuclei-templates/http/cves/2022/CVE-2022-4060.yaml
affected_product: WordPress User Post Gallery
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.19
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress User Post Gallery plugin through 2.19 is susceptible to remote code execution. The plugin does not limit which callback functions can be called by users, making it possible for an attacker to execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials.

**CVSS:** 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE:** CWE-94  
**Impact:** Successful exploitation could allow arbitrary code execution on the affected WordPress site.  
**Remediation:** Update to >=2.20.  
**Metadata:** verified, wordpress plugin (odude/user_post_gallery).

## PoC / Detection
Classification: rce

The template sends a single unauthenticated GET request to `{{BaseURL}}/wp-admin/admin-ajax.php?action=upg_datatable&field=field:exec:head+-1+/etc/passwd:NULL:NULL` that injects a command-execution payload into the vulnerable callback handler. Detection succeeds if the response meets all conditions: `application/json` content-type header, `recordsFiltered` string present in body, regex match `root:.*:0:0:` (proving command output leakage), and HTTP 200 status.

## References
- https://wpscan.com/vulnerability/8f982ebd-6fc5-452d-8280-42e027d01b1e
- https://wordpress.org/plugins/wp-upg/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4060
- https://github.com/im-hanzou/UPGer
- https://github.com/nomi-sec/PoC-in-GitHub
