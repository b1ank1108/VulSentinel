---
cve_id: CVE-2022-0873
template_path: nuclei-templates/http/cves/2022/CVE-2022-0873.yaml
affected_product: WordPress Gmedia Photo Gallery Plugin
severity: medium
authentication: required
external_callback: false
affected_versions: < 1.20.0
preconditions: Requires administrative privileges (high-privilege user like admin) to create albums
poc_classification: state-change
---

## Vulnerability
Gmedia Photo Gallery WordPress plugin < 1.20.0 fails to sanitise and escape album `name` before output in pages/posts containing media embeds. High-privilege users (admins) can inject arbitrary JS/HTML even when `unfiltered_html` capability is disallowed (CWE-79).  

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N (score 4.8).  
Successful exploitation enables session hijacking, defacement or client-side attacks against any user viewing the affected embed.

## PoC / Detection
Classification: state-change  

The template executes a multi-step authenticated workflow:  
1. POST to `/wp-login.php` with supplied `username`/`password` to establish admin session.  
2. GET `/wp-admin/admin.php?page=GrandMedia_Albums` to extract `_wpnonce_terms` via regex.  
3. POST to `/wp-admin/admin.php?page=GrandMedia_Albums` with `term[name]` set to random `'><script>alert(document.domain)</script>` payload (plus required album fields).  
4. Matches confirm state change: response body contains the exact unsanitised payload string in the “successfully saved” message, HTTP 200 and `text/html` content-type.

## References
- https://wpscan.com/vulnerability/d5ce4b8a-9aa5-4df8-b521-c2105990a87e
- https://wordpress.org/plugins/grand-media/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0873
