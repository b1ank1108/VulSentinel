---
cve_id: CVE-2022-1597
template_path: nuclei-templates/http/cves/2022/CVE-2022-1597.yaml
affected_product: WordPress WPQA plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <5.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress WPQA plugin prior to version 5.4 contains a reflected cross-site scripting (XSS) vulnerability (CWE-79) in its password reset form. The vulnerability exists because the plugin fails to properly sanitize and escape the `redirect_to` parameter when processing password reset requests through the `wpqa_ajax_password_process` AJAX action.

The CVSS v3.1 score is 6.1 (Medium severity) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, indicating network-based exploitation requiring no privileges but user interaction, with cross-site scope and low confidentiality/integrity impact.

Successful exploitation allows an attacker to inject arbitrary JavaScript code that executes in the context of a victim's browser session when they interact with a malicious password reset link. This can lead to session hijacking, credential theft, or unauthorized actions performed on behalf of the victim.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Account Creation**: First, it creates a test user account by sending a POST request to `/wp-admin/admin-ajax.php` with the `wpqa_ajax_signup_process` action, registering a randomly generated username and email address.

2. **XSS Payload Injection**: Second, it initiates a password reset request for the newly created account via the `wpqa_ajax_password_process` action, injecting an XSS payload (`"><img src=x onerror=alert(document.domain)>`) into the `redirect_to` parameter.

The template confirms the vulnerability by checking for:
- The reflected XSS payload in the response body
- A success indicator (`"success":1`) in the JSON response
- A `text/html` content type header
- HTTP 200 status code

The detection verifies that the unsanitized `redirect_to` parameter is reflected in the response, confirming the presence of the XSS vulnerability.

## References

- https://wpscan.com/vulnerability/faff9484-9fc7-4300-bdad-9cd8a30a9a4e
- https://nvd.nist.gov/vuln/detail/CVE-2022-1597
- https://github.com/trhacknon/Pocingit
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
