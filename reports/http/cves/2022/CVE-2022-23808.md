---
cve_id: CVE-2022-23808
template_path: nuclei-templates/http/cves/2022/CVE-2022-23808.yaml
affected_product: phpMyAdmin
severity: medium
authentication: none
external_callback: false
affected_versions: phpMyAdmin 5.1 before 5.1.2
preconditions: phpMyAdmin setup interface accessible
poc_classification: info-leak
---

## Vulnerability
Reflected cross-site scripting (XSS) in the phpMyAdmin setup script (CWE-79). An attacker can inject malicious JavaScript/HTML via the `id` parameter on `/setup/index.php?page=servers&mode=test`, breaking out of context to execute arbitrary scripts in the victim's browser (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, score 6.1). Impact includes session hijacking, credential theft, or phishing in the context of the phpMyAdmin domain. Fixed by upgrading to 5.1.2 or later.

## PoC / Detection
Classification: info-leak

The template sends two GET requests (stop-at-first-match) to `{{BaseURL}}/phpmyadmin/setup/index.php` and `{{BaseURL}}/setup/index.php` with reflected XSS payload in the `id` parameter (`%22%3e%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E` and variant). It matches on unescaped payload reflection in body (`"></script><script>alert(document.domain)</script>`), setup page markers (`<h2>Add a new server</h2>`, `<title>phpMyAdmin setup`), `text/html` Content-Type header, and HTTP 200 status.

## References
- https://mp.weixin.qq.com/s/c2kwxwVUn1ym7oqv9Uio_A
- https://github.com/dipakpanchal456/CVE-2022-23808
- https://nvd.nist.gov/vuln/detail/CVE-2022-23808
- https://www.phpmyadmin.net/security/PMASA-2022-2/
- https://infosecwriteups.com/exploit-cve-2022-23808-85041c6e5b97
