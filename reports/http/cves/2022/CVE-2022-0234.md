---
cve_id: CVE-2022-0234
template_path: nuclei-templates/http/cves/2022/CVE-2022-0234.yaml
affected_product: WordPress WOOCS plugin
severity: medium
authentication: none
external_callback: false
affected_versions: < 1.3.7.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
WordPress WOOCS plugin before 1.3.7.5 is susceptible to reflected cross-site scripting. The plugin does not sanitize and escape the `woocs_in_order_currency` parameter of the `woocs_get_products_price_html` AJAX action, available to both unauthenticated and authenticated users, before outputting it back in the response. An attacker can inject arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1) â€¢ CWE-79

## PoC / Detection
Classification: info-leak

The template sends a single raw GET request to `/wp-admin/admin-ajax.php?action=woocs_get_products_price_html&woocs_in_order_currency=<img%20src%20onerror=alert(document.domain)>` and verifies the vulnerability if the unsanitized payload appears in the response body alongside `"current_currency":`, the status is 200, and the Content-Type header contains `text/html`.

## References
- https://wpscan.com/vulnerability/fd568a1f-bd51-41bb-960d-f8573b84527b
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0234
- https://plugins.trac.wordpress.org/changeset/2659191
- https://nvd.nist.gov/vuln/detail/CVE-2022-0234
- https://github.com/ARPSyndicate/kenzer-templates
