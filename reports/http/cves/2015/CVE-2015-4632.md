---
cve_id: CVE-2015-4632
template_path: nuclei-templates/http/cves/2015/CVE-2015-4632.yaml
affected_product: Koha
severity: high
authentication: none
external_callback: false
affected_versions: Koha 3.14.x before 3.14.16, 3.16.x before 3.16.12, 3.18.x before 3.18.08, and 3.20.x before 3.20.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Koha 3.14.x before 3.14.16, 3.16.x before 3.16.12, 3.18.x before 3.18.08, and 3.20.x before 3.20.1 allow remote attackers to read arbitrary files via a ..%2f (dot dot encoded slash) in the template_path parameter to svc/virtualshelves/search or svc/members/search endpoints (CWE-22). CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5). Impact includes unauthorized access to sensitive files (e.g. /etc/passwd), data leakage, or further system compromise.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/cgi-bin/koha/svc/virtualshelves/search?template_path=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd` and confirms successful traversal by matching HTTP status 200 together with the regex `root:.*:0:0:` in the response body (verifying /etc/passwd contents are returned).

## References
- https://www.exploit-db.com/exploits/37388
- https://nvd.nist.gov/vuln/detail/CVE-2015-4632
- https://www.sba-research.org/2015/06/24/researchers-of-sba-research-found-several-critical-security-vulnerabilities-in-the-koha-library-software-via-combinatorial-testing/
- https://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14408
- https://koha-community.org/koha-3-14-16-released/
