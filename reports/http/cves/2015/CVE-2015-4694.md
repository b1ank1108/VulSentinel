---
cve_id: CVE-2015-4694
template_path: nuclei-templates/http/cves/2015/CVE-2015-4694.yaml
affected_product: WordPress Zip Attachments plugin
severity: high
authentication: none
external_callback: false
affected_versions: <= 1.1.4
preconditions: Zip Attachments plugin installed on WordPress
poc_classification: info-leak
---

## Vulnerability
WordPress Zip Attachments plugin <= 1.1.4 does not sanitize or check the download path supplied via the `za_file` parameter in `download.php`. This results in an arbitrary file retrieval vulnerability (path traversal / LFI) exploitable by unauthenticated remote attackers to read any readable file on the server filesystem.  
Impact: arbitrary file retrieval.  
CWE-22, CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N (score 8.6).

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/wp-content/plugins/zip-attachments/download.php?za_file=../../../../../etc/passwd&za_filename=passwd`, then matches on HTTP 200 status code combined with regex `root:[x*]:0:0` to confirm successful retrieval of `/etc/passwd` content.

## References
- https://wordpress.org/plugins/zip-attachments/#developers
- https://wpscan.com/vulnerability/8047
- https://nvd.nist.gov/vuln/detail/CVE-2015-4694
- http://www.vapid.dhs.org/advisory.php?v=126
- https://wordpress.org/plugins/zip-attachments/changelog/
