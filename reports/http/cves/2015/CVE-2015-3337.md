---
cve_id: CVE-2015-3337
template_path: nuclei-templates/http/cves/2015/CVE-2015-3337.yaml
affected_product: Elasticsearch
severity: medium
authentication: none
external_callback: false
affected_versions: before 1.4.5 and 1.5.x before 1.5.2
preconditions: site plugin enabled
poc_classification: info-leak
---

## Vulnerability
Elasticsearch before 1.4.5 and 1.5.x before 1.5.2 allows remote attackers to read arbitrary files via unspecified vectors when a site plugin is enabled. An attacker can exploit this to read sensitive files on the server.

## PoC / Detection
Classification: info-leak
The template issues a single unauthenticated GET request to `{{BaseURL}}/_plugin/head/../../../../../../../../../../../../../../../../etc/passwd` and confirms successful LFI by checking for HTTP 200 status together with the regex `root:.*:0:0:` in the response body.

## References
- https://www.exploit-db.com/exploits/37054/
- https://www.elastic.co/community/security
- http://www.debian.org/security/2015/dsa-3241
- https://nvd.nist.gov/vuln/detail/CVE-2015-3337
- http://packetstormsecurity.com/files/131646/Elasticsearch-Directory-Traversal.html
