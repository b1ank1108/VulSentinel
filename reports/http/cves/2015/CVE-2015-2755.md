---
cve_id: CVE-2015-2755
template_path: nuclei-templates/http/cves/2015/CVE-2015-2755.yaml
affected_product: WordPress AB Google Map Travel plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <=3.4
preconditions: [plugin installed and activated on WordPress]
poc_classification: state-change
---

## Vulnerability
WordPress AB Google Map Travel plugin through 3.4 contains multiple stored cross-site scripting vulnerabilities. The plugin allows an attacker to hijack the administrator authentication for requests via the (1) lat (Latitude), (2) long (Longitude), (3) map_width, (4) map_height, or (5) zoom (Map Zoom) parameters in the ab_map_options page to wp-admin/admin.php.

Successful exploitation of this vulnerability allows an attacker to inject malicious scripts into the website, potentially leading to unauthorized access, data theft, or defacement.

Update to the latest version of the AB Google Map Travel plugin (>=3.5) or apply the vendor-supplied patch.

CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P (score 6.8); CWE-352; CVE-2015-2755.

## PoC / Detection
Classification: state-change

The template first performs a POST login to `/wp-login.php` using supplied `{{username}}`/`{{password}}` credentials, then issues a second POST to `/wp-admin/admin.php?page=ab_map_options` containing a crafted `lat` parameter with the unsanitized payload `"><script>+-+-1-+-+alert(document.domain)</script>`. Detection succeeds if the second response returns HTTP 200, `text/html` content-type, contains the exact injected script tag in the body (proving lack of output sanitization on stored map settings), and references the plugin identifier.

## References
- https://packetstormsecurity.com/files/131155/
- http://packetstormsecurity.com/files/131155/WordPress-Google-Map-Travel-3.4-XSS-CSRF.html
- http://packetstormsecurity.com/files/130960/WordPress-AB-Google-Map-Travel-CSRF-XSS.html
- https://nvd.nist.gov/vuln/detail/https://nvd.nist.gov/vuln/detail/CVE-2015-2755
- https://wordpress.org/plugins/ab-google-map-travel/changelog/
