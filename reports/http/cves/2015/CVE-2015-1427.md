---
cve_id: CVE-2015-1427
template_path: nuclei-templates/http/cves/2015/CVE-2015-1427.yaml
affected_product: ElasticSearch
severity: high
authentication: none
external_callback: false
affected_versions: before 1.3.8 and 1.4.x before 1.4.3
preconditions: []
poc_classification: rce
---

## Vulnerability
ElasticSearch before 1.3.8 and 1.4.x before 1.4.3 allows remote attackers to bypass the sandbox protection mechanism and execute arbitrary shell commands via a crafted script to the Groovy scripting engine. Successful exploitation could allow an attacker to execute arbitrary code on the affected system. CVSS: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P).

## PoC / Detection
Classification: rce

The template first issues a POST to `/website/blog/` creating a document `{"name": "test"}`. It then issues a POST to `/_search` embedding a Groovy `script_fields` payload that calls `java.lang.Runtime.getRuntime().exec("cat /etc/passwd").getText()`. Detection confirms success if the response has `application/json` header, HTTP 200, and regex match `root:.*:0:0:` in the body.

## References
- https://blog.csdn.net/JiangBuLiu/article/details/94457980
- http://www.elasticsearch.com/blog/elasticsearch-1-4-3-1-3-8-released/
- https://nvd.nist.gov/vuln/detail/CVE-2015-1427
- http://packetstormsecurity.com/files/130368/Elasticsearch-1.3.7-1.4.2-Sandbox-Escape-Command-Execution.html
- https://access.redhat.com/errata/RHSA-2017:0868
