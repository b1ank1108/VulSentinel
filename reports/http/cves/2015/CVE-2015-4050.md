---
cve_id: CVE-2015-4050
template_path: nuclei-templates/http/cves/2015/CVE-2015-4050.yaml
affected_product: Symfony
severity: medium
authentication: none
external_callback: false
affected_versions: 2.3.19 through 2.3.28, 2.4.9 through 2.4.10, 2.5.4 through 2.5.11, and 2.6.0 through 2.6.7
preconditions: ESI or SSI support enabled
poc_classification: auth-bypass
---

## Vulnerability
Symfony 2.3.19 through 2.3.28, 2.4.9 through 2.4.10, 2.5.4 through 2.5.11, and 2.6.0 through 2.6.7 (when ESI or SSI support enabled) does not check if the _controller attribute is set in the HttpKernel component. This allows remote attackers to bypass URL signing and security rules by including (1) no hash or (2) an invalid hash in a request to /_fragment.

**Impact:** Successful exploitation could allow an attacker to bypass authentication and gain unauthorized access.  
**Remediation:** Apply the latest security patches or upgrade to a non-vulnerable version of Symfony.  
**CVSS:** 4.3 (CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N) | CWE-284

## PoC / Detection
Classification: auth-bypass

The template sends a single unauthenticated GET request to `{{BaseURL}}/_fragment?_path=_controller=phpcredits&flag=-1` and checks for the string "PHP Credits" in the response body together with HTTP status 200.

## References
- https://symfony.com/blog/cve-2015-4050-esi-unauthorized-access
- http://symfony.com/blog/cve-2015-4050-esi-unauthorized-access
- http://www.debian.org/security/2015/dsa-3276
- https://nvd.nist.gov/vuln/detail/CVE-2015-4050
- http://lists.fedoraproject.org/pipermail/package-announce/2015-June/159513.html
