---
cve_id: CVE-2015-9415
template_path: nuclei-templates/http/cves/2015/CVE-2015-9415.yaml
affected_product: BJ Lazy Load (Timthumb)
severity: high
authentication: none
external_callback: true
affected_versions: <= 0.7.5
preconditions: []
poc_classification: rce
---

## Vulnerability
BJ Lazy Load (Timthumb) WordPress plugin <= 0.7.5 contains a remote file inclusion flaw in `thumb.php` via the `src` parameter. Attackers can include and execute arbitrary remote malicious files. Impact includes potential remote code execution and complete site compromise. Fixed in 1.0. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N (score 7.5). CWE-20.

## PoC / Detection
Classification: rce

The template verifies the underlying RFI condition with two raw GET probes to `/wp-content/plugins/bj-lazy-load/thumb.php` (flow `http(1) || http(2)`):

- ALLOW_ALL_EXTERNAL_SITES path: `?src=http://{{interactsh-url}}/{{rand_base(16)}}.jpg` → matches status_code==400, contains(body, "TimThumb Error"), contains(interactsh_protocol, "http").
- Default path: `?src=http://img.youtube.com/{{rand_base(16)}}.jpg` → matches status_code==200, contains(body, "gd-jpeg"), contains(content_type, "image/jpeg").

## References
- https://wpscan.com/vulnerability/c15aef94-822d-40eb-80a6-e4a0611cb5c1/
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/bj-lazy-load/bj-lazy-load-10-remote-file-inclusion-via-timthumb
- https://nvd.nist.gov/vuln/detail/CVE-2015-9415
