---
cve_id: CVE-2015-4063
template_path: nuclei-templates/http/cves/2015/CVE-2015-4063.yaml
affected_product: NewStatPress
severity: low
authentication: required
external_callback: false
affected_versions: <0.9.9
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2015-4063 is a cross-site scripting (XSS) vulnerability in the WordPress NewStatPress plugin versions prior to 0.9.9. The vulnerability exists in the `includes/nsp_search.php` file, where the `where1` parameter in the `nsp_search` page is not properly sanitized. Remote authenticated users can inject arbitrary web script or HTML via this parameter when accessing `/wp-admin/admin.php`. Successful exploitation could allow an attacker to inject malicious scripts into web pages viewed by users, potentially leading to data theft, session hijacking, or website defacement. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS 2.0 score of 3.5 (AV:N/AC:M/Au:S/C:N/I:P/A:N).

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Authentication**: Sends a POST request to `/wp-login.php` with WordPress credentials to establish an authenticated session
2. **XSS Probe**: Sends a GET request to `/wp-admin/admin.php` with the vulnerable `nsp_search` page, injecting a test XSS payload `<script>alert(document.domain)</script>` in the `where1` parameter

The template confirms the vulnerability by checking:
- HTTP 200 status code on the second request
- Presence of the injected script tag reflected in the response body
- Presence of the string "newstatpress" in the response to confirm the correct plugin context

Both conditions must be satisfied to confirm the XSS vulnerability exists and is exploitable.

## References

- https://packetstormsecurity.com/files/132038/
- https://wordpress.org/plugins/newstatpress/
- http://packetstormsecurity.com/files/132038/WordPress-NewStatPress-0.9.8-Cross-Site-Scripting-SQL-Injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2015-4063
- https://wordpress.org/plugins/newstatpress/changelog/
