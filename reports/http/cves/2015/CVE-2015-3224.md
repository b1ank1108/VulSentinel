---
cve_id: CVE-2015-3224
template_path: nuclei-templates/http/cves/2015/CVE-2015-3224.yaml
affected_product: Ruby on Rails Web Console
severity: medium
authentication: none
external_callback: false
affected_versions: Ruby on Rails Web Console before 2.1.3, as used with Ruby on Rails 3.x and 4.x
preconditions: [Web Console feature enabled]
poc_classification: rce
---

## Vulnerability
Ruby on Rails Web Console before 2.1.3 (as used with Ruby on Rails 3.x and 4.x) does not properly restrict X-Forwarded-For headers when determining client IP address. Remote attackers can bypass the whitelisted_ips protection via crafted requests, resulting in unauthorized access to the web console.

Impact: Remote code execution leading to unauthorized access, data breaches, and complete system compromise.  
Remediation: Upgrade to patched version or disable the Web Console feature.  
CVSS: 4.3 (CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N)  
CWE: CWE-284 (Improper Access Control)  
CPE: cpe:2.3:a:rubyonrails:web_console:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: rce

The template issues a single GET request to `{{BaseURL}}/{{randstr}}` (random non-existent path) with the header `X-Forwarded-For: "::1"` to spoof a localhost IP. It matches on the resulting response containing both "Rails.root:" and "Action Controller: Exception caught" in the body, plus (case-insensitive) presence of any web-console indicators (`X-Web-Console-Session-Id`, `data-remote-path=`, `data-session-id=`) to confirm the whitelist bypass succeeded and the RCE-capable console is exposed.

## References
- https://www.metahackers.pro/rails-web-console-v2-whitelist-bypass-code-exec/
- https://www.jomar.fr/posts/2022/basic_recon_to_rce_ii/
- https://hackerone.com/reports/44513
- https://nvd.nist.gov/vuln/detail/CVE-2015-3224
- http://lists.fedoraproject.org/pipermail/package-announce/2015-June/160881.html
