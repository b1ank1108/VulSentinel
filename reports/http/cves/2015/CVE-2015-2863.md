---
cve_id: CVE-2015-2863
template_path: nuclei-templates/http/cves/2015/CVE-2015-2863.yaml
affected_product: Kaseya Virtual System Administrator
severity: medium
authentication: none
external_callback: false
affected_versions: 7.x before 7.0.0.29, 8.x before 8.0.0.18, 9.0 before 9.0.0.14, and 9.1 before 9.1.0.4
preconditions: []
poc_classification: detect-only
---

## Vulnerability
Kaseya Virtual System Administrator 7.x before 7.0.0.29, 8.x before 8.0.0.18, 9.0 before 9.0.0.14, and 9.1 before 9.1.0.4 is susceptible to an open redirect vulnerability (CVE-2015-2863, CWE-601). An attacker can redirect users to arbitrary web sites and conduct phishing attacks via the `supportLoad.asp` and `LocalProxy.ashx` endpoints (user-controlled `urlToLoad`/`url` parameters).

CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N (score 4.3).  
Impact: facilitates phishing attacks and potential credential theft.  
Remediation: update to 7.0.0.29, 8.0.0.18, 9.0.0.14 or 9.1.0.4 (or later).

## PoC / Detection
Classification: detect-only

The template issues two GET requests (stopping at first match):  
`{{BaseURL}}/inc/supportLoad.asp?urlToLoad=http://oast.me`  
`{{BaseURL}}/vsaPres/Web20/core/LocalProxy.ashx?url=http://oast.me`  

It matches on the `Location` response header with regex `(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$` to confirm the server echoes the attacker-controlled URL in a redirect.

## References
- https://github.com/pedrib/PoC/blob/3f927b957b86a91ce65b017c4b9c93d05e241592/advisories/Kaseya/kaseya-vsa-vuln.txt
- http://www.kb.cert.org/vuls/id/919604
- https://nvd.nist.gov/vuln/detail/CVE-2015-2863
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/ARPSyndicate/cvemon
