---
cve_id: CVE-2015-9312
template_path: nuclei-templates/http/cves/2015/CVE-2015-9312.yaml
affected_product: WordPress NewStatPress plugin
severity: medium
authentication: required
external_callback: false
affected_versions: <=1.0.4
preconditions: [NewStatPress plugin installed and activated on a WordPress site]
poc_classification: info-leak
---

## Vulnerability
WordPress NewStatPress plugin through 1.0.4 contains a reflected cross-site scripting vulnerability. The plugin utilizes, on lines 28 and 31 of `includes/nsp_search.php`, several `$_GET` variables without sanitization. WordPress escapes quotes on this scope, but the outputs occur outside of quotes and can be used to initiate an XSS attack.  
**CVE:** CVE-2015-9312  
**CWE:** CWE-79  
**CVSS 3.0:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**Impact:** Successful exploitation allows arbitrary script execution in the context of the affected website, leading to session hijacking, defacement, or theft of sensitive information.  
**Remediation:** Fixed in version 1.0.6.

## PoC / Detection
Classification: info-leak

The template first issues a POST to `/wp-login.php` with supplied `{{username}}`/`{{password}}` credentials to authenticate as a WordPress administrator. It then sends a GET request to `/wp-admin/admin.php?groupby1=checked%3E%3Cimg+src%3Dx+onerror%3Dalert%28document.domain%29&page=nsp_search&newstatpress_action=search` that injects a reflected XSS payload into the vulnerable `groupby1` parameter. Detection succeeds if the response returns HTTP 200, contains the unsanitized payload string `<img src=x onerror=alert(document.domain)`, and includes the string `newstatpress`.

## References
- https://wpscan.com/vulnerability/46bf6c69-b612-4aee-965d-91f53f642054
- https://g0blin.co.uk/g0blin-00057/
- https://wordpress.org/plugins/newstatpress/#developers
- https://nvd.nist.gov/vuln/detail/CVE-2015-9312
- https://github.com/ARPSyndicate/cvemon
