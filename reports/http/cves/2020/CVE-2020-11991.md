---
cve_id: CVE-2020-11991
template_path: nuclei-templates/http/cves/2020/CVE-2020-11991.yaml
affected_product: Apache Cocoon
severity: high
authentication: none
external_callback: false
affected_versions: 2.1.12
preconditions: using the StreamGenerator
poc_classification: info-leak
---

## Vulnerability
Apache Cocoon 2.1.12 is susceptible to XML injection. When using the StreamGenerator, the code parses a user-provided XML. A specially crafted XML, including external system entities, can be used to access any file on the server system.

Impact: Successful exploitation can lead to unauthorized access, data leakage, and remote code execution.  
Remediation: Upgrade to Apache Cocoon 2.1.13 or later.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (score 7.5).  
CWE-611.

## PoC / Detection
Classification: info-leak

The template issues a single POST request to `{{BaseURL}}/v2/api/product/manger/getInfo` with `Content-Type: text/xml` and body containing `<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>` plus `&ent;` reference inside `<lastName>`. It verifies success with an `and` matcher on HTTP 200 status and regex `root:.*:0:0:` in the response body.

## References
- https://lists.apache.org/thread/6xg5j4knfczwdhggo3t95owqzol37k1b
- https://nvd.nist.gov/vuln/detail/CVE-2020-11991
- https://lists.apache.org/thread.html/r77add973ea521185e1a90aca00ba9dae7caa8d8b944d92421702bb54%40%3Cusers.cocoon.apache.org%3E
- https://github.com/ARPSyndicate/cvemon
- https://github.com/H4ckTh3W0r1d/Goby_POC
