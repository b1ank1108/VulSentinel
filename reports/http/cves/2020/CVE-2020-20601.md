---
cve_id: CVE-2020-20601
template_path: nuclei-templates/http/cves/2020/CVE-2020-20601.yaml
affected_product: ThinkCMF
severity: critical
authentication: none
external_callback: false
affected_versions: X2.2.2 and below
preconditions: []
poc_classification: rce
---

## Vulnerability
ThinkCMF X2.2.2 and below contain a remote code execution vulnerability (CVE-2020-20601, CWE-94) caused by processing crafted packets, allowing attackers to execute arbitrary code remotely. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Unauthenticated attackers can execute arbitrary PHP code on ThinkCMF servers, leading to complete server compromise and access to all website data. Remediation: Upgrade to ThinkCMF version X2.2.3 or later.

## PoC / Detection
Classification: rce

The template issues a single GET request to `{{BaseURL}}/index.php?g=g&m=Door&a=index&content=<?php%20echo%20md5('ThinkCMF');` and verifies exploitation by checking for HTTP status 200 combined with the exact string `d9b2c63a497e2f30c4ad9ad083a00691` in the response body, confirming the injected PHP code executed and returned the expected MD5 hash.

## References
- https://www.shuzhiduo.com/A/l1dygr36Je/
- https://blog.riskivy.com/thinkcmf-%e6%a1%86%e6%9e%b6%e4%b8%8a%e7%9a%84%e4%bb%bb%e6%84%8f%e5%86%85%e5%ae%b9%e5%8c%85%e5%90%ab%e6%bc%8f%e6%b4%9e/
