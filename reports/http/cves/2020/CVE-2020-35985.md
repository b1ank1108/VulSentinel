---
cve_id: CVE-2020-35985
template_path: nuclei-templates/http/cves/2020/CVE-2020-35985.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 2.7.2
preconditions: []
poc_classification: state-change
---

## Vulnerability
Stored cross-site scripting (XSS) in the Global Lists feature. Authenticated attackers can inject arbitrary web scripts or HTML via the `name` parameter when saving a list.  
Impact: script execution in victims’ browsers enabling data theft, session hijacking or page defacement.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4).  
CWE-79. Fixed by upgrading beyond 2.7.2.

## PoC / Detection
Classification: state-change  
The template first GETs `/index.php?module=users/login` to extract the `form_session_token` nonce, POSTs credentials to `/index.php?module=users/login&action=login`, then POSTs to `/index.php?module=global_lists/lists&action=save` with the payload `name=<script>alert(document.domain)</script>`. Detection succeeds when the third response returns HTTP 200, text/html content-type, contains the unsanitized `<script>alert(document.domain)</script>` string and the word “rukovoditel”, confirming the injected payload is persisted in application data.

## References
- https://github.com/r0ck3t1973/rukovoditel/issues/3
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2020-35985
