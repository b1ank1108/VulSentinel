---
cve_id: CVE-2020-24391
template_path: nuclei-templates/http/cves/2020/CVE-2020-24391.yaml
affected_product: Mongo-Express
severity: critical
authentication: none
external_callback: false
affected_versions: before 1.0.0
preconditions: []
poc_classification: rce
---

## Vulnerability
Mongo-Express before 1.0.0 is susceptible to remote code execution because it uses safer-eval to validate user supplied javascript. Unfortunately safer-eval sandboxing capabilities are easily bypassed leading to remote code execution in the context of the node server.

Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (Score: 9.8). CPE: cpe:2.3:a:mongo-express_project:mongo-express:*:*:*:*:*:node.js:*:*

## PoC / Detection
Classification: rce

The template detects the RCE by performing a multi-step attack simulation:
- Sends an initial GET request to `/`.
- Posts a specially crafted payload to `/checkValid` that bypasses safer-eval to execute `id > build/css/{{randstr}}.css` via `child_process.execSync`.
- Retrieves the generated file at `/public/css/{{randstr}}.css` and matches for Unix `id` command output (uid/gid patterns) to confirm successful command execution.

This verifies the vulnerability by observing the side effects of executed system commands.

## References
- https://securitylab.github.com/advisories/GHSL-2020-131-mongo-express/
- https://github.com/mongo-express/mongo-express/commit/3a26b079e7821e0e209c3ee0cc2ae15ad467b91a
- https://nvd.nist.gov/vuln/detail/CVE-2020-24391
- https://github.com/mongodb-js/query-parser/issues/16
- https://github.com/ARPSyndicate/kenzer-templates
