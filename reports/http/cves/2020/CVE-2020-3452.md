---
cve_id: CVE-2020-3452
template_path: nuclei-templates/http/cves/2020/CVE-2020-3452.yaml
affected_product: Cisco Adaptive Security Appliance (ASA) / Firepower Threat Defense (FTD)
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [WebVPN or AnyConnect features must be configured and enabled on the device]
poc_classification: info-leak
---

## Vulnerability

CVE-2020-3452 is a local file inclusion vulnerability in Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software. The vulnerability stems from improper input validation of URLs in HTTP requests processed by affected devices, allowing directory traversal attacks. An unauthenticated attacker can send crafted HTTP requests containing directory traversal character sequences to read arbitrary files within the web services file system on the targeted device.

The vulnerability is exploitable when the affected device is configured with either WebVPN or AnyConnect features, which enable the web services file system. While the vulnerability allows access to files within the web services file system, it cannot be used to obtain access to ASA or FTD system files or underlying operating system (OS) files. The CVSS score of 7.5 (High) reflects the confidentiality impact, with the attack vector being network-based, requiring no authentication, and having low attack complexity.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending two different HTTP GET requests that exploit directory traversal sequences to access sensitive configuration files:

1. The first request targets `/+CSCOT+/translation-table` with parameters that traverse directories using `../` sequences to access `/+CSCOE+/portal_inc.lua`
2. The second request targets `/+CSCOT+/oem-customization` with similar directory traversal techniques using `..` in the platform and resource-type parameters to access the same file

The template confirms successful exploitation by checking for the presence of two specific strings in the response: "INTERNAL_PASSWORD_ENABLED" and "CONF_VIRTUAL_KEYBOARD". These strings indicate that the `portal_inc.lua` configuration file has been successfully read, demonstrating the local file inclusion vulnerability.

## References

- https://twitter.com/aboul3la/status/1286012324722155525
- http://packetstormsecurity.com/files/158646/Cisco-ASA-FTD-Remote-File-Disclosure.html
- http://packetstormsecurity.com/files/158647/Cisco-Adaptive-Security-Appliance-Software-9.11-Local-File-Inclusion.html
- http://packetstormsecurity.com/files/159523/Cisco-ASA-FTD-9.6.4.42-Path-Traversal.html
- http://packetstormsecurity.com/files/160497/Cisco-ASA-9.14.1.10-FTD-6.6.0.1-Path-Traversal.html
- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86
- https://nvd.nist.gov/vuln/detail/CVE-2020-3452
