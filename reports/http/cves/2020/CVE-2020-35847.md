---
cve_id: CVE-2020-35847
template_path: nuclei-templates/http/cves/2020/CVE-2020-35847.yaml
affected_product: Agentejo Cockpit
severity: critical
authentication: none
external_callback: false
affected_versions: <0.11.2
preconditions: []
poc_classification: rce
---

## Vulnerability
Agentejo Cockpit before 0.11.2 allows NoSQL injection via the resetpassword function of Controller/Auth.php in the Auth controller. Unauthenticated attackers can submit crafted JSON to the /auth/requestreset endpoint to execute arbitrary NoSQL queries (including the $func operator).

Impact includes unauthorized access, data manipulation, or denial of service. The flaw enables arbitrary PHP function execution.

CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-89.

## PoC / Detection
Classification: rce

The template issues two raw unauthenticated POST requests to /auth/requestreset:
- First: `{"user":{"$func":"var_dump"}}` — positive regex matcher on body_1 for `string\([0-9]{1,3}\)(\s)?"([A-Za-z0-9-.@\s-]+)"` (excluding "error404" strings).
- Second: `{"user":{"$func":"nonexistent_function"}}` — negative regex matcher on body_2 confirming absence of dump output.

This verifies the injection point permits server-side function calls.

## References
- https://swarm.ptsecurity.com/rce-cockpit-cms/
- https://nvd.nist.gov/vuln/detail/CVE-2020-35847
- https://getcockpit.com/
- https://github.com/agentejo/cockpit/commit/2a385af8d80ed60d40d386ed813c1039db00c466
- https://github.com/agentejo/cockpit/commit/33e7199575631ba1f74cba6b16b10c820bec59af
