---
cve_id: CVE-2020-8644
template_path: nuclei-templates/http/cves/2020/CVE-2020-8644.yaml
affected_product: playSMS
severity: critical
authentication: none
external_callback: false
affected_versions: <1.4.3
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-8644 is a critical pre-authentication remote code execution vulnerability in playSMS versions prior to 1.4.3. The vulnerability stems from double processing of server-side templates, allowing attackers to inject and execute arbitrary code without authentication. The flaw is classified as CWE-94 (Improper Control of Generation of Code - Code Injection) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no privileges or user interaction required. The vulnerability has an EPSS score of 0.94 (99.888th percentile), indicating extremely high likelihood of exploitation in the wild. It is listed in the Known Exploited Vulnerabilities (KEV) catalog.

The vulnerability exploits a server-side template injection (SSTI) flaw in the authentication mechanism, specifically in the login route. By injecting template expressions into the username parameter during login attempts, attackers can achieve arbitrary code execution on the target system without valid credentials.

## PoC / Detection

Classification: rce

The template performs a two-step detection process to verify the remote code execution vulnerability:

1. **Initial Request**: Sends a GET request to `/index.php?app=main&inc=core_auth&route=login` to retrieve the login page and extract the CSRF token using XPath from the form input field.

2. **Exploitation Request**: Submits a POST request to the login endpoint with:
   - The extracted CSRF token
   - A malicious username parameter containing URL-encoded template injection payload: `{{`echo 'CVE-2020-8644' | rev`}}` (which reverses the string "CVE-2020-8644")
   - An empty password field

The template confirms successful exploitation by checking for the reversed string "4468-0202-EVC" in the response body with HTTP status 200. The presence of this reversed string demonstrates that the server executed the injected command, proving arbitrary code execution capability.

## References

- https://research.nccgroup.com/2020/02/11/technical-advisory-playsms-pre-authentication-remote-code-execution-cve-2020-8644/
- https://playsms.org/2020/02/05/playsms-1-4-3-has-been-released/
- https://nvd.nist.gov/vuln/detail/CVE-2020-8644
- http://packetstormsecurity.com/files/157106/PlaySMS-index.php-Unauthenticated-Template-Injection-Code-Execution.html
- https://forum.playsms.org/t/playsms-1-4-3-has-been-released/2704
