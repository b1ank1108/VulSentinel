---
cve_id: CVE-2020-17530
template_path: nuclei-templates/http/cves/2020/CVE-2020-17530.yaml
affected_product: Apache Struts
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0.0 through 2.5.25
preconditions: []
poc_classification: rce
---

## Vulnerability

Apache Struts versions 2.0.0 through 2.5.25 contain a critical remote code execution vulnerability (CVE-2020-17530, S2-061) caused by forced OGNL (Object-Graph Navigation Language) evaluation. When OGNL expressions are evaluated on raw user input within tag attributes, attackers can inject malicious OGNL code that executes arbitrary commands on the server. This vulnerability is classified as CWE-917 (Improper Neutralization of Special Elements used in an Expression Language Statement). The CVSS v3.1 score is 9.8 (Critical) with vector AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-exploitable, low complexity, requiring no privileges or user interaction, with high impact to confidentiality, integrity, and availability. The EPSS score of 0.94376 (99.965th percentile) indicates extremely high likelihood of active exploitation.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a GET request with a crafted OGNL payload in the `id` parameter. The payload exploits forced OGNL evaluation to:
1. Access the Tomcat InstanceManager from the application context
2. Manipulate the ValueStack to access the OGNL context
3. Modify memberAccess security restrictions by clearing excludedClasses and excludedPackageNames
4. Instantiate the freemarker.template.utility.Execute class
5. Execute the command `cat /etc/passwd`

The template confirms successful exploitation by matching the regex pattern `root:.*:0:0:` in the response body, which indicates the `/etc/passwd` file contents were successfully read and returned, proving arbitrary command execution capability.

## References

- http://packetstormsecurity.com/files/160721/Apache-Struts-2-Forced-Multi-OGNL-Evaluation.html
- http://jvn.jp/en/jp/JVN43969166/index.html
- https://cwiki.apache.org/confluence/display/WW/S2-061
- https://security.netapp.com/advisory/ntap-20210115-0005/
- https://nvd.nist.gov/vuln/detail/CVE-2020-17530
