---
cve_id: CVE-2020-10199
template_path: nuclei-templates/http/cves/2020/CVE-2020-10199.yaml
affected_product: Sonatype Nexus Repository Manager 3
severity: high
authentication: required
external_callback: false
affected_versions: before 3.21.2
preconditions: []
poc_classification: rce
---

## Vulnerability
Sonatype Nexus Repository Manager 3 before 3.21.2 is vulnerable to Java Expression Language (JavaEL) injection (CWE-917, CVE-2020-10199). An authenticated low-privileged user can inject arbitrary EL expressions, leading to remote code execution.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).  
Impact: Successful exploitation could allow an attacker to execute arbitrary code on the affected system.

## PoC / Detection
Classification: rce  
The template first sends a POST to `/service/rapture/session` with base64-encoded default admin credentials (`username=admin`, `password=admin123`) to establish an authenticated session. It then issues a second POST to `/service/rest/beta/repositories/bower/group` containing the JSON `{"name": "internal", "online": "true", "storage": {"blobStoreName": "default", "strictContentTypeValidation": "true"}, "group": {"memberNames": ["$\\A{3*3333}"]}}` (NX-ANTI-CSRF-TOKEN header and cookie set). Detection matches on HTTP 400 status and the body string "Member repository does not exist: A9999", confirming server-side evaluation of the injected arithmetic expression `3*3333`.

## References
- https://twitter.com/iamnoooob/status/1246182773427240967
- https://securitylab.github.com/advisories/GHSL-2020-011-nxrm-sonatype
- https://nvd.nist.gov/vuln/detail/CVE-2020-10199
- http://packetstormsecurity.com/files/157261/Nexus-Repository-Manager-3.21.1-01-Remote-Code-Execution.html
- https://cwe.mitre.org/data/definitions/917.html
