---
cve_id: CVE-2020-17526
template_path: nuclei-templates/http/cves/2020/CVE-2020-17526.yaml
affected_product: Apache Airflow
severity: high
authentication: none
external_callback: false
affected_versions: prior to 1.10.14
preconditions: default configuration (webserver secret_key)
poc_classification: auth-bypass
---

## Vulnerability
Apache Airflow prior to 1.10.14 contains an authentication bypass vulnerability via incorrect session validation with default configuration. An attacker on site A can access unauthorized Airflow on site B through the site A session. Successful exploitation can lead to unauthorized access to sensitive information or unauthorized execution of arbitrary code. Remediation requires changing the default value for the `[webserver]` `secret_key` config.

## PoC / Detection
Classification: auth-bypass

The template executes two raw GET requests to `/admin/`:
- First request (no cookie) expects status 302 and body containing "Redirecting...".
- Second request supplies a hardcoded `session` cookie and expects the authenticated admin dashboard containing "DAG", "Recent Tasks", "Users", "SLA Misses", or "Task Instances".

## References
- https://kloudle.com/academy/authentication-bypass-in-apache-airflow-cve-2020-17526-and-aws-cloud-platform-compromise
- https://lists.apache.org/thread.html/rbeeb73a6c741f2f9200d83b9c2220610da314810c4e8c9cf881d47ef%40%3Cusers.airflow.apache.org%3E
- http://www.openwall.com/lists/oss-security/2020/12/21/1
- https://nvd.nist.gov/vuln/detail/CVE-2020-17526
- https://lists.apache.org/thread.html/r466759f377651f0a690475d5a52564d0e786e82c08d5a5730a4f8352@%3Cannounce.apache.org%3E
