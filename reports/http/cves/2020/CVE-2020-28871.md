---
cve_id: CVE-2020-28871
template_path: nuclei-templates/http/cves/2020/CVE-2020-28871.yaml
affected_product: Monitorr
severity: critical
authentication: none
external_callback: false
affected_versions: 1.7.6m
preconditions: []
poc_classification: rce
---

## Vulnerability

Monitorr version 1.7.6m contains an unauthenticated remote code execution vulnerability (CWE-434: Unrestricted Upload of File with Dangerous Type). The vulnerability stems from improper input validation and lack of authorization controls in the file upload functionality. An unauthorized attacker with web access can upload and execute specially crafted files through the web application's upload endpoint, leading to arbitrary code execution on the server. The CVSS v3.1 score is 9.8 (Critical) with vector AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-exploitable, low complexity, requiring no privileges or user interaction, with high impact to confidentiality, integrity, and availability.

## PoC / Detection

Classification: rce

The template performs a two-step verification process to detect this remote code execution vulnerability:

1. **File Upload**: Sends a POST request to `/assets/php/upload.php` with a multipart form-data payload containing a PHP file disguised as a GIF image. The uploaded file contains PHP code that outputs an MD5 hash of a unique string and then deletes itself using `unlink(__FILE__)`.

2. **Execution Verification**: Sends a GET request to `/assets/data/usrimg/` with the uploaded filename to verify the PHP code was executed by checking for the presence of the expected MD5 hash in the response.

The template confirms the vulnerability when both conditions are met: the server returns HTTP 200 status and the response body contains the calculated MD5 hash, proving that arbitrary PHP code was uploaded and executed without authentication.

## References

- https://www.exploit-db.com/exploits/48980
- https://lyhinslab.org/index.php/2020/09/12/how-the-white-box-hacking-works-authorization-bypass-and-remote-code-execution-in-monitorr-1-7-6/
- https://nvd.nist.gov/vuln/detail/CVE-2020-28871
- http://packetstormsecurity.com/files/163263/Monitorr-1.7.6m-Bypass-Information-Disclosure-Shell-Upload.html
- http://packetstormsecurity.com/files/170974/Monitorr-1.7.6-Shell-Upload.html
