---
cve_id: CVE-2020-25780
template_path: nuclei-templates/http/cves/2020/CVE-2020-25780.yaml
affected_product: Commvault CommCell
severity: high
authentication: required
external_callback: false
affected_versions: CommCell in Commvault before 14.68, 15.x before 15.58, 16.x before 16.44, 17.x before 17.29, and 18.x before 18.13
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Commvault CommCell is vulnerable to local file inclusion (CVE-2020-25780, CWE-22). CommCell in Commvault before 14.68, 15.x before 15.58, 16.x before 16.44, 17.x before 17.29, and 18.x before 18.13 allows an attacker to read arbitrary files outside the log-files folder by supplying an arbitrary path to the downLoadFile SOAP method. Impact: successful exploitation allows reading sensitive files on the system. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5).

## PoC / Detection
Classification: info-leak

The template issues a single POST request to `{{BaseURL}}/SearchSvc/CVSearchService.svc` containing a SOAP envelope that invokes `downLoadFile` with `<tem:path>c:/Windows/system.ini</tem:path>`, sets the `Cookie: Login` header, `soapaction: http://tempuri.org/ICVSearchSvc/downLoadFile`, and `content-type: text/xml`. It detects the LFI if the response returns HTTP 200 and contains the string `downLoadFileResult`.

## References
- https://srcincite.io/blog/2021/11/22/unlocking-the-vault.html
- http://kb.commvault.com/article/63264
- https://nvd.nist.gov/vuln/detail/CVE-2020-25780
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
