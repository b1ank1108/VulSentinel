---
cve_id: CVE-2020-29047
template_path: nuclei-templates/http/cves/2020/CVE-2020-29047.yaml
affected_product: WP Hotel Booking
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.10.3
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-29047 is a critical PHP object injection vulnerability in the WP Hotel Booking plugin for WordPress (versions through 1.10.2). The vulnerability exists in the `includes/class-wphb-sessions.php` file where the plugin performs an unsafe `unserialize()` operation on the `thimpress_hotel_booking_1` cookie value without proper validation. This allows unauthenticated remote attackers to inject arbitrary PHP objects, which can be leveraged to execute arbitrary code on the server, leading to complete server compromise. The vulnerability is classified as CWE-502 (Deserialization of Untrusted Data) with a CVSS score of 9.8, indicating critical severity with no authentication required and high impact on confidentiality, integrity, and availability.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a crafted HTTP GET request with a malicious serialized PHP object in the `thimpress_hotel_booking_1` cookie. The payload constructs a `WPHB_Logger` object containing a `Requests_Utility_FilteredIterator` object with a callback set to `phpinfo`. When the vulnerable plugin deserializes this cookie value, it triggers the execution of the `phpinfo()` function. The template verifies successful exploitation by checking for two conditions: (1) the response body contains "PHP Extension" (indicating phpinfo output), and (2) the response body contains "wp-hotel-booking" (confirming the plugin is present), combined with a 200 HTTP status code. This demonstrates that arbitrary PHP functions can be executed through the deserialization vulnerability.

## References

- https://wordpress.org/plugins/wp-hotel-booking/#developers
- https://github.com/20142995/nuclei-templates
- https://nvd.nist.gov/vuln/detail/CVE-2020-29047
