---
cve_id: CVE-2020-24186
template_path: nuclei-templates/http/cves/2020/CVE-2020-24186.yaml
affected_product: WordPress wpDiscuz plugin
severity: critical
authentication: none
external_callback: false
affected_versions: 7.0 through 7.0.4
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress wpDiscuz plugin versions 7.0 through 7.0.4 allow unauthenticated remote code execution via arbitrary file upload (CWE-434). Attackers can upload PHP files (disguised as images) through the wmuUploadFiles AJAX action and execute them on the server.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H (score 10.0).  
Impact: full server compromise on vulnerable WordPress sites.  
Remediation: update to >=7.0.5.

## PoC / Detection
Classification: rce

The template detects by first issuing `GET /?p=1` to extract the publicly exposed `wmuSecurity` nonce via regex on the response body. It then sends a `POST /wp-admin/admin-ajax.php` multipart/form-data request with `action=wmuUploadFiles`, the nonce, and a file named `rce.php` (Content-Type: image/png) containing `<?php phpinfo();?>`. Success is verified by HTTP 200 status plus the JSON body containing `"success":true`, `fullname`, `shortname`, and `url` keys; the uploaded file URL is also extracted.

## References
- https://github.com/suncsr/wpDiscuz_unauthenticated_arbitrary_file_upload/blob/main/README.md
- https://nvd.nist.gov/vuln/detail/CVE-2020-24186
- https://www.wordfence.com/blog/2020/07/critical-arbitrary-file-upload-vulnerability-patched-in-wpdiscuz-plugin/
- http://packetstormsecurity.com/files/162983/WordPress-wpDiscuz-7.0.4-Shell-Upload.html
- https://github.com/ARPSyndicate/cvemon
