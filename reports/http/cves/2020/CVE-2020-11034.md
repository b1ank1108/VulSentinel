---
cve_id: CVE-2020-11034
template_path: nuclei-templates/http/cves/2020/CVE-2020-11034.yaml
affected_product: GLPI
severity: medium
authentication: none
external_callback: true
affected_versions: < 9.4.6
preconditions: []
poc_classification: detect-only
---

## Vulnerability
GLPI versions prior to 9.4.6 contain an open redirect vulnerability in `index.php` due to insufficient regexp validation of the `redirect` query parameter. An unauthenticated remote attacker can supply an arbitrary external URL, causing the application to issue a `Location` header redirect to the attacker-controlled domain. This enables phishing attacks where victims are tricked into visiting malicious sites. CVSS 3.1 score 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Remediation requires upgrading to 9.4.6 or later. CPE: cpe:2.3:a:glpi-project:glpi:*:*:*:*:*:*:*:*.

## PoC / Detection
Classification: detect-only

The template issues two unauthenticated GET requests to `{{BaseURL}}/index.php?redirect=/\/interact.sh/` and `{{BaseURL}}/index.php?redirect=//interact.sh`. It matches the `Location` response header with the regex `(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_]*\.)?interact\.sh(?:\s*?)$` to confirm the server echoes the unvalidated redirect target. No version comparison, no credentials, and no server-side state change or data exfiltration occurs.

## References
- https://github.com/glpi-project/glpi/security/advisories/GHSA-gxv6-xq9q-37hg
- https://github.com/glpi-project/glpi/archive/9.4.6.zip
- https://nvd.nist.gov/vuln/detail/CVE-2020-11034
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5WQMONZRWLWOXMHMYWR7A5Q5JJERPMVC/
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Q4BG2UTINBVV7MTJRXKBQ26GV2UINA6L/
