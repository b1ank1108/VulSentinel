---
cve_id: CVE-2020-13121
template_path: nuclei-templates/http/cves/2020/CVE-2020-13121.yaml
affected_product: Submitty
severity: medium
authentication: none
external_callback: true
affected_versions: <=20.04.01
preconditions: []
poc_classification: detect-only
---

## Vulnerability

Submitty through version 20.04.01 contains an open redirect vulnerability in the authentication mechanism. The flaw exists in the `authentication/login?old=` parameter during login attempts. When a user attempts to log in (including invalid login attempts), the application fails to properly validate the `old` parameter value before using it in a redirect response. An attacker can craft a malicious URL with an arbitrary redirect destination, potentially leading users to phishing sites or other malicious domains. This vulnerability is classified as CWE-601 (URL Redirection to Untrusted Site) with a CVSS score of 6.1, indicating medium severity with network attack vector, low attack complexity, no privileges required, but requiring user interaction.

## PoC / Detection

Classification: detect-only

The template detects this vulnerability by sending a POST request to `/authentication/check_login` with a URL-encoded `old` parameter pointing to `interact.sh` (an external callback service). The request includes login credentials via form parameters (`user_id`, `password`, `stay_logged_in`, and `login`). The template then checks the HTTP response headers for a `Location` header that redirects to the interact.sh domain, confirming that the application improperly handles the redirect parameter and forwards users to the attacker-controlled destination. The regex matcher specifically looks for various redirect patterns including absolute URLs, protocol-relative URLs, and path-based redirects pointing to interact.sh.

## References

- https://github.com/Submitty/Submitty/issues/5265
- https://nvd.nist.gov/vuln/detail/CVE-2020-13121
- https://github.com/ARPSyndicate/kenzer-templates
