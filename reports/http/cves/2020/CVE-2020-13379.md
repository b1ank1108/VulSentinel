---
cve_id: CVE-2020-13379
template_path: nuclei-templates/http/cves/2020/CVE-2020-13379.yaml
affected_product: Grafana
severity: high
authentication: none
external_callback: false
affected_versions: 3.0.1 through 7.0.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Grafana 3.0.1 through 7.0.1 suffers from Server-Side Request Forgery (SSRF, CWE-918) in its avatar feature. Any unauthenticated user can force the application to send HTTP requests to arbitrary URLs (internal or external) and receive the results. This enables internal network reconnaissance, sensitive data exposure, bypass of security controls, and potentially further attacks like data modification or remote code execution.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H (score 8.2). Impact includes obtaining network information and unauthorized operations in the site's context.

Remediation: Upgrade to 6.3.4 or higher.

## PoC / Detection
Classification: info-leak

The template performs detection by issuing GET requests to `/avatar/1?d=http://imgur.com/..%252F1.1.1.1` (and `/grafana/avatar/` variant). It matches on status 200, Content-Type image/jpeg header, and body containing both "cloudflare.com" and "dns" to confirm the server-side fetch of the external resource succeeded, verifying the SSRF condition.

## References
- https://github.com/advisories/GHSA-wc9w-wvq2-ffm9
- https://github.com/grafana/grafana/commit/ba953be95f0302c2ea80d23f1e5f2c1847365192
- http://www.openwall.com/lists/oss-security/2020/06/03/4
- https://nvd.nist.gov/vuln/detail/CVE-2020-13379
- http://lists.opensuse.org/opensuse-security-announce/2020-06/msg00060.html
