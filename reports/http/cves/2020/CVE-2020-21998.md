---
cve_id: CVE-2020-21998
template_path: nuclei-templates/http/cves/2020/CVE-2020-21998.yaml
affected_product: HomeAutomation
severity: medium
authentication: none
external_callback: true
affected_versions: 3.3.2
preconditions: [user interaction with crafted link required]
poc_classification: detect-only
---

## Vulnerability
HomeAutomation 3.3.2 is affected by an open redirect (CWE-601) due to improper validation of the `redirect` GET parameter in `api.php`.  
**CVSS v3.1:** 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)  
**Description:** HomeAutomation 3.3.2 contains a redirect vulnerability caused by improper verification of the 'redirect' GET parameter in 'api.php', letting attackers redirect users to arbitrary websites. Exploit requires user interaction with a crafted link.  
**Impact:** Attackers can redirect users to malicious external websites through crafted links, potentially facilitating phishing attacks or malware distribution.  
**Remediation:** Upgrade to HomeAutomation version 3.3.3 or later, or apply vendor-provided security patches.

## PoC / Detection
Classification: detect-only  
The template issues one unauthenticated GET request to `{{BaseURL}}/homeautomation_v3_3_2/api.php?do=groups/toggle&groupid=1&status=1&redirect=https://interact.sh/`. It verifies success by matching the `Location` response header with the regex `(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$` to confirm the supplied redirect value is reflected unsanitized.

## References
- https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5559.php
- https://packetstormsecurity.com/files/155795/HomeAutomation-3.3.2-Open-Redirect.html
- https://cxsecurity.com/issue/WLB-2019120132
