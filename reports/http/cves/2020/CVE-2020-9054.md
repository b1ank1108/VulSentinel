---
cve_id: CVE-2020-9054
template_path: nuclei-templates/http/cves/2020/CVE-2020-9054.yaml
affected_product: Zyxel NAS Firmware
severity: critical
authentication: none
external_callback: false
affected_versions: NAS326 before firmware V5.21(AAZF.7)C0, NAS520 before firmware V5.21(AASZ.3)C0, NAS540 before firmware V5.21(AATB.4)C0, NAS542 before firmware V5.21(ABAG.4)C0; end-of-support models: NSA210, NSA220, NSA220+, NSA221, NSA310, NSA310S, NSA320, NSA320S, NSA325, NSA325v2
preconditions: []
poc_classification: rce
---

## Vulnerability
Multiple Zyxel network-attached storage (NAS) devices running firmware version 5.21 contain a pre-authentication command injection vulnerability in weblogin.cgi. The username parameter passed to the CGI executable is not properly sanitized; specially crafted input allows injection and execution of arbitrary OS commands with web-server privileges. A device-included setuid utility can then escalate these to root. Exploitation is possible via direct HTTP GET/POST or indirectly (e.g., a client visiting a malicious site that triggers the request). CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-78.

Impact: Successful exploitation results in remote code execution with root privileges on the affected device.

Remediation: Apply the latest firmware updates released by Zyxel for the listed models.

## PoC / Detection
Classification: rce

The template sends a GET request to `{{BaseURL}}/cgi-bin/weblogin.cgi?username=admin';cat /etc/passwd` (injecting a command to dump the passwd file) and matches on HTTP status 200 plus the regex `root:.*:0:0:` in the response body to confirm successful command execution.

## References
- https://krebsonsecurity.com/2020/02/zyxel-fixes-0day-in-network-storage-devices/
- https://www.zyxel.com/support/remote-code-execution-vulnerability-of-NAS-products.shtml
- https://nvd.nist.gov/vuln/detail/CVE-2020-9054
- https://kb.cert.org/vuls/id/498544/
- https://cwe.mitre.org/data/definitions/78.html
