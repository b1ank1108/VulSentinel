---
cve_id: CVE-2020-21224
template_path: nuclei-templates/http/cves/2020/CVE-2020-21224.yaml
affected_product: Inspur ClusterEngine
severity: critical
authentication: none
external_callback: false
affected_versions: 4.0
preconditions: []
poc_classification: rce
---

## Vulnerability

Inspur ClusterEngine V4.0 contains a remote code execution vulnerability that allows unauthenticated attackers to execute arbitrary commands on the control server. The vulnerability stems from improper neutralization of special elements used in a command (CWE-88), specifically through command injection in the login functionality. An attacker can send a malicious login packet containing command injection payloads to the control server's `/login` endpoint. The CVSS score of 9.8 (Critical) reflects the severity of this flaw, with attack vector being network-based, requiring no privileges, no user interaction, and providing complete compromise of confidentiality, integrity, and availability.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to the `/login` endpoint with a command injection payload embedded in the username parameter. The payload `username=;`cat /etc/passwd`&password=` attempts to execute the `cat /etc/passwd` command through backtick command substitution. The template verifies successful exploitation by checking for two conditions: (1) the response body contains a regex pattern matching the root user entry from `/etc/passwd` (format: `root:.*:0:0:`), and (2) the HTTP response status is 200. The presence of the `/etc/passwd` contents in the response confirms that arbitrary command execution occurred, demonstrating the remote code execution capability.

## References

- https://github.com/NS-Sp4ce/Inspur/tree/master/ClusterEngineV4.0%20Vul
- https://nvd.nist.gov/vuln/detail/CVE-2020-21224
- https://github.com/NS-Sp4ce/Inspur/
- https://github.com/SexyBeast233/SecBooks
- https://github.com/ARPSyndicate/cvemon
