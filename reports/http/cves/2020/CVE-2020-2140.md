---
cve_id: CVE-2020-2140
template_path: nuclei-templates/http/cves/2020/CVE-2020-2140.yaml
affected_product: Jenkins Audit Trail
severity: medium
authentication: none
external_callback: false
affected_versions: 3.2 and earlier
preconditions: Audit Trail plugin must be installed
poc_classification: info-leak
---

## Vulnerability
Jenkins Audit Trail plugin versions 3.2 and earlier suffers from a reflected cross-site scripting (XSS) flaw. The plugin does not sanitize the error message returned by the URL Patterns field form validation in the AuditTrailPlugin descriptor, allowing arbitrary HTML/JavaScript injection through the `regexCheck` endpoint. CVSS 3.1: 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Successful exploitation requires luring a logged-in Jenkins user to a crafted URL, enabling session hijacking, credential theft, or page defacement in the victim's browser.

## PoC / Detection
Classification: info-leak

The template detects the flaw by sending GET requests to `/descriptorByName/AuditTrailPlugin/regexCheck?value=*j%3Ch1%3Esample` (and the `/jenkins/` variant) and verifying that the response is HTTP 200, Content-Type contains `text/html`, and the body contains the unescaped string `<h1>sample`.

## References
- https://www.jenkins.io/security/advisory/2020-03-09/
- https://nvd.nist.gov/vuln/detail/CVE-2020-2140
- https://jenkins.io/security/advisory/2020-03-09/#SECURITY-1722
- http://www.openwall.com/lists/oss-security/2020/03/09/1
- https://github.com/merlinepedra25/nuclei-templates
