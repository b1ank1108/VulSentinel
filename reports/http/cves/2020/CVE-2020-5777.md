---
cve_id: CVE-2020-5777
template_path: nuclei-templates/http/cves/2020/CVE-2020-5777.yaml
affected_product: Magento Mass Importer
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 0.7.24
preconditions: database connection failure
poc_classification: auth-bypass
---

## Vulnerability
Magento Mass Importer (aka MAGMI) versions prior to 0.7.24 are vulnerable to remote authentication bypass. The plugin allows default credentials in the event of a database connection failure. An attacker can bypass authentication and gain unauthorized access to the Magento Mass Importer plugin. CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H), CWE-287.

## PoC / Detection
Classification: auth-bypass

The template issues a single unauthenticated GET request to `/index.php/catalogsearch/advanced/result/?name=e` and verifies HTTP 503 status with the string "Too many connections" in the response body. This identifies the database connection failure state that activates the default-credential fallback for the MAGMI authentication bypass.

## References
- https://github.com/dweeves/magmi-git/blob/18bd9ec905c90bfc9eaed0c2bf2d3525002e33b9/magmi/inc/magmi_auth.php#L35
- https://nvd.nist.gov/vuln/detail/CVE-2020-5777
- https://www.tenable.com/security/research/tra-2020-51
- https://github.com/404notf0und/CVE-Flow
- https://github.com/ARPSyndicate/cvemon
