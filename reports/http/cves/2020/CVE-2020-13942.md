---
cve_id: CVE-2020-13942
template_path: nuclei-templates/http/cves/2020/CVE-2020-13942.yaml
affected_product: Apache Unomi
severity: critical
authentication: none
external_callback: false
affected_versions: <1.5.2
preconditions: []
poc_classification: rce
---

## Vulnerability

Apache Unomi versions prior to 1.5.2 contain a critical remote code execution vulnerability. The flaw exists because Unomi allows conditions to use OGNL (Object-Graph Navigation Language) and MVEL (MVFLEX Expression Language) scripting, which enables attackers to call static Java classes from the JDK. This capability can be exploited to execute arbitrary code with the permission level of the running Java process. The vulnerability is classified under CWE-74 (Improper Neutralization of Special Elements in Output Used by a Downstream Component) and CWE-20 (Improper Input Validation), with a CVSS score of 9.8. The EPSS score of 0.9432 (99.947th percentile) indicates an extremely high probability of active exploitation in the wild.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to `/context.json` with a malicious JSON payload. The payload exploits the OGNL/MVEL scripting capability by injecting a `script::Runtime.getRuntime().exec('id')` command within the `parameterValues` of a `profilePropertyCondition`. While the template uses the benign `id` command for detection purposes, this demonstrates the ability to execute arbitrary system commands.

The template verifies successful exploitation through multiple matchers:
1. Confirms the response contains `application/json` content-type and `context-profile-id` headers
2. Validates the response body contains profile/session-related properties and UUID patterns characteristic of Unomi's response structure
3. Checks for HTTP 200 status code

The detection approach confirms the server processes the malicious condition without proper input validation, indicating the presence of the RCE vulnerability.

## References

- https://securityboulevard.com/2020/11/apache-unomi-cve-2020-13942-rce-vulnerabilities-discovered/
- https://twitter.com/chybeta/status/1328912309440311297
- https://nvd.nist.gov/vuln/detail/CVE-2020-13942
- http://unomi.apache.org./security/cve-2020-13942.txt
- https://lists.apache.org/thread.html/r4a8fa91836687eaca42b5420a778ca8c8fd3a3740e4cf4401acc9118@%3Cusers.unomi.apache.org%3E
