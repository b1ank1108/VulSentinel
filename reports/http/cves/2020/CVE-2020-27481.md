---
cve_id: CVE-2020-27481
template_path: nuclei-templates/http/cves/2020/CVE-2020-27481.yaml
affected_product: Good Layers LMS Plugin
severity: critical
authentication: none
external_callback: false
affected_versions: <= 2.1.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Unauthenticated time-based blind SQL injection (CVE-2020-27481, CWE-89) in Good Layers LMS Plugin for WordPress <= 2.1.4.  
The flaw occurs in the `gdlr_lms_cancel_booking` AJAX handler (registered via `wp_ajax_nopriv`), where the `id` POST parameter is concatenated directly into an SQL query with no sanitization or prepared statements.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Successful exploitation permits arbitrary SQL execution, enabling database data leakage, modification, or full compromise.  
Remediation: upgrade to version 2.1.5 or newer.

## PoC / Detection
Classification: info-leak  
The template sends one raw POST request to the standard WordPress AJAX endpoint with a time-based blind SQLi payload that forces a 6-second sleep if injectable:  
`action=gdlr_lms_cancel_booking&id=(SELECT 1337 FROM (SELECT(SLEEP(6)))MrMV)`.  
Detection logic (with 15 s timeout) matches when all three conditions are true: response duration â‰¥ 6 s, status code 200, and response body contains either `goodlayers-lms` or `goodlms` (plugin fingerprint). This confirms the injection point exists without performing actual data extraction or modification in the probe.

## References
- https://wpscan.com/vulnerability/652eaef8-5a3c-4a2d-ac60-b5414565c397
- https://gist.github.com/0xx7/a7aaa8b0515139cf7e30c808c8d54070
- https://nvd.nist.gov/vuln/detail/CVE-2020-27481
