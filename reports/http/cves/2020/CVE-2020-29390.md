---
cve_id: CVE-2020-29390
template_path: nuclei-templates/http/cves/2020/CVE-2020-29390.yaml
affected_product: Zeroshell
severity: critical
authentication: none
external_callback: false
affected_versions: 3.9.3
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-29390 is a critical command injection vulnerability in Zeroshell 3.9.3. The vulnerability exists in the `/cgi-bin/kerbynet` endpoint, specifically in the `StartSessionSubmit` parameter. An unauthenticated attacker can exploit this flaw by injecting shell metacharacters and the `%0a` character to execute arbitrary system commands on the target system. The vulnerability is classified as CWE-78 (OS Command Injection) with a CVSS score of 9.8, indicating network-accessible exploitation requiring no privileges, no user interaction, and resulting in complete compromise of confidentiality, integrity, and availability.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a GET request to `/cgi-bin/kerbynet` with a crafted payload in the `User` parameter that attempts to inject a command (`cat /etc/passwd`) using shell metacharacters. The payload `%27%26cat%20/etc/passwd%26%27` (decoded: `'&cat /etc/passwd&'`) exploits the command injection flaw to execute the `cat` command.

The template verifies successful exploitation by checking for three conditions:
1. The response body contains a regex pattern matching `/etc/passwd` entries (`root:.*:0:0:`)
2. The response body contains the string `<title>Start Session</title>`, confirming the vulnerable endpoint
3. The HTTP response status is 200

This detection method confirms the ability to execute arbitrary system commands, demonstrating remote code execution capability.

## References

- https://web.archive.org/web/20210303043709/https://blog.quake.so/post/zeroshell_linux_router_rce/
- https://www.exploit-db.com/exploits/41040
- https://nvd.nist.gov/vuln/detail/CVE-2020-29390
