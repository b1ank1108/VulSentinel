---
cve_id: CVE-2020-10257
template_path: nuclei-templates/http/cves/2020/CVE-2020-10257.yaml
affected_product: ThemeREX Addons
severity: critical
authentication: none
external_callback: false
affected_versions: before 2020-03-09
preconditions: []
poc_classification: rce
---

## Vulnerability
ThemeREX Addons plugin before 2020-03-09 for WordPress contains an access control vulnerability in the `/trx_addons/v2/get/sc_layout` REST API endpoint. The file `includes/plugin.rest-api.php` calls `trx_addons_rest_get_sc_layout` with an unsafe `sc` parameter, allowing any unauthenticated user to execute arbitrary PHP functions. This leads to full remote code execution and site compromise.

**Impact**  
Unauthenticated attackers can execute arbitrary PHP functions, potentially leading to remote code execution and full site compromise.

**Remediation**  
Update to version 2020-03-09 or later to fix access control issues.

**CVE Metadata**  
- CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
- CWE: CWE-94 (Improper Control of Generation of Code)  
- CPE: cpe:2.3:a:themerex:addons:*:*:*:*:*:wordpress:*:*

## PoC / Detection
Classification: rce

The template verifies exploitation with a two-step flow. First it issues a GET request to `/wp-json/trx_addons/v2/get/sc_layout?sc=wp_insert_user&role=administrator&user_login=<random>&user_pass=<random>` and checks for HTTP 200 with `{"data":` in the body. Second it posts the generated credentials to `/wp-login.php` and confirms a 302 redirect containing the `wordpress_logged_in` session cookie.

## References
- https://www.wordfence.com/blog/2020/03/zero-day-vulnerability-in-themerex-addons-now-patched/
- https://wpscan.com/vulnerability/4ed4e60e-5bbb-4010-a7fe-40eadd8dee64/
- https://nvd.nist.gov/vuln/detail/CVE-2020-10257
