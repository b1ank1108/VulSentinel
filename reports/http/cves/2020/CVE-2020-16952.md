---
cve_id: CVE-2020-16952
template_path: nuclei-templates/http/cves/2020/CVE-2020-16952.yaml
affected_product: Microsoft SharePoint
severity: high
authentication: none
external_callback: false
affected_versions: 15.0.0.4571, 15.0.0.5275, 15.0.0.4351, 15.0.0.5056, 16.0.0.10337, 16.0.0.10364, 16.0.0.10366
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-16952 is a remote code execution vulnerability in Microsoft SharePoint that occurs when the software fails to properly check the source markup of an application package. The vulnerability is classified under CWE-346 (Origin Validation Error) and has a CVSS v3.1 score of 8.6 (High severity). The attack vector is network-based, requires low attack complexity, and requires no privileges or user interaction. Successful exploitation could allow an unauthenticated attacker to execute arbitrary code on the affected SharePoint server, potentially leading to complete system compromise. The vulnerability affects specific builds of SharePoint 2016 (version 15.0.0.x) and SharePoint 2019 (version 16.0.0.x).

## PoC / Detection

Classification: rce

The template performs version detection to identify vulnerable SharePoint installations. It sends a GET request to the base URL and checks for three conditions:
1. The presence of specific vulnerable version numbers in the response body (15.0.0.4571, 15.0.0.5275, 15.0.0.4351, 15.0.0.5056 for SharePoint 2016, and 16.0.0.10337, 16.0.0.10364, 16.0.0.10366 for SharePoint 2019)
2. The presence of the "MicrosoftSharePointTeamServices" header indicating a SharePoint server
3. An HTTP status code of 200 or 201

All three conditions must be met for the template to report a positive detection. The template does not attempt to exploit the vulnerability but identifies potentially vulnerable SharePoint versions through fingerprinting.

## References

- https://srcincite.io/pocs/cve-2020-16952.py.txt
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16952
- https://github.com/rapid7/metasploit-framework/blob/1a341ae93191ac5f6d8a9603aebb6b3a1f65f107/documentation/modules/exploit/windows/http/sharepoint_ssi_viewstate.md
- https://nvd.nist.gov/vuln/detail/CVE-2020-16952
- https://github.com/ARPSyndicate/cvemon
