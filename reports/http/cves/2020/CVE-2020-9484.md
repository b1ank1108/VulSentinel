---
cve_id: CVE-2020-9484
template_path: nuclei-templates/http/cves/2020/CVE-2020-9484.yaml
affected_product: Apache Tomcat
severity: high
authentication: none
external_callback: false
affected_versions: 10.0.0-M1 to 10.0.0-M4, 9.0.0.M1 to 9.0.34, 8.5.0 to 8.5.54 and 7.0.0 to 7.0.103
preconditions: attacker can control contents and name of a file on the server and knows its relative path from FileStore storage location; server configured to use PersistenceManager with FileStore; sessionAttributeValueClassNameFilter="null" (default unless SecurityManager used) or sufficiently lax filter
poc_classification: rce
---

## Vulnerability
Apache Tomcat is affected by an unsafe deserialization vulnerability in the PersistenceManager when using FileStore. An attacker who meets all listed preconditions can trigger remote code execution by forcing deserialization of a malicious object from a file under their control via a specially crafted request.

Impact: Successful exploitation leads to remote code execution, allowing arbitrary commands on the affected system.

Remediation: Apply the latest security patches provided by Apache.

## PoC / Detection
Classification: rce

The template sends a single unauthenticated GET request to `{{BaseURL}}/index.jsp` with a crafted `JSESSIONID=../../../../../usr/local/tomcat/groovy` cookie (path-traversal payload targeting the FileStore location) and verifies exploitation conditions by matching HTTP 500 status together with the words "Exception", "ObjectInputStream", and "PersistentManagerBase" in the response body.

## References
- http://packetstormsecurity.com/files/157924/Apache-Tomcat-CVE-2020-9484-Proof-Of-Concept.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-9484
- https://lists.apache.org/thread.html/r77eae567ed829da9012cadb29af17f2df8fa23bf66faf88229857bb1%40%3Cannounce.tomcat.apache.org%3E
- https://lists.apache.org/thread.html/rf70f53af27e04869bdac18b1fc14a3ee529e59eb12292c8791a77926@%3Cusers.tomcat.apache.org%3E
- http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00057.html
