---
cve_id: CVE-2020-25506
template_path: nuclei-templates/http/cves/2020/CVE-2020-25506.yaml
affected_product: D-Link DNS-320
severity: critical
authentication: none
external_callback: true
affected_versions: v2.06B01 Revision Ax
preconditions: []
poc_classification: rce
---

## Vulnerability
D-Link DNS-320 firmware v2.06B01 Revision Ax suffers from an unauthenticated command injection vulnerability in the `system_mgr.cgi` component. The `f_ntp_server` parameter is not sanitized, enabling injection of arbitrary OS commands when processing the `cgi_ntp_time` command.

Successful exploitation allows remote attackers to execute arbitrary code on the device (CWE-78). CVSS 3.1 score: 9.8 (Critical, AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

## PoC / Detection
Classification: rce

The template sends two POST requests to `/cgi-bin/system_mgr.cgi` injecting a `curl http://{{interactsh-url}}` command (with custom random User-Agent) into the `f_ntp_server` parameter via `C1=ON&cmd=cgi_ntp_time`. It matches on the resulting OOB HTTP interaction (protocol and exact User-Agent in the received request) to confirm the injected command was executed.

## References
- https://gist.github.com/WinMin/6f63fd1ae95977e0e2d49bd4b5f00675
- https://unit42.paloaltonetworks.com/mirai-variant-iot-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2020-25506
- https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10183
- https://www.dlink.com/en/security-bulletin/
