---
cve_id: CVE-2020-36731
template_path: nuclei-templates/http/cves/2020/CVE-2020-36731.yaml
affected_product: Flexible Checkout Fields for WooCommerce
severity: high
authentication: required
external_callback: false
affected_versions: <= 2.3.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

The Flexible Checkout Fields for WooCommerce plugin for WordPress versions up to and including 2.3.1 contains an unauthenticated arbitrary plugin settings update vulnerability combined with stored cross-site scripting (XSS). The vulnerability stems from missing authorization checks on the `updateSettingsAction()` function, which is called via an `admin_init` hook. Additionally, the plugin fails to properly sanitize and escape settings that are stored, allowing attackers to inject malicious scripts.

Despite the description stating "unauthenticated," the vulnerability allows attackers to arbitrarily modify plugin settings and inject stored XSS payloads. This can lead to site takeover scenarios or theft of administrator credentials when the malicious payload is triggered. The vulnerability was exploited in a documented site takeover campaign in early 2020.

The issue is classified as CWE-79 (Cross-Site Scripting) with a CVSS score of 7.2 (High severity). The vulnerability was fixed in version 2.3.2.

## PoC / Detection

Classification: state-change

The template performs a three-step detection process:

1. **Authentication**: First, it authenticates to the WordPress admin panel by sending a POST request to `/wp-login.php` with username and password credentials.

2. **Settings Injection**: It then sends a POST request to `/wp-admin/admin.php?page=inspire_checkout_fields_settings&tab=fields_order` with crafted parameters that inject a XSS payload (`<script>alert(document.domain)</script>`) into the plugin settings. The request manipulates the `inspire_checkout_fields[settings][order]` configuration by adding a custom field with the malicious script embedded in the field name.

3. **Verification**: The template checks if the injected payload appears in the response by matching for the presence of `order_<script>alert(document.domain)</script>`, `[custom_field]`, and `inspire_checkout_fields[settings][order]` strings together.

4. **Cleanup**: A final request is sent to reset the section settings, verifying successful reset by checking for the "Settings resetted." message.

The template demonstrates that authenticated users can modify plugin settings to inject stored XSS payloads, confirming the arbitrary settings update vulnerability.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2024-11972
- https://www.wordfence.com/blog/2020/02/site-takeover-campaign-exploits-multiple-zero-day-vulnerabilities/
- https://www.wordfence.com/threat-intel/vulnerabilities/id/fd12a952-2e99-41f7-b74c-55c2b7d8deed?source=cve
