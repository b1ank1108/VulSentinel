---
cve_id: CVE-2020-35987
template_path: nuclei-templates/http/cves/2020/CVE-2020-35987.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 2.7.2
preconditions: []
poc_classification: state-change
---

## Vulnerability
Rukovoditel <= 2.7.2 contains a stored cross-site scripting (XSS) vulnerability (CWE-79, CVE-2020-35987) in the Entities List feature. Authenticated attackers can inject arbitrary web scripts or HTML via a crafted payload in the 'Name' parameter when creating or editing an entity; the payload is stored unsanitized and executed in the context of any user viewing the list.  
CVSS 3.1: 5.4 (Medium) â€“ AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N.  
Impact: JavaScript execution in victim browser, enabling session hijacking, credential theft, or application defacement.  
Remediation: Upgrade to a version higher than 2.7.2 or apply the vendor patch.

## PoC / Detection
Classification: state-change  
The template first issues a GET to /index.php?module=users/login to extract the form_session_token nonce via regex, then performs a credentialed POST login, followed by a POST to /index.php?module=entities/&action=save containing the payload `name=<script>alert(document.domain)</script>`. It confirms the stored XSS by verifying the final response meets all conditions: status_code == 200, content-type contains "text/html", body contains the literal unsanitized `<script>alert(document.domain)</script>` tag, and body contains "rukovoditel". The sequence uses three raw HTTP requests with redirects enabled.

## References
- https://github.com/r0ck3t1973/rukovoditel/issues/1
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2020-35987
