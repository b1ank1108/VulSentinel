---
cve_id: CVE-2020-17506
template_path: nuclei-templates/http/cves/2020/CVE-2020-17506.yaml
affected_product: Artica Web Proxy
severity: critical
authentication: none
external_callback: false
affected_versions: 4.30.00000000
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Artica Web Proxy 4.30.00000000 allows unauthenticated remote attackers to bypass privilege detection and gain full web backend administrator privileges via SQL injection in the `apikey` parameter of `fw.login.php`.  
The flaw (CWE-89) permits injection of a UNION SELECT payload that forces `uid=-100` (admin context) and returns a valid PHP session.  
**Impact:** Bypass authentication + arbitrary SQL execution, leading to unauthorized access and data leakage.  
**CVSS:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**Remediation:** Upgrade to a patched version or apply the vendor-supplied patch.

## PoC / Detection
Classification: auth-bypass  
The template issues a single unauthenticated GET request to `{{BaseURL}}/fw.login.php?apikey=%27UNION%20select%201,%27YToyOntzOjM6InVpZCI7czo0OiItMTAwIjtzOjIyOiJBQ1RJVkVfRElSRUNUT1JZX0lOREVYIjtzOjE6IjEiO30=%27;` (payload sets admin UID via base64-encoded serialized data). It matches on response body containing `artica-applianc`, presence of `PHPSESSID` cookie in headers, and status 200/301/302; the PHPSESSID value is extracted on success.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17506
- http://packetstormsecurity.com/files/158868/Artica-Proxy-4.3.0-Authentication-Bypass.html
- https://blog.max0x4141.com/post/artica_proxy/
- https://github.com/hangmansROP/proof-of-concepts
- https://github.com/merlinepedra/nuclei-templates
