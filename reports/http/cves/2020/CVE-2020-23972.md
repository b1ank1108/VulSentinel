---
cve_id: CVE-2020-23972
template_path: nuclei-templates/http/cves/2020/CVE-2020-23972.yaml
affected_product: Joomla! Component GMapFP 3.5
severity: high
authentication: none
external_callback: false
affected_versions: 3.5
preconditions: []
poc_classification: rce
---

## Vulnerability
Joomla! Component GMapFP 3.5 is vulnerable to arbitrary file upload. An unauthenticated attacker can reach the upload function and upload files because of unrestricted file upload, which can be bypassed by changing the Content-Type header and using a double extension on the filename.

Impact: Successful exploitation results in unauthorized remote code execution on the affected Joomla! website.

Remediation: Apply the latest security patch or update to a patched version of Joomla! Component GMapFP 3.5.

CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N). CWE-434.

## PoC / Detection
Classification: rce

The template issues a raw POST multipart/form-data request to `/index.php?option={{component}}&controller=editlieux&tmpl=component&task=upload_image` (trying payloads `com_gmapfp` and `comgmapfp`). It uploads a randomly named file `{{rand_text_alpha(5)}}.html.gif` with `Content-Type: text/html` and body content `projectdiscovery`. Success is detected by extracting a regex match `window\.opener\.(changeDisplayImage|addphoto)\(\"(.*?)\"\);` from the response body, confirming the file was accepted and processed.

## References
- https://www.exploit-db.com/exploits/49129
- https://raw.githubusercontent.com/me4yoursecurity/Reports/master/README.md
- http://packetstormsecurity.com/files/159072/Joomla-GMapFP-J3.5-J3.5F-Arbitrary-File-Upload.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-23972
- https://github.com/ARPSyndicate/cvemon
