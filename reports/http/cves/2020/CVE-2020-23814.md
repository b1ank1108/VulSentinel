---
cve_id: CVE-2020-23814
template_path: nuclei-templates/http/cves/2020/CVE-2020-23814.yaml
affected_product: XXL-JOB
severity: medium
authentication: required
external_callback: false
affected_versions: 2.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Stored cross-site scripting (XSS) vulnerability (CWE-79) in XXL-JOB 2.2.0 allows remote authenticated attackers to inject arbitrary web scripts or HTML via the AppName and AddressList parameters in JobGroupController.java.  

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1). Malicious JavaScript can be persisted in job-group data; when administrators or other users view the affected job-group list the payload executes in their browser context, enabling session-cookie theft or impersonation of administrative actions.  

Remediation: upgrade to version 2.2.1 or later.

## PoC / Detection
Classification: info-leak

The template performs the following detection flow: authenticates by POST /xxl-job-admin/login with supplied username/password credentials; confirms exact version 2.2.0 by GET /xxl-job-admin/ matching the HTML banner; injects the payload `<img src=# onerror="alert(document.domain)" />` via POST /xxl-job-admin/jobgroup/save into the addressList field (using a random lowercase title for the group); finally POSTs to /xxl-job-admin/jobgroup/pageList and verifies the unsanitized payload appears verbatim inside the returned JSON body.

## References
- https://github.com/xuxueli/xxl-job/issues/1866
- https://www.ccsq8.com/issues.html
