---
cve_id: CVE-2020-8163
template_path: nuclei-templates/http/cves/2020/CVE-2020-8163.yaml
affected_product: Ruby on Rails
severity: high
authentication: none
external_callback: false
affected_versions: <5.0.1
preconditions: []
poc_classification: rce
---

## Vulnerability
Ruby on Rails before version 5.0.1 is susceptible to remote code execution because it passes user parameters as local variables into partials. Successful exploitation of this vulnerability can lead to unauthorized remote code execution.

Remediation: Upgrade Ruby on Rails to version 5.0.1 or above.

CVSS:3.1 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
CWE-94

## PoC / Detection
Classification: rce
The template sends a GET request to `{{BaseURL}}?IO.popen(%27cat%20%2Fetc%2Fpasswd%27).read%0A%23` and verifies exploitation by checking if the response body matches the regex "root:.*:0:0:" (indicating /etc/passwd contents were returned) and status code 200.

## References
- https://hackerone.com/reports/304805
- https://groups.google.com/g/rubyonrails-security/c/hWuKcHyoKh0
- https://lists.debian.org/debian-lts-announce/2020/07/msg00013.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-8163
