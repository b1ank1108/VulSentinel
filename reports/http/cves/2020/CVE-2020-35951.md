---
cve_id: CVE-2020-35951
template_path: nuclei-templates/http/cves/2020/CVE-2020-35951.yaml
affected_product: Quiz and Survey Master
severity: critical
authentication: none
external_callback: false
affected_versions: <7.0.1
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2020-35951 is a critical arbitrary file deletion vulnerability in the WordPress Quiz and Survey Master plugin versions prior to 7.0.1. The vulnerability exists in the `qsm_remove_file_fd_question` function, which was intended to allow users to delete their own quiz-answer files but failed to implement proper authentication and authorization checks. This allows unauthenticated attackers to delete arbitrary files on the WordPress installation, including critical files such as `wp-config.php`. Successful exploitation can effectively take a site offline and allow an attacker to reinstall WordPress under their control, leading to complete site compromise. The vulnerability is classified as CWE-306 (Missing Authentication for Critical Function) with a CVSS score of 9.9.

## PoC / Detection

Classification: state-change

The template performs a multi-step detection process to verify the arbitrary file deletion vulnerability:

1. **Initial reconnaissance**: Sends GET requests to verify the presence of the Quiz and Survey Master plugin by checking for `README.md` and `AcceptanceTester.php` files in the plugin directory
2. **Path extraction**: Extracts the full server path from error messages to construct the complete file path
3. **Exploitation attempt**: Sends a POST request to `/wp-admin/admin-ajax.php` with the action `qsm_remove_file_fd_question` and targets the `README.md` file for deletion. No authentication credentials are provided, demonstrating the unauthenticated nature of the vulnerability
4. **Verification**: Confirms successful exploitation by checking that the README.md file (initially present) returns a 301 status code and is no longer accessible after the deletion attempt, while also verifying the success message "File removed successfully" in the response

The template uses an intrusive approach by actually deleting a non-critical plugin file to confirm the vulnerability exists.

## References

- https://www.wordfence.com/blog/2020/08/critical-vulnerabilities-patched-in-quiz-and-survey-master-plugin/
- https://nvd.nist.gov/vuln/detail/CVE-2020-35951
- https://wpscan.com/vulnerability/10348
