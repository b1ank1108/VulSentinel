---
cve_id: CVE-2020-5847
template_path: nuclei-templates/http/cves/2020/CVE-2020-5847.yaml
affected_product: UnRaid
severity: critical
authentication: none
external_callback: false
affected_versions: <=6.8.0
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-5847 is a critical remote code execution vulnerability affecting UnRaid version 6.8.0 and earlier. The vulnerability allows unauthenticated remote attackers to execute arbitrary PHP code on the UnRaid server without any authentication requirements. This is classified as CWE-94 (Improper Control of Generation of Code - Code Injection) and CWE-668 (Exposure of Resource to Wrong Sphere).

The vulnerability stems from improper input validation in the webGui component, specifically in the image handling functionality. Attackers can inject PHP code through the `site[x][text]` parameter when accessing the `/webGui/images/green-on.png/` endpoint. The injected code is executed server-side, leading to complete system compromise.

With a CVSS score of 9.8 (Critical) and an EPSS score of 0.9351 (99.819th percentile), this vulnerability represents an extremely high risk. The attack vector is network-based, requires low complexity, no privileges, and no user interaction. Successful exploitation results in complete compromise of confidentiality, integrity, and availability of the affected system, granting attackers access to all stored data and full control over the UnRaid server.

## PoC / Detection

Classification: rce

The Nuclei template detects this vulnerability by sending a GET request to the `/webGui/images/green-on.png/` endpoint with a crafted query string that attempts to inject PHP code. The payload uses the `site[x][text]` parameter to inject `<?php echo md5("CVE-2020-5847"); ?>`, which executes the PHP `md5()` function to generate a hash of the string "CVE-2020-5847".

The template verifies successful code execution by checking for:
1. The presence of the MD5 hash value "b13928fbcfff659363d7c7d1ec008d56" in the response body (the MD5 hash of "CVE-2020-5847")
2. An HTTP 200 status code

If both conditions are met, the vulnerability is confirmed, indicating that arbitrary PHP code can be executed on the server without authentication.

## References

- https://sysdream.com/news/lab/2020-02-06-cve-2020-5847-cve-2020-5849-unraid-6-8-0-unauthenticated-remote-code-execution-as-root/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5847
- https://sysdream.com/news/lab/
- https://forums.unraid.net/forum/7-announcements/
- https://github.com/Ostorlab/KEV
