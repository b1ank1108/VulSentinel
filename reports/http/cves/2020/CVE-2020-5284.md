---
cve_id: CVE-2020-5284
template_path: nuclei-templates/http/cves/2020/CVE-2020-5284.yaml
affected_product: Next.js
severity: medium
authentication: none
external_callback: false
affected_versions: <9.3.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability

Next.js versions before 9.3.2 contain a local file inclusion (LFI) vulnerability that allows attackers to craft special requests to access files within the dist directory (.next). The vulnerability is rooted in improper path validation (CWE-22, CWE-23), enabling directory traversal attacks. The scope is limited to files within the .next build directory and does not extend to files outside this location. The dist directory typically contains build assets, though applications may store additional assets there. The CVSS score of 4.3 reflects low confidentiality impact with no integrity or availability impact, requiring low attack complexity and low privileges.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by attempting to access the `pages-manifest.json` file, which should be restricted, through a path traversal payload. It sends a GET request to `/_next/static/../server/pages-manifest.json`, exploiting the directory traversal weakness to navigate from the static directory to the server directory within the .next build folder.

The detection verifies successful exploitation through three conditions:
1. The response contains a `application/json` content-type header
2. The response body matches the expected JSON structure of the pages manifest file (regex pattern: `\{"/_app":".*?_app\.js"`)
3. The server returns a 200 OK status code

A successful match indicates the server is vulnerable to LFI, as it improperly serves internal build files that should not be publicly accessible.

## References

- https://github.com/zeit/next.js/releases/tag/v9.3.2
- https://github.com/zeit/next.js/security/advisories/GHSA-fq77-7p7r-83rj
- https://nvd.nist.gov/vuln/detail/CVE-2020-5284
- https://github.com/Z0fhack/Goby_POC
- https://github.com/merlinepedra/nuclei-templates
