---
cve_id: CVE-2020-9480
template_path: nuclei-templates/http/cves/2020/CVE-2020-9480.yaml
affected_product: Apache Spark
severity: critical
authentication: none
external_callback: true
affected_versions: 2.4.5 and earlier
preconditions: [standalone resource manager's master]
poc_classification: rce
---

## Vulnerability
In Apache Spark 2.4.5 and earlier, a standalone resource manager's master may be configured to require authentication (`spark.authenticate`) via a shared secret. When enabled, a specially-crafted RPC to the master can succeed in starting an application's resources on the Spark cluster, even without the shared key. This can be leveraged to execute shell commands on the host machine. This does not affect Spark clusters using other resource managers (YARN, Mesos, etc).  
**Impact**: Attackers can execute arbitrary shell commands on the host machine, leading to full system compromise.  
**Remediation**: Update to Spark 2.4.6 or later.  
**CVSS**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) | **CWE**: CWE-306

## PoC / Detection
Classification: rce

The template issues a single raw POST request to `/v1/submissions/create` (port 6066) containing a crafted JSON payload that sets `appResource` and `spark.jars` to an attacker-controlled `http://{{interactsh-url}}/*.jar` URL, `mainClass` to "Exploit", and `appArgs` to reconnaissance shell commands (whoami, netstat, ps, etc.). It verifies success by matching HTTP 200 status, presence of `CreateSubmissionResponse` plus `submissionId`/`driverState` in the body, and an out-of-band HTTP callback to the interactsh server.

## References
- https://github.com/XiaoShaYu617/CVE-2020-9480/blob/main/20220624_apache_spark_apache_spark_pre-auth_code_execution_cve-2020-9480.py
- https://nvd.nist.gov/vuln/detail/cve-2020-9480
