---
cve_id: CVE-2020-8657
template_path: nuclei-templates/http/cves/2020/CVE-2020-8657.yaml
affected_product: EyesOfNetwork
severity: critical
authentication: none
external_callback: false
affected_versions: 5.3
preconditions: []
poc_classification: state-change
---

## Vulnerability

CVE-2020-8657 is a critical hardcoded API key vulnerability in EyesOfNetwork version 5.3. The application uses the same hardcoded API key (EONAPI_KEY) across all installations, defined in `include/api_functions.php` for API version 2.4.2. This design flaw allows attackers to calculate or predict the admin access token for any EyesOfNetwork installation, as the key derivation is deterministic and based on publicly known values. The vulnerability is classified as CWE-798 (Use of Hard-coded Credentials) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, and no required privileges or user interaction.

Successful exploitation enables attackers to create administrative users with full privileges, leading to complete compromise of the EyesOfNetwork management system. This allows unauthorized access to network monitoring data, configuration changes, and potential lateral movement within monitored infrastructure.

## PoC / Detection

Classification: state-change

The template exploits the hardcoded API key vulnerability to create a new administrative user account. It performs the following actions:

1. Calculates the admin API key using the hardcoded key value "â‚¬On@piK3Y" combined with userid "1" through a cryptographic hash chain: `sha256(md5(hardcoded_key + userid) + Host)`
2. Sends a POST request to `/eonapi/createEonUser` endpoint with the calculated API key
3. Submits JSON payload containing randomly generated username and password to create a new user in the "admins" group
4. Verifies successful exploitation by checking for:
   - HTTP 200 status code
   - Response body containing "200 OK", "A new user have been successfully inserted", and "api_version"
   - Content-Type header set to "application/json"
5. Extracts and displays the created credentials (username and password) for attacker use

The template demonstrates actual account creation rather than passive detection, confirming the vulnerability through successful administrative user provisioning.

## References

- https://www.exploit-db.com/exploits/48025
- https://nvd.nist.gov/vuln/detail/CVE-2020-8657
