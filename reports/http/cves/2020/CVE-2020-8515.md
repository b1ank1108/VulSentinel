---
cve_id: CVE-2020-8515
template_path: nuclei-templates/http/cves/2020/CVE-2020-8515.yaml
affected_product: DrayTek Vigor2960/Vigor3900/Vigor300B
severity: critical
authentication: none
external_callback: false
affected_versions: Vigor2960 1.3.1_Beta, Vigor3900 1.4.4_Beta, Vigor300B 1.3.3_Beta/1.4.2.1_Beta/1.4.4_Beta (fixed in v1.5.1)
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-8515 is a critical unauthenticated remote code execution vulnerability affecting DrayTek router models Vigor2960, Vigor3900, and Vigor300B. The vulnerability exists in the web management interface at the `/cgi-bin/mainfunction.cgi` endpoint, where shell metacharacters can be injected through the `keyPath` parameter without authentication. This allows an attacker to execute arbitrary commands with root privileges on the affected device.

The flaw is classified as CWE-78 (OS Command Injection) with a CVSS score of 9.8, indicating maximum severity across network attack vector, low complexity, no privileges required, and high impact on confidentiality, integrity, and availability. The vulnerability has an EPSS score of 0.94357 (99.958th percentile), indicating extremely high likelihood of exploitation in the wild. It is listed in the Known Exploited Vulnerabilities (KEV) catalog.

Successful exploitation leads to complete compromise of the router device, allowing attackers to execute arbitrary code as root, potentially enabling network reconnaissance, traffic interception, lateral movement, or using the device as a pivot point for further attacks.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending an unauthenticated POST request to `/cgi-bin/mainfunction.cgi` with a crafted payload that exploits command injection in the `keyPath` parameter. The payload uses shell metacharacters and command substitution to execute `/bin/cat /etc/passwd`, which reads the system password file.

The detection payload is: `action=login&keyPath=%27%0A%2fbin%2fcat${IFS}%2fetc%2fpasswd%0A%27&loginUser=a&loginPwd=a`

This translates to injecting a newline character followed by the command `/bin/cat /etc/passwd` (using `${IFS}` as a space substitute to bypass filtering) within single quotes in the keyPath parameter.

The template confirms successful exploitation by checking for:
1. The presence of root user entry matching the regex pattern `root:.*:0:0:` in the response body
2. HTTP 200 status code

This verification confirms that arbitrary commands can be executed with root privileges on the vulnerable device.

## References

- https://www.draytek.com/about/security-advisory/vigor3900-/-vigor2960-/-vigor300b-router-web-management-page-vulnerability-(cve-2020-8515)
- https://blog.netlab.360.com/two-zero-days-are-targeting-draytek-broadband-cpe-devices-en/
- https://nvd.nist.gov/vuln/detail/CVE-2020-8515
- https://sku11army.blogspot.com/2020/01/draytek-unauthenticated-rce-in-draytek.html
- https://www.draytek.com/about/security-advisory/vigor3900-/-vigor2960-/-vigor300b-router-web-management-page-vulnerability-%28cve-2020-8515%29/
