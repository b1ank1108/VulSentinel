---
cve_id: CVE-2020-8982
template_path: nuclei-templates/http/cves/2020/CVE-2020-8982.yaml
affected_product: Citrix ShareFile StorageZones Controller
severity: high
authentication: none
external_callback: false
affected_versions: <=5.10.x
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2020-8982 is an unauthenticated arbitrary file read vulnerability affecting Citrix ShareFile StorageZones Controller versions through at least 5.10.x. The vulnerability is classified as CWE-22 (Improper Limitation of a Pathname to a Restricted Directory), commonly known as path traversal or directory traversal. 

The flaw allows remote attackers to read arbitrary files on the affected system without authentication, potentially exposing sensitive information including configuration files, credentials, and other confidential data. The vulnerability has a CVSS v3.1 score of 7.5 (High severity) with the vector string CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, indicating network-based exploitation with low attack complexity, no privileges required, no user interaction needed, and high impact to confidentiality.

The EPSS score of 0.7588 (98.882nd percentile) indicates a high probability of active exploitation in the wild.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by exploiting the path traversal flaw in the `XmlPeek.aspx` endpoint. It sends a GET request to `/XmlPeek.aspx` with a crafted `dt` parameter containing directory traversal sequences (`\\..\\..\\..\\..\\..\\..\\Windows\\win.ini`) to access the Windows `win.ini` file outside the intended directory structure.

The detection verifies successful exploitation by checking for:
1. HTTP 200 status code response
2. Presence of characteristic strings from the Windows `win.ini` file in the response body: "bit app support", "fonts", and "extensions" (all three must be present)

The successful retrieval of the `win.ini` file contents confirms the system is vulnerable to arbitrary file read attacks through path traversal.

## References

- https://support.citrix.com/article/CTX269106
- https://drive.google.com/file/d/1Izd5MF_HHuq8YSwAyJLBErWL_nbe6f9v/view
- https://www.linkedin.com/posts/jonas-hansen-2a2606b_citrix-sharefile-storage-zones-controller-activity-6663432907455025152-8_w6/
- https://nvd.nist.gov/vuln/detail/CVE-2020-8982
- https://github.com/0xT11/CVE-POC
