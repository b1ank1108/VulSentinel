---
cve_id: CVE-2020-8115
template_path: nuclei-templates/http/cves/2020/CVE-2020-8115.yaml
affected_product: Revive Adserver
severity: medium
authentication: none
external_callback: false
affected_versions: 5.0.3 and prior
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Revive Adserver 5.0.3 and prior contains a reflected cross-site scripting (XSS) vulnerability (CWE-79, CVSS 6.1) in the publicly accessible `www/delivery/afr.php` delivery script. The query string is echoed back into a JavaScript context without sanitization or escaping. In versions prior to 3.2.2 this allows theft of the session identifier (non-HttpOnly cookie), enabling an attacker to impersonate the victim and gain access to the admin interface. Successful exploitation leads to data theft, session hijacking, or page defacement (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N).

## PoC / Detection
Classification: auth-bypass

The template sends a single unauthenticated GET request to `{{BaseURL}}/www/delivery/afr.php` with a crafted `refresh` query parameter containing a JavaScript breakout payload ending in `alert(1337)`. It verifies the vulnerability by matching (regex) the exact reflection of the alert payload inside a `window.location.replace` statement in the response body, confirming status code 200, and ensuring the response does not contain `window.location.href.indexOf` (negative matcher to filter false positives).

## References
- https://hackerone.com/reports/775693
- https://www.revive-adserver.com/security/revive-sa-2020-001/
- https://nvd.nist.gov/vuln/detail/CVE-2020-8115
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/merlinepedra/nuclei-templates
