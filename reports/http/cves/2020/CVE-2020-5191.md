---
cve_id: CVE-2020-5191
template_path: nuclei-templates/http/cves/2020/CVE-2020-5191.yaml
affected_product: PHPGurukul Hospital Management System
severity: medium
authentication: required
external_callback: false
affected_versions: 4.0
preconditions: [Valid administrator credentials required to access admin panel]
poc_classification: state-change
---

## Vulnerability

PHPGurukul Hospital Management System version 4.0 contains multiple stored cross-site scripting (XSS) vulnerabilities (CWE-79). The vulnerability exists in the doctor specialization functionality within the administrative interface. User-supplied input is not properly sanitized before being stored and rendered in web pages, allowing an attacker to inject arbitrary JavaScript code that will execute in the browsers of users viewing the affected pages.

The CVSS v3.1 score is 6.1 (Medium), with the vector string CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N, indicating network-based exploitation with low attack complexity, no privileges required for the attack itself, but requiring user interaction. The scope is changed, with low impact to confidentiality and integrity.

Successful exploitation could lead to session hijacking, credential theft, website defacement, or redirection of users to malicious sites. The vulnerability requires authenticated access to the administrative panel to inject the malicious payload, but once injected, the XSS payload affects any user (including other administrators) who views the compromised page.

## PoC / Detection

Classification: state-change

The template performs a two-step authenticated exploitation test:

1. **Authentication Step**: Sends a POST request to `/hospital/hms/admin/index.php` with username and password credentials to establish an authenticated session.

2. **XSS Injection Step**: With the authenticated session, sends a POST request to `/hospital/hms/admin/doctor-specilization.php` containing a malicious payload in the `doctorspecilization` parameter. The payload is URL-encoded: `</td><script>alert(document.domain);</script><td>`, which breaks out of an HTML table cell context to inject JavaScript.

The template confirms the vulnerability by checking for:
- The injected script tag appearing in the response body: `<td class="hidden-xs"></td><script>alert(document.domain);</script><td>`
- A `text/html` content type in the response headers
- HTTP status code 200

The detection verifies that the malicious script is stored and reflected back in the HTML response without proper sanitization, confirming the stored XSS vulnerability.

## References

- https://www.exploit-db.com/exploits/47841
- https://phpgurukul.com/hospital-management-system-in-php/
- https://nvd.nist.gov/vuln/detail/CVE-2020-5191
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
