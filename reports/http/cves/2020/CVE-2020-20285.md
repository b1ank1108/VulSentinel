---
cve_id: CVE-2020-20285
template_path: nuclei-templates/http/cves/2020/CVE-2020-20285.yaml
affected_product: ZZcms
severity: medium
authentication: none
external_callback: false
affected_versions: 2019
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2020-20285 is a reflected cross-site scripting (XSS) vulnerability in ZZcms 2019. The vulnerability exists in the user login page (`user/login.php`) where the application fails to properly sanitize the HTTP Referer header before reflecting it in the HTML response. An attacker can inject arbitrary JavaScript code through a crafted Referer header, which gets embedded into a hidden form field (`fromurl`) without proper encoding or validation. This allows execution of malicious JavaScript in the context of a victim's browser session when they visit a specially crafted link or are redirected from an attacker-controlled page.

The vulnerability can be exploited to steal session cookies, perform actions on behalf of authenticated users, deface the login page, or redirect users to malicious sites. The attack requires user interaction (the victim must visit a malicious link) but does not require the attacker to have valid credentials on the target system.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to `/user/login.php` with a malicious Referer header containing an XSS payload: `xss"/><img src="#" onerror="alert(document.domain)"/>`. 

The detection verifies three conditions:
1. The injected payload appears unescaped in the response body within a hidden input field: `fromurl" type="hidden" value="xss"/><img src="#" onerror="alert(document.domain)"/>`
2. The response Content-Type header is `text/html`
3. The HTTP response status is 200

If all conditions are met, the vulnerability is confirmed as the application reflects the malicious Referer header content directly into the HTML without sanitization, allowing JavaScript execution.

## References

- https://github.com/iohex/ZZCMS/blob/master/zzcms2019_login_xss.md
- https://nvd.nist.gov/vuln/detail/CVE-2020-20285
- https://github.com/ARPSyndicate/kenzer-templates
