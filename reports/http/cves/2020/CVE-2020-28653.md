---
cve_id: CVE-2020-28653
template_path: nuclei-templates/http/cves/2020/CVE-2020-28653.yaml
affected_product: ManageEngine OpManager
severity: critical
authentication: none
external_callback: true
affected_versions: Stable build < 125203, Released build < 125233
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-28653 is a critical Java deserialization vulnerability in Zoho ManageEngine OpManager affecting Stable builds before 125203 and Released builds before 125233. The vulnerability exists in the Smart Update Manager (SUM) servlet, specifically in the SUMCommunicationServlet endpoint. The flaw allows unauthenticated remote attackers to exploit insecure deserialization of Java objects, leading to arbitrary code execution on the server and potential full system compromise. The vulnerability has a CVSS score of 9.8 (Critical) with an EPSS score of 0.88711 (99.497th percentile), indicating high likelihood of exploitation in the wild.

## PoC / Detection

Classification: rce

The template performs a multi-stage detection process to verify the Java deserialization vulnerability:

1. **Initial reconnaissance**: Sends a GET request to verify the target is running ManageEngine OpManager by checking for "ManageEngine" in the response body.

2. **Servlet availability check**: Tests access to the SUMCommunicationServlet endpoint with a POST request to confirm the vulnerable servlet is accessible.

3. **Handshake validation**: Sends a serialized Java object (base64-encoded) to the SUMHandShakeServlet to verify the server accepts and processes serialized data.

4. **Exploitation verification**: Delivers a malicious serialized Java HashMap object containing a crafted java.net.URL object to the SUMCommunicationServlet. The payload is designed to trigger a DNS callback to an Interactsh server controlled by the tester. The template uses a 50-character padding prefix with the Interactsh URL to construct the payload. Successful DNS interaction confirms the server deserializes untrusted data and executes the embedded code, proving remote code execution capability.

## References

- http://packetstormsecurity.com/files/164231/ManageEngine-OpManager-SumPDU-Java-Deserialization.html
