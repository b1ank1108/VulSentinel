---
cve_id: CVE-2020-13640
template_path: nuclei-templates/http/cves/2020/CVE-2020-13640.yaml
affected_product: wpDiscuz
severity: critical
authentication: none
external_callback: false
affected_versions: <= 5.3.5
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A SQL injection vulnerability (CVE-2020-13640) exists in the gVectors wpDiscuz WordPress plugin versions 5.3.5 and earlier. Unauthenticated remote attackers can execute arbitrary SQL commands via the `order` parameter in a `wpdLoadMoreComments` AJAX request to `/wp-content/plugins/wpdiscuz/utils/ajax/wpdiscuz-ajax.php`.

Impact: Extraction of database contents including user credentials, posts, and sensitive WordPress configuration data (CVSS 3.1: 9.8 Critical, CWE-89).

Remediation: Upgrade to version 5.3.6 or later.

## PoC / Detection
Classification: info-leak

The template first issues a GET request to `/wp-json/wp/v2/comments` and extracts a valid `postId` via regex from the JSON response. It then sends two POST requests to the wpDiscuz AJAX endpoint with boolean blind SQL injection payloads injected into the `order` parameter (using `CASE WHEN (ORD(SUBSTRING((SELECT user_login FROM wp_users LIMIT 0,1),1,1)) > N) THEN 1 ELSE 1*(SELECT table_name FROM information_schema.tables) END`). Vulnerability is confirmed by differential matching on the JSON response body: presence of `comment_list":"<div id=\"wc-comm` (true branch) versus `"comment_list":null` (error branch).

## References
- https://github.com/asterite3/CVE-2020-13640
- https://nvd.nist.gov/vuln/detail/CVE-2020-13640
