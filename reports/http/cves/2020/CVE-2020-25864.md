---
cve_id: CVE-2020-25864
template_path: nuclei-templates/http/cves/2020/CVE-2020-25864.yaml
affected_product: HashiCorp Consul/Consul Enterprise
severity: medium
authentication: none
external_callback: false
affected_versions: <=1.9.4 (fixed in 1.9.5, 1.8.10 and 1.7.14)
preconditions: []
poc_classification: info-leak
---

## Vulnerability
HashiCorp Consul and Consul Enterprise up to version 1.9.4 are vulnerable to cross-site scripting via the key-value (KV) raw mode endpoint. An attacker can store an arbitrary HTML/JS payload via unauthenticated PUT to `/v1/kv/<key>`; the value is later reflected unsanitized (Content-Type: text/html) on GET `/v1/kv/<key>?raw`.

Impact: arbitrary JavaScript execution in the context of the victim's browser when the raw KV entry is viewed, enabling data theft, session hijacking or defacement of the Consul UI.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1) â€“ CWE-79.

## PoC / Detection
Classification: info-leak

The template performs a stored-XSS proof-of-concept:  
1. PUT `{{BaseURL}}/v1/kv/{{randstr}}` with body `<!DOCTYPE html><script>alert(document.domain)</script>` (stores payload in KV).  
2. GET `{{BaseURL}}/v1/kv/{{randstr}}%3Fraw` (retrieves value in raw mode).  

Matchers confirm: `text/html` header, exact unsanitized payload in second-response body, and HTTP 200. This verifies the raw-mode output lacks HTML escaping and would execute as script in a browser context.

## References
- https://discuss.hashicorp.com/t/hcsec-2021-07-consul-api-kv-endpoint-vulnerable-to-cross-site-scripting/23368
- https://www.hashicorp.com/blog/category/consul
- https://nvd.nist.gov/vuln/detail/CVE-2020-25864
- https://security.gentoo.org/glsa/202208-09
- https://github.com/ARPSyndicate/cvemon
