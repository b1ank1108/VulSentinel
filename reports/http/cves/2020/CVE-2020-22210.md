---
cve_id: CVE-2020-22210
template_path: nuclei-templates/http/cves/2020/CVE-2020-22210.yaml
affected_product: 74cms
severity: critical
authentication: none
external_callback: false
affected_versions: 3.2.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2020-22210 is a SQL injection vulnerability in 74cms version 3.2.0. The vulnerability exists in the `ajax_officebuilding.php` file, specifically through the `x` parameter (though the template tests via the `key` parameter). This is a classic SQL injection flaw (CWE-89) that allows attackers to inject arbitrary SQL commands into database queries without authentication.

The vulnerability has a CVSS v3.1 score of 9.8 (Critical), with the vector string indicating network-based exploitation requiring no privileges, no user interaction, and offering high impact to confidentiality, integrity, and availability. The EPSS score of 0.459 (97.5th percentile) indicates a high probability of active exploitation in the wild.

Successful exploitation allows attackers to execute arbitrary SQL queries against the backend database, potentially leading to:
- Unauthorized access to sensitive data
- Data exfiltration and leakage
- Data manipulation or deletion
- Potential for complete database compromise

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a crafted GET request to `/plus/ajax_officebuilding.php` with a SQL injection payload in the `key` parameter. The payload uses obfuscation techniques (special characters like `<>` to bypass basic filters) and attempts a UNION-based SQL injection:

```
key=éŒ¦' a<>nd 1=2 un<>ion sel<>ect 1,2,3,md5(999999999),5,6,7,8,9#
```

The injection payload:
1. Breaks out of the original SQL query with a single quote
2. Uses a false condition (`and 1=2`) to nullify the original query results
3. Performs a UNION SELECT to inject controlled data into the result set
4. Returns an MD5 hash of a known value (999999999) in the 4th column position
5. Comments out the remainder of the query with `#`

The template verifies successful exploitation by checking if the response body contains the MD5 hash of the injected number, confirming that the SQL injection executed and data was extracted from the database.

## References

- https://github.com/blindkey/cve_like/issues/11
- https://nvd.nist.gov/vuln/detail/CVE-2020-22210
- https://github.com/ARPSyndicate/kenzer-templates
