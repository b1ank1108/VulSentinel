---
cve_id: CVE-2020-11738
template_path: nuclei-templates/http/cves/2020/CVE-2020-11738.yaml
affected_product: WordPress Duplicator plugin
severity: high
authentication: none
external_callback: false
affected_versions: 1.3.24, 1.3.26
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WordPress Duplicator plugin versions 1.3.24 and 1.3.26 contain a local file inclusion (LFI) vulnerability (CWE-22: Improper Limitation of a Pathname to a Restricted Directory). The vulnerability exists in the `duplicator_download` AJAX action handler, which fails to properly validate and sanitize the `file` parameter. This allows unauthenticated attackers to perform directory traversal attacks and download arbitrary files from the server, including sensitive configuration files like `wp-config.php` (containing database credentials) and system files like `/etc/passwd`.

The vulnerability was not present in versions 1.3.22 and earlier, and was patched in version 1.3.27. According to the vendor, the flaw only existed in these two specific versions. The CVSS v3.1 score is 7.5 (High), with the attack vector being network-based, requiring low complexity, no privileges, and no user interaction. This vulnerability has been actively exploited in the wild and is listed in the Known Exploited Vulnerabilities (KEV) catalog, with an EPSS score of 0.94278 (99.935th percentile).

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending two HTTP GET requests to the WordPress admin AJAX endpoint with malicious path traversal payloads:

1. Attempts to read `/etc/passwd` using directory traversal: `?action=duplicator_download&file=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`
2. Attempts to read `wp-config.php` using path traversal: `?action=duplicator_download&file=%2F..%2Fwp-config.php`

The template confirms successful exploitation by checking for:
- Response headers indicating file download (`File Transfer`, `application/octet-stream`, and `attachment; filename=` with either `wp-config.php` or `passwd`)
- Response body content matching either Unix password file format (`root:.*:0:0:`) or WordPress database configuration constants (`define('DB_NAME|USER|PASSWORD|HOST|CHARSET|COLLATE')`)
- HTTP 200 status code

All conditions must be met simultaneously to confirm the vulnerability.

## References

- https://www.tenable.com/blog/duplicator-wordpress-plugin-vulnerability-exploited-in-the-wild
- https://snapcreek.com/duplicator/docs/changelog/?lite
- https://www.wordfence.com/blog/2020/02/active-attack-on-recently-patched-duplicator-plugin-vulnerability-affects-over-1-million-sites/
- http://packetstormsecurity.com/files/160621/WordPress-Duplicator-1.3.26-Directory-Traversal-File-Read.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-11738
