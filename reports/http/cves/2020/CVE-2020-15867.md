---
cve_id: CVE-2020-15867
template_path: nuclei-templates/http/cves/2020/CVE-2020-15867.yaml
affected_product: Gogs
severity: high
authentication: required
external_callback: true
affected_versions: 0.5.5 through 0.12.2
preconditions: Authenticated user with repository creation and git post-receive hook configuration permissions
poc_classification: rce
---

## Vulnerability
Gogs 0.5.5 through 0.12.2 is susceptible to authenticated remote code execution via the git hooks functionality. There can be a privilege escalation if access to this feature is granted to a user who does not have administrative privileges. NOTE: Since this is mentioned in the documentation but not in the UI, it could be considered a "product UI does not warn user of unsafe actions" issue.

**Impact**: Successful exploitation allows arbitrary code execution on the affected system.  
**Remediation**: Upgrade to 0.12.3 or later.  
**CVSS 3.1**: 7.2 (AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

## PoC / Detection
Classification: rce

The template logs in (GET/POST /user/login with credentials and CSRF extraction), creates a private repository (GET/POST /repo/create), sets a malicious post-receive git hook containing `#!/bin/bash\ncurl {{interactsh-url}}`, then commits a test file (GET/POST /_new/master) to trigger hook execution. Detection confirms via OOB HTTP callback to interactsh and presence of Gogs login body.

## References
- https://packetstormsecurity.com/files/162123/Gogs-Git-Hooks-Remote-Code-Execution.html
- https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1125-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/
- http://packetstormsecurity.com/files/162123/Gogs-Git-Hooks-Remote-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-15867
