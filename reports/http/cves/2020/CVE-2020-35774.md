---
cve_id: CVE-2020-35774
template_path: nuclei-templates/http/cves/2020/CVE-2020-35774.yaml
affected_product: twitter-server
severity: medium
authentication: none
external_callback: false
affected_versions: before 20.12.0
preconditions: in some configurations (administration panel histograms component)
poc_classification: info-leak
---

## Vulnerability
twitter-server before 20.12.0 is vulnerable to cross-site scripting (XSS) in some configurations. The flaw exists in the administration panel histograms component via `server/handler/HistogramQueryHandler.scala`.

**CVSS v3.1:** 5.4 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)  
**CWE:** CWE-79  
**CPE:** cpe:2.3:a:twitter:twitter-server:*:*:*:*:*:*:*:*  

**Impact:** Successful exploitation allows an attacker to execute malicious scripts in the victim's browser, leading to session hijacking, data theft, or defacement.  

**Remediation:** Apply the latest security patches or updates provided by Twitter.

## PoC / Detection
Classification: info-leak  

The template issues a single unauthenticated GET request to `{{BaseURL}}/admin/histograms?h=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&fmt=plot_cdf&log_scale=true` and confirms the vulnerability if the response body reflects the injected payload unescaped (`</script><script>alert(document.domain)</script>`), the `Content-Type` header contains `text/html`, and the HTTP status is 200.

## References
- https://advisory.checkmarx.net/advisory/CX-2020-4287
- https://nvd.nist.gov/vuln/detail/CVE-2020-35774
- https://github.com/twitter/twitter-server/commit/e0aeb87e89a6e6c711214ee2de0dd9f6e5f9cb6c
- https://github.com/twitter/twitter-server/compare/twitter-server-20.10.0...twitter-server-20.12.0
- https://github.com/ARPSyndicate/cvemon
