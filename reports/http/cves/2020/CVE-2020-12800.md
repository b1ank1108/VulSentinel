---
cve_id: CVE-2020-12800
template_path: nuclei-templates/http/cves/2020/CVE-2020-12800.yaml
affected_product: WordPress Contact Form 7
severity: critical
authentication: none
external_callback: false
affected_versions: <1.3.3.3
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Contact Form 7 before 1.3.3.3 allows unrestricted file upload and remote code execution by setting supported_type to php% and uploading a .php% file. Successful exploitation allows remote attackers to execute arbitrary code on the affected WordPress site. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8), CWE-434.

## PoC / Detection
Classification: rce

The template detects the vulnerability by sending an unauthenticated multipart/form-data POST to `/wp-admin/admin-ajax.php` (action `dnd_codedropz_upload`) that sets `supported_type=txt%`, uploads a file named `{{randstr}}.txt%` (Content-Type: application/x-httpd-php) containing the marker string `CVE-2020-12800-{{randstr}}`, then issues a GET to `/wp-content/uploads/wp_dndcf7_uploads/wpcf7-files/{{randstr}}.txt` and verifies HTTP 200 status plus the marker string in the body. This confirms the file-type bypass that enables RCE when a real PHP webshell is substituted.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2020-12800
- https://github.com/amartinsec/CVE-2020-12800
- https://packetstormsecurity.com/files/157951/WordPress-Drag-And-Drop-Multi-File-Uploader-Remote-Code-Execution.html
- https://wordpress.org/plugins/drag-and-drop-multiple-file-upload-contact-form-7/#developers
