---
cve_id: CVE-2020-1943
template_path: nuclei-templates/http/cves/2020/CVE-2020-1943.yaml
affected_product: Apache OFBiz
severity: medium
authentication: none
external_callback: false
affected_versions: 16.11.01 to 16.11.07
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Apache OFBiz 16.11.01 to 16.11.07 contains a reflected cross-site scripting (XSS) vulnerability. The `contentId` parameter to `/control/stream` accepts user-controlled data that is reflected unsanitized in the HTTP response body (CWE-79).

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (score 6.1).  
Successful exploitation allows injection and execution of arbitrary JavaScript in the context of a victim's browser session, enabling session hijacking, defacement, or theft of sensitive information.  
Remediation: upgrade to a version higher than 16.11.07.

## PoC / Detection
Classification: info-leak

The template issues a GET request to `{{BaseURL}}/control/stream?contentId=%27\%22%3E%3Csvg/onload=alert(/xss/)%3E` and confirms the vulnerability by matching the exact unsanitized payload `<svg/onload=alert(/xss/)>` in the response body, verifying the `text/html` Content-Type header, and requiring HTTP status 200.

## References
- https://lists.apache.org/thread.html/rf867d9a25fa656b279b16e27b8ff6fcda689cfa4275a26655c685702%40%3Cdev.ofbiz.apache.org%3E
- https://s.apache.org/pr5u8
- https://lists.apache.org/thread.html/r034123f2767830169fd04c922afb22d2389de6e2faf3a083207202bc@%3Ccommits.ofbiz.apache.org%3E
- https://lists.apache.org/thread.html/r8efd5b62604d849ae2f93b2eb9ce0ce0356a4cf5812deed14030a757@%3Cdev.ofbiz.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2020-1943
