---
cve_id: CVE-2020-24881
template_path: nuclei-templates/http/cves/2020/CVE-2020-24881.yaml
affected_product: osTicket
severity: critical
authentication: required
external_callback: true
affected_versions: < 1.14.3
preconditions: []
poc_classification: info-leak
---

## Vulnerability
osTicket before 1.14.3 suffers from a Server Side Request Forgery (SSRF, CWE-918) vulnerability. Authenticated attackers can embed malicious URLs in ticket messages (e.g. via `<img src>` tags), which are processed by the server during ticket print/PDF generation. This enables internal port scanning, access to internal services, and retrieval of sensitive information. CVSS 3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). Remediation: upgrade to 1.14.3+.

## PoC / Detection
Classification: info-leak

The template executes a multi-step authenticated workflow: 1) Logs in to obtain CSRF token. 2) Accesses open.php to extract help topic ID and additional CSRF. 3) Submits a new ticket via POST to open.php with payload `<img src="https://11111.{{interactsh-url}}">` in the message field. 4) Requests `/tickets.php?a=print&id=...` which triggers server-side rendering and SSRF. Detection succeeds on DNS callback via interactsh combined with PDF content-type and 200 status.

## References
- https://blackbatsec.medium.com/cve-2020-24881-server-side-request-forgery-in-osticket-eea175e147f0
- https://nvd.nist.gov/vuln/detail/CVE-2020-24881
