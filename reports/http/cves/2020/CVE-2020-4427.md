---
cve_id: CVE-2020-4427
template_path: nuclei-templates/http/cves/2020/CVE-2020-4427.yaml
affected_product: IBM Data Risk Manager
severity: critical
authentication: none
external_callback: false
affected_versions: 2.0.1 through 2.0.6
preconditions: configured with SAML authentication
poc_classification: auth-bypass
---

## Vulnerability
IBM Data Risk Manager versions 2.0.1 through 2.0.6 are vulnerable to authentication bypass when configured with SAML authentication. A remote unauthenticated attacker can bypass security restrictions by sending a specially crafted HTTP request to the SAML idpSelection endpoint, allowing full administrative access and compromise of all managed data risk information.

CVSS: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE: CWE-287 (Improper Authentication)  
CPE: cpe:2.3:a:ibm:data_risk_manager:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: auth-bypass

The template sends a single GET request to `{{BaseURL}}/albatross/saml/idpSelection?id={{randstr}}&userName=admin` and matches on HTTP 302 status with the `Location` response header containing both "localhost:8765" and "saml/idpSelection". It also extracts the full Location header value.

## References
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/ibm_drm_rce.rb
- https://seclists.org/fulldisclosure/2020/Apr/33
- https://www.ibm.com/support/pages/node/6206875
- https://nvd.nist.gov/vuln/detail/CVE-2020-4427
