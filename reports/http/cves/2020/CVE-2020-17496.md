---
cve_id: CVE-2020-17496
template_path: nuclei-templates/http/cves/2020/CVE-2020-17496.yaml
affected_product: vBulletin
severity: critical
authentication: none
external_callback: false
affected_versions: 5.5.4 through 5.6.2
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-17496 is a critical remote command execution vulnerability affecting vBulletin versions 5.5.4 through 5.6.2. The vulnerability exists in the ajax/render/widget_tabbedcontainer_tab_panel endpoint, which improperly handles crafted subWidgets data. An attacker can inject arbitrary PHP code through the widget_php template parameter, allowing execution of system commands on the target server. This vulnerability exists because of an incomplete fix for CVE-2019-16759, indicating a regression or insufficient remediation of a previously disclosed flaw. The vulnerability requires no authentication and can be exploited remotely over the network with low attack complexity.

## PoC / Detection

Classification: rce

The template sends a POST request to `/ajax/render/widget_tabbedcontainer_tab_panel` with specially crafted form data. The payload exploits the subWidgets parameter by setting `subWidgets[0][template]` to `widget_php` and injecting PHP code via `subWidgets[0][config][code]`. The injected code executes `shell_exec('cat ../../../../../../../../../../../../etc/passwd')` to read the system's password file as proof of command execution capability.

The template detects successful exploitation by:
1. Matching the regex pattern `root:.*:0:0:` in the response body, which indicates the /etc/passwd file contents were successfully retrieved
2. Verifying the HTTP response status is 200

This detection method confirms both the ability to execute arbitrary commands and read sensitive system files, demonstrating full remote code execution capability.

## References

- https://www.tenable.com/blog/zero-day-remote-code-execution-vulnerability-in-vbulletin-disclosed
- https://nvd.nist.gov/vuln/detail/CVE-2020-17496
- https://seclists.org/fulldisclosure/2020/Aug/5
- https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch
- https://cwe.mitre.org/data/definitions/78.html
