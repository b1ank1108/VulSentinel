---
cve_id: CVE-2020-29279
template_path: nuclei-templates/http/cves/2020/CVE-2020-29279.yaml
affected_product: 74CMS
severity: critical
authentication: none
external_callback: false
affected_versions: < 6.0.48
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-29279 is a remote file inclusion vulnerability in 74CMS versions prior to 6.0.48. The vulnerability exists in the `assign_resume_tpl` method within `Application/Common/Controller/BaseController.class.php`. This flaw allows attackers to inject arbitrary PHP code through the `tpl` parameter, which is then written to a log file and subsequently executed when accessed. The vulnerability requires no authentication and can be exploited remotely over the network, enabling attackers to achieve remote code execution and potentially compromise the entire system.

## PoC / Detection

Classification: rce

The template performs a two-stage exploitation to verify the vulnerability:

1. **Stage 1 (File Write)**: Sends a POST request to `/index.php?m=home&a=assign_resume_tpl` with a payload containing PHP code (`<?php phpinfo(); echo md5("999999999");ob_flush();?>`) in the `tpl` parameter. This stage verifies the vulnerable endpoint exists by checking for a 404 status with ThinkPHP error indicators.

2. **Stage 2 (Code Execution)**: Sends a second POST request to the same endpoint, but this time the `tpl` parameter references the log file path where the malicious code was written (`data/Runtime/Logs/Home/[date].log`). The template then verifies successful code execution by checking for:
   - The presence of "PHP Version" (from `phpinfo()`)
   - The MD5 hash of the test value (999999999)
   - HTTP 200 status code

This confirms both the file inclusion vulnerability and the ability to execute arbitrary PHP code.

## References

- https://github.com/Ares-X/VulWiki/blob/master/Web%E5%AE%89%E5%85%A8/74cms/74cms%20v6.0.48%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABgetshell.md
- https://www.wangan.com/p/7fyg8ka5a6f81cb6
- https://cloud.tencent.com/developer/article/1856739
