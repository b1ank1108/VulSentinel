---
cve_id: CVE-2020-9483
template_path: nuclei-templates/http/cves/2020/CVE-2020-9483.yaml
affected_product: Apache SkyWalking
severity: high
authentication: none
external_callback: false
affected_versions: 6.0.0 to 6.6.0, 7.0.0
preconditions: H2/MySQL/TiDB storage backend
poc_classification: info-leak
---

## Vulnerability
Apache SkyWalking (using H2/MySQL/TiDB storage) contains a SQL injection vulnerability (CWE-89) during metadata queries over the GraphQL protocol. Improper SQL parameter binding in versions 6.0.0â€“6.6.0 and 7.0.0 allows injection into queries such as getLinearIntValues. 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N (7.5 High). Successful exploitation enables arbitrary SQL execution, resulting in unauthorized data access or leakage.

## PoC / Detection
Classification: info-leak

The template sends a single POST request to `{{BaseURL}}/graphql` containing a JSON body with a malicious GraphQL query that injects `') UNION SELECT 1,CONCAT('~','9999999999','~')-- ` into the metric name field. Detection matches on HTTP 200 status, JSON Content-Type header, and the response body simultaneously containing the raw injected UNION SELECT string plus the phrase 'Exception while fetching data'.

## References
- https://github.com/apache/skywalking/pull/4639
- https://nvd.nist.gov/vuln/detail/CVE-2020-9483
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/developer3000S/PoC-in-GitHub
- https://github.com/pen4uin/awesome-vulnerability-research
