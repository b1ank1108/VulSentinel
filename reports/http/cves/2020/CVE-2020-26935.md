---
cve_id: CVE-2020-26935
template_path: nuclei-templates/http/cves/2020/CVE-2020-26935.yaml
affected_product: phpMyAdmin
severity: critical
authentication: required
external_callback: false
affected_versions: < 4.9.6, 5.x < 5.0.3
preconditions: [Valid user credentials required for authentication, Database and table must exist for exploitation]
poc_classification: info-leak
---

## Vulnerability

phpMyAdmin versions before 4.9.6 and 5.x before 5.0.3 contain a SQL injection vulnerability in the search feature. The vulnerability stems from improper processing of SQL statements in the search functionality, specifically in the `tbl_zoom_select.php` endpoint. Attackers with valid credentials can inject malicious SQL code through crafted search input parameters, particularly the `where_clause` parameter. This allows execution of arbitrary SQL commands against the database, potentially leading to unauthorized data access, modification, or deletion. The vulnerability is classified as CWE-89 (SQL Injection) with a CVSS score of 9.8, indicating critical severity.

## PoC / Detection

Classification: info-leak

The template performs a multi-step authentication and exploitation sequence:

1. **Initial Access**: Sends a GET request to the root path to retrieve the login page and extract CSRF tokens (`token` and `set_session` values)

2. **Authentication**: Performs a POST request to `/index.php` with username and password credentials along with extracted tokens to establish an authenticated session

3. **Session Verification**: Confirms successful authentication by checking for `logged_in:true` in the response and extracts a new session token

4. **SQL Injection Exploitation**: Sends a POST request to `/tbl_zoom_select.php` with a crafted `where_clause` parameter containing a UNION-based SQL injection payload: `1=0 UNION SELECT 1,CONCAT(USER(),0x3a,DATABASE(),0x3a,VERSION()),3-- -`. This payload extracts the database user, database name, and version information

The template detects successful exploitation by checking for HTTP 200 status and the presence of both `"success":true` and `"row_info"` in the JSON response, then extracts the injected data from the username field.

## References

- https://www.phpmyadmin.net/security/PMASA-2020-6/
- https://github.com/phpmyadmin/phpmyadmin/commit/d09ab9bc9d634ad08b866d42bb8c4109869d38d2
- https://nvd.nist.gov/vuln/detail/CVE-2020-26935
