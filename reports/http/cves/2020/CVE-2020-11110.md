---
cve_id: CVE-2020-11110
template_path: nuclei-templates/http/cves/2020/CVE-2020-11110.yaml
affected_product: Grafana
severity: medium
authentication: none
external_callback: false
affected_versions: <= 6.7.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Grafana through 6.7.1 is affected by an unauthenticated stored Cross-Site Scripting (XSS) vulnerability (CVE-2020-11110, CWE-79) due to insufficient sanitization of the `originalUrl` field in snapshot creation. Attackers can inject arbitrary JavaScript (e.g., `javascript:alert('Revers3c')`) that executes in a victim's browser when viewing the snapshot and clicking "Open Original Dashboard".

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4). Impact includes potential session hijacking, data theft, or other client-side attacks in the context of authenticated users viewing the malicious snapshot.

## PoC / Detection
Classification: info-leak

The template sends a POST request to `/api/snapshots` embedding the XSS payload inside a crafted dashboard JSON under `snapshot.originalUrl`. Success is confirmed if the server responds with HTTP 200, `application/json` content-type, and response body containing both `"deleteKey":` and `"deleteUrl":` indicators (proving snapshot creation and storage of unsanitized input). The snapshot URL is extracted for potential manual verification.

## References
- https://github.com/grafana/grafana/pull/23254
- https://security.netapp.com/advisory/ntap-20200810-0002/
- https://nvd.nist.gov/vuln/detail/CVE-2020-11110
- https://hackerone.com/reports/1329433
- https://github.com/grafana/grafana/blob/master/CHANGELOG.md
