---
cve_id: CVE-2020-27838
template_path: nuclei-templates/http/cves/2020/CVE-2020-27838.yaml
affected_product: Keycloak
severity: medium
authentication: none
external_callback: false
affected_versions: prior to 13.0.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
A flaw was found in Keycloak in versions prior to 13.0.0. The client registration endpoint allows fetching information about PUBLIC clients (like client secret) without authentication which could be an issue if the same PUBLIC client changed to CONFIDENTIAL later. The highest threat from this vulnerability is to data confidentiality. The vulnerability allows an attacker to gain sensitive information from the Keycloak server.

## PoC / Detection
Classification: info-leak

The template issues a GET request to `{{BaseURL}}/auth/realms/master/clients-registrations/default/security-admin-console` and verifies HTTP 200 status, `application/json` Content-Type header, and JSON body containing both `"clientId":\s*"security-admin-console"` and `"secret":`.

## References
- https://bugzilla.redhat.com/show_bug.cgi?id=1906797
- https://nvd.nist.gov/vuln/detail/CVE-2020-27838
- https://github.com/muneebaashiq/MBProjects
- https://github.com/j4k0m/godkiller
