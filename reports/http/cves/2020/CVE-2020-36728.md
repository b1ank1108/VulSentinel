---
cve_id: CVE-2020-36728
template_path: nuclei-templates/http/cves/2020/CVE-2020-36728.yaml
affected_product: WordPress Plugin Adning Advertising
severity: medium
authentication: none
external_callback: false
affected_versions: < 1.5.6
preconditions: []
poc_classification: rce
---

## Vulnerability
WordPress Plugin Adning Advertising versions below 1.5.6 is vulnerable to unauthenticated arbitrary file upload. Attackers can upload malicious PHP files via the `_ning_upload_image` AJAX action (with directory traversal `../` and `php` allowed in file types), achieving remote code execution and full compromise of the WordPress site and underlying server.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N (6.5).  
Impact: full site/server takeover. Remediation: upgrade to 1.5.6 or later.

## PoC / Detection
Classification: rce

The template performs an intrusive two-request verification of the RCE impact:  
1. Multipart POST to `/wp-admin/admin-ajax.php?action=_ning_upload_image` uploads a PHP webshell (`<?php echo base64_decode($_GET["input"]);?>`) named with random 8-char basename, setting `allowed_file_types=php,jpg,jpeg` and `{"dir": "../"}`. Matches on HTTP 200 + body containing filename/tmp_name/grid_item/success.  
2. GET to the uploaded `/{{filename}}.php?input={{base64(randstr)}}` executes the shell and matches on HTTP 200 + response body containing the original marker string.

## References
- https://www.wordfence.com/blog/2020/07/critical-vulnerabilities-patched-in-adning-advertising-plugin/
- https://blog.nintechnet.com/critical-vulnerability-in-adning-advertising-plugin-actively-exploited-in-the-wild/
- https://codecanyon.net/item/wp-pro-advertising-system-all-in-one-ad-manager/269693
- https://nvd.nist.gov/vuln/detail/CVE-2020-36728
