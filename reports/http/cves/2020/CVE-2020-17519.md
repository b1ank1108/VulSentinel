---
cve_id: CVE-2020-17519
template_path: nuclei-templates/http/cves/2020/CVE-2020-17519.yaml
affected_product: Apache Flink
severity: high
authentication: none
external_callback: false
affected_versions: 1.11.0, 1.11.1, 1.11.2
preconditions: [JobManager REST interface must be accessible]
poc_classification: info-leak
---

## Vulnerability

Apache Flink versions 1.11.0, 1.11.1, and 1.11.2 contain a local file inclusion (LFI) vulnerability in the JobManager REST interface. The vulnerability allows unauthenticated remote attackers to read arbitrary files from the local filesystem of the JobManager process through path traversal in the REST API endpoint. This is classified as CWE-552 (Files or Directories Accessible to External Parties) with a CVSS score of 7.5 (High severity). The vulnerability enables attackers to access sensitive files including configuration files, credentials, and proprietary data stored on the JobManager server without requiring any authentication.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a GET request to the JobManager logs endpoint with a path traversal payload: `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`. The payload uses double URL encoding (`%252f` for `/`) to bypass path sanitization and traverse up multiple directory levels to access `/etc/passwd`. 

The template confirms successful exploitation by:
1. Checking for a 200 HTTP status code
2. Verifying the response body contains the regex pattern `root:.*:0:0:`, which matches the root user entry in Unix/Linux passwd files

This detection method demonstrates the ability to read arbitrary system files through the vulnerable REST interface.

## References

- https://github.com/B1anda0/CVE-2020-17519
- https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cdev.flink.apache.org%3E
- https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cdev.flink.apache.org%3E
- https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cuser.flink.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2020-17519
