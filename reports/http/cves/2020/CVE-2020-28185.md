---
cve_id: CVE-2020-28185
template_path: nuclei-templates/http/cves/2020/CVE-2020-28185.yaml
affected_product: TerraMaster TOS
severity: medium
authentication: none
external_callback: false
affected_versions: <= 4.2.06
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2020-28185 is a user enumeration vulnerability in TerraMaster TOS version 4.2.06 and earlier. The vulnerability exists in the `wizard/initialise.php` endpoint, which allows remote unauthenticated attackers to identify valid usernames within the system by submitting username values via the `username` parameter. The endpoint responds with user information including username, email, and status fields when a valid user is queried, enabling attackers to enumerate legitimate accounts without authentication. This information disclosure can facilitate subsequent attacks such as credential stuffing, targeted phishing, or brute force authentication attempts.

## PoC / Detection

Classification: info-leak

The template performs a two-step detection process:

1. **Initial Request**: Sends a GET request to `/tos/index.php?user/login` to establish context and obtain the login page.

2. **Enumeration Probe**: Sends a POST request to `/wizard/initialise.php` with the following parameters:
   - `tab=checkuser`
   - `username=admin` (testing for the common 'admin' username)
   - Sets appropriate headers including `X-Requested-With: XMLHttpRequest` and `Referer` to mimic legitimate AJAX requests

The template confirms the vulnerability by checking for:
- HTTP 200 status response
- Presence of all three JSON fields in the response body: `"username":`, `"email":`, and `"status":`
- Extracts the actual username and email values from the response using regex patterns

The successful detection indicates that the system discloses user account information to unauthenticated requests, confirming the user enumeration vulnerability.

## References

- https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/TerraMaster%20TOS%20%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E%20CVE-2020-28185.md
- https://nvd.nist.gov/vuln/detail/CVE-2020-28185
- https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/
- https://www.terra-master.com/
- https://github.com/ArrestX/--POC
