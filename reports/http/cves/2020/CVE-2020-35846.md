---
cve_id: CVE-2020-35846
template_path: nuclei-templates/http/cves/2020/CVE-2020-35846.yaml
affected_product: Agentejo Cockpit
severity: critical
authentication: none
external_callback: false
affected_versions: < 0.11.2
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Agentejo Cockpit before 0.11.2 allows NoSQL injection via the Controller/Auth.php check function using the $eq operator to match documents where a field value equals the specified value. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). CWE-89. Successful exploitation enables unauthorized access, data leakage, or data manipulation. Remediation: upgrade to 0.11.2 or later.

## PoC / Detection
Classification: auth-bypass  
The template sends one unauthenticated POST request to `{{BaseURL}}/auth/check` with JSON body `{"auth":{"user":{"$eq":"admin"},"password":[0]}}` (Content-Type: application/json). Detection matches HTTP 200 status plus the exact PHP warning string `password_verify() expects parameter` in the body, confirming the NoSQL injection reached the admin user record and triggered a type-mismatch error during password verification.

## References
- https://swarm.ptsecurity.com/rce-cockpit-cms/
- https://nvd.nist.gov/vuln/detail/CVE-2020-35846
- https://getcockpit.com/
- https://github.com/agentejo/cockpit/commit/2a385af8d80ed60d40d386ed813c1039db00c466
- https://github.com/agentejo/cockpit/commit/33e7199575631ba1f74cba6b16b10c820bec59af
