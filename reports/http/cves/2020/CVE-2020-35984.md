---
cve_id: CVE-2020-35984
template_path: nuclei-templates/http/cves/2020/CVE-2020-35984.yaml
affected_product: Rukovoditel
severity: medium
authentication: required
external_callback: false
affected_versions: <= 2.7.2
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Rukovoditel <= 2.7.2 contains a stored cross-site scripting (XSS) vulnerability in the Users Alerts feature. Authenticated attackers can submit a crafted payload in the Title (name) parameter that is saved unsanitized and later executed in the context of any user viewing the alert.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (score 5.4)  
CWE-79  
Impact includes arbitrary JavaScript execution leading to session hijacking, cookie theft, or page defacement in the victim's browser.  
Remediation requires upgrade to a version higher than 2.7.2.

## PoC / Detection
Classification: info-leak

The template first performs a GET to /index.php?module=users/login to extract the form_session_token nonce via regex. It then issues a POST login request with the supplied username/password credentials, followed by a POST to /index.php?module=users_alerts/users_alerts&action=save containing the payload `name=<script>alert(document.domain)</script>`. Detection succeeds if the final response returns HTTP 200, contains the literal unsanitized `<script>alert(document.domain)</script>` string, and includes the product identifier "rukovoditel", confirming the injected script is stored and would execute for any viewer of the alert.

## References
- https://github.com/r0ck3t1973/rukovoditel/issues/4
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2020-35984
