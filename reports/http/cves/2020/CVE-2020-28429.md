---
cve_id: CVE-2020-28429
template_path: nuclei-templates/http/cves/2020/CVE-2020-28429.yaml
affected_product: geojson2kml
severity: critical
authentication: none
external_callback: false
affected_versions: all versions
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-28429 is a command injection vulnerability in geojson2kml, a Node.js package. The vulnerability allows attackers to inject arbitrary operating system commands through the `fileName` parameter in the `/convert` endpoint. The flaw stems from improper input validation (CWE-78), enabling attackers to execute shell commands on the server without authentication. With a CVSS score of 9.8, this critical vulnerability can lead to unauthorized access, remote code execution, and privilege escalation. The vendor has not released a fixed version, and the remediation guidance recommends discontinuing use of the package entirely.

## PoC / Detection

Classification: rce

The template detects this command injection vulnerability by sending a POST request to the `/convert` endpoint with a malicious `fileName` parameter containing shell command injection syntax. The payload uses command chaining (`&`) to execute `echo` and write a random string to a file with a randomly generated filename, followed by the `ls` command. The template then attempts to retrieve the created file via a GET request to `/file/{{filename}}.txt`. 

Detection is confirmed when:
1. The second response body contains the exact random string that was written
2. The response Content-Type header is `text/html`
3. The HTTP status code is 200

This two-step verification proves that arbitrary commands were executed on the server and that file creation was successful, confirming the presence of the command injection vulnerability.

## References

- https://snyk.io/vuln/SNYK-JS-GEOJSON2KML-1050412
- https://github.com/advisories/GHSA-w83x-fp72-p9qc
- https://nvd.nist.gov/vuln/detail/CVE-2020-28429
