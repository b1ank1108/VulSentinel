---
cve_id: CVE-2020-27615
template_path: nuclei-templates/http/cves/2020/CVE-2020-27615.yaml
affected_product: WordPress Loginizer plugin
severity: critical
authentication: none
external_callback: false
affected_versions: < 1.6.4
preconditions: []
poc_classification: info-leak
---

## Vulnerability

The Loginizer plugin for WordPress versions prior to 1.6.4 contains an unauthenticated SQL injection vulnerability in the `log` parameter. The flaw exists in the `loginizer_login_failed` and `lz_valid_ip` functions, which fail to properly sanitize user input before using it in SQL queries. This critical vulnerability allows remote attackers to inject arbitrary SQL commands without authentication, potentially leading to complete database compromise. The vulnerability can also be chained with cross-site scripting (XSS) attacks. The severity is rated as critical with a CVSS score of 9.8, reflecting the ease of exploitation (no authentication required, low complexity) and high impact on confidentiality, integrity, and availability.

## PoC / Detection

Classification: info-leak

The template performs a two-stage detection process:

1. **Version Check**: Retrieves `/wp-content/plugins/loginizer/readme.txt` to extract the plugin version from the "Stable tag" field and verifies it is below 1.6.4.

2. **Time-Based SQL Injection Verification**: Sends a POST request to `/wp-login.php` with a malicious `log` parameter containing a time-based SQL injection payload: `'%2cip%3dLEFT(UUID()%2c8)%2curl%3dif(1%3d1%2csleep(7)%2c0)%23`. The payload uses a conditional `sleep(7)` function to cause a 7-second delay if the SQL injection is successful. The template confirms the vulnerability by checking if the response time is at least 7 seconds and the response contains WordPress login page indicators (`wp-admin`, `user_login`) with a 200 status code. This time-based blind SQL injection technique allows attackers to extract database contents through boolean-based or time-based queries.

## References

- https://web.archive.org/web/20210321225040/https://wpscan.com/vulnerability/10441/
- https://www.zdnet.com/article/wordpress-deploys-forced-security-update-for-dangerous-bug-in-popular-plugin/
- https://wpscan.com/vulnerability/10441
