---
cve_id: CVE-2020-35729
template_path: nuclei-templates/http/cves/2020/CVE-2020-35729.yaml
affected_product: Klog Server
severity: critical
authentication: none
external_callback: false
affected_versions: <=2.4.1
preconditions: []
poc_classification: rce
---

## Vulnerability

CVE-2020-35729 is an unauthenticated command injection vulnerability in Klog Server version 2.4.1 and prior. The vulnerability exists in the `authenticate.php` file, which improperly handles the `user` HTTP POST parameter by passing it directly to the `shell_exec()` PHP function without adequate input validation. This allows an attacker to inject and execute arbitrary commands as the Apache user. The severity is compounded by a misconfigured sudo configuration that permits the Apache user to execute any command as root without password authentication, effectively escalating the command injection to root-level privileged execution.

The vulnerability is classified as CWE-78 (OS Command Injection) with a CVSS v3.1 score of 9.8 (Critical), indicating network-accessible exploitation requiring no privileges, no user interaction, and resulting in complete compromise of confidentiality, integrity, and availability. The EPSS score of 0.89753 (99.553rd percentile) indicates a very high probability of active exploitation in the wild.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to `/actions/authenticate.php` with a crafted payload in the `user` parameter. The payload uses command injection techniques to execute a base64 decoding operation that outputs a specific marker string ("poc-testing"). The injection payload structure is:

`user={{dummy}} & echo "cG9jLXRlc3Rpbmc=" | base64 -d & echo"&pswd={{dummy}}`

Where `{{dummy}}` is a random 5-character alphabetic string. The injected commands leverage shell metacharacters (`&`) to break out of the intended command context and execute arbitrary commands. The template verifies successful exploitation by checking for the presence of "poc-testing" (the decoded base64 string) in the response, confirming that command injection occurred and arbitrary code was executed on the server.

## References

- https://docs.unsafe-inline.com/0day/klog-server-unauthentication-command-injection
- https://nvd.nist.gov/vuln/detail/CVE-2020-35729
- https://github.com/mustgundogdu/Research/blob/main/KLOG_SERVER/Exploit_Code
- https://github.com/mustgundogdu/Research/blob/main/KLOG_SERVER/README.md
- https://github.com/Z0fhack/Goby_POC
