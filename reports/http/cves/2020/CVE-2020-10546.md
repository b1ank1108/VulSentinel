---
cve_id: CVE-2020-10546
template_path: nuclei-templates/http/cves/2020/CVE-2020-10546.yaml
affected_product: rConfig
severity: critical
authentication: none
external_callback: false
affected_versions: 3.9.4 and previous versions
preconditions: []
poc_classification: info-leak
---

## Vulnerability
rConfig 3.9.4 and previous versions are affected by an unauthenticated SQL injection in compliancepolicies.inc.php (searchField parameter). The flaw permits execution of arbitrary SQL queries. Nodes' passwords are stored in cleartext by default, allowing credential extraction and lateral movement to monitored network devices upon successful exploitation.

## PoC / Detection
Classification: info-leak
The template sends a single unauthenticated GET request to `{{BaseURL}}/compliancepolicies.inc.php?search=True&searchColumn=policyName&searchOption=contains&searchField=antani'+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL+--+`. It verifies success by checking for the injected marker string "[project-discovery]" in the response body and HTTP status 200.

## References
- https://github.com/theguly/exploits/blob/master/CVE-2020-10546.py
- https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2020-10546
- https://github.com/theguly/exploits
- https://github.com/ARPSyndicate/kenzer-templates
