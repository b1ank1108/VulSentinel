---
cve_id: CVE-2020-27986
template_path: nuclei-templates/http/cves/2020/CVE-2020-27986.yaml
affected_product: SonarQube
severity: high
authentication: none
external_callback: false
affected_versions: 8.4.2.36762
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2020-27986 is an authentication bypass vulnerability in SonarQube 8.4.2.36762 that allows remote attackers to discover cleartext credentials for SMTP, SVN, and GitLab integrations without authentication. The vulnerability exists in the `/api/settings/values` endpoint, which exposes sensitive configuration values including email server credentials (SMTP host, password, port, username) and potentially other integration credentials. This represents a CWE-306 (Missing Authentication for Critical Function) flaw with a CVSS score of 7.5, classified as high severity. The vulnerability allows unauthorized access to sensitive credential information that could be leveraged for further attacks against integrated systems.

## PoC / Detection

Classification: info-leak

The template detects this vulnerability by sending an unauthenticated GET request to the `/api/settings/values` API endpoint. It verifies the presence of the vulnerability by checking for a 200 OK response status and confirming that the response body contains all four SMTP-related configuration keys: `email.smtp_host.secured`, `email.smtp_password.secured`, `email.smtp_port.secured`, and `email.smtp_username.secured`. The presence of these fields in the API response indicates that the endpoint is improperly exposing sensitive credential information without requiring authentication, confirming the authentication bypass and information disclosure vulnerability.

## References

- https://csl.com.co/sonarqube-auditando-al-auditor-parte-i/
- https://nvd.nist.gov/vuln/detail/CVE-2020-27866
- https://github.com/SexyBeast233/SecBooks
- https://github.com/SouthWind0/southwind0.github.io
- https://github.com/Z0fhack/Goby_POC
