---
cve_id: CVE-2020-9039
template_path: nuclei-templates/http/cves/2020/CVE-2020-9039.yaml
affected_product: Couchbase Server
severity: critical
authentication: none
external_callback: false
affected_versions: 4.0.0, 4.1.0, 4.1.1, 4.5.0, 4.5.1, 4.6.0-4.6.5, 5.0.0, 5.1.1, 5.5.0, 5.5.1
preconditions: []
poc_classification: auth-bypass
---

## Vulnerability
Couchbase Server versions 4.0.0, 4.1.0, 4.1.1, 4.5.0, 4.5.1, 4.6.0-4.6.5, 5.0.0, 5.1.1, 5.5.0, and 5.5.1 contain insecure permissions on the projector and indexer REST endpoints. Unauthenticated access to these administrative APIs is possible with no special conditions required. Attackers can read and modify administrative settings, resulting in potential data tampering or full system compromise. Remediation requires updating to a version where the `/settings` endpoint enforces authentication.

## PoC / Detection
Classification: auth-bypass

The template performs two unauthenticated GET requests (`{{BaseURL}}/settings` and `{{BaseURL}}/indexer/settings`) with `stop-at-first-match: true`. It verifies exploitation success when `status_code == 200` and the response body contains any of the strings `indexer.settings`, `projector.settings`, or `max_seckey_size`, confirming that protected administrative configuration endpoints are reachable without credentials.

## References
- https://docs.couchbase.com/server/current/index-rest-settings/index.html#Settings
