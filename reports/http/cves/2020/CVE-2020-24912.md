---
cve_id: CVE-2020-24912
template_path: nuclei-templates/http/cves/2020/CVE-2020-24912.yaml
affected_product: qcubed
severity: medium
authentication: none
external_callback: false
affected_versions: all versions including 3.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
qcubed (all versions including 3.1.1) contains a reflected cross-site scripting vulnerability in profile.php via the stQuery parameter (CVE-2020-24912, CWE-79). Unauthenticated remote attackers can craft a malicious POST to the endpoint that reflects unsanitized `<script>alert('xss')</script>` back into the HTML response sent to authenticated victims. Successful exploitation enables session hijacking, defacement, or theft of sensitive information. CVSS 3.1 score 6.1 (AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N). Remediation requires upgrading to a fixed release.

## PoC / Detection
Classification: info-leak

The template sends up to three unauthenticated POST requests (one per candidate path) to `{{BaseURL}}/assets/_core/php/profile.php`, `{{BaseURL}}/assets/php/profile.php`, or `{{BaseURL}}/vendor/qcubed/qcubed/assets/php/profile.php` using `Content-Type: application/x-www-form-urlencoded`. The body contains a base64-encoded `strProfileData` payload engineered to trigger reflection of the XSS string through the stQuery parameter. Detection succeeds if the response body contains the literal string `<script>alert('xss')</script>` AND the `Content-Type` header equals `text/html`.

## References
- https://www.ait.ac.at/themen/cyber-security/pentesting/security-advisories/ait-sa-20210215-03
- https://github.com/qcubed/qcubed/pull/1320/files
- https://nvd.nist.gov/vuln/detail/CVE-2020-24912
- http://seclists.org/fulldisclosure/2021/Mar/30
- http://qcubed.com
