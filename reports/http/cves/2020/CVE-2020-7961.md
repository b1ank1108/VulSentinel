---
cve_id: CVE-2020-7961
template_path: nuclei-templates/http/cves/2020/CVE-2020-7961.yaml
affected_product: Liferay Portal
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 7.2.1 CE GA2
preconditions: []
poc_classification: rce
---

## Vulnerability
Liferay Portal prior to 7.2.1 CE GA2 allows unauthenticated remote attackers to execute arbitrary code via the JSON web services (JSONWS) endpoint due to insecure deserialization of untrusted data (CWE-502). 

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8). Impact includes complete server compromise and access to all portal data.

## PoC / Detection
Classification: rce

The template sends a POST request to `/api/jsonws/invoke` with a URL-encoded payload containing a serialized Java object exploiting a deserialization gadget chain (involving Apache Commons Collections, TiedMapEntry, LazyMap, ChainedTransformer, and ScriptEngineManager). This leads to evaluation of JavaScript code that executes an OS command (via ProcessBuilder, handling Windows/Linux differences) passed in the `cmd2` parameter. It matches the HTTP 200 response body for command output patterns like "OS Name:.*Microsoft Windows" or "Distributor ID:" to confirm successful RCE.

## References
- https://www.synacktiv.com/en/publications/how-to-exploit-liferay-cve-2020-7961-quick-journey-to-poc.html
- https://codewhitesec.blogspot.com/2020/03/liferay-portal-json-vulns.html
- https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/117954271
- https://nvd.nist.gov/vuln/detail/CVE-2020-7961
- http://packetstormsecurity.com/files/157254/Liferay-Portal-Java-Unmarshalling-Remote-Code-Execution.html
