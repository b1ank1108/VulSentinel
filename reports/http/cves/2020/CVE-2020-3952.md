---
cve_id: CVE-2020-3952
template_path: nuclei-templates/http/cves/2020/CVE-2020-3952.yaml
affected_product: VMware vCenter Server
severity: critical
authentication: none
external_callback: false
affected_versions: < 6.7.0
preconditions: vmdir as part of embedded or external Platform Services Controller (PSC)
poc_classification: auth-bypass
---

## Vulnerability
VMware vCenter Server LDAP Broken Access Control (CVE-2020-3952) affects the vmdir component. Under certain conditions, vmdir that ships with VMware vCenter Server as part of an embedded or external Platform Services Controller (PSC) does not correctly implement access controls.

Unauthorized users may access sensitive functions, potentially leading to privilege escalation or data exposure.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8, Critical). CWE-306. EPSS 0.94355 (99.957th percentile).

Remediation: Apply the latest VMware security patches and updates.

## PoC / Detection
Classification: auth-bypass

The template issues an unauthenticated raw POST to `/sdk/` containing a SOAP envelope that invokes `RetrieveServiceContent` on the `ServiceInstance` ManagedObjectReference. It verifies the response with:
- status code 200
- `Content-Type` containing `text/xml`
- body containing `RetrieveServiceContentResponse` or `urn:vim`
- version extracted via regex `<version>([^<]+)</version>` satisfying `compare_versions(version, '< 6.7.0')`

## References
- https://nvd.nist.gov/vuln/detail/CVE-2020-3952
- https://www.vmware.com/security/advisories/VMSA-2020-0006.html
- https://github.com/guardicore/vmware_vcenter_cve_2020_3952
