---
cve_id: CVE-2020-20300
template_path: nuclei-templates/http/cves/2020/CVE-2020-20300.yaml
affected_product: WeiPHP 5.0
severity: critical
authentication: none
external_callback: false
affected_versions: 5.0
preconditions: []
poc_classification: state-change
---

## Vulnerability
WeiPHP 5.0 contains a SQL injection vulnerability (CWE-89) in the `wp_where` function. An unauthenticated remote attacker can execute arbitrary SQL queries via the `uid` parameter on the `/public/index.php/home/index/bind_follow` endpoint. This enables extraction of sensitive database information, data modification, and unauthorized administrative operations.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8).  
CPE: cpe:2.3:a:weiphp:weiphp:5.0:*:*:*:*:*:*:*.

## PoC / Detection
Classification: state-change  
The template issues a single POST request to `{{BaseURL}}/public/index.php/home/index/bind_follow/?publicid=1&is_ajax=1&uid[0]=exp&uid[1]=)%20and%20updatexml(1,concat(0x7e,md5('999999'),0x7e),1)--+ ` containing an `updatexml` error-based payload. It matches on the presence of the string `52c69e3a57331081823331c4e69d3f2` (MD5 of 999999) in the response body together with HTTP status 500, confirming the injection point is exploitable and arbitrary SQL execution is possible.

## References
- https://github.com/Y4er/Y4er.com/blob/15f49973707f9d526a059470a074cb6e38a0e1ba/content/post/weiphp-exp-sql.md
- https://nvd.nist.gov/vuln/detail/CVE-2020-20300
- https://github.com/Y4er/Y4er.com/blob/master/content/post/weiphp-exp-sql.md
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
