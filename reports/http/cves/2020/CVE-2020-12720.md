---
cve_id: CVE-2020-12720
template_path: nuclei-templates/http/cves/2020/CVE-2020-12720.yaml
affected_product: vBulletin
severity: critical
authentication: none
external_callback: false
affected_versions: vBulletin before 5.5.6pl1, 5.6.0 before 5.6.0pl1, and 5.6.1 before 5.6.1pl1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
vBulletin versions before 5.5.6pl1, 5.6.0 prior to 5.6.0pl1, and 5.6.1 prior to 5.6.1pl1 suffer from incorrect access control in the `/ajax/api/content_infraction/getIndexableContent` AJAX endpoint, permitting unauthenticated SQL injection attacks.  
**Impact:** Successful exploitation leads to unauthorized access, data leakage, and potential compromise of the underlying system.  
**CVSS:** 3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)  
**CWE:** CWE-306 (Missing Authentication for Critical Function)  
**CPE:** cpe:2.3:a:vbulletin:vbulletin:*:*:*:*:*:*:*:*  
**Remediation:** Apply the latest security patch or upgrade to a non-vulnerable version.

## PoC / Detection
Classification: info-leak

The template sends a single unauthenticated POST request to `/ajax/api/content_infraction/getIndexableContent` with a crafted `nodeId[nodeid]` parameter containing the UNION SELECT payload `1 union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,CONCAT('vbulletin','rce',@@version),19,20,21,22,23,24,25,26,27` and matches the string "vbulletinrce" in the response body to confirm the injection and successful exfiltration of database version information.

## References
- https://github.com/rekter0/exploits/tree/master/CVE-2020-12720
- https://nvd.nist.gov/vuln/detail/CVE-2020-12720
- https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4440032-vbulletin-5-6-1-security-patch-level-1
- http://packetstormsecurity.com/files/157716/vBulletin-5.6.1-SQL-Injection.html
- http://packetstormsecurity.com/files/157904/vBulletin-5.6.1-SQL-Injection.html
