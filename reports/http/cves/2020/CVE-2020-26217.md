---
cve_id: CVE-2020-26217
template_path: nuclei-templates/http/cves/2020/CVE-2020-26217.yaml
affected_product: XStream
severity: high
authentication: none
external_callback: true
affected_versions: <1.4.14
preconditions: [processes untrusted XML input using XStream (relies on blocklists)]
poc_classification: rce
---

## Vulnerability
XStream before 1.4.14 is susceptible to remote code execution. An attacker can run arbitrary shell commands by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site. Users who rely on blocklists are affected.

**Impact:** Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system.  
**Remediation:** Fixed in 1.4.14.  
**CVSS:** CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8)  
**CWE:** CWE-78

## PoC / Detection
Classification: rce

The template sends a single POST request to `/` with Content-Type `application/xml` containing a malicious deserialization gadget chain (`jdk.nashorn.internal.objects.NativeString` → `com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data` → `javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator` → `javax.imageio.spi.FilterIterator` wrapping `java.lang.ProcessBuilder` with command `curl http://{{interactsh-url}}`). Detection occurs via OOB matching on the resulting HTTP callback: `interactsh_protocol` contains "http" and `interactsh_request` contains "User-Agent: curl".

## References
- https://x-stream.github.io/CVE-2020-26217.html
- https://github.com/x-stream/xstream/commit/0fec095d534126931c99fd38e9c6d41f5c685c1a
- https://github.com/x-stream/xstream/security/advisories/GHSA-mw36-7c6c-q4q2
- https://nvd.nist.gov/vuln/detail/cve-2020-26217
- https://lists.apache.org/thread.html/r2de526726e7f4db4a7cb91b7355070779f51a84fd985c6529c2f4e9e@%3Cissues.activemq.apache.org%3E
