---
cve_id: CVE-2020-13945
template_path: nuclei-templates/http/cves/2020/CVE-2020-13945.yaml
affected_product: Apache APISIX
severity: medium
authentication: required
external_callback: false
affected_versions: 1.2, 1.3, 1.4, and 1.5
preconditions: ['Admin API enabled', 'default token accepted (IP restrictions absent or removable)']
poc_classification: rce
---

## Vulnerability
Apache APISIX 1.2, 1.3, 1.4, and 1.5 is susceptible to insufficiently protected credentials. An attacker can enable the Admin API and delete the Admin API access IP restriction rules. Eventually, the default token is allowed to access APISIX management data.

The vulnerability could result in unauthorized access to sensitive information, leading to potential data breaches or unauthorized actions. Template patterns reveal that management access permits creation of routes embedding arbitrary Lua scripts, enabling full remote code execution.

## PoC / Detection
Classification: rce

The template verifies the vulnerability with a two-step raw HTTP sequence using the hardcoded default admin token `edd1c9f034335f136f87ad84b625c8f1`:

- POST `/apisix/admin/routes` registers a route containing a Lua `script` that defines `_M.access` to execute `io.popen(args.cmd)` on the `cmd` query argument and return the output via `ngx.say`.
- GET `/{{randstr}}?cmd=id` triggers the script on the newly created route.

Matchers require 201 status plus JSON fields `action:create` and `script` in the creation response; extractors confirm successful RCE by matching `uid=` / `gid=` patterns in the command output.

## References
- https://github.com/vulhub/vulhub/tree/master/apisix/CVE-2020-13945
- https://lists.apache.org/thread.html/r792feb29964067a4108f53e8579a1e9bd1c8b5b9bc95618c814faf2f%40%3Cdev.apisix.apache.org%3E
- http://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-13945
- https://github.com/ARPSyndicate/cvemon
