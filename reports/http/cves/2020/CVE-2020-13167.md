---
cve_id: CVE-2020-13167
template_path: nuclei-templates/http/cves/2020/CVE-2020-13167.yaml
affected_product: Netsweeper
severity: critical
authentication: none
external_callback: false
affected_versions: <=6.4.3
preconditions: []
poc_classification: rce
---

## Vulnerability
Netsweeper through 6.4.3 allows unauthenticated remote code execution because webadmin/tools/unixlogin.php (with certain Referer headers) launches a command line with client-supplied parameters, and allows injection of shell metacharacters.

Successful exploitation of this vulnerability can lead to remote code execution, compromising the affected system.

Remediation: Upgrade to a patched version of Netsweeper (>=6.4.4).

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (score 9.8), CWE-78.

## PoC / Detection
Classification: rce

The template detects the vulnerability by performing actual exploitation: it issues a GET request to `/webadmin/tools/unixlogin.php?login=admin&password=<Python injection payload>&timeout=5` (payload hex-encodes `echo "{{base64(rand_str)}}" | base64 -d > /usr/local/netsweeper/webadmin/out` inside `';import os;os.system(...).decode("hex")#`) with Referer header `{{BaseURL}}/webadmin/admin/service_manager_data.php`. A follow-up GET to `/webadmin/out` then matches the random string in the response body (status 200) to confirm successful code execution.

## References
- https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/
- https://portswigger.net/daily-swig/severe-rce-vulnerability-in-content-filtering-system-has-been-patched-netsweeper-says
- https://nvd.nist.gov/vuln/detail/CVE-2020-13167
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Elsfa7-110/kenzer-templates
