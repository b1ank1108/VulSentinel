---
cve_id: CVE-2020-2036
template_path: nuclei-templates/http/cves/2020/CVE-2020-2036.yaml
affected_product: Palo Alto Networks PAN-OS Web Interface
severity: high
authentication: none
external_callback: false
affected_versions: PAN-OS 8.1 versions earlier than PAN-OS 8.1.16; PAN-OS 9.0 versions earlier than PAN-OS 9.0.9
preconditions: Administrator with an active authenticated session must be tricked into clicking a crafted link
poc_classification: state-change
---

## Vulnerability
PAN-OS management web interface is vulnerable to reflected cross-site scripting (XSS). A remote attacker able to convince an administrator with an active authenticated session on the firewall management interface to click on a crafted link could execute arbitrary JavaScript code in the administrator's browser and perform administrative actions. CVSS 8.8 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H). Successful exploitation enables session hijacking, defacement, or theft of sensitive information. Remediation requires applying the latest security patches.

## PoC / Detection
Classification: state-change

The template first issues a GET to `/global-protect/login.esp` and internally matches for the strings "GlobalProtect" or "gp_portal" in the response body to fingerprint a PAN-OS instance. It then sends three GET requests embedding the reflected XSS payload `"><svg/onload=alert(document.domain)>` to the paths `/_404_/`, `/unauth/php/change_password.php/`, and `/php/change_password.php/`. Detection triggers when the payload appears unsanitized in the HTML body (status 200, text/html content-type) of the second or third response while being absent from the first.

## References
- https://swarm.ptsecurity.com/swarm-of-palo-alto-pan-os-vulnerabilities/
- https://security.paloaltonetworks.com/CVE-2020-2036
- https://nvd.nist.gov/vuln/detail/CVE-2020-2036
- https://github.com/404notf0und/CVE-Flow
- https://github.com/ARPSyndicate/kenzer-templates
