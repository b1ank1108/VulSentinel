---
cve_id: CVE-2020-15415
template_path: nuclei-templates/http/cves/2020/CVE-2020-15415.yaml
affected_product: DrayTek Vigor
severity: critical
authentication: none
external_callback: false
affected_versions: unknown
preconditions: []
poc_classification: rce
---

## Vulnerability
DrayTek Vigor devices contain a command injection vulnerability in the cvmcfgupload functionality. The vulnerability allows remote attackers to execute arbitrary commands through specially crafted requests to the /cgi-bin/mainfunction.cgi/cvmcfgupload endpoint. Unauthenticated attackers can execute arbitrary system commands on the device, leading to complete device compromise and potential network infiltration (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, CWE-78).

## PoC / Detection
Classification: rce
The template sends a single raw POST request to `/cgi-bin/mainfunction.cgi/cvmcfgupload?1=2` using multipart/form-data with boundary `----WebKitFormBoundary`. The form-data field `abc` uses filename `t';id;echo '1_"` to inject and execute the `id` command. It verifies success by matching regex `uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)` in the body, presence of `DWS` in headers, and HTTP status 200.

## References
- https://github.com/CLP-team/Vigor-Commond-Injection
- https://nvd.nist.gov/vuln/detail/CVE-2020-15415
