---
cve_id: CVE-2020-24949
template_path: nuclei-templates/http/cves/2020/CVE-2020-24949.yaml
affected_product: PHP-Fusion
severity: high
authentication: required
external_callback: false
affected_versions: 9.03.50
preconditions: [authenticated as non-admin user]
poc_classification: rce
---

## Vulnerability
PHP-Fusion 9.03.50 contains a command injection vulnerability (CWE-77) in infusions/downloads/downloads.php. An authenticated non-admin user can submit a crafted `cat_id` parameter containing `${system(command)}` syntax to achieve arbitrary command execution on the server.

Impact: successful exploitation allows arbitrary code execution, potentially leading to full system compromise.  
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (score 8.8).  
Remediation: apply the latest security patch or upgrade to a non-vulnerable version.

## PoC / Detection
Classification: rce

The template issues a single GET request to `{{BaseURL}}/infusions/downloads/downloads.php?cat_id=${system(ls)}` to inject the `ls` command. It verifies exploitation by checking for HTTP status 200 and the presence of the string "infusion_db.php" in the response body (expected output of the injected directory listing).

## References
- https://packetstormsecurity.com/files/162852/phpfusion90350-exec.txt
- https://github.com/php-fusion/PHP-Fusion/issues/2312
- http://packetstormsecurity.com/files/162852/PHPFusion-9.03.50-Remote-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-24949
- https://github.com/404notf0und/CVE-Flow
