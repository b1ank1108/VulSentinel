---
cve_id: CVE-2020-15227
template_path: nuclei-templates/http/cves/2020/CVE-2020-15227.yaml
affected_product: Nette Framework
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.0.19, 2.1.x < 2.1.13, 2.2.x < 2.2.10, 2.3.x < 2.3.14, 2.4.x < 2.4.16, 3.0.x < 3.0.6
preconditions: []
poc_classification: rce
---

## Vulnerability

Nette Framework versions before 2.0.19, 2.1.13, 2.2.10, 2.3.14, 2.4.16, and 3.0.6 contain a critical code injection vulnerability (CWE-94, CWE-74). The vulnerability allows remote attackers to execute arbitrary code through specially crafted parameters passed to a URL. This is a PHP/Composer MVC Framework vulnerability that requires no authentication and can be exploited remotely over the network with low attack complexity.

The CVSS v3.1 score is 9.8 (Critical) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H, indicating network-based exploitation with no privileges required, no user interaction needed, and high impact to confidentiality, integrity, and availability. The EPSS score of 0.93793 (99.852nd percentile) indicates this vulnerability is actively exploited in the wild.

## PoC / Detection

Classification: rce

The template detects this remote code execution vulnerability by sending a GET request to `/nette.micro/?callback=phpcredits` at the target's base URL. The `callback` parameter is set to `phpcredits`, which is a PHP function that displays PHP credits information. 

The detection logic verifies exploitation by checking for two conditions:
1. The response body contains the string "PHP Credits" (indicating the `phpcredits()` function was executed)
2. The response headers contain "Nette Framework" (confirming the target is running Nette)

This demonstrates that arbitrary PHP functions can be invoked through the callback parameter, proving the code injection vulnerability exists. While the template uses a benign function (`phpcredits`) for detection, the underlying vulnerability allows execution of arbitrary PHP code.

## References

- https://github.com/nette/application/security/advisories/GHSA-8gv3-3j7f-wg94
- https://github.com/Mr-xn/Penetration_Testing_POC/blob/02546075f378a9effeb6426fc17beb66b6d5c8ee/books/Nette%E6%A1%86%E6%9E%B6%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2020-15227).md
- https://nvd.nist.gov/vuln/detail/CVE-2020-15227
- https://lists.debian.org/debian-lts-announce/2021/04/msg00003.html
- https://packagist.org/packages/nette/application
