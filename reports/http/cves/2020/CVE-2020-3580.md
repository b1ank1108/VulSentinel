---
cve_id: CVE-2020-3580
template_path: nuclei-templates/http/cves/2020/CVE-2020-3580.yaml
affected_product: Cisco ASA/FTD Software
severity: medium
authentication: none
external_callback: false
affected_versions: unknown
preconditions: specific AnyConnect and WebVPN configurations
poc_classification: info-leak
---

## Vulnerability
Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software web services interface is vulnerable to cross-site scripting due to insufficient validation of user-supplied input. An unauthenticated remote attacker can exploit this by persuading a user of the interface to click a crafted link. Successful exploitation allows execution of arbitrary script code in the context of the interface or access to sensitive browser-based information. Affects only specific AnyConnect and WebVPN configurations. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N (6.1).

## PoC / Detection
Classification: info-leak

The template issues a single raw POST request to `/+CSCOE+/saml/sp/acs?tgname=a` containing a crafted `SAMLResponse` parameter with the reflected payload `"><svg/onload=alert(/{{randstr}}/)>`. Detection succeeds when the response body contains the exact unescaped payload string, the `Content-Type` header includes `text/html`, and the status code is 200.

## References
- https://twitter.com/ptswarm/status/1408050644460650502
- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-xss-multiple-FCB3vPZe
- https://nvd.nist.gov/vuln/detail/CVE-2020-3580
- https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors
- https://github.com/r0eXpeR/supplier
