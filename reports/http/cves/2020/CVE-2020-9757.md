---
cve_id: CVE-2020-9757
template_path: nuclei-templates/http/cves/2020/CVE-2020-9757.yaml
affected_product: Craft CMS
severity: critical
authentication: none
external_callback: false
affected_versions: < 3.3.0
preconditions: SEOmatic component installed
poc_classification: rce
---

## Vulnerability
Craft CMS before 3.3.0 is vulnerable to server-side template injection (SSTI) via the SEOmatic component in the metacontainers controller. Malformed data submitted to the endpoint allows full remote code execution.  
Unauthenticated remote attack (PR:N). CVSS 3.1 score 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-74. Successful exploitation yields arbitrary code execution on the server.  
Remediation: upgrade to Craft CMS 3.3.0 or higher.

## PoC / Detection
Classification: rce

The template issues two unauthenticated GET requests to `/actions/seomatic/meta-container/meta-link-container/?uri={{228*'98'}}` and `/actions/seomatic/meta-container/all-meta-containers?uri={{228*'98'}}`. It verifies exploitation by checking for HTTP 200 and the simultaneous presence of the strings "MetaLinkContainer", "canonical", and "22344" (the evaluated result of the Twig math payload) in the response body.

## References
- https://github.com/nystudio107/craft-seomatic/blob/v3/CHANGELOG.md
- https://github.com/giany/CVE/blob/master/CVE-2020-9757.txt
- https://github.com/nystudio107/craft-seomatic/commit/65ab659cb6c914c7ad671af1e417c0da2431f79b
- https://github.com/nystudio107/craft-seomatic/commit/a1c2cad7e126132d2442ec8ec8e9ab43df02cc0f
- https://nvd.nist.gov/vuln/detail/CVE-2020-9757
