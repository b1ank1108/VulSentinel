---
cve_id: CVE-2020-7943
template_path: nuclei-templates/http/cves/2020/CVE-2020-7943.yaml
affected_product: Puppet Server/PuppetDB
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: [metrics API endpoint exposed and accessible]
poc_classification: info-leak
---

## Vulnerability

CVE-2020-7943 is a sensitive information disclosure vulnerability affecting Puppet Server and PuppetDB. The vulnerability stems from exposed metrics API endpoints (`/metrics/v1/mbeans`) that provide performance and debugging information. When these endpoints are left accessible without proper access controls (CWE-276: Incorrect Default Permissions), they can leak sensitive information to unauthorized actors. The CVSS score of 7.5 (High) reflects the ease of exploitation (network-accessible, low complexity, no privileges or user interaction required) and the high confidentiality impact, though there is no integrity or availability impact.

The metrics API endpoints are designed for operational monitoring but may inadvertently expose sensitive configuration details, internal system information, or other data that could aid attackers in reconnaissance or further exploitation of the Puppet infrastructure.

## PoC / Detection

Classification: info-leak

The Nuclei template detects this vulnerability by sending a GET request to the `/metrics/v1/mbeans` endpoint. The template verifies the presence of the vulnerability through three conditions:

1. The response body contains the string "trapperkeeper" (a Clojure framework used by Puppet Server)
2. The response header indicates `application/json` content type
3. The HTTP status code is 200 (successful response)

This detection confirms that the metrics API endpoint is publicly accessible and returning operational data, indicating the information disclosure vulnerability is present. The template performs a non-invasive check that simply accesses the endpoint without attempting to extract or exfiltrate specific sensitive data.

## References

- https://puppet.com/security/cve/CVE-2020-7943
- https://tickets.puppetlabs.com/browse/PDB-4876
- https://puppet.com/security/cve/CVE-2020-7943/
- https://nvd.nist.gov/vuln/detail/CVE-2020-7943
- https://github.com/ARPSyndicate/cvemon
