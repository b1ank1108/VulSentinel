---
cve_id: CVE-2020-8193
template_path: nuclei-templates/http/cves/2020/CVE-2020-8193.yaml
affected_product: Citrix ADC and Citrix Gateway
severity: medium
authentication: none
external_callback: false
affected_versions: Citrix ADC and Gateway < 13.0-58.30, < 12.1-57.18, < 12.0-63.21, < 11.1-64.14, < 10.5-70.18; Citrix SDWAN WAN-OP < 11.1.1a, < 11.0.3d, < 10.2.7
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2020-8193 is a local file inclusion (LFI) vulnerability affecting multiple Citrix products including ADC, Gateway, and SDWAN WAN-OP. The vulnerability allows unauthenticated attackers to access certain URL endpoints that should be restricted, enabling them to read arbitrary files from the server's filesystem. This is caused by improper access controls (CWE-284) and authentication issues (CWE-287) in the affected versions.

The vulnerability has a CVSS score of 6.5 (Medium severity) with the vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N, indicating it is exploitable remotely without authentication, with low attack complexity, and can result in low confidentiality and integrity impact. The EPSS score of 0.94177 (99.914th percentile) indicates this vulnerability is highly likely to be exploited in the wild. It is also listed in CISA's Known Exploited Vulnerabilities (KEV) catalog.

An attacker can leverage this vulnerability to access sensitive information stored on the server, including configuration files, credentials, and other system files, potentially leading to further exploitation or unauthorized access to the infrastructure.

## PoC / Detection

Classification: info-leak

The template performs a multi-step exploitation sequence to detect and verify the local file inclusion vulnerability:

1. **Initial Setup Request**: Sends a POST request to `/pcidss/report` with XML payload containing an appfwprofile element, using custom X-NITRO-USER and X-NITRO-PASS headers to establish a session context.

2. **Session Manipulation**: Makes three GET requests to `/menu/ss`, `/menu/neo`, and `/menu/stc` endpoints with session parameters (sid=nsroot, username=nsroot) to manipulate the session state and prepare for exploitation.

3. **Dynamic Key Extraction**: Sends another POST request to `/pcidss/report` and extracts a random key value from the response body using regex pattern `[0-9]{3,10}\.[0-9]+`. This key is stored as a dynamic variable for subsequent requests.

4. **File Disclosure**: Executes a POST request to `/rapi/filedownload?filter=path:%2Fetc%2Fpasswd` (URL-encoded path to `/etc/passwd`) with the extracted random key, attempting to download the system password file.

5. **Verification**: Confirms successful exploitation by matching the response body against the regex pattern `root:.*:0:0:`, which identifies the root user entry in Unix/Linux password files.

The template successfully detects the vulnerability when it can retrieve and read the contents of `/etc/passwd`, demonstrating unauthorized file access.

## References

- https://github.com/jas502n/CVE-2020-8193
- http://packetstormsecurity.com/files/160047/Citrix-ADC-NetScaler-Local-File-Inclusion.html
- https://support.citrix.com/article/CTX276688
- https://nvd.nist.gov/vuln/detail/CVE-2020-8193
- https://github.com/0ps/pocassistdb
