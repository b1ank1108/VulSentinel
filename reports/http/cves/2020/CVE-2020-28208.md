---
cve_id: CVE-2020-28208
template_path: nuclei-templates/http/cves/2020/CVE-2020-28208.yaml
affected_product: Rocket.Chat
severity: medium
authentication: none
external_callback: false
affected_versions: <3.9.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Rocket.Chat versions prior to 3.9.1 expose an information disclosure flaw via the password reset endpoint. An unauthenticated remote attacker can enumerate valid user email addresses by interacting with the anonymous method `sendForgotPasswordEmail`. This leakage enables further attacks including targeted phishing, credential stuffing, account takeover, or unauthorized data access/modification.  

**CVSS 3.1**: 5.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)  
**CWE**: 203 (Observable Response Discrepancy)  
**Impact**: Exposure of sensitive user data (email addresses) that can lead to confidentiality breaches and downstream compromise.  
**Remediation**: Upgrade to Rocket.Chat 3.9.1 or later.

## PoC / Detection
Classification: info-leak  

The template issues a single unauthenticated POST request to `/api/v1/method.callAnon/sendForgotPasswordEmail` containing the JSON-RPC payload `{"msg":"method","method":"sendForgotPasswordEmail","params":["user@local.email"],"id":"3"}`. Detection succeeds when the server returns HTTP 200 with body containing both `"result":false` and `"success":true`, confirming the endpoint processes the reset request and thereby reveals the presence of the email-enumeration behavior.

## References
- https://trovent.io/security-advisory-2010-01
- https://trovent.github.io/security-advisories/TRSA-2010-01/TRSA-2010-01.txt
- http://www.openwall.com/lists/oss-security/2021/01/07/1
- http://packetstormsecurity.com/files/160845/Rocket.Chat-3.7.1-Email-Address-Enumeration.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-28208
