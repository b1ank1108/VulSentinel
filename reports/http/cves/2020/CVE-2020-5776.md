---
cve_id: CVE-2020-5776
template_path: nuclei-templates/http/cves/2020/CVE-2020-5776.yaml
affected_product: MAGMI
severity: high
authentication: none
external_callback: false
affected_versions: unknown
preconditions: requires existing authenticated admin session
poc_classification: rce
---

## Vulnerability
MAGMI (Magento Mass Importer) suffers from a Cross-Site Request Forgery (CSRF, CWE-352) vulnerability due to missing anti-CSRF tokens in its profile management and import execution endpoints. An attacker can forge requests to save malicious profiles and trigger reindexing. When leveraged against an existing authenticated admin session, this enables arbitrary command execution via the `REINDEX:phpcli` parameter, resulting in full remote code execution.  
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (8.8)

## PoC / Detection
Classification: rce

The template executes a 3-request chain simulating full exploitation:  
- POST to `/magmi/web/magmi_saveprofile.php` with form data that sets a remote CSV import and `REINDEX:phpcli=echo "<?php phpinfo(); ?>" > /var/www/html/magmi/web/info.php; php` to write and execute a PHP info file.  
- POST to `/magmi/web/magmi_run.php` (engine=magmi_productimportengine, profile=default) to trigger the import and reindex, executing the injected command.  
- GET `/magmi/web/info.php` matching both "PHP Extension" and "PHP Version" strings under 200 status to confirm successful RCE and file creation.

## References
- https://www.tenable.com/security/research/tra-2020-51
- https://nvd.nist.gov/vuln/detail/CVE-2020-5776
- https://github.com/sobinge/nuclei-templates
- https://github.com/404notf0und/CVE-Flow
- https://github.com/ARPSyndicate/cvemon
