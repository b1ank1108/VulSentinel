---
cve_id: CVE-2011-3600
template_path: nuclei-templates/http/cves/2011/CVE-2011-3600.yaml
affected_product: Apache OFBiz
severity: high
authentication: none
external_callback: false
affected_versions: 16.11.01 to 16.11.04
preconditions: []
poc_classification: info-leak
---

## Vulnerability
The /webtools/control/xmlrpc endpoint in the OFBiz XML-RPC event handler allows XML External Entity Injection (XXE) through crafted DOCTYPE declarations containing executable external entities. This enables disclosure of arbitrary filesystem contents (e.g., /etc/passwd), probing of internal network ports via entity resolution, and determination of file existence based on error responses.  
Impact: Sensitive filesystem data exposure, internal port scanning, and file-existence oracle, enabling information disclosure and further exploitation chains.  
Remediation: Update to the latest OFBiz version or apply patches that mitigate XXE in the XML-RPC handler.  
Classification: CWE-611, CVE-2011-3600, CVSS 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N).

## PoC / Detection
Classification: info-leak  
The template issues a single raw POST request to `/webtools/control/xmlrpc` containing the XML payload `<?xml version="1.0"?><!DOCTYPE x [<!ENTITY disclose SYSTEM "file:////etc/passwd">]><methodCall><methodName>&disclose;</methodName></methodCall>`. Detection succeeds if the 200 OK response body simultaneously matches the regex `root:.*:0:0:` (indicating successful entity resolution and file read) and contains the string `faultString`.

## References
- https://lists.apache.org/thread/cwz2v0b6pnxvqrnsd0hj3l80g9qq5kd8
- https://nvd.nist.gov/vuln/detail/CVE-2011-3600
