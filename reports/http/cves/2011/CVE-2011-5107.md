---
cve_id: CVE-2011-5107
template_path: nuclei-templates/http/cves/2011/CVE-2011-5107.yaml
affected_product: WordPress Alert Before Your Post plugin
severity: medium
authentication: none
external_callback: false
affected_versions: <= 0.1.1
preconditions: []
poc_classification: info-leak
---

## Vulnerability

CVE-2011-5107 is a reflected cross-site scripting (XSS) vulnerability in the Alert Before Your Post plugin for WordPress, affecting versions 0.1.1 and earlier. The vulnerability exists in the `post_alert.php` file, which fails to properly sanitize the `name` parameter before reflecting it in the HTTP response. Remote attackers can exploit this flaw by crafting malicious URLs containing JavaScript code in the `name` parameter, which will be executed in the context of a victim's browser when they visit the malicious link. This can lead to session hijacking, website defacement, or theft of sensitive information such as authentication cookies. The vulnerability is classified as CWE-79 (Improper Neutralization of Input During Web Page Generation) with a CVSS v2.0 score of 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N), indicating network-based exploitation with medium attack complexity requiring no authentication.

## PoC / Detection

Classification: info-leak

The Nuclei template performs a two-step detection process:

1. **Plugin Detection**: Sends a GET request to the WordPress site's base URL and checks for the presence of the string `/wp-content/plugins/alert-before-your-post/` in the response, confirming the plugin is installed.

2. **XSS Verification**: If the plugin is detected, sends a second GET request to `/wp-content/plugins/alert-before-your-post/trunk/post_alert.php` with a crafted `name` parameter containing the payload `</script><script>alert(document.domain)</script>`. The template verifies the vulnerability by checking for:
   - The reflected XSS payload in the response body
   - A `text/html` content-type header
   - HTTP status code 200

The template uses a non-destructive proof-of-concept that demonstrates the XSS vulnerability by attempting to execute `alert(document.domain)`, which would display the current domain in a browser alert box if successfully exploited.

## References

- https://nvd.nist.gov/vuln/detail/CVE-2011-5107 https://www.acunetix.com/vulnerabilities/web/wordpress-plugin-alert-before-your-post-cross-site-scripting-0-1-1/
- https://exchange.xforce.ibmcloud.com/vulnerabilities/71413
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/d4n-sec/d4n-sec.github.io
