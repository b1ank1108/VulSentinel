---
cve_id: CVE-2011-0049
template_path: nuclei-templates/http/cves/2011/CVE-2011-0049.yaml
affected_product: Majordomo2
severity: medium
authentication: none
external_callback: false
affected_versions: Majordomo 2 before 20110131
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Majordomo2 contains a directory traversal flaw (CVE-2011-0049, CWE-22) in the `_list_file_get` function of `lib/Majordomo.pm`. Remote unauthenticated attackers can read arbitrary files by supplying `..` sequences in the `help` command. The issue is reachable both via SMTP (crafted email) and the HTTP web interface (`cgi-bin/mj_wwwusr`). CVSS 2.0 score is 5.0 (AV:N/AC:L/Au:N/C:P/I:N/A:N). Impact includes unauthorized disclosure of sensitive server files such as `/etc/passwd`. Remediation requires upgrading to Majordomo 2 20110131 or newer.

## PoC / Detection
Classification: info-leak

The template issues a single unauthenticated GET request to `{{BaseURL}}/cgi-bin/mj_wwwusr?passw=&list=GLOBAL&user=&func=help&extra=/../../../../../../../../etc/passwd`, then asserts HTTP 200 status and presence of the regex `root:.*:0:0:` in the response body to confirm traversal succeeded and `/etc/passwd` was returned.

## References
- https://www.exploit-db.com/exploits/16103
- https://nvd.nist.gov/vuln/detail/CVE-2011-0063
- http://www.kb.cert.org/vuls/id/363726
- https://bug628064.bugzilla.mozilla.org/attachment.cgi?id=506481
- http://securityreason.com/securityalert/8061
