---
cve_id: CVE-2026-21859
template_path: nuclei-templates/http/cves/2026/CVE-2026-21859.yaml
affected_product: Mailpit
severity: high
authentication: none
external_callback: false
affected_versions: <= 1.28.0
preconditions: []
poc_classification: info-leak
---
# CVE-2026-21859

## Vulnerability

Mailpit versions 1.28.0 and earlier contain a server-side request forgery (SSRF) vulnerability in the `/proxy` endpoint due to insufficient validation of internal IP addresses. An unauthenticated remote attacker can craft HTTP GET requests to make the Mailpit server perform arbitrary HTTP requests to internal network resources, including localhost-bound services. The flaw is classified as CWE-918 (Server-Side Request Forgery). Impact includes access to internal APIs, metadata endpoints, admin interfaces, cloud metadata services, or other resources reachable from the Mailpit server that would otherwise be inaccessible from the public internet. CVSS 3.1 vector: AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N (score 8.6).

## PoC / Detection

Classification: info-leak

The template detects the vulnerability by sending a single unauthenticated GET request to `/proxy?url=http://127.0.0.1:8025/api/v1/info`. Exploitation is confirmed if the response meets all of the following conditions simultaneously:

- HTTP status code 200
- Content-Type header contains `application/json`
- Response body contains the JSON keys `"Version"`, `"Database"`, and `"RuntimeStats"` (characteristic internal Mailpit API response fields)

Successful detection indicates the `/proxy` endpoint forwards the request to localhost:8025 (Mailpit's own API) and returns the internal response to the attacker, proving the SSRF condition exists and internal network access is possible.

## References

- https://rosecurify.com/advisories/RO-26-001-mailpit-server-side-request-forgery-ssrf/
- https://github.com/axllent/mailpit/security/advisories/GHSA-8v65-47jx-7mfr
