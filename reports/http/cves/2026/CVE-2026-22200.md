---
cve_id: CVE-2026-22200
template_path: nuclei-templates/http/cves/2026/CVE-2026-22200.yaml
severity: high
auth_requirement: none
oast_required: false
version_constraints: unknown
feature_gates: [guests may create tickets and access ticket status, or self-registration is enabled]
---
# CVE-2026-22200

- template_path: `nuclei-templates/http/cves/2026/CVE-2026-22200.yaml`
## Signals
- severity: high
- auth_requirement: none
- oast_required: false
- version_constraints: unknown
- feature_gates: [guests may create tickets and access ticket status, or self-registration is enabled]

## Vulnerability
Arbitrary file read (local file disclosure) via insufficient sanitization of rich-text HTML in ticket messages, exploited through PHP filter expressions embedded in image tags (srcset / img) that get processed by mPDF during ticket PDF export. The vulnerability allows embedding server filesystem file contents as bitmap images in the generated PDF, readable by the attacker who controls the export.

The template detects the presence of the vulnerable behavior pattern rather than reading arbitrary files.

## PoC / Detection
Classification: active-detect

The template performs a two-step non-intrusive check:
1. GET /open.php → extracts topicId and CSRF token (fingerprinting / setup)
2. POST /open.php → submits a crafted ticket containing an `<img>` tag with a `srcset` attribute pointing to non-existent attacker-controlled domains (PATCH_DETECT_*.example.com)

Matcher looks for HTTP 200 + echo of the attacker-controlled srcset URLs in the response body.

This probes whether the application reflects unsanitized user-supplied HTML attributes without triggering any file read, code execution, or persistent state change. No real file disclosure or exfiltration occurs in the template.

## References
- https://horizon3.ai/attack-research/attack-blogs/ticket-to-shell-exploiting-php-filters-and-cnext-in-osticket-cve-2026-22200/
- https://github.com/horizon3ai/CVE-2026-22200/blob/main/check.py
- https://nvd.nist.gov/vuln/detail/CVE-2026-22200
