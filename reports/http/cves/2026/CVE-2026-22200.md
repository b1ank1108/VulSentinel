---
cve_id: CVE-2026-22200
template_path: nuclei-templates/http/cves/2026/CVE-2026-22200.yaml
affected_product: osTicket
severity: high
authentication: none
external_callback: false
affected_versions: 1.18.x prior to 1.18.3 and 1.17.x prior to 1.17.7
preconditions: guests may create tickets and access ticket status (default), or self-registration enabled
poc_classification: info-leak
---

## Vulnerability
Enhancesoft osTicket versions 1.18.x prior to 1.18.3 and 1.17.x prior to 1.17.7 contain an arbitrary file read vulnerability in the ticket PDF export functionality. A remote attacker can submit a ticket containing crafted rich-text HTML that includes PHP filter expressions which are insufficiently sanitized before being processed by the mPDF PDF generator during export. When the attacker exports the ticket to PDF, the generated PDF can embed the contents of attacker-selected files from the server filesystem as bitmap images, allowing disclosure of sensitive local files in the context of the osTicket application user. This issue is exploitable in default configurations.

## PoC / Detection
Classification: info-leak

The template performs a two-step HTTP flow to detect the vulnerable ticket submission path. It first issues `GET /open.php` and uses regex extractors to capture `topic_id` (from `<option value>` or `topicId` fields) and `__CSRFToken__` (from hidden input fields). It then issues `POST /open.php` with `application/x-www-form-urlencoded` data simulating a guest ticket creation (`a=open`, subject, name, and a `message` containing an `<img>` element whose `srcset` attribute includes multiple `http://PATCH_DETECT_7f3a9b2e.example.com/...` URLs). The matcher verifies `status_code == 200` and that the response body contains both `srcset` and the PATCH_DETECT domain string. This confirms unsanitized rich-text HTML processing in ticket creation (the prerequisite for triggering LFI during subsequent PDF export).

## References
- https://horizon3.ai/attack-research/attack-blogs/ticket-to-shell-exploiting-php-filters-and-cnext-in-osticket-cve-2026-22200/
- https://github.com/horizon3ai/CVE-2026-22200/blob/main/check.py
- https://nvd.nist.gov/vuln/detail/CVE-2026-22200
