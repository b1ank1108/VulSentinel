---
cve_id: CVE-2026-22200
template_path: nuclei-templates/http/cves/2026/CVE-2026-22200.yaml
affected_product: osTicket
severity: high
authentication: none
external_callback: false
affected_versions: 1.18.x prior to 1.18.3 and 1.17.x prior to 1.17.7
preconditions: ["guests may create tickets and access ticket status", "or self-registration is enabled"]
poc_classification: info-leak
---
# CVE-2026-22200

## Vulnerability

osTicket contains an arbitrary file read (local file inclusion) vulnerability in the ticket PDF export functionality using mPDF. A remote attacker can inject specially crafted rich-text HTML (via PHP filter wrappers such as `php://filter`) into a ticket's message field. When the ticket is later exported to PDF by any user (including the attacker themselves), mPDF processes the unsanitized filter expressions and embeds the contents of arbitrary server-side files as embedded bitmap images in the generated PDF. This allows disclosure of sensitive local files readable by the osTicket application user (typically the web server user).

The flaw is exploitable without authentication in default configurations that allow guest ticket creation.

## PoC / Detection
Classification: info-leak

The template performs a non-destructive detection check for the underlying vulnerability condition rather than attempting full file exfiltration:

1. Sends a GET request to `/open.php` to extract a valid `topicId` (department/category) and `__CSRFToken__` value from the public ticket submission form.
2. Submits a crafted POST to `/open.php` creating a ticket with a benign-looking `<img>` tag containing a `srcset` attribute that includes the placeholder domain `http://PATCH_DETECT_7f3a9b2e.example.com`.
3. Checks whether the server echoes back the exact crafted `srcset` URL verbatim in the response body (status 200 + contains `srcset` and the placeholder domain).

Successful reflection of the unmodified `srcset` value indicates insufficient sanitization/filtering of rich-text HTML attributes before they reach the mPDF PDF rendering engine â€” the precondition required for the PHP filter-based file read to succeed during actual PDF export.

The template does **not** attempt to read files, inject real PHP filters (e.g. `php://filter/convert.base64-encode/resource=...`), trigger PDF generation, or exfiltrate file contents.

## References

- https://horizon3.ai/attack-research/attack-blogs/ticket-to-shell-exploiting-php-filters-and-cnext-in-osticket-cve-2026-22200/
- https://github.com/horizon3ai/CVE-2026-22200/blob/main/check.py
- https://nvd.nist.gov/vuln/detail/CVE-2026-22200
