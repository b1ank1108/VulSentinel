---
cve_id: CVE-2026-22812
template_path: nuclei-templates/http/cves/2026/CVE-2026-22812.yaml
affected_product: OpenCode
severity: high
authentication: none
external_callback: false
affected_versions: < 1.0.216
preconditions: []
poc_classification: rce
---

## Vulnerability
OpenCode versions prior to 1.0.216 contain an unauthenticated remote code execution vulnerability. The application exposes session creation and shell execution endpoints without proper authentication, allowing remote attackers to create sessions and execute arbitrary shell commands on the underlying server.

CVSS v3.1: 8.8 (High) â€“ AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H.  
CWE-306 (Missing Authentication for Critical Function).  
Impact: full system compromise via arbitrary command execution.

## PoC / Detection
Classification: rce

The template performs a two-request flow to detect the RCE:  
1. POST /session with empty JSON `{}` to obtain a session_id (matches on 200 + JSON body containing "id").  
2. POST /session/{{session_id}}/shell with `{"agent":"build","command":"id"}` and verifies success by matching UID/GID regex (e.g. `uid=\d+\([^)]+\) gid=\d+\([^)]+\)`) in the response body (status 200/201/202).

## References
- https://github.com/rohmatariow/CVE-2026-22812-exploit
- https://nvd.nist.gov/vuln/detail/CVE-2026-22812
