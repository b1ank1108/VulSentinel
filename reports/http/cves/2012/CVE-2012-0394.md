---
cve_id: CVE-2012-0394
template_path: nuclei-templates/http/cves/2012/CVE-2012-0394.yaml
affected_product: Apache Struts
severity: medium
authentication: none
external_callback: false
affected_versions: before 2.3.1.1
preconditions: developer mode enabled in DebuggingInterceptor component
poc_classification: rce
---

## Vulnerability
Apache Struts before 2.3.1.1 is susceptible to remote code execution via arbitrary OGNL command execution in the DebuggingInterceptor component when developer mode is enabled. A remote unauthenticated attacker can trigger this via unspecified vectors, enabling malware execution, sensitive information disclosure, data modification, or full system compromise. Vendor note: behavior is characterized as not “a security vulnerability itself.”  
CVSS v2: 6.8 (AV:N/AC:M/Au:N/C:P/I:P/A:P) | CWE-94 | CPE: cpe:2.3:a:apache:struts:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: rce

The template issues a single unauthenticated GET request to `{{BaseURL}}/portal/displayAPSForm.action?debug=command&expression={{rand_int}}*{{rand_int}}` and matches on HTTP 200 together with the exact computed product value appearing in the response body, confirming OGNL expression evaluation is active.

## References
- https://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/
- https://www.exploit-db.com/exploits/31434
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0394
- http://www.exploit-db.com/exploits/18329
- https://nvd.nist.gov/vuln/detail/CVE-2012-0394
