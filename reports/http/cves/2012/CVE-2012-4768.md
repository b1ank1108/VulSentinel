---
cve_id: CVE-2012-4768
template_path: nuclei-templates/http/cves/2012/CVE-2012-4768.yaml
affected_product: WordPress Download Monitor plugin
severity: medium
authentication: none
external_callback: false
affected_versions: < 3.3.5.9
preconditions: []
poc_classification: info-leak
---

## Vulnerability
Cross-site scripting (XSS) vulnerability in the WordPress Download Monitor plugin before 3.3.5.9 allows remote unauthenticated attackers to inject arbitrary web script or HTML via the `dlsearch` parameter to the default URI.

**CVSS v2**: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)  
**CWE**: CWE-79  
**Impact**: Successful exploitation allows execution of arbitrary JavaScript in the victim's browser context, enabling session hijacking, page defacement, or theft of sensitive information such as cookies or form data.  
**Remediation**: Update to version 3.3.5.9 or higher (or apply the vendor patch).

## PoC / Detection
Classification: info-leak

The template detects the vulnerability via a two-step process. It first issues an internal GET to `/wp-content/plugins/download-monitor/readme.txt` and matches the string "Download Monitor =" to confirm plugin presence. It then issues a GET request to `/?dlsearch=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E` and verifies reflected XSS by checking that the exact unsanitized payload string appears in the response body, the Content-Type header contains `text/html`, and the status code is 200.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2012-4768
- http://packetstormsecurity.org/files/116408/wpdownloadmonitor3357-xss.txt
- http://www.reactionpenetrationtesting.co.uk/wordpress-download-monitor-xss.html
- https://exchange.xforce.ibmcloud.com/vulnerabilities/78422
- https://github.com/ARPSyndicate/kenzer-templates
