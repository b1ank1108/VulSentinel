---
cve_id: CVE-2012-4547
template_path: nuclei-templates/http/cves/2012/CVE-2012-4547.yaml
affected_product: AWStats
severity: medium
authentication: none
external_callback: false
affected_versions: 6.95/7.0
preconditions: []
poc_classification: info-leak
---

## Vulnerability
AWStats 6.95/7.0 is affected by a reflected cross-site scripting (XSS) vulnerability in the `awredir.pl` script (and potentially under `/cgi-bin/`). The application does not properly sanitize user-supplied input to the `url` parameter, allowing injection of arbitrary web script or HTML.

Impact: Remote attackers can craft malicious links that execute JavaScript in the context of the AWStats interface when clicked by victims, potentially leading to session cookie theft, account hijacking, or site defacement.

CVSS 2.0: 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N) | CWE-79

Remediation: Apply the latest security patches and updates from the vendor.

## PoC / Detection
Classification: info-leak

The template performs a reflected XSS test by issuing GET requests to two common paths for `awredir.pl` (`{{BaseURL}}/awstats/awredir.pl` and `{{BaseURL}}/cgi-bin/awstats/awredir.pl`) with the payload `url=%3Cscript%3Ealert(document.domain)%3C/script%3E`. It verifies the condition by matching on the raw payload appearing unsanitized in the response body, `text/html` Content-Type header, and HTTP 200 status. Stops at the first successful match.

## References
- https://www.exploit-db.com/exploits/36164
- https://nvd.nist.gov/vuln/detail/CVE-2012-4547
- http://awstats.sourceforge.net/docs/awstats_changelog.txt
- http://openwall.com/lists/oss-security/2012/10/29/7
- http://openwall.com/lists/oss-security/2012/10/26/1
