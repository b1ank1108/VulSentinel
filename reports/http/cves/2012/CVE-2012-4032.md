---
cve_id: CVE-2012-4032
template_path: nuclei-templates/http/cves/2012/CVE-2012-4032.yaml
affected_product: WebsitePanel
severity: medium
authentication: required
external_callback: false
affected_versions: before 1.2.2.1
preconditions: []
poc_classification: detect-only
---

## Vulnerability
WebsitePanel before v1.2.2.1 contains an open redirect vulnerability in the login page (`Default.aspx?pid=Login`). Remote attackers can supply an arbitrary URL in the `ReturnUrl` parameter, causing the application to issue a `Location` header redirect to any destination. This enables phishing attacks where victims are tricked into visiting malicious sites after providing their login credentials.

**Impact:** An attacker can trick users into visiting a malicious website, leading to potential phishing attacks or further exploitation.  
**Remediation:** Upgrade to WebsitePanel v1.2.2.1 or later.  
**CVSS:** CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:N (score 5.8)  
**CWE:** CWE-20 (Improper Input Validation)  
**CPE:** cpe:2.3:a:websitepanel:websitepanel:*:*:*:*:*:*:*:*

## PoC / Detection
Classification: detect-only

The template issues a single raw POST request to `/Default.aspx?pid=Login&ReturnUrl=http%3A%2F%2Fwww.interact.sh` that includes form-encoded login fields (`txtUsername={{username}}`, `txtPassword={{password}}`), an empty `.WEBSITEPANELPORTALAUTHASPX=` cookie, and standard User-Agent/Content-Type headers. It matches the response `Location` header with a regex that detects any redirect containing the `interact.sh` domain (handling http/https, leading slashes, and various path formats).

## References
- https://nvd.nist.gov/vuln/detail/CVE-2012-4032
- https://www.exploit-db.com/exploits/37488
- https://packetstormsecurity.com/files/114541/WebsitePanel-CMS-Open-Redirect.html
- https://exchange.xforce.ibmcloud.com/vulnerabilities/76803
- http://websitepanel.codeplex.com/workitem/224
