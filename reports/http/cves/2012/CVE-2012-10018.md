---
cve_id: CVE-2012-10018
template_path: nuclei-templates/http/cves/2012/CVE-2012-10018.yaml
affected_product: WordPress Mapplic and Mapplic Lite plugins
severity: high
authentication: required
external_callback: false
affected_versions: Mapplic <= 6.1, Mapplic Lite <= 1.0
preconditions: author-level WordPress permissions
poc_classification: state-change
---

## Vulnerability
WordPress Mapplic (<= 6.1) and Mapplic Lite (<= 1.0) plugins suffer from authenticated stored cross-site scripting via arbitrary URL injection in map configurations. Authenticated author-level users can inject remote SVG URLs (or malicious content in map level titles) into mapplic_map posts. On map view (admin panel or frontend shortcode), jQuery `.load()` fetches the SVG and inserts it directly into the DOM, executing any embedded JavaScript with the viewer's privileges.  

Impact: session hijacking, privilege escalation, or full site compromise for any viewer. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L (8.3), CWE-79.  

Remediation: upgrade to Mapplic 7.0+ or Mapplic Lite 1.0.1+.

## PoC / Detection
Classification: state-change

The template runs a 4-step authenticated workflow:  
1. POST to `/wp-login.php` with username/password to obtain `wordpress_logged_in` cookie.  
2. GET `/wp-admin/post-new.php?post_type=mapplic_map` to extract `_wpnonce` and `post_ID`.  
3. POST to `/wp-admin/post.php` with crafted `mapplic-mapdata` JSON embedding `<img src=x onerror=alert(document.domain)>` in a level `title` to persist the payload.  
4. GET the edit page and assert the raw payload appears unsanitized in the response body.

## References
- https://nvd.nist.gov/vuln/detail/CVE-2012-10018
- https://wpscan.com/vulnerability/7bdee32b-9036-4e13-9586-4d6a9a1159c6/
- https://patchstack.com/database/wordpress/plugin/mapplic-lite/vulnerability/wordpress-mapplic-lite-plugin-1-0-stored-cross-site-scripting-xss-injection-via-server-side-request-forgery-ssrf-vulnerability
- https://packetstormsecurity.com/files/161920/WordPress-Mapplic-6.1-SSRF-Cross-Site-Scripting.html
