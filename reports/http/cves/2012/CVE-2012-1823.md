---
cve_id: CVE-2012-1823
template_path: nuclei-templates/http/cves/2012/CVE-2012-1823.yaml
affected_product: PHP CGI
severity: high
authentication: none
external_callback: false
affected_versions: PHP before 5.3.12 and 5.4.x before 5.4.2
preconditions: [configured as a CGI script (aka php-cgi)]
poc_classification: rce
---

## Vulnerability
sapi/cgi/cgi_main.c in PHP before 5.3.12 and 5.4.x before 5.4.2, when configured as a CGI script (aka php-cgi), does not properly handle query strings lacking an `=` character. Remote attackers can execute arbitrary code by embedding command-line options (e.g., `-d` flags) directly in the query string, bypassing php_getopt skipping for the `d` case.

**Impact:** Remote code execution  
**Remediation:** Upgrade to patched PHP version or apply security patches  
**CVSS v2:** 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P)  
**CWE:** CWE-20  
**Metadata:** vendor=php, product=php, cpe=cpe:2.3:a:php:php:*:*:*:*:*:*:*:*, tags=cve,cve2012,kev,vulhub,rce,php,vkev,vuln

## PoC / Detection
Classification: rce

The template sends a single raw POST request to `/index.php?-d+allow_url_include%3don+-d+auto_prepend_file%3dphp%3a//input` (Host: {{Hostname}}) with `Content-Type: application/x-www-form-urlencoded` and body containing `<?php echo md5("CVE-2012-1823");?>`. It matches on the presence of the computed MD5 hash in the response body to confirm arbitrary PHP code execution via the injected CGI query-string options.

## References
- https://github.com/vulhub/vulhub/tree/master/php/CVE-2012-1823
- https://nvd.nist.gov/vuln/detail/CVE-2012-1823
- https://bugs.php.net/bug.php?id=61910
- http://www.php.net/ChangeLog-5.php#5.4.2
- http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03360041
