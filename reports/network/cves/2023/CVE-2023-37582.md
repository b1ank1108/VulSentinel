---
cve_id: CVE-2023-37582
template_path: nuclei-templates/network/cves/2023/CVE-2023-37582.yaml
affected_product: Apache RocketMQ
severity: critical
authentication: none
external_callback: false
affected_versions: 5.x prior to 5.1.2 (including 5.1.1) and 4.x prior to 4.9.7
preconditions: NameServer component exposed on the extranet without permission verification
---

## Vulnerability
Apache RocketMQ NameServer remains vulnerable to remote command execution (incomplete patch of CVE-2023-33246). When the NameServer address is exposed externally and lacks permission checks, an attacker can abuse the configuration update function to run arbitrary commands as the RocketMQ system user.  
**CVSS 3.1**: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
**CWE**: CWE-94  
**Impact**: Full system compromise via arbitrary command execution.  
**Remediation**: Upgrade to RocketMQ 5.1.2+ (5.x series) or 4.9.7+ (4.x series).

## PoC / Detection
**Classification**: rce  
The template performs a single TCP connection to port 9876 and sends a hexadecimal payload that mimics a RocketMQ NameServer configuration-update request (code 318, JSON-serialized, with malicious `configStorePath=/tmp/pwned` and test values). It verifies exploitation success by checking that the raw response contains `serializeTypeCurrentRPC`, `version`, and `code":0` while excluding error strings such as `Can not update config` or `FORBID ACCESS`. This confirms the server accepted and processed the malicious update, proving the RCE condition.

## References
- http://www.openwall.com/lists
