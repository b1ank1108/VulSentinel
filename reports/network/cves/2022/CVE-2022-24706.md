---
cve_id: CVE-2022-24706
template_path: nuclei-templates/network/cves/2022/CVE-2022-24706.yaml
affected_product: CouchDB Erlang Distribution
severity: critical
authentication: none
external_callback: false
affected_versions: prior to 3.2.2
preconditions: default installation with Erlang cookie "monster" and exposed Erlang distribution port (TCP/9100)
poc_classification: rce
---

## Vulnerability
In Apache CouchDB prior to 3.2.2, an attacker can access an improperly secured default installation without authenticating and gain admin privileges via the Erlang distribution interface using the hardcoded default cookie "monster". Successful exploitation allows arbitrary command execution on the affected system.

CVSS v3.1: 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)  
CWE-1188: Insecure Default Initialization of Resource

## PoC / Detection
Classification: rce

The template connects via TCP to `{{Hostname}}` or `{{Host}}:9100`, sends a hex name message, reads the challenge, replies with a hex challenge-response computed from MD5("monster" + challenge), then injects a second hex payload that invokes Erlang `os:cmd` to execute a command returning system user details; success is verified by matching the words "uid", "gid", and "groups" (AND condition) in the raw response.

## References
- https://www.exploit-db.com/exploits/50914
- https://github.com/sadshade/CVE-2022-24706-CouchDB-Exploit/blob/main/CVE-2022-24706-Exploit.py
- https://nvd.nist.gov/vuln/detail/CVE-2022-24706
- http://www.openwall.com/lists/oss-security/2022/04/26/1
- http://www.openwall.com/lists/oss-security/2022/05/09/1
