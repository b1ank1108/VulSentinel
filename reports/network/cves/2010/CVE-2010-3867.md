---
cve_id: CVE-2010-3867
template_path: nuclei-templates/network/cves/2010/CVE-2010-3867.yaml
affected_product: ProFTPD
severity: high
authentication: required
external_callback: false
affected_versions: < 1.3.3c
preconditions: mod_site_misc module enabled
poc_classification: state-change
---

## Vulnerability
ProFTPD versions before 1.3.3c contain directory traversal vulnerabilities in the mod_site_misc module. Authenticated attackers can exploit directory traversal in mod_site_misc module through SITE MKDIR and other SITE commands to traverse directories and overwrite arbitrary files on the ProFTPD server.  
CVSS:2.0/AV:N/AC:H/Au:S/C:C/I:C/A:C (score 7.1) • CWE-22.

## PoC / Detection
Classification: state-change

The template initiates a TCP connection to port 21, sends hex payload `00000000` to elicit the FTP banner, extracts the version via regex `ProFTPD ([0-9.a-z]+)`, and matches if the banner contains 'ProFTPD' **and** `compare_versions(version, '< 1.3.3c')`. No SITE commands, traversal attempts, or file writes are performed — detection is purely passive banner fingerprinting.

## References
- http://bugs.proftpd.org/show_bug.cgi?id=3519
- http://lists.fedoraproject.org/pipermail/package-announce/2010-November/050687.html
- http://lists.fedoraproject.org/pipermail/package-announce/2010-November/050703.html
- http://lists.fedoraproject.org/pipermail/package-announce/2010-November/050726.html
- http://slackware.com/security/viewer.php?l=slackware-security&y=2010&m=slackware-security.498209
