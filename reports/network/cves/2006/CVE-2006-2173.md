---
cve_id: CVE-2006-2173
template_path: nuclei-templates/network/cves/2006/CVE-2006-2173.yaml
affected_product: FileZilla FTP Server
severity: medium
authentication: required
external_callback: false
affected_versions: 2.2.22
preconditions: []
poc_classification: rce
---

## Vulnerability
FileZilla FTP Server version 2.2.22 contains a buffer overflow vulnerability that allows remote authenticated attackers to cause denial of service and potentially execute arbitrary code. The flaw is triggered by sending excessively long PORT or PASS commands followed by MLSD commands, or through the remote interface. CVSS:2.0/AV:N/AC:L/Au:N/C:N/I:P/A:P (score 6.4). CPE: cpe:2.3:a:filezilla:filezilla_server:*:*:*:*:*:*:*:*. Remediation requires updating to a version newer than 2.2.22 with proper command-length validation.

## PoC / Detection
Classification: rce

The template opens a TCP connection to port 21, sends hex payload `00000000`, reads up to 1024 bytes, extracts the version via regex `FileZilla Server version ([0-9.]+)`, and applies DSL matchers requiring both `contains(raw, 'FileZilla')` and `contains(version, '2.2.22')`. This performs passive banner-based version fingerprinting to confirm the vulnerable component.

## References
- http://marc.info/?l=bugtraq&m=114658586018818&w=2
- http://www.infigo.hr/hr/in_focus/advisories/INFIGO-2006-05-03
- https://exchange.xforce.ibmcloud.com/vulnerabilities/26303
