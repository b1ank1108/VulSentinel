---
cve_id: CVE-2017-5645
template_path: nuclei-templates/network/cves/2017/CVE-2017-5645.yaml
affected_product: Apache Log4j Server
severity: critical
authentication: none
external_callback: true
affected_versions: Apache Log4j 2.x before 2.8.2
preconditions: TCP or UDP socket server to receive serialized log events from another application
poc_classification: rce
---

## Vulnerability
In Apache Log4j 2.x before 2.8.2, when using the TCP socket server or UDP socket server to receive serialized log events from another application, a specially crafted binary payload can be sent that, when deserialized, executes arbitrary code. Successful exploitation allows remote attackers to execute arbitrary commands on the affected server. CVSS 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). CWE-502.

## PoC / Detection
Classification: rce  
The template opens a TCP connection to the target ({{Hostname}} or {{Host}}:4712), transmits a hex-encoded Java gadget payload generated via `generate_java_gadget('dns', 'http://{{interactsh-url}}')`, and confirms the vulnerability by matching a DNS interaction on the interactsh_protocol field.

## References
- https://github.com/vulhub/vulhub/tree/master/log4j/CVE-2017-5645
- https://nvd.nist.gov/vuln/detail/CVE-2017-5645
- http://www.openwall.com/lists/oss-security/2019/12/19/2
- http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
- http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html
