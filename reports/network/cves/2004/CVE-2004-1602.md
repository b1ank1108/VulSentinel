---
cve_id: CVE-2004-1602
template_path: nuclei-templates/network/cves/2004/CVE-2004-1602.yaml
affected_product: ProFTPD
severity: medium
authentication: none
external_callback: false
affected_versions: 1.2.0 - 1.2.10
preconditions: []
poc_classification: info-leak
---

## Vulnerability
ProFTPD versions 1.2.x (including 1.2.8 and 1.2.10) are vulnerable to timing attacks that allow remote attackers to distinguish valid usernames from invalid ones. The server responds in varying amounts of time when a given username exists, enabling username enumeration through response time analysis (CWE-203). Attackers can enumerate valid usernames by analyzing server response times, facilitating subsequent brute force or targeted attacks against ProFTPD authentication. CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:N/A:N (score 5.0). Remediation requires upgrading to a version later than 1.2.10 that normalizes response times for authentication attempts regardless of username validity.

## PoC / Detection
Classification: info-leak

The template establishes a TCP connection to port 21, sends a minimal hex payload `00000000`, reads up to 1024 bytes of the banner response, extracts the version string via regex `ProFTPD ([0-9.]+)`, and confirms vulnerability if the banner contains "ProFTPD" and the version satisfies `compare_versions(version, '>= 1.2.0', '<= 1.2.10')` via DSL matcher. This passive banner-based version fingerprint identifies instances susceptible to the timing attack; the actual exploit would require active timing measurements on USER commands (not performed here).

## References
- http://marc.info/?l=bugtraq&m=109786760926133&w=2
- https://exchange.xforce.ibmcloud.com/vulnerabilities/17724
