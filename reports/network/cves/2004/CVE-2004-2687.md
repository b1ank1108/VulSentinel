---
cve_id: CVE-2004-2687
template_path: nuclei-templates/network/cves/2004/CVE-2004-2687.yaml
affected_product: Distccd v1
severity: high
authentication: none
external_callback: false
affected_versions: distcc 2.x (as used in XCode 1.5 and others)
preconditions: not configured to restrict access to the server port
poc_classification: rce
---

## Vulnerability
distcc 2.x (distccd), as used in Xcode 1.5 and others, when not configured to restrict access to the server port, allows unauthenticated remote attackers to execute arbitrary commands via compilation jobs. Jobs are executed by the server without any authorization checks, potentially with elevated privileges.

CVSS v2: 9.3 (AV:N/AC:M/Au:N/C:C/I:C/A:C). CWE-16.

## PoC / Detection
Classification: rce

The template connects via TCP to port 3632 on the target and transmits a hex-encoded distcc protocol payload: a DIST00000001 handshake followed by an ARGC/ARGV job that submits `sh -c '(id)'` as the compilation command. It then matches the raw response for the regex `uid=[0-9]+.*gid=[0-9]+` to confirm the `id` command executed successfully on the server.

## References
- http://distcc.samba.org/security.html
- http://lists.samba.org/archive/distcc/2004q3/002550.html
- http://lists.samba.org/archive/distcc/2004q3/002562.html
- https://github.com/crypticdante/distccd_rce_CVE-2004-2687
- https://github.com/gwyomarch/Lame-HTB-Writeup-FR
