---
cve_id: CVE-2004-1641
template_path: nuclei-templates/network/cves/2004/CVE-2004-1641.yaml
affected_product: Titan FTP Server
severity: medium
authentication: none
external_callback: false
affected_versions: <= 3.21
preconditions: []
poc_classification: dos
---

## Vulnerability
Titan FTP Server versions <= 3.21 contain heap overflow vulnerabilities when processing long FTP commands such as CWD, STAT, or LIST. Remote unauthenticated attackers can cause denial of service (daemon crash) by sending excessively long arguments to these commands, leading to server instability.

CVSS v2: 5.0 (AV:N/AC:L/Au:N/C:N/I:N/A:P).

## PoC / Detection
Classification: dos

The template performs a passive TCP connection to port 21, sends hex payload `00000000` (to initiate banner read), reads up to 1024 bytes of the response, checks for the string "Titan" in the banner, extracts the version via regex `Titan FTP Server ([0-9.]+)`, and applies DSL matcher `compare_versions(version, '<= 3.21')` with AND condition. This fingerprints vulnerable versions without attempting to send long commands or trigger the overflow.

## References
- http://marc.info/?l=bugtraq&m=109396159332523&w=2
- https://exchange.xforce.ibmcloud.com/vulnerabilities/17172
