---
cve_id: CVE-2020-1938
template_path: nuclei-templates/network/cves/2020/CVE-2020-1938.yaml
affected_product: Apache Tomcat
severity: critical
authentication: none
external_callback: false
affected_versions: 9.0.0.M1 to 9.0.0.30, 8.5.0 to 8.5.50, 7.0.0 to 7.0.99
preconditions: [AJP Connector enabled by default and accessible to untrusted users]
poc_classification: info-leak
---

## Vulnerability
Apache Tomcat AJP File Read/Inclusion Vulnerability (Ghostcat).  
AJP connections are treated with higher trust than HTTP. When the AJP Connector (default TCP/8009, bound to all interfaces) is reachable by untrusted networks, attackers can:  
- Return arbitrary files from anywhere in the web application  
- Process any file in the web application as a JSP  
- Achieve remote code execution if the application permits file upload and stores files inside the webapp directory  
Impact: unauthorized access to sensitive information such as configuration files, source code, or credentials (CVSS 9.8).  
Fixed in 9.0.31, 8.5.51, 7.0.100+ (default AJP config hardened).

## PoC / Detection
Classification: info-leak  
The template opens a TCP connection to `{{Hostname}}` or `{{Host}}:8009` and sends a single hex-decoded AJP ForwardRequest packet. The packet emulates an HTTP/1.1 GET to `/examples/xxxxxx.jsp` while injecting `javax.servlet.include.path_info` and `javax.servlet.include.servlet_path` attributes that force inclusion of `/WEB-INF/web.xml`. The 1024-byte response is matched for the static string `"See the NOTICE file distributed with"` (present in Tomcat's default WEB-INF/web.xml) to confirm the server performed an unauthorized file read via the AJP protocol flaw.

## References
- https://www.tenable.com/blog/cve-2020-1938-ghostcat-apache-tomcat-ajp-file-readinclusion-vulnerability-cnvd-2020-10487
- https://nvd.nist.gov/vuln/detail/CVE-2020-1938
- https://lists.apache.org/thread.html/r7c6f492fbd39af34a68681dbbba0468490ff1a97a1bd79c6a53610ef%40%3Cannounce.tomcat.apache.org%3E
- https://lists.apache.org/thread.html/r75113652e46c4dee687236510649acfb70d2c63e074152049c3f399d@%3Cnotifications.ofbiz.apache.org%3E
- http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00025.html
