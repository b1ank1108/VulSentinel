---
cve_id: CVE-2020-0796
template_path: nuclei-templates/network/cves/2020/CVE-2020-0796.yaml
affected_product: Microsoft SMBv3
severity: critical
authentication: none
external_callback: false
affected_versions: Windows 10 version 1903 and later and Windows Server systems
preconditions: SMBv3 enabled and listening on TCP port 445
poc_classification: rce
---

## Vulnerability
Microsoft Server Message Block 3.1.1 (SMBv3) contains a remote code execution vulnerability (CVE-2020-0796, aka SMBGhost/CoronaBlue) due to improper handling of certain requests in the SMBv3.1.1 protocol. Unauthenticated remote attackers can send specially crafted packets to trigger a buffer-related flaw (CWE-119), achieving arbitrary code execution and complete system compromise on affected Windows 10 and Windows Server installations.  
**CVSS 3.1**: 10.0 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)  
**Impact**: Full system takeover.

## PoC / Detection
Classification: rce

The template connects to TCP port 445 and transmits two hex-decoded crafted SMBv3 negotiation packets (including NTLMSSP Type 1 elements). It reads up to 8192 bytes of response data and applies binary matchers (condition: or) to detect characteristic unpatched SMBv3.1.1 signatures such as `fc534d4248000000`, `0d0000c0`, `1000602d00` and the longer response pattern `00000031fc534d4248000000...`.

## References
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0796
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796
- https://github.com/tdevworks/CVE-2020-0796-SMBGhost-Exploit-Demo
- http://packetstormsecurity.com/files/156731/CoronaBlue-SMBGhost-Microsoft-Windows-10-SMB-3.1.1-Proof-Of-Concept.html
- http://packetstormsecurity.com/files/156980/Microsoft-Windows-10-SMB-3.1.1-Local-Privilege-Escalation.html
