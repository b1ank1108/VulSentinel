"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"openai-dotenv-root-cli-01-01","P1","1","infra","新增 requirements.txt 固化依赖","在仓库根目录新增 requirements.txt；至少声明 openai 与 python-dotenv；其余依赖保持现状。","WHEN 用户查看仓库根目录 requirements.txt → THEN 文件存在且包含 openai 与 python-dotenv; ref: specs/cve-poc-llm-reporting/spec.md:62; SHALL 在根目录提供 requirements.txt 并至少声明 openai/python-dotenv; ref: specs/cve-poc-llm-reporting/spec.md:57; 约束：依赖管理用 requirements.txt; ref: design.md:15","MANUAL","requirements.txt 仅补齐本变更新增依赖（openai/python-dotenv），避免无关升级与冗余依赖; ref: design.md:33; 不引入 wheel/console_scripts 等发行流程; ref: design.md:29","确认安装依赖后可正常 import openai 与 dotenv（不要求在评审时真实联网调用）; ref: design.md:61","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:3; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:56; openspec/changes/archive/openai-dotenv-root-cli/design.md:33","picked_reason:先补齐requirements.txt中新增依赖声明，降低后续CLI/dotenv/SDK变更的环境不确定性; 与文档更新（1.3）联动：README/selfcheck 需要给出最小安装命令。; done_at:2026-02-03; evidence:requirements.txt包含openai/python-dotenv；pip install -r requirements.txt后import openai/dotenv成功; risk:low 仅新增依赖声明文件"
"openai-dotenv-root-cli-01-02","P1","1","infra","更新 .gitignore 忽略 .env","更新根目录 .gitignore：默认忽略 .env（以及可选的 .env.* 变体），避免密钥误提交。","WHEN 用户查看仓库根目录 .gitignore → THEN 其中包含忽略规则以匹配 .env; ref: specs/cve-poc-llm-reporting/spec.md:69; 安全要求：.env 必须被忽略并避免泄露密钥; ref: proposal.md:26","MANUAL","检查忽略规则覆盖 .env 与常见变体（.env.local/.env.prod 等），但避免误伤必要配置文件; ref: tasks.md:4","确认仓库历史/CI 不依赖提交 .env；若有依赖需同步更新 CI 配置来源; ref: proposal.md:25","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:4; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:66; openspec/changes/archive/openai-dotenv-root-cli/proposal.md:26","picked_reason:先加.gitignore忽略.env，避免后续配置引入时误提交密钥; 如仓库已存在其他忽略策略，需避免重复/冲突规则。; done_at:2026-02-03; evidence:.gitignore新增.env/.env.*并保留!.env.example；git check-ignore验证.env被忽略且.env.example不被忽略; risk:low 仅gitignore规则变更"
"openai-dotenv-root-cli-01-03","P0","1","infra","更新 README/selfcheck：.env + 根目录入口","更新 README.md 与 docs/cve_poc_llm_reports_selfcheck.md：以“根目录 .env + python cve_poc_llm_reports_cli.py”为主；明确 OPENAI_BASE_URL 必须包含 /v1。","文档示例明确要求 OPENAI_BASE_URL 形如 http(s)://host:port/v1（包含 /v1），且说明程序不做校验/自动修正; ref: proposal.md:11; 文档主路径为根目录 .env + python cve_poc_llm_reports_cli.py（零参数运行）；ref: design.md:20; 文档不得引导在日志/报错中输出明文 OPENAI_API_KEY; ref: proposal.md:26","MANUAL","对齐 Non-Goals：不引入 base_url 校验/自动补 /v1；文档不得暗示存在自动修正; ref: design.md:28; 对齐 CLI 设计：仅保留跑批相关参数；OpenAI 三要素以 .env/环境变量为主; ref: design.md:45","覆盖风险 Mitigation：文档中显式给出 base_url 示例并提示常见误配；必要时在故障排查段落建议查看 base_url（但不打印 key）; ref: design.md:59","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:5; openspec/changes/archive/openai-dotenv-root-cli/proposal.md:11; openspec/changes/archive/openai-dotenv-root-cli/design.md:59; README.md:1; docs/cve_poc_llm_reports_selfcheck.md:1","picked_reason:入口与dotenv已落地，及时更新README/selfcheck作为Breaking Change对外告知与最小上手路径; 这是 Breaking Change 的主要对外告知渠道；建议把旧运行方式标注为不推荐或仅兼容（取决于 2.3 决策）。; done_at:2026-02-03; evidence:README/selfcheck改为根目录.env + python3 cve_poc_llm_reports_cli.py为主；明确OPENAI_BASE_URL需包含/v1且不做校验/自动修正；示例不在命令行回显OPENAI_API_KEY; risk:low 文档更新"
"openai-dotenv-root-cli-02-01","P1","2","backend","实现根目录 CLI 入口脚本","新增根目录 cve_poc_llm_reports_cli.py（argparse；支持 --from-year/--templates-dir/--reports-dir；零参数可运行）。","SHALL 提供可直接运行的根目录入口脚本 cve_poc_llm_reports_cli.py; ref: specs/cve-poc-llm-reporting/spec.md:4; WHEN 用户在仓库根目录执行 python cve_poc_llm_reports_cli.py 且配置齐全 → THEN 程序启动并进入批处理流程，输出结构化日志（至少 start 与 summary）; ref: specs/cve-poc-llm-reporting/spec.md:7; 入口脚本放根目录且避免与包目录同名造成 import 冲突; ref: design.md:44","AUTOSERVER","CLI 仅包含跑批相关参数（from-year/templates-dir/reports-dir）；OpenAI 配置以 .env/环境变量为主，避免再引入必填 CLI 参数; ref: design.md:45; 不改变报告 schema/落盘路径/索引与幂等跳过等业务语义; ref: design.md:26","确保入口只读 nuclei-templates/ 只写 reports/，单条失败不中断全局; ref: design.md:23","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:9; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:3; openspec/changes/archive/openai-dotenv-root-cli/design.md:42; scripts/cve_poc_llm_reports.py:127","picked_reason:先提供根目录默认入口，减少对scripts/依赖并为后续dotenv/SDK迁移定锚; 待澄清：是否允许用 CLI 临时覆盖 OpenAI 配置（base_url/model/key）？ref: design.md:74; done_at:2026-02-03; evidence:新增根目录cve_poc_llm_reports_cli.py（仅from-year/templates-dir/reports-dir）；python -m unittest通过；使用空cves.json的临时templates验证输出start/summary且不触发网络; risk:low 新增入口文件未改动既有业务模块"
"openai-dotenv-root-cli-02-02","P1","2","backend","dotenv 加载 + 必填配置校验（不泄露 key）","启动时调用 load_dotenv() 从仓库根目录加载 .env（不覆盖系统环境变量）；缺失 OPENAI_BASE_URL/OPENAI_API_KEY/OPENAI_MODEL 时快速失败且错误信息不泄露明文 key。","程序启动时 MUST 使用 python-dotenv 从仓库根目录加载 .env，且默认行为 MUST NOT 覆盖系统环境变量; ref: specs/cve-poc-llm-reporting/spec.md:11; WHEN 系统环境变量与 .env 同时提供同名配置且值不同 → THEN 使用系统环境变量值; ref: specs/cve-poc-llm-reporting/spec.md:14; 缺失任意必填项 MUST 非 0 退出并列出缺失项名称，且错误信息 MUST NOT 包含明文 OPENAI_API_KEY; ref: specs/cve-poc-llm-reporting/spec.md:24","AUTOSERVER","缺失项提示只列 key 名称，严禁回显 OPENAI_API_KEY；日志中也不得输出 key; ref: specs/cve-poc-llm-reporting/spec.md:24; OPENAI_BASE_URL 只做非空与 strip，不做 /v1 校验或拼接; ref: design.md:40","异常/日志不绑定特定异常类名，记录字符串化摘要 + 可选状态码，避免 SDK 异常类型变化造成回归; ref: design.md:62","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:10; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:10; openspec/changes/archive/openai-dotenv-root-cli/design.md:37; cve_poc_llm_reports_cli.py:209","picked_reason:补齐dotenv根目录加载与必填校验，确保入口零参数可依赖.env运行且不泄露key; 待澄清：是否需要把 timeout/max_retries 暴露到 .env（如 OPENAI_TIMEOUT_SECONDS）？ref: design.md:75; done_at:2026-02-03; evidence:cve_poc_llm_reports_cli.py启动时load_dotenv(dotenv_path=repo_root/.env, override=False)；自测验证.env生效且OS env优先生效；unittest通过；错误仅列缺失key名不回显OPENAI_API_KEY; risk:low 仅入口启动阶段加载.env并做必填检查"
"openai-dotenv-root-cli-02-03","P2","2","backend","处理旧 scripts 入口（wrapper 或移除）","可选：将 scripts/cve_poc_llm_reports.py 改为兼容 wrapper（内部调用新入口）或移除旧入口；保证文档与实际入口一致。","选择其一：保留旧入口为 wrapper（内部调用新入口）或删除旧入口；并确保 README/selfcheck 与代码一致; ref: design.md:53; 不引入重复实现：旧逻辑应迁移/复用到共享模块，避免复制粘贴; ref: design.md:67","AUTOSERVER","决策需明确：是否保留 scripts 入口作为兼容层；避免出现两个“推荐入口”; ref: design.md:73","如删除旧入口，确认 CI/历史脚本不再依赖该路径；必要时提供迁移说明或 wrapper 过渡; ref: proposal.md:25","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:11; openspec/changes/archive/openai-dotenv-root-cli/design.md:53; openspec/changes/archive/openai-dotenv-root-cli/design.md:73; scripts/cve_poc_llm_reports.py:1; cve_poc_llm_reports_cli.py:1","picked_reason:已新增根目录入口，需将scripts旧入口降级为兼容wrapper并消除重复实现，统一共享逻辑; Open Question：是否保留 scripts/cve_poc_llm_reports.py 兼容入口？ref: design.md:73; decision:保留scripts/cve_poc_llm_reports.py为兼容wrapper（支持旧CLI覆盖参数），文档只推荐根目录入口; done_at:2026-02-03; evidence:新增共享入口实现cve_poc_llm_reports/cli.py；根目录cve_poc_llm_reports_cli.py与scripts入口均委托共享实现，避免重复；unittest通过; risk:low 入口重构为委托调用，行为保持一致"
"openai-dotenv-root-cli-03-01","P1","3","backend","迁移 OpenAI 调用到官方 SDK（Chat Completions）","将现有 OpenAI 调用封装迁移为 openai 官方 SDK：OpenAI(...).chat.completions.create(...)，替换自研 urllib 实现。","生成报告时 MUST 使用官方 openai Python SDK 通过 Chat Completions 发起请求，并使用 OPENAI_MODEL 指定的模型名; ref: specs/cve-poc-llm-reporting/spec.md:38; WHEN 调用模型 → THEN 请求使用 OPENAI_MODEL 指定模型名; ref: specs/cve-poc-llm-reporting/spec.md:40","AUTOSERVER","仅替换调用层，不改变报告 schema/落盘语义/幂等策略; ref: design.md:26; 上层错误处理以字符串摘要为主，避免绑定 SDK 异常类型; ref: design.md:62","确保单条失败不阻塞全局；失败原因记录结构化信息便于定位; ref: design.md:51","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:15; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:37; openspec/changes/archive/openai-dotenv-root-cli/design.md:47; cve_poc_llm_reports/report_generation.py:1; cve_poc_llm_reports/openai_chat.py:36","picked_reason:当前OpenAI调用为自研urllib封装，先迁移到官方openai SDK以降低兼容与维护成本; 待澄清：是否需要在 .env 暴露 timeout/max_retries（影响 SDK 初始化/请求配置）？ref: design.md:75; done_at:2026-02-03; evidence:openai_chat.post_chat_completions已改为使用OpenAI SDK(OpenAI(...).chat.completions.create)；保持返回dict供上层解析；unittest通过; risk:medium OpenAI调用实现替换为SDK（异常类型/重试语义可能与urllib不同）"
"openai-dotenv-root-cli-03-02","P1","3","backend","实现 JSON mode（messages 包含 json 关键字）","优先使用 JSON mode：请求携带 response_format={""type"":""json_object""}，并确保 messages 中包含 “json” 字样以满足部分模型/后端约束。","优先请求 JSON mode：设置 response_format={""type"":""json_object""}，且 messages 中 MUST 包含 “json” 字样; ref: specs/cve-poc-llm-reporting/spec.md:47; 若 JSON mode 受约束，提示词需显式包含 json 关键字; ref: design.md:49","AUTOSERVER","提示词中显式包含 ""json""，并保持输出可解析；避免在 prompt 中泄露 OPENAI_API_KEY; ref: design.md:49; 不改变报告 schema/落盘路径/索引与幂等跳过等业务语义; ref: design.md:26","回归关注：JSON mode 不被支持或被额外约束时必须走 fallback，不得直接失败中断; ref: design.md:60","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:16; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:44; openspec/changes/archive/openai-dotenv-root-cli/design.md:49; cve_poc_llm_reports/openai_json.py:23","picked_reason:补齐JSON mode前置条件（messages包含json关键字），避免后端/模型约束导致隐式失败; 如后端对 JSON mode 有额外限制（例如 messages 必须出现 json），测试需覆盖该前置条件。; done_at:2026-02-03; evidence:openai_json在JSON mode与fallback前确保messages包含""json""关键字（必要时注入system提示），并将force prompt改为小写json；单测已更新并通过; risk:low 仅提示词前置与system message调整"
"openai-dotenv-root-cli-03-03","P1","3","backend","实现 response_format 400 自动 fallback + json.loads 校验","当服务端以 400 拒绝 response_format（不支持或约束不满足）时，自动重试一次（不带 response_format，system prompt 强制仅返回 JSON）；并对输出做 json.loads 校验。","WHEN JSON mode 请求因 response_format 被服务端以 400 拒绝 → THEN 自动发起 fallback 请求并继续尝试解析 JSON; ref: specs/cve-poc-llm-reporting/spec.md:52; fallback：不带 response_format 再请求一次，system prompt 强制只返回 JSON 对象；随后 json.loads 校验; ref: design.md:50; 不可解析时 MUST 将该条目标记为失败并继续后续条目处理（不中断全局）; ref: specs/cve-poc-llm-reporting/spec.md:50","AUTOSERVER","fallback 触发条件严格为 response_format 导致的 400；避免对其他 4xx/5xx 误触发导致重复请求; ref: specs/cve-poc-llm-reporting/spec.md:48; 错误信息与日志 MUST NOT 包含明文 OPENAI_API_KEY; ref: specs/cve-poc-llm-reporting/spec.md:24","回归验证：JSON mode 失败时仍可产出可解析 JSON；并记录两次请求路径的错误摘要便于定位; ref: design.md:60","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:17; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:52; openspec/changes/archive/openai-dotenv-root-cli/design.md:50; cve_poc_llm_reports/openai_json.py:23; cve_poc_llm_reports/openai_chat.py:65","picked_reason:将fallback触发条件收敛为response_format导致的400，避免对其他错误重复请求，并保持json.loads可解释失败; 需确保 fallback 不会把不可控文本写入后续解析路径（json.loads 失败应当可解释且可定位）。; done_at:2026-02-03; evidence:openai_json仅在APIStatusError(400)且错误信息包含response_format时触发fallback；其他4xx/5xx不误触发；fallback仍做json.loads校验且失败可定位；新增单测覆盖“不误触发fallback”; risk:medium 严格化fallback条件，部分此前可fallback的异常将直接失败（符合spec，需排查真实400原因）"
"openai-dotenv-root-cli-03-04","P0","3","backend","更新 OPENAI_BASE_URL 语义（已包含 /v1，不校验/不修正）","配置语义更新：OPENAI_BASE_URL 视为已包含 /v1 且不做校验/自动修正；直接用于 SDK 初始化。","OPENAI_BASE_URL SHALL 被视为已包含 /v1 的 base URL，程序 MUST NOT 校验/自动补 /v1/做路径拼接修正; ref: specs/cve-poc-llm-reporting/spec.md:31; WHEN 用户提供 OPENAI_BASE_URL → THEN 程序不做校验或自动修正，直接用于 SDK 初始化与请求; ref: specs/cve-poc-llm-reporting/spec.md:33; BREAKING：OPENAI_BASE_URL 规范改为包含 /v1 且不做格式校验或自动修正（需对齐文档与实现）; ref: proposal.md:11","AUTOSERVER","对齐 Non-Goals：不引入 base_url 解析/修正逻辑（包含自动补 /v1）; ref: design.md:28; 日志可打印 base_url 便于定位误配，但严禁输出 OPENAI_API_KEY; ref: design.md:59","回归关注：base_url 误配导致失败时错误信息可定位（包含 base_url），且不会触发隐藏修正逻辑; ref: design.md:59","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:18; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:30; openspec/changes/archive/openai-dotenv-root-cli/proposal.md:11; cve_poc_llm_reports/cli.py:191; cve_poc_llm_reports/openai_chat.py:32","picked_reason:README已要求OPENAI_BASE_URL包含/v1，需先对齐实现避免出现/v1/v1路径错误并保持不校验/不修正; 这是显式 Breaking Change；建议在 docs 与错误日志中强化可观测性（显示 base_url，但不校验/不修正）。; done_at:2026-02-03; evidence:base_url语义改为已包含/v1：openai_chat不再自动补/v1；cli侧仅strip空白不做URL修正；单测已更新并通过; risk:medium Breaking Change：提供不带/v1的OPENAI_BASE_URL将请求到/chat/completions（需按README设置为.../v1）"
"openai-dotenv-root-cli-04-01","P1","4","backend","更新 OpenAI 相关单测：mock SDK 覆盖 JSON mode + fallback","更新/替换 tests/test_openai_chat.py、tests/test_openai_json.py 等：改为 mock OpenAI SDK 调用并覆盖 JSON mode + fallback 行为。","单测覆盖：JSON mode 路径（response_format=json_object + messages 含 json）与 400 触发 fallback 路径; ref: design.md:68; mock OpenAI SDK 调用，避免测试依赖真实网络/真实 OpenAI 服务; ref: tasks.md:22; validate: python -m unittest discover -s tests -v; ref: tasks.md:24","AUTOSERVER","mock 需断言请求参数：response_format、model、messages 关键字；并覆盖 400 特殊分支; ref: specs/cve-poc-llm-reporting/spec.md:47","回归：确保既有流水线行为不变（除 OpenAI 调用层/入口/配置契约），单测应覆盖“单条失败不阻塞全局”; ref: design.md:23","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:22; openspec/changes/archive/openai-dotenv-root-cli/design.md:68; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:44; tests/test_openai_chat.py:1; tests/test_openai_json.py:1","picked_reason:OpenAI调用已迁移到SDK，需要把单测改为mock SDK并覆盖JSON mode与400 fallback，避免真实网络依赖; 不改变报告 schema/落盘路径/索引与幂等跳过等业务语义; ref: design.md:26; done_at:2026-02-03; evidence:tests/test_openai_chat.py与tests/test_openai_json.py改为mock OpenAI SDK(OpenAI(...).chat.completions.create)；断言model/response_format(json_object)/messages含json；覆盖400触发fallback；新增用例覆盖单条失败不中断全局；unittest通过; risk:low 测试改动，避免网络依赖"
"openai-dotenv-root-cli-04-02","P1","4","backend","增加 dotenv 优先级测试：OS env 覆盖 .env","增加 dotenv 优先级测试：系统环境变量覆盖 .env（默认 load_dotenv() 不 override）。","WHEN 系统环境变量与 .env 同时提供同名配置且值不同 → THEN 程序使用系统环境变量值; ref: specs/cve-poc-llm-reporting/spec.md:14; validate: python -m unittest discover -s tests -v; ref: tasks.md:24","AUTOSERVER","测试需显式设置与清理环境变量，避免用例间污染；并验证 load_dotenv 默认 override=False 行为; ref: design.md:38","回归关注：CI 环境变量应继续生效，不被本地 .env 覆盖导致环境漂移; ref: specs/cve-poc-llm-reporting/spec.md:11","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:23; openspec/changes/archive/openai-dotenv-root-cli/specs/cve-poc-llm-reporting/spec.md:13; openspec/changes/archive/openai-dotenv-root-cli/design.md:37; cve_poc_llm_reports/cli.py:231","picked_reason:补齐dotenv优先级单测，防止CI/生产环境变量被本地.env覆盖导致配置漂移; 建议同时覆盖 OPENAI_BASE_URL/OPENAI_MODEL/OPENAI_API_KEY 三项（至少两项），避免只测单字段。; done_at:2026-02-03; evidence:新增tests/test_dotenv_precedence.py覆盖OS env覆盖.env（override=False）；至少验证OPENAI_BASE_URL/OPENAI_MODEL优先使用OS env；unittest通过; risk:low 仅新增单测"
"openai-dotenv-root-cli-04-03","P2","4","backend","跑全量单测并确认不回归","执行 python -m unittest discover -s tests -v，确保既有流水线行为不回归。","validate: python -m unittest discover -s tests -v 退出码为 0; ref: tasks.md:24; 既有跑批语义不回归：单条失败不阻塞全局；只读 nuclei-templates/ 只写 reports/; ref: design.md:23","AUTOSERVER","若新增/改动用例失败，需先定位是否为变更引入还是既有不稳定；仅修复与本变更相关失败; ref: tasks.md:24","关注与 OpenAI SDK 迁移相关的异常类型变化/日志差异；保证错误摘要可用且不泄露 key; ref: design.md:62","已完成","已完成","已完成","已提交","","openspec/changes/archive/openai-dotenv-root-cli/tasks.md:24; openspec/changes/archive/openai-dotenv-root-cli/design.md:23; openspec/changes/archive/openai-dotenv-root-cli/design.md:62; tests:1","picked_reason:收尾跑全量unittest作为回归证据并固化到CSV闭环; 如 CI 使用不同 Python 版本/依赖源，建议在 CI 上再跑一次以验证 requirements.txt 的兼容性。; done_at:2026-02-03; evidence:python3 -m unittest discover -s tests -v 退出码0（37 tests）; risk:low 回归以单测为证据"
"openai-dotenv-root-cli-05-01","P0","5","backend","修复 Python 3.8：Path.is_relative_to 兼容","修复 cve_poc_llm_reports/cves_jsonl.py 在 Python 3.8 上调用 Path.is_relative_to 报错，保持 file_path traversal guard 语义不变。","WHEN 使用 Python 3.8 运行 python -m unittest tests.test_cves_jsonl -v → THEN 全部通过；并且 iter_cves_jsonl 解析 cves.json 时不再抛出 is_relative_to AttributeError；在 path traversal 时仍报 ValueError(file_path escapes templates_dir)。","AUTOSERVER","继续保证 path traversal 防护：candidate 必须在 templates_dir 下（使用 relative_to 或等价实现）；错误信息与结构化 on_error 行为保持不变；不引入新依赖。","回归：Python 3.8 下运行 python -m unittest tests.test_cves_jsonl -v；必要时跑 python -m unittest discover -s tests -v。","已完成","已完成","已完成","已提交","","cve_poc_llm_reports/cves_jsonl.py:51; tests/test_cves_jsonl.py:1","picked_reason:当前 Python 3.8 环境运行 iter_cves_jsonl 会因 Path.is_relative_to 缺失直接失败，阻断 CLI 批处理与后续流程; done_at:2026-02-03; evidence:python -m unittest tests.test_cves_jsonl -v (OK); evidence:python -m unittest discover -s tests -v (OK 37 tests); risk:low 兼容性修复，不改变 traversal guard 语义"
"cve-report-2026-21858-01","P1","6","reports","丰富 CVE-2026-21858 report：描述/POC步骤 + 移除 exploit_vs_detect","丰富 reports/http/cves/2026/CVE-2026-21858.json 的可读性与可推理信息：补充漏洞描述、POC 描述与执行步骤，便于下游大模型判断危害；并移除 exploit_vs_detect 字段。同步补充 nuclei 模板描述信息（不改变探测逻辑）。","CVE-2026-21858 报告 JSON 新增：漏洞描述（string）、POC 描述（string）、POC 执行步骤（string 或 steps 列表均可）；并删除 exploit_vs_detect 字段；JSON 可被项目解析/生成流程读取且不报错；nuclei 模板仅增加描述性信息（info/metadata），不改探测请求与匹配逻辑。","AUTOSERVER","确保新增字段信息完整且不泄露敏感数据；exploit_vs_detect 删除后仍保持向后兼容（解析侧不依赖该字段）；描述字段允许自由文本（string）以降低下游解析负担。","运行最相关的报告/模板解析相关单测或 CLI dry-run，确保不会因字段变化导致报表读取/序列化失败；必要时补最小单测。","已完成","已完成","已完成","已提交","","reports/http/cves/2026/CVE-2026-21858.json:1; nuclei-templates/http/cves/2026/CVE-2026-21858.yaml:1; cve_poc_llm_reports/report_schema_v1.py:1; cve_poc_llm_reports/prompt_v1.py:1; tests/test_report_generation.py:1","picked_reason:用户要求丰富CVE-2026-21858报告信息以提升下游模型判断能力，并移除exploit_vs_detect字段，属于低风险的内容增强变更。; done_at:2026-02-03; evidence:reports/http/cves/2026/CVE-2026-21858.json 增加 vulnerability_description/poc_description/poc_steps/impact/remediation/references，并移除 signals.exploit_vs_detect; evidence:nuclei-templates/http/cves/2026/CVE-2026-21858.yaml 仅补充 metadata.poc_* 描述信息，不改探测逻辑; evidence:build_report_v1 默认丢弃 exploit_vs_detect，prompt_v1 不再要求该字段，schema 校验也不再强制; evidence:python -m unittest discover -s tests -v (OK 37 tests); risk:low 报告 schema 精简（移除字段）+ 内容增强，未改 CLI/探测行为。"
"cve-report-raw-response-log-01","P1","6","backend","report_generation_failed 时打印原始返回 excerpt（非 JSON）","当 OpenAI/兼容服务端未严格遵守 response_format=json_object，导致 assistant content 不是合法 JSON 时，在失败日志中追加原始返回（assistant content）excerpt 与关键元信息，便于定位与下游风险判断。","当解析模型返回失败且报错包含 assistant content is not valid JSON 时，event=fail 的 reason 必须包含 content_excerpt（有长度上限）以及 content_len/stripped_len 等信息；不得泄露 OPENAI_API_KEY；不影响既有成功/失败统计与输出格式（仍为 kv+json 编码）。","AUTOSERVER","excerpt 必须限制长度，避免把超长输出塞进日志；对换行/引号等字符需保持可读且不破坏 kv 日志（使用现有 json.dumps 编码）；不要打印 OPENAI_API_KEY 或任何敏感信息。","运行 python -m unittest discover -s tests -v；并补充/更新最小测试覆盖 JSON 解析失败时错误信息包含 excerpt（如已有用例可只断言关键子串）。","已完成","已完成","已完成","已提交","","cve_poc_llm_reports/openai_json.py:1; cve_poc_llm_reports/cli.py:1; tests/test_openai_json.py:1","picked_reason:批处理出现 response_format 路径下 assistant content 非 JSON 导致 report_generation_failed（Expecting value...），需要把原始返回 excerpt 打到日志里便于调试与风险判断。; done_at:2026-02-03; evidence:openai_json 在 JSONDecodeError 时追加 content_excerpt/content_len/stripped_len 与 response_id/model/finish_reason（如有）到错误信息，最终进入 event=fail reason; evidence:excerpt 有长度上限（800 chars，头尾截断）并用 json.dumps 编码，不破坏 kv 日志; evidence:python -m unittest discover -s tests -v (OK 37 tests); risk:low 仅增强失败日志可观测性，不影响成功路径与重试策略。"
